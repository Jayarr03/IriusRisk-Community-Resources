<?xml version="1.0" encoding="UTF-8"?>
<template ref="azure-hub-and-spoke-network-topology" name="Azure - Hub and Spoke Network Topology" tags="">
  <desc/>
  <diagram draft="false">
    <schema>PG14R3JhcGhNb2RlbCBkeD0iMTYxMCIgZHk9Ijk2MyIgZ3JpZD0iMCIgZ3JpZFNpemU9IjEwIiBndWlkZXM9IjEiIHRvb2x0aXBzPSIxIiBjb25uZWN0PSIxIiBhcnJvd3M9IjEiIGZvbGQ9IjEiIHBhZ2U9IjAiIHBhZ2VTY2FsZT0iMSIgcGFnZVdpZHRoPSI4NTAiIHBhZ2VIZWlnaHQ9IjExMDAiIG1hdGg9IjAiIHNoYWRvdz0iMCIgaXJEcmF3aW9WZXJzaW9uPSI0LjYuMCI+CiAgPHJvb3Q+CiAgICA8bXhDZWxsIGlkPSIwIi8+CiAgICA8bXhDZWxsIGlkPSIxIiBwYXJlbnQ9IjAiLz4KICAgIDxteENlbGwgaWQ9IjIiIHZhbHVlPSJQdWJsaWMiIHN0eWxlPSJpci5yZWY9NjM3NmQ1M2UtNjQ2MS00MTJiLThlMDQtN2IzZmUyYjM5N2RlO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7cmVjdXJzaXZlUmVzaXplPTA7aHRtbD0xO3ZlcnRpY2FsQWxpZ249dG9wO2FsaWduPWxlZnQ7ZGFzaGVkPTE7c3Ryb2tlV2lkdGg9MTthcmNTaXplPTM7YWJzb2x1dGVBcmNTaXplPTE7c3BhY2luZ1RvcD0xO3NwYWNpbmdMZWZ0PTMyO3N0cm9rZUNvbG9yPSM3NTc1RUI7ZmlsbENvbG9yPSNGMEYwRkY7ZmlsbE9wYWNpdHk9MzA7Zm9udENvbG9yPSM1NjUxRTA7Y29ubmVjdGFibGU9MDtjb250YWluZXI9MTtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9VFJVU1RaT05FOyIgcGFyZW50PSIxIiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSItMjk4IiB5PSItMTUiIHdpZHRoPSIxMTM3IiBoZWlnaHQ9IjUxMSIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxvYmplY3QgbGFiZWw9IkF6dXJlIEVudmlyb25tZW50IiBpci5zb3VyY2VTdHlsZT0icm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9bWljcm9zb2Z0LWF6dXJlLWVudmlyb25tZW50O2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3S1NJK0ppTjRZVHM4WnlCamJHbHdMWEJoZEdnOUluVnliQ2dqWTJ4cGNERXBJajRtSTNoaE96eHdZWFJvSUdROUlrMHdMak00TnpBMk1pQXdMakUyTmpVd05FZ3dMall3TWpJek1rd3dMak0zT0RnM01pQXdMamd5T0RNd09FTXdMak0zTmpVM05pQXdMamd6TlRFeElEQXVNemN5TWpBMElEQXVPRFF4TURJeElEQXVNelkyTXpjeUlEQXVPRFExTWpBNFF6QXVNell3TlRRZ01DNDRORGt6T1RRZ01DNHpOVE0xTkRFZ01DNDROVEUyTkRZZ01DNHpORFl6TmpJZ01DNDROVEUyTkRaSU1DNHhOemc1TVRGRE1DNHhOek0wTnpJZ01DNDROVEUyTkRjZ01DNHhOamd4TVRFZ01DNDROVEF6TlRJZ01DNHhOak15TnpJZ01DNDRORGM0TmpsRE1DNHhOVGcwTXpNZ01DNDRORFV6T0RZZ01DNHhOVFF5TlRRZ01DNDROREUzT0RjZ01DNHhOVEV3T0RJZ01DNDRNemN6TmpsRE1DNHhORGM1TVNBd0xqZ3pNamsxTVNBd0xqRTBOVGd6TmlBd0xqZ3lOemcwTVNBd0xqRTBOVEF6TVNBd0xqZ3lNalEyTWtNd0xqRTBOREl5TmlBd0xqZ3hOekE0TXlBd0xqRTBORGN4TXlBd0xqZ3hNVFU1SURBdU1UUTJORFV5SURBdU9EQTJORE0yVERBdU16VTBOVFV6SURBdU1UZzVPRFF5UXpBdU16VTJPRFE1SURBdU1UZ3pNRFFnTUM0ek5qRXlNakVnTUM0eE56Y3hNamtnTUM0ek5qY3dOVE1nTUM0eE56STVOREpETUM0ek56STRPRFVnTUM0eE5qZzNOVFlnTUM0ek56azRPRE1nTUM0eE5qWTFNRFFnTUM0ek9EY3dOaklnTUM0eE5qWTFNRFJhSWlCbWFXeHNQU0oxY213b0kzQmhhVzUwTUY5c2FXNWxZWElwSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0Mk9UazJOVGNnTUM0Mk1UQXpOVEpJTUM0ek5UZzBORGRETUM0ek5UVXlOemNnTUM0Mk1UQXpOVElnTUM0ek5USXhPQ0F3TGpZeE1UTXdOaUF3TGpNME9UVTFPU0F3TGpZeE16QTVRekF1TXpRMk9UTTRJREF1TmpFME9EYzBJREF1TXpRME9URTBJREF1TmpFM05EQTFJREF1TXpRek56VXlJREF1TmpJd016VTFRekF1TXpReU5UZzVJREF1TmpJek16QTFJREF1TXpReU16UXhJREF1TmpJMk5UTTJJREF1TXpRek1EUWdNQzQyTWprMk1qbERNQzR6TkRNM016Z2dNQzQyTXpJM01qRWdNQzR6TkRVek5USWdNQzQyTXpVMU16SWdNQzR6TkRjMk55QXdMall6TnpZNU5Vd3dMalUyTmpreU1pQXdMamcwTWpNeU9FTXdMalUzTXpNd05DQXdMamcwT0RJNE5DQXdMalU0TVRjd09DQXdMamcxTVRVNU55QXdMalU1TURRek55QXdMamcxTVRVNU4wZ3dMamM0TXpZek5Fd3dMalk1T1RZMU55QXdMall4TURNMU1sb2lJR1pwYkd3OUlpTXdNRGM0UkRRaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTROekUwTVNBd0xqRTJOalV3TkVNd0xqTTNPVGc0TkNBd0xqRTJOalEzTnlBd0xqTTNNamd3T0NBd0xqRTJPRGMzSURBdU16WTJPVFEzSURBdU1UY3pNRFZETUM0ek5qRXdPRFlnTUM0eE56Y3pNamtnTUM0ek5UWTNORFlnTUM0eE9ETXpOeUF3TGpNMU5EVTJNaUF3TGpFNU1ESTVUREF1TVRRMk56ZzJJREF1T0RBMU9EYzRRekF1TVRRME9UTWdNQzQ0TVRFd05TQXdMakUwTkRNME55QXdMamd4TmpVNU5DQXdMakUwTlRBNE55QXdMamd5TWpBek9VTXdMakUwTlRneU5pQXdMamd5TnpRNE5DQXdMakUwTnpnMk55QXdMamd6TWpZM01TQXdMakUxTVRBek5TQXdMamd6TnpFMk1VTXdMakUxTkRJd015QXdMamcwTVRZMU1TQXdMakUxT0RRd055QXdMamcwTlRNeE1TQXdMakUyTXpJNE9TQXdMamcwTnpnek0wTXdMakUyT0RFM01pQXdMamcxTURNMU5DQXdMakUzTXpVNUlEQXVPRFV4TmpZeklEQXVNVGM1TURnMUlEQXVPRFV4TmpRNFNEQXVNelV3T0RaRE1DNHpOVGN5TmlBd0xqZzFNRFV3TlNBd0xqTTJNekkwTVNBd0xqZzBOelk0TXlBd0xqTTJPREU1TWlBd0xqZzBNelEzTVVNd0xqTTNNekUwTkNBd0xqZ3pPVEkxT1NBd0xqTTNOamc0T0NBd0xqZ3pNemd3T1NBd0xqTTNPVEEwTXlBd0xqZ3lOelkzTmt3d0xqUXlNRFEzTXlBd0xqY3dOVFUzTkV3d0xqVTJPRFEzTlNBd0xqZzBNell4TVVNd0xqVTNORFkzTmlBd0xqZzBPRGMwTXlBd0xqVTRNalExTmlBd0xqZzFNVFU0TWlBd0xqVTVNRFV3TlNBd0xqZzFNVFkwT1Vnd0xqYzRNams0T0V3d0xqWTVPRFUyTlNBd0xqWXhNRFJNTUM0ME5USTBOalFnTUM0Mk1UQTBOVFZNTUM0Mk1ETXdPVFFnTUM0eE5qWTFNRFJJTUM0ek9EY3hOREZhSWlCbWFXeHNQU0oxY213b0kzQmhhVzUwTVY5c2FXNWxZWElwSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0Mk5qRTNPRFVnTUM0eE9EazRNRFpETUM0Mk5UazBPVE1nTUM0eE9ETXdNVFVnTUM0Mk5UVXhNamdnTUM0eE56Y3hNVE1nTUM0Mk5Ea3pNRFlnTUM0eE56STVNek5ETUM0Mk5ETTBPRE1nTUM0eE5qZzNOVE1nTUM0Mk16WTBPVFlnTUM0eE5qWTFNRFFnTUM0Mk1qa3pNamdnTUM0eE5qWTFNRFJJTUM0ek9EazFNalpETUM0ek9UWTJPVFVnTUM0eE5qWTFNRFFnTUM0ME1ETTJPRElnTUM0eE5qZzNOVE1nTUM0ME1EazFNRFVnTUM0eE56STVNek5ETUM0ME1UVXpNamdnTUM0eE56Y3hNVE1nTUM0ME1UazJPVE1nTUM0eE9ETXdNVFVnTUM0ME1qRTVPRFlnTUM0eE9EazRNRFpNTUM0Mk16QXdPVGtnTUM0NE1EWTBNelZETUM0Mk16RTRNemdnTUM0NE1URTFPRGdnTUM0Mk16SXpNalVnTUM0NE1UY3dPRElnTUM0Mk16RTFNVGtnTUM0NE1qSTBOa013TGpZek1EY3hOQ0F3TGpneU56Z3pPU0F3TGpZeU9EWXpPU0F3TGpnek1qazBPU0F3TGpZeU5UUTJOeUF3TGpnek56TTJPRU13TGpZeU1qSTVOU0F3TGpnME1UYzROaUF3TGpZeE9ERXhOeUF3TGpnME5UTTROU0F3TGpZeE16STNPQ0F3TGpnME56ZzJPVU13TGpZd09EUXpPU0F3TGpnMU1ETTFNaUF3TGpZd016QTNPQ0F3TGpnMU1UWTBOeUF3TGpVNU56WXpPU0F3TGpnMU1UWTBPRWd3TGpnek56UTBNVU13TGpnME1qZzRJREF1T0RVeE5qUTNJREF1T0RRNE1qUXhJREF1T0RVd016VXlJREF1T0RVek1EZ2dNQzQ0TkRjNE5qbERNQzQ0TlRjNU1Ua2dNQzQ0TkRVek9EWWdNQzQ0TmpJd09UY2dNQzQ0TkRFM09EWWdNQzQ0TmpVeU5qa2dNQzQ0TXpjek5qaERNQzQ0TmpnME5ERWdNQzQ0TXpJNU5Ea2dNQzQ0TnpBMU1UVWdNQzQ0TWpjNE16a2dNQzQ0TnpFek1pQXdMamd5TWpRMlF6QXVPRGN5TVRJMUlEQXVPREUzTURneElEQXVPRGN4TmpNM0lEQXVPREV4TlRnNElEQXVPRFk1T0RrNElEQXVPREEyTkRNMVREQXVOall4TnpnMUlEQXVNVGc1T0RBMldpSWdabWxzYkQwaWRYSnNLQ053WVdsdWRESmZiR2x1WldGeUtTSXZQaVlqZUdFN1BDOW5QaVlqZUdFN1BDOW5QaVlqZUdFN1BHUmxabk0rSmlONFlUczhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbkJoYVc1ME1GOXNhVzVsWVhJaUlIZ3hQU0l3TGpRMk5UUTROaUlnZVRFOUlqQXVNakUzTWpjMUlpQjRNajBpTUM0eU5ESXdNamtpSUhreVBTSXdMamczTnpReU1pSWdaM0poWkdsbGJuUlZibWwwY3owaWRYTmxjbE53WVdObFQyNVZjMlVpUGlZamVHRTdQSE4wYjNBZ2MzUnZjQzFqYjJ4dmNqMGlJekV4TkVFNFFpSXZQaVlqZUdFN1BITjBiM0FnYjJabWMyVjBQU0l4SWlCemRHOXdMV052Ykc5eVBTSWpNRFkyT1VKRElpOCtKaU40WVRzOEwyeHBibVZoY2tkeVlXUnBaVzUwUGlZamVHRTdQR3hwYm1WaGNrZHlZV1JwWlc1MElHbGtQU0p3WVdsdWRERmZiR2x1WldGeUlpQjRNVDBpTUM0MU16VXpOeUlnZVRFOUlqQXVOVEkwT1RJaUlIZ3lQU0l3TGpRNE16WTNPU0lnZVRJOUlqQXVOVFF5TXprNElpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krSmlONFlUczhjM1J2Y0NCemRHOXdMVzl3WVdOcGRIazlJakF1TXlJdlBpWWplR0U3UEhOMGIzQWdiMlptYzJWMFBTSXdMakEzTVRJaUlITjBiM0F0YjNCaFkybDBlVDBpTUM0eUlpOCtKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TXpJeElpQnpkRzl3TFc5d1lXTnBkSGs5SWpBdU1TSXZQaVlqZUdFN1BITjBiM0FnYjJabWMyVjBQU0l3TGpZeU16RWlJSE4wYjNBdGIzQmhZMmwwZVQwaU1DNHdOU0l2UGlZamVHRTdQSE4wYjNBZ2IyWm1jMlYwUFNJeElpQnpkRzl3TFc5d1lXTnBkSGs5SWpBaUx6NG1JM2hoT3p3dmJHbHVaV0Z5UjNKaFpHbGxiblErSmlONFlUczhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbkJoYVc1ME1sOXNhVzVsWVhJaUlIZ3hQU0l3TGpVd05qYzJNU0lnZVRFOUlqQXVNVGs0TURFMUlpQjRNajBpTUM0M05USXdORFlpSUhreVBTSXdMamcxTVRVeE55SWdaM0poWkdsbGJuUlZibWwwY3owaWRYTmxjbE53WVdObFQyNVZjMlVpUGlZamVHRTdQSE4wYjNBZ2MzUnZjQzFqYjJ4dmNqMGlJek5EUTBKR05DSXZQaVlqZUdFN1BITjBiM0FnYjJabWMyVjBQU0l4SWlCemRHOXdMV052Ykc5eVBTSWpNamc1TWtSR0lpOCtKaU40WVRzOEwyeHBibVZoY2tkeVlXUnBaVzUwUGlZamVHRTdQR05zYVhCUVlYUm9JR2xrUFNKamJHbHdNQ0krSmlONFlUczhjbVZqZENCM2FXUjBhRDBpTUM0NU9EUTJNVFVpSUdobGFXZG9kRDBpTUM0NU9EUTJNVEVpSUdacGJHdzlJbmRvYVhSbElpQjBjbUZ1YzJadmNtMDlJblJ5WVc1emJHRjBaU2d3TGpBeE5UTTRNRGtnTUM0d01UVXpPREE1S1NJdlBpWWplR0U3UEM5amJHbHdVR0YwYUQ0bUkzaGhPenhqYkdsd1VHRjBhQ0JwWkQwaVkyeHBjREVpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU56azFOVFk1SWlCb1pXbG5hSFE5SWpBdU56azFOVFkxSWlCbWFXeHNQU0ozYUdsMFpTSWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0eE1EazVPRFVnTUM0eE1EazROak1wSWk4K0ppTjRZVHM4TDJOc2FYQlFZWFJvUGlZamVHRTdQQzlrWldaelBpWWplR0U3UEM5emRtYys7dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSIzIj4KICAgICAgPG14Q2VsbCBzdHlsZT0iaXIucmVmPTIxMWE1NDk2LTMwNzMtNGFmMi05ZjcyLWE1ZTZjNjRiNzNjMjtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1sZWZ0O2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT0zO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTM7c291cmNlPWN1c3RvbTtpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1taWNyb3NvZnQtYXp1cmUtZW52aXJvbm1lbnQ7dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7Y29udGFpbmVyPTE7cGVyaW1ldGVyPXJlY3RhbmdsZVBlcmltZXRlcjtyZWN1cnNpdmVSZXNpemU9MDtzdHJva2VXaWR0aD0xO3RleHREaXJlY3Rpb249bHRyO3NwYWNpbmdUb3A9MTtzcGFjaW5nTGVmdD0zMjsiIHBhcmVudD0iMiIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgICA8bXhHZW9tZXRyeSB4PSIyMyIgeT0iNDEiIHdpZHRoPSIxMDkxIiBoZWlnaHQ9IjQ0MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICAgIDwvbXhDZWxsPgogICAgPC9vYmplY3Q+CiAgICA8bXhDZWxsIGlkPSIyNCIgdmFsdWU9IlNwb2tlIE5ldHdvcmsgLSZndDsgSHViIE5ldHdvcmsiIHN0eWxlPSJpci5yZWY9MGVjYjk2ODYtOTIwNS00NWRmLTg4MzYtZmFkOTgxNDg1ZjNlO2VkZ2VTdHlsZT1ub25lO2N1cnZlZD0xO2h0bWw9MTtpci5zeW5jaHJvbml6ZWQ9MTtleGl0WD0wO2V4aXRZPTAuMjU7ZXhpdER4PTA7ZXhpdER5PTA7ZW50cnlYPTAuOTQ7ZW50cnlZPTAuMTQ4O2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW50cnlQZXJpbWV0ZXI9MDtlbmRBcnJvdz1vcGVuO2VuZEZpbGw9MDtlbmRTaXplPTQ7c291cmNlUGVyaW1ldGVyU3BhY2luZz05O3N0cm9rZUNvbG9yPSNCRkJGQkY7c3Ryb2tlV2lkdGg9MjsiIHBhcmVudD0iMyIgc291cmNlPSI2IiB0YXJnZXQ9IjUiIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxvYmplY3QgbGFiZWw9IlNwb2tlIE5ldHdvcmsiIGlyLnNvdXJjZVN0eWxlPSJyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxMYWJlbFBvc2l0aW9uPW1pZGRsZTt2ZXJ0aWNhbEFsaWduPW1pZGRsZTtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSI2Ij4KICAgICAgPG14Q2VsbCBzdHlsZT0iaXIucmVmPTMyZWIyMGM1LTBhNTctNDhmMS1hMzI2LTRmOTc1ZWFjYWYxZTtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1sZWZ0O2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT0zO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTM7c291cmNlPWN1c3RvbTtpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7Y29udGFpbmVyPTE7cGVyaW1ldGVyPXJlY3RhbmdsZVBlcmltZXRlcjtyZWN1cnNpdmVSZXNpemU9MDtzdHJva2VXaWR0aD0xO3RleHREaXJlY3Rpb249bHRyO3NwYWNpbmdUb3A9MTtzcGFjaW5nTGVmdD0zMjsiIHBhcmVudD0iMyIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgICA8bXhHZW9tZXRyeSB4PSI2MjUiIHk9IjI4IiB3aWR0aD0iNDQ1IiBoZWlnaHQ9IjE5MSIgYXM9Imdlb21ldHJ5Ii8+CiAgICAgIDwvbXhDZWxsPgogICAgPC9vYmplY3Q+CiAgICA8bXhDZWxsIGlkPSIxMSIgdmFsdWU9IkF6dXJlIFZpcnR1YWwgTWFjaGluZXMiIHN0eWxlPSJpci5yZWY9ZTU4MmY1NmItNTk0Yy00M2Y0LThjYmQtYWJmMTQ1MjE1YzlhO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWF6dXJlLXZpcnR1YWwtbWFjaGluZXM7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQ0T0RFME56VWdNQzR4TkRFek5UZElNQzR4TXpZMU9EaERNQzR4TWpFNE9UWWdNQzR4TkRFek5UY2dNQzR4TURrNU9EVWdNQzR4TlRNeU5qZ2dNQzR4TURrNU9EVWdNQzR4TmpjNU5sWXdMalkwTmpneE5VTXdMakV3T1RrNE5TQXdMalkyTVRVd055QXdMakV5TVRnNU5pQXdMalkzTXpReE9DQXdMakV6TmpVNE9DQXdMalkzTXpReE9FZ3dMamc0TVRRM05VTXdMamc1TmpFMk55QXdMalkzTXpReE9DQXdMamt3T0RBM09DQXdMalkyTVRVd055QXdMamt3T0RBM09DQXdMalkwTmpneE5WWXdMakUyTnprMlF6QXVPVEE0TURjNElEQXVNVFV6TWpZNElEQXVPRGsyTVRZM0lEQXVNVFF4TXpVM0lEQXVPRGd4TkRjMUlEQXVNVFF4TXpVM1dpSWdabWxzYkQwaWRYSnNLQ053WVdsdWREQmZiR2x1WldGeUtTSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURRNUlEQXVNekk1T0RNMFZqQXVORGcwTlRjMVREQXVOVEE1TURNeklEQXVOVFl5TmpFeFZqQXVOREEzTkRJMlREQXVOalF5TURRNUlEQXVNekk1T0RNMFdpSWdabWxzYkQwaUl6VXdSVFpHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5qUXlNREExSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU5EQTNPREkxVERBdU16YzFPVGMzSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU1qVXlNVGszVERBdU5qUXlNREExSURBdU16STVOemc1V2lJZ1ptbHNiRDBpSTBNelJqRkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TlRBNE9Ua3pJREF1TkRBM09EZFdNQzQxTmpJMk1URk1NQzR6TnpVNU56Y2dNQzQwT0RRMU56VldNQzR6TWprNE16Uk1NQzQxTURnNU9UTWdNQzQwTURjNE4xb2lJR1pwYkd3OUlpTTVRMFZDUmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTNOVGszTnlBd0xqUTRORFl4T1V3d0xqVXdPRGs1TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqTTNOVGszTnlBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlORE0wWXhSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZME1qQTBPU0F3TGpRNE5EWXhPVXd3TGpVd09UQXpNeUF3TGpRd056UTNNVll3TGpVMk1qWTFNMHd3TGpZME1qQTBPU0F3TGpRNE5EWXhPVm9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalkyT1RBek1pQXdMamd6TkRJNE9FTXdMalU1TURFeElEQXVPREl4T0RjeklEQXVOVGczTURBMklEQXVOelkxTVRJZ01DNDFPRGN3TURZZ01DNDJOek16TkVnd0xqUXpNRFE1TWtNd0xqUXpNRFE1TWlBd0xqYzJOVEV5SURBdU5ESTNPRE15SURBdU9ESXhPRGN6SURBdU16UTRPVEVnTUM0NE16UXlPRGhETUM0ek16Z3dNVFVnTUM0NE16VTBPVE1nTUM0ek1qYzVOVE1nTUM0NE5EQTJPVElnTUM0ek1qQTJOallnTUM0NE5EZzRPRU13TGpNeE16TTNPU0F3TGpnMU56QTJPQ0F3TGpNd09UTTRNeUF3TGpnMk56WTJOU0F3TGpNd09UUTBPU0F3TGpnM09EWXlOa2d3TGpjd09EUTVNME13TGpjd09EVTJJREF1T0RZM05qWTFJREF1TnpBME5UWTBJREF1T0RVM01EWTRJREF1TmprM01qYzJJREF1T0RRNE9EaERNQzQyT0RrNU9Ea2dNQzQ0TkRBMk9USWdNQzQyTnprNU1qY2dNQzQ0TXpVME9UTWdNQzQyTmprd016SWdNQzQ0TXpReU9EaGFJaUJtYVd4c1BTSjFjbXdvSTNCaGFXNTBNVjlzYVc1bFlYSXBJaTgrSmlONFlUczhMMmMrSmlONFlUczhaR1ZtY3o0bUkzaGhPenhzYVc1bFlYSkhjbUZrYVdWdWRDQnBaRDBpY0dGcGJuUXdYMnhwYm1WaGNpSWdlREU5SWpBdU5UQTVNRE15SWlCNU1UMGlNQzQyTnpNME1UZ2lJSGd5UFNJd0xqVXdPVEF6TWlJZ2VUSTlJakF1TVRReE16VTNJaUJuY21Ga2FXVnVkRlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJK0ppTjRZVHM4YzNSdmNDQnpkRzl3TFdOdmJHOXlQU0lqTURBM09FUTBJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU9ESWlJSE4wYjNBdFkyOXNiM0k5SWlNMVJVRXdSVVlpTHo0bUkzaGhPend2YkdsdVpXRnlSM0poWkdsbGJuUStKaU40WVRzOGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUluQmhhVzUwTVY5c2FXNWxZWElpSUhneFBTSXdMalV3T0RrM01TSWdlVEU5SWpBdU9EYzROakkySWlCNE1qMGlNQzQxTURnNU56RWlJSGt5UFNJd0xqWTNNek0wSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TVRVaUlITjBiM0F0WTI5c2IzSTlJaU5EUTBORFEwTWlMejRtSTNoaE96eHpkRzl3SUc5bVpuTmxkRDBpTVNJZ2MzUnZjQzFqYjJ4dmNqMGlJemN3TnpBM01DSXZQaVlqZUdFN1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0bUkzaGhPenhqYkdsd1VHRjBhQ0JwWkQwaVkyeHBjREFpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9UZzBOakUxSWlCb1pXbG5hSFE5SWpBdU9UZzBOakV4SWlCbWFXeHNQU0ozYUdsMFpTSWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0d01UVXpPREE1SURBdU1ERTFNemd3T1NraUx6NG1JM2hoT3p3dlkyeHBjRkJoZEdnK0ppTjRZVHM4TDJSbFpuTStKaU40WVRzOEwzTjJaejQ9O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjYiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjM5IiB5PSI1NCIgd2lkdGg9IjkwIiBoZWlnaHQ9IjkwIiBhcz0iZ2VvbWV0cnkiLz4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMTMiIHZhbHVlPSJBenVyZSBWaXJ0dWFsIE1hY2hpbmVzIiBzdHlsZT0iaXIucmVmPTkyNGYzODEzLTA2YWQtNDJmMy04NTU1LWQ0ZTNkYmVhMDM2Njtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1henVyZS12aXJ0dWFsLW1hY2hpbmVzO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3S1NJK0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NE9ERTBOelVnTUM0eE5ERXpOVGRJTUM0eE16WTFPRGhETUM0eE1qRTRPVFlnTUM0eE5ERXpOVGNnTUM0eE1EazVPRFVnTUM0eE5UTXlOamdnTUM0eE1EazVPRFVnTUM0eE5qYzVObFl3TGpZME5qZ3hOVU13TGpFd09UazROU0F3TGpZMk1UVXdOeUF3TGpFeU1UZzVOaUF3TGpZM016UXhPQ0F3TGpFek5qVTRPQ0F3TGpZM016UXhPRWd3TGpnNE1UUTNOVU13TGpnNU5qRTJOeUF3TGpZM016UXhPQ0F3TGprd09EQTNPQ0F3TGpZMk1UVXdOeUF3TGprd09EQTNPQ0F3TGpZME5qZ3hOVll3TGpFMk56azJRekF1T1RBNE1EYzRJREF1TVRVek1qWTRJREF1T0RrMk1UWTNJREF1TVRReE16VTNJREF1T0RneE5EYzFJREF1TVRReE16VTNXaUlnWm1sc2JEMGlkWEpzS0NOd1lXbHVkREJmYkdsdVpXRnlLU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TmpReU1EUTVJREF1TXpJNU9ETTBWakF1TkRnME5UYzFUREF1TlRBNU1ETXpJREF1TlRZeU5qRXhWakF1TkRBM05ESTJUREF1TmpReU1EUTVJREF1TXpJNU9ETTBXaUlnWm1sc2JEMGlJelV3UlRaR1JpSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURBMUlEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVOREEzT0RJMVREQXVNemMxT1RjM0lEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVNalV5TVRrM1REQXVOalF5TURBMUlEQXVNekk1TnpnNVdpSWdabWxzYkQwaUkwTXpSakZHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UQTRPVGt6SURBdU5EQTNPRGRXTUM0MU5qSTJNVEZNTUM0ek56VTVOemNnTUM0ME9EUTFOelZXTUM0ek1qazRNelJNTUM0MU1EZzVPVE1nTUM0ME1EYzROMW9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMak0zTlRrM055QXdMalE0TkRZeE9Vd3dMalV3T0RrNU15QXdMalF3TnpRM01WWXdMalUyTWpZMU0wd3dMak0zTlRrM055QXdMalE0TkRZeE9Wb2lJR1pwYkd3OUlpTkRNMFl4UmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqWTBNakEwT1NBd0xqUTRORFl4T1V3d0xqVXdPVEF6TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqWTBNakEwT1NBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlNNVEwVkNSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZMk9UQXpNaUF3TGpnek5ESTRPRU13TGpVNU1ERXhJREF1T0RJeE9EY3pJREF1TlRnM01EQTJJREF1TnpZMU1USWdNQzQxT0Rjd01EWWdNQzQyTnpNek5FZ3dMalF6TURRNU1rTXdMalF6TURRNU1pQXdMamMyTlRFeUlEQXVOREkzT0RNeUlEQXVPREl4T0RjeklEQXVNelE0T1RFZ01DNDRNelF5T0RoRE1DNHpNemd3TVRVZ01DNDRNelUwT1RNZ01DNHpNamM1TlRNZ01DNDROREEyT1RJZ01DNHpNakEyTmpZZ01DNDRORGc0T0VNd0xqTXhNek0zT1NBd0xqZzFOekEyT0NBd0xqTXdPVE00TXlBd0xqZzJOelkyTlNBd0xqTXdPVFEwT1NBd0xqZzNPRFl5Tmtnd0xqY3dPRFE1TTBNd0xqY3dPRFUySURBdU9EWTNOalkxSURBdU56QTBOVFkwSURBdU9EVTNNRFk0SURBdU5qazNNamMySURBdU9EUTRPRGhETUM0Mk9EazVPRGtnTUM0NE5EQTJPVElnTUM0Mk56azVNamNnTUM0NE16VTBPVE1nTUM0Mk5qa3dNeklnTUM0NE16UXlPRGhhSWlCbWFXeHNQU0oxY213b0kzQmhhVzUwTVY5c2FXNWxZWElwSWk4K0ppTjRZVHM4TDJjK0ppTjRZVHM4WkdWbWN6NG1JM2hoT3p4c2FXNWxZWEpIY21Ga2FXVnVkQ0JwWkQwaWNHRnBiblF3WDJ4cGJtVmhjaUlnZURFOUlqQXVOVEE1TURNeUlpQjVNVDBpTUM0Mk56TTBNVGdpSUhneVBTSXdMalV3T1RBek1pSWdlVEk5SWpBdU1UUXhNelUzSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J6ZEc5d0xXTnZiRzl5UFNJak1EQTNPRVEwSWk4K0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVPRElpSUhOMGIzQXRZMjlzYjNJOUlpTTFSVUV3UlVZaUx6NG1JM2hoT3p3dmJHbHVaV0Z5UjNKaFpHbGxiblErSmlONFlUczhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbkJoYVc1ME1WOXNhVzVsWVhJaUlIZ3hQU0l3TGpVd09EazNNU0lnZVRFOUlqQXVPRGM0TmpJMklpQjRNajBpTUM0MU1EZzVOekVpSUhreVBTSXdMalkzTXpNMElpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU1UVWlJSE4wYjNBdFkyOXNiM0k5SWlORFEwTkRRME1pTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1TSWdjM1J2Y0MxamIyeHZjajBpSXpjd056QTNNQ0l2UGlZamVHRTdQQzlzYVc1bFlYSkhjbUZrYVdWdWRENG1JM2hoT3p4amJHbHdVR0YwYUNCcFpEMGlZMnhwY0RBaVBpWWplR0U3UEhKbFkzUWdkMmxrZEdnOUlqQXVPVGcwTmpFMUlpQm9aV2xuYUhROUlqQXVPVGcwTmpFeElpQm1hV3hzUFNKM2FHbDBaU0lnZEhKaGJuTm1iM0p0UFNKMGNtRnVjMnhoZEdVb01DNHdNVFV6T0RBNUlEQXVNREUxTXpnd09Ta2lMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOEwyUmxabk0rSmlONFlUczhMM04yWno0PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSI2IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIzMjAiIHk9IjU0IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIxMiIgdmFsdWU9IkF6dXJlIFZpcnR1YWwgTWFjaGluZXMiIHN0eWxlPSJpci5yZWY9NmVhZmVjZDctMjVkYS00NWZhLWI5NWEtYTAwOWZlNWE5MTQwO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWF6dXJlLXZpcnR1YWwtbWFjaGluZXM7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQ0T0RFME56VWdNQzR4TkRFek5UZElNQzR4TXpZMU9EaERNQzR4TWpFNE9UWWdNQzR4TkRFek5UY2dNQzR4TURrNU9EVWdNQzR4TlRNeU5qZ2dNQzR4TURrNU9EVWdNQzR4TmpjNU5sWXdMalkwTmpneE5VTXdMakV3T1RrNE5TQXdMalkyTVRVd055QXdMakV5TVRnNU5pQXdMalkzTXpReE9DQXdMakV6TmpVNE9DQXdMalkzTXpReE9FZ3dMamc0TVRRM05VTXdMamc1TmpFMk55QXdMalkzTXpReE9DQXdMamt3T0RBM09DQXdMalkyTVRVd055QXdMamt3T0RBM09DQXdMalkwTmpneE5WWXdMakUyTnprMlF6QXVPVEE0TURjNElEQXVNVFV6TWpZNElEQXVPRGsyTVRZM0lEQXVNVFF4TXpVM0lEQXVPRGd4TkRjMUlEQXVNVFF4TXpVM1dpSWdabWxzYkQwaWRYSnNLQ053WVdsdWREQmZiR2x1WldGeUtTSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURRNUlEQXVNekk1T0RNMFZqQXVORGcwTlRjMVREQXVOVEE1TURNeklEQXVOVFl5TmpFeFZqQXVOREEzTkRJMlREQXVOalF5TURRNUlEQXVNekk1T0RNMFdpSWdabWxzYkQwaUl6VXdSVFpHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5qUXlNREExSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU5EQTNPREkxVERBdU16YzFPVGMzSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU1qVXlNVGszVERBdU5qUXlNREExSURBdU16STVOemc1V2lJZ1ptbHNiRDBpSTBNelJqRkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TlRBNE9Ua3pJREF1TkRBM09EZFdNQzQxTmpJMk1URk1NQzR6TnpVNU56Y2dNQzQwT0RRMU56VldNQzR6TWprNE16Uk1NQzQxTURnNU9UTWdNQzQwTURjNE4xb2lJR1pwYkd3OUlpTTVRMFZDUmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTNOVGszTnlBd0xqUTRORFl4T1V3d0xqVXdPRGs1TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqTTNOVGszTnlBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlORE0wWXhSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZME1qQTBPU0F3TGpRNE5EWXhPVXd3TGpVd09UQXpNeUF3TGpRd056UTNNVll3TGpVMk1qWTFNMHd3TGpZME1qQTBPU0F3TGpRNE5EWXhPVm9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalkyT1RBek1pQXdMamd6TkRJNE9FTXdMalU1TURFeElEQXVPREl4T0RjeklEQXVOVGczTURBMklEQXVOelkxTVRJZ01DNDFPRGN3TURZZ01DNDJOek16TkVnd0xqUXpNRFE1TWtNd0xqUXpNRFE1TWlBd0xqYzJOVEV5SURBdU5ESTNPRE15SURBdU9ESXhPRGN6SURBdU16UTRPVEVnTUM0NE16UXlPRGhETUM0ek16Z3dNVFVnTUM0NE16VTBPVE1nTUM0ek1qYzVOVE1nTUM0NE5EQTJPVElnTUM0ek1qQTJOallnTUM0NE5EZzRPRU13TGpNeE16TTNPU0F3TGpnMU56QTJPQ0F3TGpNd09UTTRNeUF3TGpnMk56WTJOU0F3TGpNd09UUTBPU0F3TGpnM09EWXlOa2d3TGpjd09EUTVNME13TGpjd09EVTJJREF1T0RZM05qWTFJREF1TnpBME5UWTBJREF1T0RVM01EWTRJREF1TmprM01qYzJJREF1T0RRNE9EaERNQzQyT0RrNU9Ea2dNQzQ0TkRBMk9USWdNQzQyTnprNU1qY2dNQzQ0TXpVME9UTWdNQzQyTmprd016SWdNQzQ0TXpReU9EaGFJaUJtYVd4c1BTSjFjbXdvSTNCaGFXNTBNVjlzYVc1bFlYSXBJaTgrSmlONFlUczhMMmMrSmlONFlUczhaR1ZtY3o0bUkzaGhPenhzYVc1bFlYSkhjbUZrYVdWdWRDQnBaRDBpY0dGcGJuUXdYMnhwYm1WaGNpSWdlREU5SWpBdU5UQTVNRE15SWlCNU1UMGlNQzQyTnpNME1UZ2lJSGd5UFNJd0xqVXdPVEF6TWlJZ2VUSTlJakF1TVRReE16VTNJaUJuY21Ga2FXVnVkRlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJK0ppTjRZVHM4YzNSdmNDQnpkRzl3TFdOdmJHOXlQU0lqTURBM09FUTBJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU9ESWlJSE4wYjNBdFkyOXNiM0k5SWlNMVJVRXdSVVlpTHo0bUkzaGhPend2YkdsdVpXRnlSM0poWkdsbGJuUStKaU40WVRzOGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUluQmhhVzUwTVY5c2FXNWxZWElpSUhneFBTSXdMalV3T0RrM01TSWdlVEU5SWpBdU9EYzROakkySWlCNE1qMGlNQzQxTURnNU56RWlJSGt5UFNJd0xqWTNNek0wSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TVRVaUlITjBiM0F0WTI5c2IzSTlJaU5EUTBORFEwTWlMejRtSTNoaE96eHpkRzl3SUc5bVpuTmxkRDBpTVNJZ2MzUnZjQzFqYjJ4dmNqMGlJemN3TnpBM01DSXZQaVlqZUdFN1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0bUkzaGhPenhqYkdsd1VHRjBhQ0JwWkQwaVkyeHBjREFpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9UZzBOakUxSWlCb1pXbG5hSFE5SWpBdU9UZzBOakV4SWlCbWFXeHNQU0ozYUdsMFpTSWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0d01UVXpPREE1SURBdU1ERTFNemd3T1NraUx6NG1JM2hoT3p3dlkyeHBjRkJoZEdnK0ppTjRZVHM4TDJSbFpuTStKaU40WVRzOEwzTjJaejQ9O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjYiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjE4MCIgeT0iNTQiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjI1IiB2YWx1ZT0iU3Bva2UgTmV0d29yayAtJmd0OyBIdWIgTmV0d29yayIgc3R5bGU9ImlyLnJlZj03YjY4MmQzNi00MWEyLTQ2OTItYjMyMS0zOTQ5NTU1Yzc4NGI7ZWRnZVN0eWxlPW5vbmU7Y3VydmVkPTE7aHRtbD0xO2lyLnN5bmNocm9uaXplZD0xO2V4aXRYPTA7ZXhpdFk9MC43NTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MC45NzM7ZW50cnlZPTAuOTI5O2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW50cnlQZXJpbWV0ZXI9MDtlbmRBcnJvdz1vcGVuO2VuZEZpbGw9MDtlbmRTaXplPTQ7c291cmNlUGVyaW1ldGVyU3BhY2luZz05O3N0cm9rZUNvbG9yPSNCRkJGQkY7c3Ryb2tlV2lkdGg9MjsiIHBhcmVudD0iMyIgc291cmNlPSI3IiB0YXJnZXQ9IjUiIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxvYmplY3QgbGFiZWw9IlNwb2tlIE5ldHdvcmsiIGlyLnNvdXJjZVN0eWxlPSJyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxMYWJlbFBvc2l0aW9uPW1pZGRsZTt2ZXJ0aWNhbEFsaWduPW1pZGRsZTtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSI3Ij4KICAgICAgPG14Q2VsbCBzdHlsZT0iaXIucmVmPTQ5ZDkxMDUyLWE2NGItNDU2YS1iYjg0LThlMDYwZDY4YjEzMDtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1sZWZ0O2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT0zO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTM7c291cmNlPWN1c3RvbTtpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7Y29udGFpbmVyPTE7cGVyaW1ldGVyPXJlY3RhbmdsZVBlcmltZXRlcjtyZWN1cnNpdmVSZXNpemU9MDtzdHJva2VXaWR0aD0xO3RleHREaXJlY3Rpb249bHRyO3NwYWNpbmdUb3A9MTtzcGFjaW5nTGVmdD0zMjsiIHBhcmVudD0iMyIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgICA8bXhHZW9tZXRyeSB4PSI2MjciIHk9IjIyOSIgd2lkdGg9IjQ0NSIgaGVpZ2h0PSIxOTEiIGFzPSJnZW9tZXRyeSIvPgogICAgICA8L214Q2VsbD4KICAgIDwvb2JqZWN0PgogICAgPG14Q2VsbCBpZD0iMTYiIHZhbHVlPSJBenVyZSBWaXJ0dWFsIE1hY2hpbmVzIiBzdHlsZT0iaXIucmVmPWExNTk5ZTA2LWJjZDItNDgxOC1iMzc2LTgzNWQ4ZDA2N2M3NDtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1henVyZS12aXJ0dWFsLW1hY2hpbmVzO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3S1NJK0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NE9ERTBOelVnTUM0eE5ERXpOVGRJTUM0eE16WTFPRGhETUM0eE1qRTRPVFlnTUM0eE5ERXpOVGNnTUM0eE1EazVPRFVnTUM0eE5UTXlOamdnTUM0eE1EazVPRFVnTUM0eE5qYzVObFl3TGpZME5qZ3hOVU13TGpFd09UazROU0F3TGpZMk1UVXdOeUF3TGpFeU1UZzVOaUF3TGpZM016UXhPQ0F3TGpFek5qVTRPQ0F3TGpZM016UXhPRWd3TGpnNE1UUTNOVU13TGpnNU5qRTJOeUF3TGpZM016UXhPQ0F3TGprd09EQTNPQ0F3TGpZMk1UVXdOeUF3TGprd09EQTNPQ0F3TGpZME5qZ3hOVll3TGpFMk56azJRekF1T1RBNE1EYzRJREF1TVRVek1qWTRJREF1T0RrMk1UWTNJREF1TVRReE16VTNJREF1T0RneE5EYzFJREF1TVRReE16VTNXaUlnWm1sc2JEMGlkWEpzS0NOd1lXbHVkREJmYkdsdVpXRnlLU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TmpReU1EUTVJREF1TXpJNU9ETTBWakF1TkRnME5UYzFUREF1TlRBNU1ETXpJREF1TlRZeU5qRXhWakF1TkRBM05ESTJUREF1TmpReU1EUTVJREF1TXpJNU9ETTBXaUlnWm1sc2JEMGlJelV3UlRaR1JpSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURBMUlEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVOREEzT0RJMVREQXVNemMxT1RjM0lEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVNalV5TVRrM1REQXVOalF5TURBMUlEQXVNekk1TnpnNVdpSWdabWxzYkQwaUkwTXpSakZHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UQTRPVGt6SURBdU5EQTNPRGRXTUM0MU5qSTJNVEZNTUM0ek56VTVOemNnTUM0ME9EUTFOelZXTUM0ek1qazRNelJNTUM0MU1EZzVPVE1nTUM0ME1EYzROMW9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMak0zTlRrM055QXdMalE0TkRZeE9Vd3dMalV3T0RrNU15QXdMalF3TnpRM01WWXdMalUyTWpZMU0wd3dMak0zTlRrM055QXdMalE0TkRZeE9Wb2lJR1pwYkd3OUlpTkRNMFl4UmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqWTBNakEwT1NBd0xqUTRORFl4T1V3d0xqVXdPVEF6TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqWTBNakEwT1NBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlNNVEwVkNSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZMk9UQXpNaUF3TGpnek5ESTRPRU13TGpVNU1ERXhJREF1T0RJeE9EY3pJREF1TlRnM01EQTJJREF1TnpZMU1USWdNQzQxT0Rjd01EWWdNQzQyTnpNek5FZ3dMalF6TURRNU1rTXdMalF6TURRNU1pQXdMamMyTlRFeUlEQXVOREkzT0RNeUlEQXVPREl4T0RjeklEQXVNelE0T1RFZ01DNDRNelF5T0RoRE1DNHpNemd3TVRVZ01DNDRNelUwT1RNZ01DNHpNamM1TlRNZ01DNDROREEyT1RJZ01DNHpNakEyTmpZZ01DNDRORGc0T0VNd0xqTXhNek0zT1NBd0xqZzFOekEyT0NBd0xqTXdPVE00TXlBd0xqZzJOelkyTlNBd0xqTXdPVFEwT1NBd0xqZzNPRFl5Tmtnd0xqY3dPRFE1TTBNd0xqY3dPRFUySURBdU9EWTNOalkxSURBdU56QTBOVFkwSURBdU9EVTNNRFk0SURBdU5qazNNamMySURBdU9EUTRPRGhETUM0Mk9EazVPRGtnTUM0NE5EQTJPVElnTUM0Mk56azVNamNnTUM0NE16VTBPVE1nTUM0Mk5qa3dNeklnTUM0NE16UXlPRGhhSWlCbWFXeHNQU0oxY213b0kzQmhhVzUwTVY5c2FXNWxZWElwSWk4K0ppTjRZVHM4TDJjK0ppTjRZVHM4WkdWbWN6NG1JM2hoT3p4c2FXNWxZWEpIY21Ga2FXVnVkQ0JwWkQwaWNHRnBiblF3WDJ4cGJtVmhjaUlnZURFOUlqQXVOVEE1TURNeUlpQjVNVDBpTUM0Mk56TTBNVGdpSUhneVBTSXdMalV3T1RBek1pSWdlVEk5SWpBdU1UUXhNelUzSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J6ZEc5d0xXTnZiRzl5UFNJak1EQTNPRVEwSWk4K0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVPRElpSUhOMGIzQXRZMjlzYjNJOUlpTTFSVUV3UlVZaUx6NG1JM2hoT3p3dmJHbHVaV0Z5UjNKaFpHbGxiblErSmlONFlUczhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbkJoYVc1ME1WOXNhVzVsWVhJaUlIZ3hQU0l3TGpVd09EazNNU0lnZVRFOUlqQXVPRGM0TmpJMklpQjRNajBpTUM0MU1EZzVOekVpSUhreVBTSXdMalkzTXpNMElpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU1UVWlJSE4wYjNBdFkyOXNiM0k5SWlORFEwTkRRME1pTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1TSWdjM1J2Y0MxamIyeHZjajBpSXpjd056QTNNQ0l2UGlZamVHRTdQQzlzYVc1bFlYSkhjbUZrYVdWdWRENG1JM2hoT3p4amJHbHdVR0YwYUNCcFpEMGlZMnhwY0RBaVBpWWplR0U3UEhKbFkzUWdkMmxrZEdnOUlqQXVPVGcwTmpFMUlpQm9aV2xuYUhROUlqQXVPVGcwTmpFeElpQm1hV3hzUFNKM2FHbDBaU0lnZEhKaGJuTm1iM0p0UFNKMGNtRnVjMnhoZEdVb01DNHdNVFV6T0RBNUlEQXVNREUxTXpnd09Ta2lMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOEwyUmxabk0rSmlONFlUczhMM04yWno0PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSI3IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIzMTgiIHk9IjM5IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIxNSIgdmFsdWU9IkF6dXJlIFZpcnR1YWwgTWFjaGluZXMiIHN0eWxlPSJpci5yZWY9YzlhOTVhNjgtM2E0ZC00MWMyLWI2NmYtYTM2MWJmOWEwZTVjO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWF6dXJlLXZpcnR1YWwtbWFjaGluZXM7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQ0T0RFME56VWdNQzR4TkRFek5UZElNQzR4TXpZMU9EaERNQzR4TWpFNE9UWWdNQzR4TkRFek5UY2dNQzR4TURrNU9EVWdNQzR4TlRNeU5qZ2dNQzR4TURrNU9EVWdNQzR4TmpjNU5sWXdMalkwTmpneE5VTXdMakV3T1RrNE5TQXdMalkyTVRVd055QXdMakV5TVRnNU5pQXdMalkzTXpReE9DQXdMakV6TmpVNE9DQXdMalkzTXpReE9FZ3dMamc0TVRRM05VTXdMamc1TmpFMk55QXdMalkzTXpReE9DQXdMamt3T0RBM09DQXdMalkyTVRVd055QXdMamt3T0RBM09DQXdMalkwTmpneE5WWXdMakUyTnprMlF6QXVPVEE0TURjNElEQXVNVFV6TWpZNElEQXVPRGsyTVRZM0lEQXVNVFF4TXpVM0lEQXVPRGd4TkRjMUlEQXVNVFF4TXpVM1dpSWdabWxzYkQwaWRYSnNLQ053WVdsdWREQmZiR2x1WldGeUtTSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURRNUlEQXVNekk1T0RNMFZqQXVORGcwTlRjMVREQXVOVEE1TURNeklEQXVOVFl5TmpFeFZqQXVOREEzTkRJMlREQXVOalF5TURRNUlEQXVNekk1T0RNMFdpSWdabWxzYkQwaUl6VXdSVFpHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5qUXlNREExSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU5EQTNPREkxVERBdU16YzFPVGMzSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU1qVXlNVGszVERBdU5qUXlNREExSURBdU16STVOemc1V2lJZ1ptbHNiRDBpSTBNelJqRkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TlRBNE9Ua3pJREF1TkRBM09EZFdNQzQxTmpJMk1URk1NQzR6TnpVNU56Y2dNQzQwT0RRMU56VldNQzR6TWprNE16Uk1NQzQxTURnNU9UTWdNQzQwTURjNE4xb2lJR1pwYkd3OUlpTTVRMFZDUmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTNOVGszTnlBd0xqUTRORFl4T1V3d0xqVXdPRGs1TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqTTNOVGszTnlBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlORE0wWXhSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZME1qQTBPU0F3TGpRNE5EWXhPVXd3TGpVd09UQXpNeUF3TGpRd056UTNNVll3TGpVMk1qWTFNMHd3TGpZME1qQTBPU0F3TGpRNE5EWXhPVm9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalkyT1RBek1pQXdMamd6TkRJNE9FTXdMalU1TURFeElEQXVPREl4T0RjeklEQXVOVGczTURBMklEQXVOelkxTVRJZ01DNDFPRGN3TURZZ01DNDJOek16TkVnd0xqUXpNRFE1TWtNd0xqUXpNRFE1TWlBd0xqYzJOVEV5SURBdU5ESTNPRE15SURBdU9ESXhPRGN6SURBdU16UTRPVEVnTUM0NE16UXlPRGhETUM0ek16Z3dNVFVnTUM0NE16VTBPVE1nTUM0ek1qYzVOVE1nTUM0NE5EQTJPVElnTUM0ek1qQTJOallnTUM0NE5EZzRPRU13TGpNeE16TTNPU0F3TGpnMU56QTJPQ0F3TGpNd09UTTRNeUF3TGpnMk56WTJOU0F3TGpNd09UUTBPU0F3TGpnM09EWXlOa2d3TGpjd09EUTVNME13TGpjd09EVTJJREF1T0RZM05qWTFJREF1TnpBME5UWTBJREF1T0RVM01EWTRJREF1TmprM01qYzJJREF1T0RRNE9EaERNQzQyT0RrNU9Ea2dNQzQ0TkRBMk9USWdNQzQyTnprNU1qY2dNQzQ0TXpVME9UTWdNQzQyTmprd016SWdNQzQ0TXpReU9EaGFJaUJtYVd4c1BTSjFjbXdvSTNCaGFXNTBNVjlzYVc1bFlYSXBJaTgrSmlONFlUczhMMmMrSmlONFlUczhaR1ZtY3o0bUkzaGhPenhzYVc1bFlYSkhjbUZrYVdWdWRDQnBaRDBpY0dGcGJuUXdYMnhwYm1WaGNpSWdlREU5SWpBdU5UQTVNRE15SWlCNU1UMGlNQzQyTnpNME1UZ2lJSGd5UFNJd0xqVXdPVEF6TWlJZ2VUSTlJakF1TVRReE16VTNJaUJuY21Ga2FXVnVkRlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJK0ppTjRZVHM4YzNSdmNDQnpkRzl3TFdOdmJHOXlQU0lqTURBM09FUTBJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU9ESWlJSE4wYjNBdFkyOXNiM0k5SWlNMVJVRXdSVVlpTHo0bUkzaGhPend2YkdsdVpXRnlSM0poWkdsbGJuUStKaU40WVRzOGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUluQmhhVzUwTVY5c2FXNWxZWElpSUhneFBTSXdMalV3T0RrM01TSWdlVEU5SWpBdU9EYzROakkySWlCNE1qMGlNQzQxTURnNU56RWlJSGt5UFNJd0xqWTNNek0wSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TVRVaUlITjBiM0F0WTI5c2IzSTlJaU5EUTBORFEwTWlMejRtSTNoaE96eHpkRzl3SUc5bVpuTmxkRDBpTVNJZ2MzUnZjQzFqYjJ4dmNqMGlJemN3TnpBM01DSXZQaVlqZUdFN1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0bUkzaGhPenhqYkdsd1VHRjBhQ0JwWkQwaVkyeHBjREFpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9UZzBOakUxSWlCb1pXbG5hSFE5SWpBdU9UZzBOakV4SWlCbWFXeHNQU0ozYUdsMFpTSWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0d01UVXpPREE1SURBdU1ERTFNemd3T1NraUx6NG1JM2hoT3p3dlkyeHBjRkJoZEdnK0ppTjRZVHM4TDJSbFpuTStKaU40WVRzOEwzTjJaejQ9O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjciIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjE3OCIgeT0iMzkiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjE0IiB2YWx1ZT0iQXp1cmUgVmlydHVhbCBNYWNoaW5lcyIgc3R5bGU9ImlyLnJlZj1iMWEyZTYwNy01ZGJiLTRhMjMtODJmYy01MWM2NWQwY2UwOWY7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9YXp1cmUtdmlydHVhbC1tYWNoaW5lcztpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQR2NnWTJ4cGNDMXdZWFJvUFNKMWNtd29JMk5zYVhBd0tTSStKaU40WVRzOGNHRjBhQ0JrUFNKTk1DNDRPREUwTnpVZ01DNHhOREV6TlRkSU1DNHhNelkxT0RoRE1DNHhNakU0T1RZZ01DNHhOREV6TlRjZ01DNHhNRGs1T0RVZ01DNHhOVE15TmpnZ01DNHhNRGs1T0RVZ01DNHhOamM1TmxZd0xqWTBOamd4TlVNd0xqRXdPVGs0TlNBd0xqWTJNVFV3TnlBd0xqRXlNVGc1TmlBd0xqWTNNelF4T0NBd0xqRXpOalU0T0NBd0xqWTNNelF4T0Vnd0xqZzRNVFEzTlVNd0xqZzVOakUyTnlBd0xqWTNNelF4T0NBd0xqa3dPREEzT0NBd0xqWTJNVFV3TnlBd0xqa3dPREEzT0NBd0xqWTBOamd4TlZZd0xqRTJOemsyUXpBdU9UQTRNRGM0SURBdU1UVXpNalk0SURBdU9EazJNVFkzSURBdU1UUXhNelUzSURBdU9EZ3hORGMxSURBdU1UUXhNelUzV2lJZ1ptbHNiRDBpZFhKc0tDTndZV2x1ZERCZmJHbHVaV0Z5S1NJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5qUXlNRFE1SURBdU16STVPRE0wVmpBdU5EZzBOVGMxVERBdU5UQTVNRE16SURBdU5UWXlOakV4VmpBdU5EQTNOREkyVERBdU5qUXlNRFE1SURBdU16STVPRE0wV2lJZ1ptbHNiRDBpSXpVd1JUWkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TmpReU1EQTFJREF1TXpJNU56ZzVUREF1TlRBNE9Ua3hJREF1TkRBM09ESTFUREF1TXpjMU9UYzNJREF1TXpJNU56ZzVUREF1TlRBNE9Ua3hJREF1TWpVeU1UazNUREF1TmpReU1EQTFJREF1TXpJNU56ZzVXaUlnWm1sc2JEMGlJME16UmpGR1JpSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOVEE0T1RreklEQXVOREEzT0RkV01DNDFOakkyTVRGTU1DNHpOelU1TnpjZ01DNDBPRFExTnpWV01DNHpNams0TXpSTU1DNDFNRGc1T1RNZ01DNDBNRGM0TjFvaUlHWnBiR3c5SWlNNVEwVkNSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpNM05UazNOeUF3TGpRNE5EWXhPVXd3TGpVd09EazVNeUF3TGpRd056UTNNVll3TGpVMk1qWTFNMHd3TGpNM05UazNOeUF3TGpRNE5EWXhPVm9pSUdacGJHdzlJaU5ETTBZeFJrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalkwTWpBME9TQXdMalE0TkRZeE9Vd3dMalV3T1RBek15QXdMalF3TnpRM01WWXdMalUyTWpZMU0wd3dMalkwTWpBME9TQXdMalE0TkRZeE9Wb2lJR1pwYkd3OUlpTTVRMFZDUmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqWTJPVEF6TWlBd0xqZ3pOREk0T0VNd0xqVTVNREV4SURBdU9ESXhPRGN6SURBdU5UZzNNREEySURBdU56WTFNVElnTUM0MU9EY3dNRFlnTUM0Mk56TXpORWd3TGpRek1EUTVNa013TGpRek1EUTVNaUF3TGpjMk5URXlJREF1TkRJM09ETXlJREF1T0RJeE9EY3pJREF1TXpRNE9URWdNQzQ0TXpReU9EaERNQzR6TXpnd01UVWdNQzQ0TXpVME9UTWdNQzR6TWpjNU5UTWdNQzQ0TkRBMk9USWdNQzR6TWpBMk5qWWdNQzQ0TkRnNE9FTXdMak14TXpNM09TQXdMamcxTnpBMk9DQXdMak13T1RNNE15QXdMamcyTnpZMk5TQXdMak13T1RRME9TQXdMamczT0RZeU5rZ3dMamN3T0RRNU0wTXdMamN3T0RVMklEQXVPRFkzTmpZMUlEQXVOekEwTlRZMElEQXVPRFUzTURZNElEQXVOamszTWpjMklEQXVPRFE0T0RoRE1DNDJPRGs1T0RrZ01DNDROREEyT1RJZ01DNDJOems1TWpjZ01DNDRNelUwT1RNZ01DNDJOamt3TXpJZ01DNDRNelF5T0RoYUlpQm1hV3hzUFNKMWNtd29JM0JoYVc1ME1WOXNhVzVsWVhJcElpOCtKaU40WVRzOEwyYytKaU40WVRzOFpHVm1jejRtSTNoaE96eHNhVzVsWVhKSGNtRmthV1Z1ZENCcFpEMGljR0ZwYm5Rd1gyeHBibVZoY2lJZ2VERTlJakF1TlRBNU1ETXlJaUI1TVQwaU1DNDJOek0wTVRnaUlIZ3lQU0l3TGpVd09UQXpNaUlnZVRJOUlqQXVNVFF4TXpVM0lpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krSmlONFlUczhjM1J2Y0NCemRHOXdMV052Ykc5eVBTSWpNREEzT0VRMElpOCtKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1T0RJaUlITjBiM0F0WTI5c2IzSTlJaU0xUlVFd1JVWWlMejRtSTNoaE96d3ZiR2x1WldGeVIzSmhaR2xsYm5RK0ppTjRZVHM4YkdsdVpXRnlSM0poWkdsbGJuUWdhV1E5SW5CaGFXNTBNVjlzYVc1bFlYSWlJSGd4UFNJd0xqVXdPRGszTVNJZ2VURTlJakF1T0RjNE5qSTJJaUI0TWowaU1DNDFNRGc1TnpFaUlIa3lQU0l3TGpZM016TTBJaUJuY21Ga2FXVnVkRlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJK0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVNVFVpSUhOMGIzQXRZMjlzYjNJOUlpTkRRME5EUTBNaUx6NG1JM2hoT3p4emRHOXdJRzltWm5ObGREMGlNU0lnYzNSdmNDMWpiMnh2Y2owaUl6Y3dOekEzTUNJdlBpWWplR0U3UEM5c2FXNWxZWEpIY21Ga2FXVnVkRDRtSTNoaE96eGpiR2x3VUdGMGFDQnBaRDBpWTJ4cGNEQWlQaVlqZUdFN1BISmxZM1FnZDJsa2RHZzlJakF1T1RnME5qRTFJaUJvWldsbmFIUTlJakF1T1RnME5qRXhJaUJtYVd4c1BTSjNhR2wwWlNJZ2RISmhibk5tYjNKdFBTSjBjbUZ1YzJ4aGRHVW9NQzR3TVRVek9EQTVJREF1TURFMU16Z3dPU2tpTHo0bUkzaGhPend2WTJ4cGNGQmhkR2crSmlONFlUczhMMlJsWm5NK0ppTjRZVHM4TDNOMlp6ND07dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTsiIHBhcmVudD0iNyIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgPG14R2VvbWV0cnkgeD0iNDUiIHk9IjM5IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8b2JqZWN0IGxhYmVsPSJDcm9zcyBQcmVtaXNlIE5ldHdvcmsiIGlyLnNvdXJjZVN0eWxlPSJyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxMYWJlbFBvc2l0aW9uPW1pZGRsZTt2ZXJ0aWNhbEFsaWduPW1pZGRsZTtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSIxNyI+CiAgICAgIDxteENlbGwgc3R5bGU9ImlyLnJlZj0wOWQwZjk2ZC04NTJiLTQwZjktODIwZi1kMDRlNTA4NTU1MDI7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249bGVmdDtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9MzthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEzO3NvdXJjZT1jdXN0b207aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9ZW1wdHktY29tcG9uZW50O3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xO2NvbnRhaW5lcj0xO3BlcmltZXRlcj1yZWN0YW5nbGVQZXJpbWV0ZXI7cmVjdXJzaXZlUmVzaXplPTA7c3Ryb2tlV2lkdGg9MTt0ZXh0RGlyZWN0aW9uPWx0cjtzcGFjaW5nVG9wPTE7c3BhY2luZ0xlZnQ9MzI7IiBwYXJlbnQ9IjMiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgICAgPG14R2VvbWV0cnkgeD0iMjgiIHk9IjExMyIgd2lkdGg9IjI5MiIgaGVpZ2h0PSIyNjgiIGFzPSJnZW9tZXRyeSIvPgogICAgICA8L214Q2VsbD4KICAgIDwvb2JqZWN0PgogICAgPG14Q2VsbCBpZD0iMTkiIHZhbHVlPSJBenVyZSBWaXJ0dWFsIE1hY2hpbmVzIiBzdHlsZT0iaXIucmVmPTNlYTM5MTRlLTdjOTEtNDY1OC04ZTIwLTk2Y2RlMTlhNGRjNTtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1henVyZS12aXJ0dWFsLW1hY2hpbmVzO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3S1NJK0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NE9ERTBOelVnTUM0eE5ERXpOVGRJTUM0eE16WTFPRGhETUM0eE1qRTRPVFlnTUM0eE5ERXpOVGNnTUM0eE1EazVPRFVnTUM0eE5UTXlOamdnTUM0eE1EazVPRFVnTUM0eE5qYzVObFl3TGpZME5qZ3hOVU13TGpFd09UazROU0F3TGpZMk1UVXdOeUF3TGpFeU1UZzVOaUF3TGpZM016UXhPQ0F3TGpFek5qVTRPQ0F3TGpZM016UXhPRWd3TGpnNE1UUTNOVU13TGpnNU5qRTJOeUF3TGpZM016UXhPQ0F3TGprd09EQTNPQ0F3TGpZMk1UVXdOeUF3TGprd09EQTNPQ0F3TGpZME5qZ3hOVll3TGpFMk56azJRekF1T1RBNE1EYzRJREF1TVRVek1qWTRJREF1T0RrMk1UWTNJREF1TVRReE16VTNJREF1T0RneE5EYzFJREF1TVRReE16VTNXaUlnWm1sc2JEMGlkWEpzS0NOd1lXbHVkREJmYkdsdVpXRnlLU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TmpReU1EUTVJREF1TXpJNU9ETTBWakF1TkRnME5UYzFUREF1TlRBNU1ETXpJREF1TlRZeU5qRXhWakF1TkRBM05ESTJUREF1TmpReU1EUTVJREF1TXpJNU9ETTBXaUlnWm1sc2JEMGlJelV3UlRaR1JpSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURBMUlEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVOREEzT0RJMVREQXVNemMxT1RjM0lEQXVNekk1TnpnNVREQXVOVEE0T1RreElEQXVNalV5TVRrM1REQXVOalF5TURBMUlEQXVNekk1TnpnNVdpSWdabWxzYkQwaUkwTXpSakZHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UQTRPVGt6SURBdU5EQTNPRGRXTUM0MU5qSTJNVEZNTUM0ek56VTVOemNnTUM0ME9EUTFOelZXTUM0ek1qazRNelJNTUM0MU1EZzVPVE1nTUM0ME1EYzROMW9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMak0zTlRrM055QXdMalE0TkRZeE9Vd3dMalV3T0RrNU15QXdMalF3TnpRM01WWXdMalUyTWpZMU0wd3dMak0zTlRrM055QXdMalE0TkRZeE9Wb2lJR1pwYkd3OUlpTkRNMFl4UmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqWTBNakEwT1NBd0xqUTRORFl4T1V3d0xqVXdPVEF6TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqWTBNakEwT1NBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlNNVEwVkNSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZMk9UQXpNaUF3TGpnek5ESTRPRU13TGpVNU1ERXhJREF1T0RJeE9EY3pJREF1TlRnM01EQTJJREF1TnpZMU1USWdNQzQxT0Rjd01EWWdNQzQyTnpNek5FZ3dMalF6TURRNU1rTXdMalF6TURRNU1pQXdMamMyTlRFeUlEQXVOREkzT0RNeUlEQXVPREl4T0RjeklEQXVNelE0T1RFZ01DNDRNelF5T0RoRE1DNHpNemd3TVRVZ01DNDRNelUwT1RNZ01DNHpNamM1TlRNZ01DNDROREEyT1RJZ01DNHpNakEyTmpZZ01DNDRORGc0T0VNd0xqTXhNek0zT1NBd0xqZzFOekEyT0NBd0xqTXdPVE00TXlBd0xqZzJOelkyTlNBd0xqTXdPVFEwT1NBd0xqZzNPRFl5Tmtnd0xqY3dPRFE1TTBNd0xqY3dPRFUySURBdU9EWTNOalkxSURBdU56QTBOVFkwSURBdU9EVTNNRFk0SURBdU5qazNNamMySURBdU9EUTRPRGhETUM0Mk9EazVPRGtnTUM0NE5EQTJPVElnTUM0Mk56azVNamNnTUM0NE16VTBPVE1nTUM0Mk5qa3dNeklnTUM0NE16UXlPRGhhSWlCbWFXeHNQU0oxY213b0kzQmhhVzUwTVY5c2FXNWxZWElwSWk4K0ppTjRZVHM4TDJjK0ppTjRZVHM4WkdWbWN6NG1JM2hoT3p4c2FXNWxZWEpIY21Ga2FXVnVkQ0JwWkQwaWNHRnBiblF3WDJ4cGJtVmhjaUlnZURFOUlqQXVOVEE1TURNeUlpQjVNVDBpTUM0Mk56TTBNVGdpSUhneVBTSXdMalV3T1RBek1pSWdlVEk5SWpBdU1UUXhNelUzSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J6ZEc5d0xXTnZiRzl5UFNJak1EQTNPRVEwSWk4K0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVPRElpSUhOMGIzQXRZMjlzYjNJOUlpTTFSVUV3UlVZaUx6NG1JM2hoT3p3dmJHbHVaV0Z5UjNKaFpHbGxiblErSmlONFlUczhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbkJoYVc1ME1WOXNhVzVsWVhJaUlIZ3hQU0l3TGpVd09EazNNU0lnZVRFOUlqQXVPRGM0TmpJMklpQjRNajBpTUM0MU1EZzVOekVpSUhreVBTSXdMalkzTXpNMElpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU1UVWlJSE4wYjNBdFkyOXNiM0k5SWlORFEwTkRRME1pTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1TSWdjM1J2Y0MxamIyeHZjajBpSXpjd056QTNNQ0l2UGlZamVHRTdQQzlzYVc1bFlYSkhjbUZrYVdWdWRENG1JM2hoT3p4amJHbHdVR0YwYUNCcFpEMGlZMnhwY0RBaVBpWWplR0U3UEhKbFkzUWdkMmxrZEdnOUlqQXVPVGcwTmpFMUlpQm9aV2xuYUhROUlqQXVPVGcwTmpFeElpQm1hV3hzUFNKM2FHbDBaU0lnZEhKaGJuTm1iM0p0UFNKMGNtRnVjMnhoZEdVb01DNHdNVFV6T0RBNUlEQXVNREUxTXpnd09Ta2lMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOEwyUmxabk0rSmlONFlUczhMM04yWno0PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSIxNyIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgPG14R2VvbWV0cnkgeD0iNDIiIHk9IjI4IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIxOCIgdmFsdWU9IkF6dXJlIFZpcnR1YWwgTWFjaGluZXMiIHN0eWxlPSJpci5yZWY9OGRkY2ZkYjYtOTlmZS00Y2YyLWI1NTEtOTU1NWY0MGYzNzkwO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWF6dXJlLXZpcnR1YWwtbWFjaGluZXM7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQ0T0RFME56VWdNQzR4TkRFek5UZElNQzR4TXpZMU9EaERNQzR4TWpFNE9UWWdNQzR4TkRFek5UY2dNQzR4TURrNU9EVWdNQzR4TlRNeU5qZ2dNQzR4TURrNU9EVWdNQzR4TmpjNU5sWXdMalkwTmpneE5VTXdMakV3T1RrNE5TQXdMalkyTVRVd055QXdMakV5TVRnNU5pQXdMalkzTXpReE9DQXdMakV6TmpVNE9DQXdMalkzTXpReE9FZ3dMamc0TVRRM05VTXdMamc1TmpFMk55QXdMalkzTXpReE9DQXdMamt3T0RBM09DQXdMalkyTVRVd055QXdMamt3T0RBM09DQXdMalkwTmpneE5WWXdMakUyTnprMlF6QXVPVEE0TURjNElEQXVNVFV6TWpZNElEQXVPRGsyTVRZM0lEQXVNVFF4TXpVM0lEQXVPRGd4TkRjMUlEQXVNVFF4TXpVM1dpSWdabWxzYkQwaWRYSnNLQ053WVdsdWREQmZiR2x1WldGeUtTSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOalF5TURRNUlEQXVNekk1T0RNMFZqQXVORGcwTlRjMVREQXVOVEE1TURNeklEQXVOVFl5TmpFeFZqQXVOREEzTkRJMlREQXVOalF5TURRNUlEQXVNekk1T0RNMFdpSWdabWxzYkQwaUl6VXdSVFpHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5qUXlNREExSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU5EQTNPREkxVERBdU16YzFPVGMzSURBdU16STVOemc1VERBdU5UQTRPVGt4SURBdU1qVXlNVGszVERBdU5qUXlNREExSURBdU16STVOemc1V2lJZ1ptbHNiRDBpSTBNelJqRkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TlRBNE9Ua3pJREF1TkRBM09EZFdNQzQxTmpJMk1URk1NQzR6TnpVNU56Y2dNQzQwT0RRMU56VldNQzR6TWprNE16Uk1NQzQxTURnNU9UTWdNQzQwTURjNE4xb2lJR1pwYkd3OUlpTTVRMFZDUmtZaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTNOVGszTnlBd0xqUTRORFl4T1V3d0xqVXdPRGs1TXlBd0xqUXdOelEzTVZZd0xqVTJNalkxTTB3d0xqTTNOVGszTnlBd0xqUTRORFl4T1ZvaUlHWnBiR3c5SWlORE0wWXhSa1lpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpZME1qQTBPU0F3TGpRNE5EWXhPVXd3TGpVd09UQXpNeUF3TGpRd056UTNNVll3TGpVMk1qWTFNMHd3TGpZME1qQTBPU0F3TGpRNE5EWXhPVm9pSUdacGJHdzlJaU01UTBWQ1JrWWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalkyT1RBek1pQXdMamd6TkRJNE9FTXdMalU1TURFeElEQXVPREl4T0RjeklEQXVOVGczTURBMklEQXVOelkxTVRJZ01DNDFPRGN3TURZZ01DNDJOek16TkVnd0xqUXpNRFE1TWtNd0xqUXpNRFE1TWlBd0xqYzJOVEV5SURBdU5ESTNPRE15SURBdU9ESXhPRGN6SURBdU16UTRPVEVnTUM0NE16UXlPRGhETUM0ek16Z3dNVFVnTUM0NE16VTBPVE1nTUM0ek1qYzVOVE1nTUM0NE5EQTJPVElnTUM0ek1qQTJOallnTUM0NE5EZzRPRU13TGpNeE16TTNPU0F3TGpnMU56QTJPQ0F3TGpNd09UTTRNeUF3TGpnMk56WTJOU0F3TGpNd09UUTBPU0F3TGpnM09EWXlOa2d3TGpjd09EUTVNME13TGpjd09EVTJJREF1T0RZM05qWTFJREF1TnpBME5UWTBJREF1T0RVM01EWTRJREF1TmprM01qYzJJREF1T0RRNE9EaERNQzQyT0RrNU9Ea2dNQzQ0TkRBMk9USWdNQzQyTnprNU1qY2dNQzQ0TXpVME9UTWdNQzQyTmprd016SWdNQzQ0TXpReU9EaGFJaUJtYVd4c1BTSjFjbXdvSTNCaGFXNTBNVjlzYVc1bFlYSXBJaTgrSmlONFlUczhMMmMrSmlONFlUczhaR1ZtY3o0bUkzaGhPenhzYVc1bFlYSkhjbUZrYVdWdWRDQnBaRDBpY0dGcGJuUXdYMnhwYm1WaGNpSWdlREU5SWpBdU5UQTVNRE15SWlCNU1UMGlNQzQyTnpNME1UZ2lJSGd5UFNJd0xqVXdPVEF6TWlJZ2VUSTlJakF1TVRReE16VTNJaUJuY21Ga2FXVnVkRlZ1YVhSelBTSjFjMlZ5VTNCaFkyVlBibFZ6WlNJK0ppTjRZVHM4YzNSdmNDQnpkRzl3TFdOdmJHOXlQU0lqTURBM09FUTBJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU9ESWlJSE4wYjNBdFkyOXNiM0k5SWlNMVJVRXdSVVlpTHo0bUkzaGhPend2YkdsdVpXRnlSM0poWkdsbGJuUStKaU40WVRzOGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUluQmhhVzUwTVY5c2FXNWxZWElpSUhneFBTSXdMalV3T0RrM01TSWdlVEU5SWpBdU9EYzROakkySWlCNE1qMGlNQzQxTURnNU56RWlJSGt5UFNJd0xqWTNNek0wSWlCbmNtRmthV1Z1ZEZWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSStKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TVRVaUlITjBiM0F0WTI5c2IzSTlJaU5EUTBORFEwTWlMejRtSTNoaE96eHpkRzl3SUc5bVpuTmxkRDBpTVNJZ2MzUnZjQzFqYjJ4dmNqMGlJemN3TnpBM01DSXZQaVlqZUdFN1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0bUkzaGhPenhqYkdsd1VHRjBhQ0JwWkQwaVkyeHBjREFpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9UZzBOakUxSWlCb1pXbG5hSFE5SWpBdU9UZzBOakV4SWlCbWFXeHNQU0ozYUdsMFpTSWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0d01UVXpPREE1SURBdU1ERTFNemd3T1NraUx6NG1JM2hoT3p3dlkyeHBjRkJoZEdnK0ppTjRZVHM4TDJSbFpuTStKaU40WVRzOEwzTjJaejQ9O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjE3IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIxNzEiIHk9IjI2IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8b2JqZWN0IGxhYmVsPSJWUE4gRGV2aWNlIChFbXB0eSkiIGlkPSIyMCI+CiAgICAgIDxteENlbGwgc3R5bGU9ImlyLnJlZj1iYzZiZjlkYi1lZDU4LTQzZGUtOWZjOS1lMmY4ZDRmOWJhNTk7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9ZW1wdHktY29tcG9uZW50O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1taWRkbGU7dmVydGljYWxBbGlnbj1taWRkbGU7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjE3IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICAgIDxteEdlb21ldHJ5IHg9Ijk2IiB5PSIxNTciIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICAgIDwvbXhDZWxsPgogICAgPC9vYmplY3Q+CiAgICA8b2JqZWN0IGxhYmVsPSJIdWIgTmV0d29yayIgaXIuc291cmNlU3R5bGU9InJvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWVtcHR5LWNvbXBvbmVudDt2ZXJ0aWNhbExhYmVsUG9zaXRpb249bWlkZGxlO3ZlcnRpY2FsQWxpZ249bWlkZGxlO2lyLnN5bmNocm9uaXplZD0wOyIgaWQ9IjUiPgogICAgICA8bXhDZWxsIHN0eWxlPSJpci5yZWY9MjgzMmUxMDUtMjQ4MC00YjNlLTliZGEtMzZjMWRiYjg2MmI1O3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWxlZnQ7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTM7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMztzb3VyY2U9Y3VzdG9tO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWVtcHR5LWNvbXBvbmVudDt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTtjb250YWluZXI9MTtwZXJpbWV0ZXI9cmVjdGFuZ2xlUGVyaW1ldGVyO3JlY3Vyc2l2ZVJlc2l6ZT0wO3N0cm9rZVdpZHRoPTE7dGV4dERpcmVjdGlvbj1sdHI7c3BhY2luZ1RvcD0xO3NwYWNpbmdMZWZ0PTMyOyIgcGFyZW50PSIzIiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICAgIDxteEdlb21ldHJ5IHg9IjM0MyIgeT0iMTUuNSIgd2lkdGg9IjEyNCIgaGVpZ2h0PSI0MDkiIGFzPSJnZW9tZXRyeSIvPgogICAgICA8L214Q2VsbD4KICAgIDwvb2JqZWN0PgogICAgPG14Q2VsbCBpZD0iOCIgdmFsdWU9IkF6dXJlIEJhc3Rpb24iIHN0eWxlPSJpci5yZWY9YjUxMWI5YjQtZmYwZi00MDdjLWEyNmEtNjY1MWI1MDlkZjZiO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPUNELU1JQ1JPU09GVC1BWlVSRS1CQVNUSU9OO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOVFk0T1RrMElEQXVORGN3TnpZMlF6QXVOVFV4TVRJeklEQXVORFV5TVRJeUlEQXVOVGcxTWpVeklEQXVORFF3TkRjNElEQXVOakE0TlRZM0lEQXVOREkwTWpBeVF6QXVOakE0TlRnMElEQXVOREkwTVRrZ01DNDNPVGswTnpjZ01DNDJNalkzTkRRZ01DNDNPVGswTnpjZ01DNDJNalkzTkRSRE1DNDNPVGswTnpjZ01DNDJNalkzTkRRZ01DNDRNRGczTnpFZ01DNDJOVEF3TVRZZ01DNDNPVEkwTnpRZ01DNDJOak01T0RSRE1DNDNOell4TnpnZ01DNDJOemM1TlRNZ01DNDNOVFV5TWpVZ01DNDJOamcyTkNBd0xqYzFOVEl5TlNBd0xqWTJPRFkwUXpBdU56VTFNakkxSURBdU5qWTROalFnTUM0MU9EWTROallnTUM0ME9EazBNU0F3TGpVMk9EazVOQ0F3TGpRM01EYzJObG9pSUdacGJHdzlJaU13TURjelF6WWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalV3TWpBM015QXdMak0yTnpRM1F6QXVORGt5TVRBMklEQXVNemM1T1RneUlEQXVOVEF5TURVMUlEQXVOREEzT0RnZ01DNDFOREV3TkRJZ01DNDBOREkzT1RsRE1DNDFOREV3TkRJZ01DNDBOREkzT1RrZ01DNDFNemMzTmpFZ01DNDBNekV4TlRnZ01DNDFOREV3TVRJZ01DNDBNamc0T0RORE1DNDFOelUxTlRZZ01DNDBNRFEzTURjZ01DNDNOemsyTkRNZ01DNHlOakkxT1RJZ01DNDNOemsyTkRNZ01DNHlOakkxT1RKRE1DNDNOemsyTkRNZ01DNHlOakkxT1RJZ01DNDNPVE0wTnpnZ01DNHlNemt6TkRJZ01DNDNOemMzTkRFZ01DNHlNVGczTmtNd0xqYzJNakF3TlNBd0xqRTVPREUzT0NBd0xqY3pOelV5T0NBd0xqSXdNakkyTVNBd0xqY3pOelV5T0NBd0xqSXdNakkyTVVNd0xqY3pOelV5T0NBd0xqSXdNakkyTVNBd0xqVXhNakEwTVNBd0xqTTFORGsxTnlBd0xqVXdNakEzTXlBd0xqTTJOelEzV2lJZ1ptbHNiRDBpSXpBd056TkROaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TkRZME56RXpJREF1TmpRNE5EVTBRekF1TkRnMk1qTTFJREF1TmpNME1UYzRJREF1TkRVMU5EZzFJREF1TmpFMU16UXhJREF1TkRNMk16QXpJREF1TlRrME16VXlRekF1TkRNMk1qZzVJREF1TlRrME16TTNJREF1TWpBMU5qVTVJREF1TnpVd01UUTRJREF1TWpBMU5qVTVJREF1TnpVd01UUTRRekF1TWpBMU5qVTVJREF1TnpVd01UUTRJREF1TVRreE5Ea3lJREF1Tnpjd09ERTRJREF1TWpBME16TXpJREF1TnpnNE1ERTNRekF1TWpFM01UY3pJREF1T0RBMU1qRTNJREF1TWpNNU5qVTNJREF1T0RBd056SXhJREF1TWpNNU5qVTNJREF1T0RBd056SXhRekF1TWpNNU5qVTNJREF1T0RBd056SXhJREF1TkRRek1Ua3hJREF1TmpZeU56STVJREF1TkRZME56RXpJREF1TmpRNE5EVTBXaUlnWm1sc2JEMGlJekF3TnpORE5pSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOVFE1TVRVZ01DNDFOVGMyTkRGRE1DNDFOVFl6TWpNZ01DNDFOekU1TkRFZ01DNDFOREE0TXpVZ01DNDFPVGN4T0RjZ01DNDBPVFUwT0RRZ01DNDJNak16TVRSRE1DNDBPVFUwT0RRZ01DNDJNak16TVRRZ01DNDFNREV3T1RZZ01DNDJNVEkyTURFZ01DNDBPVGd6T0RRZ01DNDJNRGszTURSRE1DNDBOamsxTmprZ01DNDFOemc1TWpRZ01DNHlPVGt4TnpjZ01DNHpPVGMzTnpVZ01DNHlPVGt4TnpjZ01DNHpPVGMzTnpWRE1DNHlPVGt4TnpjZ01DNHpPVGMzTnpVZ01DNHlPVEEwTXpRZ01DNHpOekl4TnpJZ01DNHpNVEF3TnpjZ01DNHpOVFV5TnpoRE1DNHpNamszTWlBd0xqTXpPRE00TkNBd0xqTTFNamd5T0NBd0xqTTBOelF5TmlBd0xqTTFNamd5T0NBd0xqTTBOelF5TmtNd0xqTTFNamd5T0NBd0xqTTBOelF5TmlBd0xqVTBNVGszT0NBd0xqVTBNek0wTWlBd0xqVTBPVEUxSURBdU5UVTNOalF4V2lJZ1ptbHNiRDBpSXpBd056TkROaUl2UGlZamVHRTdQQzl6ZG1jKzt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSI1IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIxOCIgeT0iMzYuNSIgd2lkdGg9IjkwIiBoZWlnaHQ9IjkwIiBhcz0iZ2VvbWV0cnkiLz4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iOSIgdmFsdWU9IkF6dXJlIEZpcmV3YWxsIiBzdHlsZT0iaXIucmVmPTk3NGZmMTM0LWY5ZWUtNDhkZS05NDAxLTAwOGU1OTNkYjEwZTtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1taWNyb3NvZnQtYXp1cmUtZmlyZXdhbGw7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQ1TlRJM01UUWdNQzQxTmpZNE16aERNQzQ1TlRFeE5qSWdNQzQxTVRrME5DQXdMamt6TWpnNE1pQXdMalEzTkRFeU1pQXdMamt3TVRFeE15QXdMalF6T0RreE0wTXdMamcyT1RNME15QXdMalF3TXpjd05TQXdMamd5TmpFek5pQXdMak00TURnM09TQXdMamMzT1RFME5pQXdMak0zTkRRNFF6QXVOemMyTVRnNUlEQXVNekE0TWpneUlEQXVOelEzTWprMklEQXVNalExT1RBNUlEQXVOams0TnpFMUlEQXVNakF3T0RRMFF6QXVOalV3TVRNMElEQXVNVFUxTnpnZ01DNDFPRFUzTmprZ01DNHhNekUyTkRjZ01DNDFNVGsxTXpZZ01DNHhNek0yTmpKRE1DNDBOalU1TWprZ01DNHhNekkyTnpJZ01DNDBNVE16TXprZ01DNHhORGd6TmpjZ01DNHpOamt3TkRRZ01DNHhOemcxTnpkRE1DNHpNalEzTkRrZ01DNHlNRGczT0RZZ01DNHlPVEE1TXpjZ01DNHlOVEl3TVRZZ01DNHlOekl5T0RnZ01DNHpNREl5T0RSRE1DNHlNVFUyTnpFZ01DNHpNRGt4TWlBd0xqRTJNek00TVNBd0xqTXpOakF6SURBdU1USTBPVEV4SURBdU16YzRNVE5ETUM0d09EWTBOREEzSURBdU5ESXdNakk1SURBdU1EWTBNelF3TlNBd0xqUTNORGN5TmlBd0xqQTJNall5TWpFZ01DNDFNekUzTWpsRE1DNHdOalV3TmpreUlEQXVOVGsxT0RNZ01DNHdPVEk0TXpVMklEQXVOalUyTXpRMUlEQXVNVE01T0RNeklEQXVOekF3TURBMVF6QXVNVGcyT0RNeElEQXVOelF6TmpZMUlEQXVNalE1TWpJeklEQXVOelkyT1RBM0lEQXVNekV6TXpNeElEQXVOelkwTmpNMVNEQXVNek0xTURnNVNEQXVOelF4TURkRE1DNDNORFEyT1RFZ01DNDNOalE1TURnZ01DNDNORGd6TWpnZ01DNDNOalE1TURnZ01DNDNOVEU1TkRrZ01DNDNOalEyTXpWRE1DNDRNRFExTXpFZ01DNDNOalF4TXpjZ01DNDROVFE0TmpNZ01DNDNORE15TXlBd0xqZzVNak15TVNBd0xqY3dOak15TlVNd0xqa3lPVGM0SURBdU5qWTVOREl4SURBdU9UVXhORE0wSURBdU5qRTVOREEySURBdU9UVXlOekUwSURBdU5UWTJPRE00V2lJZ1ptbHNiRDBpZFhKc0tDTndZV2x1ZERCZmJHbHVaV0Z5S1NJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU56WTVNamN4SURBdU5qRTRPVEEzUXpBdU56WTVNVFF5SURBdU5qRXpORGcxSURBdU56WTJPRGszSURBdU5qQTRNekk1SURBdU56WXpNREUySURBdU5qQTBOVFJETUM0M05Ua3hNelVnTUM0Mk1EQTNOVEVnTUM0M05UTTVNallnTUM0MU9UZzJNekVnTUM0M05EZzFNRElnTUM0MU9UZzJNek5JTUM0eU5qWTROak5ETUM0eU5qRTBNemtnTUM0MU9UZzJNekVnTUM0eU5UWXlNeUF3TGpZd01EYzFNU0F3TGpJMU1qTTBPU0F3TGpZd05EVTBRekF1TWpRNE5EWTRJREF1TmpBNE16STVJREF1TWpRMk1qSXpJREF1TmpFek5EZzFJREF1TWpRMk1EazBJREF1TmpFNE9UQTNWakF1T0RZMk1UVTJRekF1TWpRMk1qSXpJREF1T0RjeE5UYzRJREF1TWpRNE5EWTRJREF1T0RjMk56TTBJREF1TWpVeU16UTVJREF1T0Rnd05USXpRekF1TWpVMk1qTWdNQzQ0T0RRek1USWdNQzR5TmpFME16a2dNQzQ0T0RZME16SWdNQzR5TmpZNE5qTWdNQzQ0T0RZME0wZ3dMamMwT0RVd01rTXdMamMxTXpreU5pQXdMamc0TmpRek1pQXdMamMxT1RFek5TQXdMamc0TkRNeE1pQXdMamMyTXpBeE5pQXdMamc0TURVeU0wTXdMamMyTmpnNU55QXdMamczTmpjek5DQXdMamMyT1RFME1pQXdMamczTVRVM09DQXdMamMyT1RJM01TQXdMamcyTmpFMU5sWXdMall4T0Rrd04xWXdMall4T0Rrd04xb2lJR1pwYkd3OUlpTTRNakV3TVRBaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqUXhOekU0T1NBd0xqWXlOekU1TjBnd0xqSTNOVEkyT1ZZd0xqWTRPVGs1TjBnd0xqUXhOekU0T1ZZd0xqWXlOekU1TjFvaUlHWnBiR3c5SWlORk5qSXpNak1pTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpVNE1ETTVOeUF3TGpZeU56RTVOMGd3TGpRek9EUTNOMVl3TGpZNE9UazVOMGd3TGpVNE1ETTVOMVl3TGpZeU56RTVOMW9pSUdacGJHdzlJaU5HUmpjek9ERWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMamMwTXpRNE5TQXdMall5TnpFNU4wZ3dMall3TVRVMk1sWXdMalk0T1RrNU4wZ3dMamMwTXpRNE5WWXdMall5TnpFNU4xb2lJR1pwYkd3OUlpTkZOakl6TWpNaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTXpOREV4TXlBd0xqY3hNVEU0TWtnd0xqSTNOVEkyT1ZZd0xqYzNNems0TVVnd0xqTXpOREV4TTFZd0xqY3hNVEU0TWxvaUlHWnBiR3c5SWlORk5qSXpNak1pTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpjME16VXpPQ0F3TGpjeE1URTRNa2d3TGpZNE5EWTVNbFl3TGpjM016azRNVWd3TGpjME16VXpPRll3TGpjeE1URTRNbG9pSUdacGJHdzlJaU5HUmpjek9ERWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalE1TnpNNE9TQXdMamN4TVRFNE1rZ3dMak0xTlRRMk9WWXdMamMzTXprNE1VZ3dMalE1TnpNNE9WWXdMamN4TVRFNE1sb2lJR1pwYkd3OUlpTkdSamN6T0RFaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqWTJNVEE0TlNBd0xqY3hNVEU0TWtnd0xqVXhPVEUyTlZZd0xqYzNNems0TVVnd0xqWTJNVEE0TlZZd0xqY3hNVEU0TWxvaUlHWnBiR3c5SWlORk5qSXpNak1pTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpReE56RTRPU0F3TGpjNU5UUXhTREF1TWpjMU1qWTVWakF1T0RVNE1qRklNQzQwTVRjeE9EbFdNQzQzT1RVME1Wb2lJR1pwYkd3OUlpTkZOakl6TWpNaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqVTRNRE01TnlBd0xqYzVOVFF4U0RBdU5ETTRORGMzVmpBdU9EVTRNakZJTUM0MU9EQXpPVGRXTUM0M09UVTBNVm9pSUdacGJHdzlJaU5HUmpjek9ERWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMamMwTXpRNE5TQXdMamM1TlRReFNEQXVOakF4TlRZeVZqQXVPRFU0TWpGSU1DNDNORE0wT0RWV01DNDNPVFUwTVZvaUlHWnBiR3c5SWlORk5qSXpNak1pTHo0bUkzaGhPend2Wno0bUkzaGhPenhrWldaelBpWWplR0U3UEd4cGJtVmhja2R5WVdScFpXNTBJR2xrUFNKd1lXbHVkREJmYkdsdVpXRnlJaUI0TVQwaU1DNDFNRGMyTmpnaUlIa3hQU0l3TGpjMk5EWXpOU0lnZURJOUlqQXVOVEEzTmpZNElpQjVNajBpTUM0eE16TTJOaklpSUdkeVlXUnBaVzUwVlc1cGRITTlJblZ6WlhKVGNHRmpaVTl1VlhObElqNG1JM2hoT3p4emRHOXdJSE4wYjNBdFkyOXNiM0k5SWlNd01EYzRSRFFpTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1DNDRNaUlnYzNSdmNDMWpiMnh2Y2owaUl6VkZRVEJGUmlJdlBpWWplR0U3UEM5c2FXNWxZWEpIY21Ga2FXVnVkRDRtSTNoaE96eGpiR2x3VUdGMGFDQnBaRDBpWTJ4cGNEQWlQaVlqZUdFN1BISmxZM1FnZDJsa2RHZzlJakF1T1RnME5qRTFJaUJvWldsbmFIUTlJakF1T1RnME5qRXhJaUJtYVd4c1BTSjNhR2wwWlNJZ2RISmhibk5tYjNKdFBTSjBjbUZ1YzJ4aGRHVW9NQzR3TVRVek9EQTVJREF1TURFMU16Z3dPU2tpTHo0bUkzaGhPend2WTJ4cGNGQmhkR2crSmlONFlUczhMMlJsWm5NK0ppTjRZVHM4TDNOMlp6ND07dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTsiIHBhcmVudD0iNSIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgPG14R2VvbWV0cnkgeD0iMTgiIHk9IjE1My41IiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIxMCIgdmFsdWU9IkF6dXJlIFZQTiBHYXRld2F5IiBzdHlsZT0iaXIucmVmPTJiODBlODYyLTZlNTAtNDA1NS1iYzU2LTI1OTVjZjAzOTE2OTtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1DRC1NSUNST1NPRlQtQVpVUkUtVlBOLUdXO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVOemN3TURnMUlEQXVORGcyTURJM1NEQXVOekkxTmpBeFZqQXVNelV3TnprNFF6QXVOekkxT1RnM0lEQXVNamczTWpnMElEQXVOekF5TXpVeUlEQXVNakkxT1RFeklEQXVOalU1TXpJZ01DNHhOemcyT0RoRE1DNDJNemt4T1RNZ01DNHhOVFUxTkRVZ01DNDJNVFF5TURZZ01DNHhNemNnTUM0MU9EWXdPVElnTUM0eE1qUXpNemxETUM0MU5UYzVOemtnTUM0eE1URTJOemdnTUM0MU1qYzBNVEVnTUM0eE1EVXlNRFFnTUM0ME9UWTFNU0F3TGpFd05UTTJOa013TGpRMk5UTXdPU0F3TGpFd05EazBPQ0F3TGpRek5ETTVOeUF3TGpFeE1USTVOeUF3TGpRd05UazFOaUF3TGpFeU16azJOME13TGpNM056VXhOaUF3TGpFek5qWXpOeUF3TGpNMU1qSTBNaUF3TGpFMU5UTXhOeUF3TGpNek1Ua3lJREF1TVRjNE5qZzRRekF1TWpnNE5UZzJJREF1TWpJMU56TXhJREF1TWpZME9UQTFJREF1TWpnM01qSXpJREF1TWpZMU5qTTVJREF1TXpVd056azRWakF1TkRnMk1ESTNTREF1TWpJNU5qQTNRekF1TWpJeE5UQXpJREF1TkRnMk1UUWdNQzR5TVRNM05qSWdNQzQwT0Rrek5qZ2dNQzR5TURnd016RWdNQzQwT1RVd01qVkRNQzR5TURJeU9Ua2dNQzQxTURBMk9ESWdNQzR4T1Rrd01qa2dNQzQxTURnek1qSWdNQzR4T1RnNU1UUWdNQzQxTVRZek1qRldNQzQ0TmpjMU5qVkRNQzR4T1Rrd01qa2dNQzQ0TnpVMU5qVWdNQzR5TURJeU9Ua2dNQzQ0T0RNeU1EUWdNQzR5TURnd016RWdNQzQ0T0RnNE5qRkRNQzR5TVRNM05qSWdNQzQ0T1RRMU1UZ2dNQzR5TWpFMU1ETWdNQzQ0T1RjM05EY2dNQzR5TWprMk1EY2dNQzQ0T1RjNE5rZ3dMamMzTURBNE5VTXdMamMzT0RJek1pQXdMamc1TnpjMUlEQXVOemcyTURJeElEQXVPRGswTlRNMklEQXVOemt4T0RJMElEQXVPRGc0T0RreFF6QXVOemszTmpJM0lEQXVPRGd6TWpRMUlEQXVPREF3T1RrMUlEQXVPRGMxTmpBMElEQXVPREF4TWpJeklEQXVPRFkzTlRZMVZqQXVOVEUyTXpJeFF6QXVPREF3T1RrMUlEQXVOVEE0TWpneUlEQXVOemszTmpJM0lEQXVOVEF3TmpReUlEQXVOemt4T0RJMElEQXVORGswT1RrMlF6QXVOemcyTURJeElEQXVORGc1TXpVZ01DNDNOemd5TXpJZ01DNDBPRFl4TXpjZ01DNDNOekF3T0RVZ01DNDBPRFl3TWpkV01DNDBPRFl3TWpkYVRUQXVOakl3TVRjMUlEQXVORGcyTURJM1NEQXVNemN5T0RRMVZqQXVNelE0TmpBeVF6QXVNemN6TWpRMUlEQXVNekV6TkRVZ01DNHpPRGN3TmpVZ01DNHlOemszTkNBd0xqUXhNVFUwTmlBd0xqSTFOREl3TmtNd0xqUXlNVGszSURBdU1qUXlOREV5SURBdU5ETTBPREU1SURBdU1qTXlPVFEwSURBdU5EUTVNak01SURBdU1qSTJORE0wUXpBdU5EWXpOalU1SURBdU1qRTVPVEl6SURBdU5EYzVNekU0SURBdU1qRTJOVEU1SURBdU5EazFNVGMxSURBdU1qRTJORFEzUXpBdU5URXhNRGt6SURBdU1qRTJOVFFnTUM0MU1qWTRNVElnTUM0eU1UazVOVElnTUM0MU5ERXpJREF1TWpJMk5EVTVRekF1TlRVMU56ZzVJREF1TWpNeU9UWTJJREF1TlRZNE56SXhJREF1TWpReU5ESXlJREF1TlRjNU1qVWdNQzR5TlRReU1EWkRNQzQxT0RRMU1qTWdNQzR5TmpBd09UUWdNQzQxT0RreU9EUWdNQzR5TmpZME1Ea2dNQzQxT1RNME9EUWdNQzR5TnpNd09EVldNQzR5TnpNd09EVkRNQzQyTVRBeE5qa2dNQzR5T1RRM05EUWdNQzQyTVRrMk5EZ2dNQzR6TWpBNU56SWdNQzQyTWpBMk1Ua2dNQzR6TkRneE5qTk1NQzQyTWpBeE56VWdNQzQwT0RZd01qZGFJaUJtYVd4c1BTSjFjbXdvSTNCaGFXNTBNRjlzYVc1bFlYSXBJaTgrSmlONFlUczhjR0YwYUNCa1BTSk5NQzQzTWpVMU56a2dNQzQwT0RZd09EUklNQzQzTnpBd05qTkRNQzQzTnpneU1TQXdMalE0TmpFNU5DQXdMamM0TlRrNU9TQXdMalE0T1RRd09DQXdMamM1TVRnd01pQXdMalE1TlRBMU0wTXdMamM1TnpZd05TQXdMalV3TURZNU9TQXdMamd3TURrM015QXdMalV3T0RNMElEQXVPREF4TWpBeUlEQXVOVEUyTXpjNVZqQXVPRFkzTmpJelF6QXVPREF3T1RjeklEQXVPRGMxTmpZeUlEQXVOemszTmpBMUlEQXVPRGd6TXpBeUlEQXVOemt4T0RBeUlEQXVPRGc0T1RRNFREQXVNakE0TURBNElEQXVORGsxTURnelF6QXVNakV6TnpNNUlEQXVORGc1TkRJMklEQXVNakl4TkRnZ01DNDBPRFl4T1RjZ01DNHlNamsxT0RRZ01DNDBPRFl3T0RSSU1DNHlOalUyTVRaSU1DNHpOekk0TWpKSU1DNDJNakF4TlRKSU1DNDNNalUxTnpsYUlpQm1hV3hzUFNJak5UQkZOa1pHSWk4K0ppTjRZVHM4Y0dGMGFDQnZjR0ZqYVhSNVBTSXdMaklpSUdROUlrMHdMamN5TlRZd05TQXdMalE0TmpNeU9FZ3dMamMzTURBNE9VTXdMamMzT0RJek55QXdMalE0TmpRek9DQXdMamM0TmpBeU5pQXdMalE0T1RZMU1pQXdMamM1TVRneU9TQXdMalE1TlRJNU4wd3dMakl3T0RBek1TQXdMamc0T1RFMk0wTXdMakl3TWpJNU9TQXdMamc0TXpVd05pQXdMakU1T1RBeU9TQXdMamczTlRnMk5pQXdMakU1T0RreE5DQXdMamcyTnpnMk4xWXdMalV4TmpZeU0wTXdMakU1T1RBeU9TQXdMalV3T0RZeU5DQXdMakl3TWpJNU9TQXdMalV3TURrNE5DQXdMakl3T0RBek1TQXdMalE1TlRNeU4wTXdMakl4TXpjMk1pQXdMalE0T1RZM0lEQXVNakl4TlRBeklEQXVORGcyTkRReUlEQXVNakk1TmpBNElEQXVORGcyTXpJNFNEQXVNalkxTmpSSU1DNHpOekk0TkRaSU1DNDJNakF4TnpoSU1DNDNNalUyTURWYUlpQm1hV3hzUFNKM2FHbDBaU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TkRRMk1UWXlJREF1TlRjeU5EZzNUREF1TkRrNU5UTTBJREF1TlRFNE5UVTRRekF1TlRBd01EazFJREF1TlRFNE1EZ3pJREF1TlRBd09EQXpJREF1TlRFM09ESXlJREF1TlRBeE5UTTFJREF1TlRFM09ESXlRekF1TlRBeU1qWTNJREF1TlRFM09ESXlJREF1TlRBeU9UYzJJREF1TlRFNE1EZ3pJREF1TlRBek5UTTNJREF1TlRFNE5UVTRUREF1TlRVMk5EWTBJREF1TlRjeU5EZzNRekF1TlRVMk9ETXhJREF1TlRjeU56TXpJREF1TlRVM01UTXlJREF1TlRjek1EWTNJREF1TlRVM016UWdNQzQxTnpNME5UbERNQzQxTlRjMU5EZ2dNQzQxTnpNNE5URWdNQzQxTlRjMk5UY2dNQzQxTnpReU9Ea2dNQzQxTlRjMk5UY2dNQzQxTnpRM016UkRNQzQxTlRjMk5UY2dNQzQxTnpVeE56a2dNQzQxTlRjMU5EZ2dNQzQxTnpVMk1UY2dNQzQxTlRjek5DQXdMalUzTmpBd09VTXdMalUxTnpFek1pQXdMalUzTmpRd01pQXdMalUxTmpnek1TQXdMalUzTmpjek5TQXdMalUxTmpRMk5DQXdMalUzTmprNE1VZ3dMalV5TlRNelF6QXVOVEkwTmpJeklEQXVOVGMyT1RneElEQXVOVEl6T1RRMElEQXVOVGMzTWpZMklEQXVOVEl6TkRReklEQXVOVGMzTnpjeFF6QXVOVEl5T1RReklEQXVOVGM0TWpjM0lEQXVOVEl5TmpZeUlEQXVOVGM0T1RZeklEQXVOVEl5TmpZeUlEQXVOVGM1TmpjNFZqQXVOalE0T0RnM1F6QXVOVEl5TmpZeUlEQXVOalE1TmpBeUlEQXVOVEl5TXpnZ01DNDJOVEF5T0RnZ01DNDFNakU0T0NBd0xqWTFNRGM1TTBNd0xqVXlNVE00SURBdU5qVXhNams1SURBdU5USXdOekF4SURBdU5qVXhOVGd6SURBdU5URTVPVGt6SURBdU5qVXhOVGd6U0RBdU5EZzBPRFUyUXpBdU5EZzBORGc1SURBdU5qVXhOalk1SURBdU5EZzBNVEExSURBdU5qVXhOalU1SURBdU5EZ3pOelF5SURBdU5qVXhOVFUwUXpBdU5EZ3pNemM1SURBdU5qVXhORFE1SURBdU5EZ3pNRFE1SURBdU5qVXhNalV6SURBdU5EZ3lOemd5SURBdU5qVXdPVGd6UXpBdU5EZ3lOVEUxSURBdU5qVXdOekV6SURBdU5EZ3lNeklnTUM0Mk5UQXpOemtnTUM0ME9ESXlNVFlnTUM0Mk5UQXdNVE5ETUM0ME9ESXhNVElnTUM0Mk5EazJORFlnTUM0ME9ESXhNRE1nTUM0Mk5Ea3lOVGdnTUM0ME9ESXhPRGdnTUM0Mk5EZzRPRGRXTUM0MU56azJOemhETUM0ME9ESXdPQ0F3TGpVM09Ea3lOQ0F3TGpRNE1UY3dOU0F3TGpVM09ESXpOU0F3TGpRNE1URXpNeUF3TGpVM056Y3pPVU13TGpRNE1EVTJJREF1TlRjM01qUXpJREF1TkRjNU9ESTVJREF1TlRjMk9UYzBJREF1TkRjNU1EYzFJREF1TlRjMk9UZ3hTREF1TkRRM09UUXhRekF1TkRRM05EUTBJREF1TlRjMk9UUXpJREF1TkRRMk9UWTNJREF1TlRjMk56WTFJREF1TkRRMk5UWTFJREF1TlRjMk5EWTJRekF1TkRRMk1UWXpJREF1TlRjMk1UWTRJREF1TkRRMU9EVXhJREF1TlRjMU56WXlJREF1TkRRMU5qWTJJREF1TlRjMU1qazBRekF1TkRRMU5EZ3hJREF1TlRjME9ESTJJREF1TkRRMU5ESTVJREF1TlRjME16RTFJREF1TkRRMU5URTNJREF1TlRjek9ERTVRekF1TkRRMU5qQTBJREF1TlRjek16SXpJREF1TkRRMU9ESTRJREF1TlRjeU9EWXlJREF1TkRRMk1UWXlJREF1TlRjeU5EZzNWakF1TlRjeU5EZzNXazB3TGpVMU5qQXhPU0F3TGpneE9EYzJNMHd3TGpVd016QTVNaUF3TGpnM01qSTBNa013TGpVd01qZzBNU0F3TGpnM01qVXlPU0F3TGpVd01qVXpOQ0F3TGpnM01qYzFPU0F3TGpVd01qRTRPQ0F3TGpnM01qa3hOa013TGpVd01UZzBNeUF3TGpnM016QTNOQ0F3TGpVd01UUTJPU0F3TGpnM016RTFOU0F3TGpVd01UQTVJREF1T0Rjek1UVTFRekF1TlRBd056RXlJREF1T0Rjek1UVTFJREF1TlRBd016TTRJREF1T0Rjek1EYzBJREF1TkRrNU9Ua3pJREF1T0RjeU9URTJRekF1TkRrNU5qUTNJREF1T0RjeU56VTVJREF1TkRrNU16TTVJREF1T0RjeU5USTVJREF1TkRrNU1EZzVJREF1T0RjeU1qUXlUREF1TkRRMk1UWXlJREF1T0RFNE56WXpRekF1TkRRMU56azFJREF1T0RFNE5URTNJREF1TkRRMU5EazBJREF1T0RFNE1UZ3pJREF1TkRRMU1qZzJJREF1T0RFM056a3hRekF1TkRRMU1EYzNJREF1T0RFM016azVJREF1TkRRME9UWTRJREF1T0RFMk9UWXhJREF1TkRRME9UWTRJREF1T0RFMk5URTJRekF1TkRRME9UWTRJREF1T0RFMk1EY3hJREF1TkRRMU1EYzNJREF1T0RFMU5qTXpJREF1TkRRMU1qZzJJREF1T0RFMU1qUXhRekF1TkRRMU5EazBJREF1T0RFME9EUTVJREF1TkRRMU56azFJREF1T0RFME5URTFJREF1TkRRMk1UWXlJREF1T0RFME1qWTVTREF1TkRjM01qazFRekF1TkRjNE1EVWdNQzQ0TVRReU56Y2dNQzQwTnpnM09ERWdNQzQ0TVRRd01EZ2dNQzQwTnprek5UUWdNQzQ0TVRNMU1USkRNQzQwTnprNU1qWWdNQzQ0TVRNd01UWWdNQzQwT0RBek1ERWdNQzQ0TVRJek1qY2dNQzQwT0RBME1Ea2dNQzQ0TVRFMU56SldNQzQzTkRFNU1UUkRNQzQwT0RBME1Ea2dNQzQzTkRFeE9Ua2dNQzQwT0RBMk9TQXdMamMwTURVeE15QXdMalE0TVRFNUlEQXVOelF3TURBM1F6QXVORGd4TmpreElEQXVOek01TlRBeUlEQXVORGd5TXpjZ01DNDNNemt5TVRnZ01DNDBPRE13TnpjZ01DNDNNemt5TVRoSU1DNDFNVFU1T1VNd0xqVXhOalk1T0NBd0xqY3pPVEl4T0NBd0xqVXhOek0zTnlBd0xqY3pPVFV3TWlBd0xqVXhOemczTnlBd0xqYzBNREF3TjBNd0xqVXhPRE0zT0NBd0xqYzBNRFV4TXlBd0xqVXhPRFkxT1NBd0xqYzBNVEU1T1NBd0xqVXhPRFkxT1NBd0xqYzBNVGt4TkZZd0xqZ3hNVFUzTWtNd0xqVXhPRFkxT1NBd0xqZ3hNakk0TnlBd0xqVXhPRGswSURBdU9ERXlPVGN6SURBdU5URTVORFFnTUM0NE1UTTBOemxETUM0MU1UazVOREVnTUM0NE1UTTVPRFVnTUM0MU1qQTJNaUF3TGpneE5ESTJPU0F3TGpVeU1UTXlOeUF3TGpneE5ESTJPVWd3TGpVMU1qUTJNVU13TGpVMU16QTFNU0F3TGpneE16YzVNaUF3TGpVMU16Z3dOQ0F3TGpneE16VTNNU0F3TGpVMU5EVTFOU0F3TGpneE16WTFOa013TGpVMU5UTXdOU0F3TGpneE16YzBJREF1TlRVMU9Ua3lJREF1T0RFME1USXlJREF1TlRVMk5EWTBJREF1T0RFME56RTRRekF1TlRVMk9UTTJJREF1T0RFMU16RTBJREF1TlRVM01UVTBJREF1T0RFMk1EYzFJREF1TlRVM01EY3hJREF1T0RFMk9ETTBRekF1TlRVMk9UZzNJREF1T0RFM05Ua3lJREF1TlRVMk5qQTVJREF1T0RFNE1qZzJJREF1TlRVMk1ERTVJREF1T0RFNE56WXpWakF1T0RFNE56WXpXazB3TGpNME5qazNPU0F3TGpjME9URXdOVll3TGpjeE56WTBOa013TGpNME5qazNPU0F3TGpjeE5qa3pNU0F3TGpNME5qWTVPQ0F3TGpjeE5qSTBOU0F3TGpNME5qRTVOeUF3TGpjeE5UY3pPVU13TGpNME5UWTVOeUF3TGpjeE5USXpOQ0F3TGpNME5UQXhPQ0F3TGpjeE5EazFJREF1TXpRME16RWdNQzQzTVRRNU5VZ3dMakkzTnpFMVF6QXVNamMyTkRReklEQXVOekUwT1RVZ01DNHlOelUzTmpRZ01DNDNNVFEyTmpZZ01DNHlOelV5TmpNZ01DNDNNVFF4TmtNd0xqSTNORGMyTXlBd0xqY3hNelkxTkNBd0xqSTNORFE0TWlBd0xqY3hNamsyT0NBd0xqSTNORFE0TWlBd0xqY3hNakkxTTFZd0xqWTRNRE0wTlVNd0xqSTNOREl5TlNBd0xqWTNPVGt3T0NBd0xqSTNOREE1TmlBd0xqWTNPVFF3TnlBd0xqSTNOREV4SURBdU5qYzRPRGs1UXpBdU1qYzBNVEl6SURBdU5qYzRNemt4SURBdU1qYzBNamM0SURBdU5qYzNPRGs0SURBdU1qYzBOVFUzSURBdU5qYzNORGMxUXpBdU1qYzBPRE0ySURBdU5qYzNNRFV5SURBdU1qYzFNakkzSURBdU5qYzJOekU0SURBdU1qYzFOamcySURBdU5qYzJOVEZETUM0eU56WXhORFVnTUM0Mk56WXpNRElnTUM0eU56WTJOVElnTUM0Mk56WXlNeUF3TGpJM056RTFJREF1TmpjMk16QXhTREF1TXpRME16RkRNQzR6TkRVd01UZ2dNQzQyTnpZek1ERWdNQzR6TkRVMk9UY2dNQzQyTnpZd01UWWdNQzR6TkRZeE9UY2dNQzQyTnpVMU1URkRNQzR6TkRZMk9UZ2dNQzQyTnpVd01EVWdNQzR6TkRZNU56a2dNQzQyTnpRek1Ua2dNQzR6TkRZNU56a2dNQzQyTnpNMk1EUldNQzQyTkRJeE5EWkRNQzR6TkRjd016VWdNQzQyTkRFMU9Ua2dNQzR6TkRjeU16RWdNQzQyTkRFd056Y2dNQzR6TkRjMU5EZ2dNQzQyTkRBMk16SkRNQzR6TkRjNE5qVWdNQzQyTkRBeE9EWWdNQzR6TkRneU9UTWdNQzQyTXprNE16SWdNQzR6TkRnM09EY2dNQzQyTXprMk1EVkRNQzR6TkRreU9ESWdNQzQyTXprek56Y2dNQzR6TkRrNE1qY2dNQzQyTXpreU9EVWdNQzR6TlRBek5qZ2dNQzQyTXprek16ZERNQzR6TlRBNU1Ea2dNQzQyTXprek9EZ2dNQzR6TlRFME1qY2dNQzQyTXprMU9ESWdNQzR6TlRFNE56RWdNQzQyTXprNE9UbE1NQzQwTURRM09UZ2dNQzQyT1RNNE1qZERNQzQwTURVeU16WWdNQzQyT1RRek1qSWdNQzQwTURVME56Z2dNQzQyT1RRNU5qSWdNQzQwTURVME56Z2dNQzQyT1RVMk1qVkRNQzQwTURVME56Z2dNQzQyT1RZeU9EZ2dNQzQwTURVeU16WWdNQzQyT1RZNU1qZ2dNQzQwTURRM09UZ2dNQzQyT1RjME1qTk1NQzR6TlRFNE56RWdNQzQzTlRFek5USkRNQzR6TlRFME1qY2dNQzQzTlRFMk5qZ2dNQzR6TlRBNU1Ea2dNQzQzTlRFNE5qSWdNQzR6TlRBek5qZ2dNQzQzTlRFNU1UUkRNQzR6TkRrNE1qY2dNQzQzTlRFNU5qVWdNQzR6TkRreU9ESWdNQzQzTlRFNE56TWdNQzR6TkRnM09EY2dNQzQzTlRFMk5EWkRNQzR6TkRneU9UTWdNQzQzTlRFME1UZ2dNQzR6TkRjNE5qVWdNQzQzTlRFd05qUWdNQzR6TkRjMU5EZ2dNQzQzTlRBMk1UaERNQzR6TkRjeU16RWdNQzQzTlRBeE56TWdNQzR6TkRjd016VWdNQzQzTkRrMk5URWdNQzR6TkRZNU56a2dNQzQzTkRreE1EVldNQzQzTkRreE1EVmFUVEF1TmpVMU1qQXlJREF1TmpReU1UUTJWakF1Tmpjek5qQTBRekF1TmpVMU1qQXlJREF1TmpjME16RTVJREF1TmpVMU5EZ3pJREF1TmpjMU1EQTFJREF1TmpVMU9UZzBJREF1TmpjMU5URXhRekF1TmpVMk5EZzBJREF1TmpjMk1ERTJJREF1TmpVM01UWXpJREF1TmpjMk16QXhJREF1TmpVM09EY3hJREF1TmpjMk16QXhTREF1TnpJMk16WTFRekF1TnpJMk16WTFJREF1TmpjMk16QXhJREF1TnpJNU5EYzRJREF1TmpjMk16QXhJREF1TnpJNU5EYzRJREF1TmpjNE9UazNWakF1TnpFeU1qVXpRekF1TnpJNU16Y3hJREF1TnpFek1EQTNJREF1TnpJNE9UazJJREF1TnpFek5qazNJREF1TnpJNE5ESXpJREF1TnpFME1Ua3lRekF1TnpJM09EVWdNQzQzTVRRMk9EZ2dNQzQzTWpjeE1Ua2dNQzQzTVRRNU5UY2dNQzQzTWpZek5qVWdNQzQzTVRRNU5VZ3dMalkxTnpnM01VTXdMalkxTnpVeUlEQXVOekUwT1RVZ01DNDJOVGN4TnpNZ01DNDNNVFV3TVRrZ01DNDJOVFk0TlNBd0xqY3hOVEUxTlVNd0xqWTFOalV5TmlBd0xqY3hOVEk1SURBdU5qVTJNak15SURBdU56RTFORGc1SURBdU5qVTFPVGcwSURBdU56RTFOek01UXpBdU5qVTFOek0ySURBdU56RTFPVGtnTUM0Mk5UVTFNemtnTUM0M01UWXlPRGNnTUM0Mk5UVTBNRFVnTUM0M01UWTJNVFJETUM0Mk5UVXlOekVnTUM0M01UWTVOREVnTUM0Mk5UVXlNRElnTUM0M01UY3lPVElnTUM0Mk5UVXlNRElnTUM0M01UYzJORFpXTUM0M05Ea3hNRFZETUM0Mk5UVXlOVEVnTUM0M05EazJORFVnTUM0Mk5UVXhNemdnTUM0M05UQXhPRGdnTUM0Mk5UUTROemNnTUM0M05UQTJOak5ETUM0Mk5UUTJNVFlnTUM0M05URXhNemNnTUM0Mk5UUXlNVGtnTUM0M05URTFNakVnTUM0Mk5UTTNNemdnTUM0M05URTNOalJETUM0Mk5UTXlOVGdnTUM0M05USXdNRGNnTUM0Mk5USTNNVFlnTUM0M05USXdPVGNnTUM0Mk5USXhPRE1nTUM0M05USXdNalJETUM0Mk5URTJOVEVnTUM0M05URTVOU0F3TGpZMU1URTFNeUF3TGpjMU1UY3hOaUF3TGpZMU1EYzFOQ0F3TGpjMU1UTTFNa3d3TGpVNU56Z3lOeUF3TGpZNU56UXlNMVl3TGpZNU16Z3lOMHd3TGpZMU1EYzFOQ0F3TGpZek9UZzVPVU13TGpZMU1EYzFOQ0F3TGpZek9UZzVPU0F3TGpZMU5USXdNaUF3TGpZek9UUTBPU0F3TGpZMU5USXdNaUF3TGpZME1qRTBObFl3TGpZME1qRTBObG9pSUdacGJHdzlJbmRvYVhSbElpOCtKaU40WVRzOFpHVm1jejRtSTNoaE96eHNhVzVsWVhKSGNtRmthV1Z1ZENCcFpEMGljR0ZwYm5Rd1gyeHBibVZoY2lJZ2VERTlJakF1TkRneU1qYzFJaUI1TVQwaUxUQXVNak0yTmpVNElpQjRNajBpTUM0MU1EVXlORE1pSUhreVBTSXdMams0TlRZNE1pSWdaM0poWkdsbGJuUlZibWwwY3owaWRYTmxjbE53WVdObFQyNVZjMlVpUGlZamVHRTdQSE4wYjNBZ2IyWm1jMlYwUFNJd0xqSXlJaUJ6ZEc5d0xXTnZiRzl5UFNJak16SkVORVkxSWk4K0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVORGNpSUhOMGIzQXRZMjlzYjNJOUlpTXpNVVF4UmpNaUx6NG1JM2hoT3p4emRHOXdJRzltWm5ObGREMGlNQzQyTXlJZ2MzUnZjQzFqYjJ4dmNqMGlJekpGUXpsRlFpSXZQaVlqZUdFN1BITjBiM0FnYjJabWMyVjBQU0l3TGpjM0lpQnpkRzl3TFdOdmJHOXlQU0lqTWpsQ1FVUkZJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU9Ea2lJSE4wYjNBdFkyOXNiM0k5SWlNeU1rRTFRMElpTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1TSWdjM1J2Y0MxamIyeHZjajBpSXpFNU9FRkNNeUl2UGlZamVHRTdQQzlzYVc1bFlYSkhjbUZrYVdWdWRENG1JM2hoT3p3dlpHVm1jejRtSTNoaE96d3ZjM1puUGc9PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSI1IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIxOCIgeT0iMjc3LjUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjIxIiB2YWx1ZT0iQXp1cmUgTW9uaXRvciIgc3R5bGU9ImlyLnJlZj0wMWYxN2YzYy03MDhlLTQ4NzctOTRlZC04MDZhODIwNDI4Y2E7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9bWljcm9zb2Z0LWF6dXJlLW1vbml0b3I7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOc2FYQXdLU0krSmlONFlUczhjR0YwYUNCa1BTSk5NQzQxTURjMk1qRWdNQzQ1TnpFd05qRkRNQzQzTmpRME1TQXdMamszTVRBMk1TQXdMamszTWpVM09TQXdMamMyTXpZeU9TQXdMamszTWpVM09TQXdMalV3TnpjME9FTXdMamszTWpVM09TQXdMakkxTVRnMk5pQXdMamMyTkRReElEQXVNRFEwTkRNek5pQXdMalV3TnpZeU1TQXdMakEwTkRRek16WkRNQzR5TlRBNE16SWdNQzR3TkRRME16TTJJREF1TURReU5qWXpOaUF3TGpJMU1UZzJOaUF3TGpBME1qWTJNellnTUM0MU1EYzNORGhETUM0d05ESTJOak0ySURBdU56WXpOakk1SURBdU1qVXdPRE15SURBdU9UY3hNRFl4SURBdU5UQTNOakl4SURBdU9UY3hNRFl4V2lJZ1ptbHNiRDBpZFhKc0tDTndZV2x1ZERCZmNtRmthV0ZzS1NJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UQTNOamt5SURBdU9URXdOemM1UXpBdU56TXhNalE1SURBdU9URXdOemM1SURBdU9URXlORGM0SURBdU56TXdNamcxSURBdU9URXlORGM0SURBdU5UQTNOak0xUXpBdU9URXlORGM0SURBdU1qZzBPVGcySURBdU56TXhNalE1SURBdU1UQTBORGt5SURBdU5UQTNOamt5SURBdU1UQTBORGt5UXpBdU1qZzBNVE0wSURBdU1UQTBORGt5SURBdU1UQXlPVEExSURBdU1qZzBPVGcySURBdU1UQXlPVEExSURBdU5UQTNOak0xUXpBdU1UQXlPVEExSURBdU56TXdNamcxSURBdU1qZzBNVE0wSURBdU9URXdOemM1SURBdU5UQTNOamt5SURBdU9URXdOemM1V2lJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMakUyTkRBMk1pQXdMalV6TVRjek9FTXdMakUyT1RZeE9DQXdMall4TkRNek1pQXdMakl3TkRrNU9TQXdMalk1TWpBNU1pQXdMakkyTXpZeE9DQXdMamMxTURVME1Vd3dMak0zTXpBeUlEQXVOalF4TVRNNVF6QXVNelF6TkRFeklEQXVOakV4TlRZeklEQXVNekkwTWpFMklEQXVOVGN6TVRZNUlEQXVNekU0TXpFNUlEQXVOVE14TnpNNFNEQXVNVFkwTURZeVdpSWdabWxzYkQwaUl6bERSVUpHUmlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU56TXpOalEySURBdU1qUTRPVGMxUXpBdU5qYzNNek1nTUM0eE9UazNORGtnTUM0Mk1EWTBNalVnTUM0eE56QXpORGtnTUM0MU16RTNPVGtnTUM0eE5qVXlPRE5XTUM0ek1UYzRPVGhETUM0MU5qVTVNRGtnTUM0ek1qRTRNU0F3TGpVNU9ESTNOaUF3TGpNek5UQTJJREF1TmpJMU16TTRJREF1TXpVMk1UZzRUREF1TnpNek5qUTJJREF1TWpRNE9UYzFXaUlnWm1sc2JEMGlJek15UWtWRVJDSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVNamd4TnpNNElEQXVNalE0T1RjMVREQXVNemt4TVRRZ01DNHpOVGd6TnpaRE1DNDBNVGd5TURFZ01DNHpNemN5TkRnZ01DNDBOVEExTmprZ01DNHpNak01T1RnZ01DNDBPRFEyTnpnZ01DNHpNakF3T0RaV01DNHhOalV5T0RORE1DNDBNRGsyTnpFZ01DNHhOekF4TVRRZ01DNHpNemd6TkRZZ01DNHhPVGsxTWpnZ01DNHlPREUzTXpnZ01DNHlORGc1TnpWV01DNHlORGc1TnpWYUlpQm1hV3hzUFNJak16SkNSVVJFSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0Mk5UazNPU0F3TGpNNU1ERTNNa013TGpZNE1EWTNJREF1TkRFM05ETXlJREF1TmprME1EVTRJREF1TkRRNU5qYzRJREF1TmprNE5qSTRJREF1TkRnek56RklNQzQ0TlRFeU5ETkRNQzQ0TkRZek1ETWdNQzQwTURrek9ESWdNQzQ0TVRZNE56SWdNQzR6TXpnM09EVWdNQzQzTmpjMU5URWdNQzR5T0RJNU5UbE1NQzQyTlRrM09TQXdMak01TURFM01sb2lJR1pwYkd3OUlpTXpNa0pGUkVRaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTTFOVFV4TlNBd0xqTTVNREUyTTB3d0xqSTBOakV4TkNBd0xqSTRNRGMyTWtNd0xqRTVOamswSURBdU16TTNNemt5SURBdU1UWTRNRFkySURBdU5EQTRPREE0SURBdU1UWTBNRFl5SURBdU5EZ3pOekF4U0RBdU16RTJOamM0UXpBdU16SXhNalEzSURBdU5EUTVOalk1SURBdU16TTBOak0ySURBdU5ERTNOREl6SURBdU16VTFOVEUxSURBdU16a3dNVFl6VmpBdU16a3dNVFl6V2lJZ1ptbHNiRDBpSXpVd1JUWkdSaUl2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TnpnNE56YzBJREF1TXprNE1qSTNRekF1TnpnMk16UWdNQzR6T1RJek5qa2dNQzQzT0RFM016Z2dNQzR6T0RjMk56Y2dNQzQzTnpVNU1qa2dNQzR6T0RVeE0wTXdMamMzTURFeUlEQXVNemd5TlRneUlEQXVOell6TlRVeUlEQXVNemd5TXpjMUlEQXVOelUzTlRrMElEQXVNemcwTlRVeVREQXVOVE15TWpJM0lEQXVORGMxTXpVMVREQXVOVFE1TnpNeElEQXVOVEU1TmpZeVREQXVOemMxTURrNElEQXVORE13TlVNd0xqYzNPREUzT0NBd0xqUXlPVE0yTVNBd0xqYzRNRGs1TVNBd0xqUXlOell3TkNBd0xqYzRNek0yTmlBd0xqUXlOVE16TjBNd0xqYzROVGMwTVNBd0xqUXlNekEzSURBdU56ZzNOakkzSURBdU5ESXdNelF4SURBdU56ZzRPVEE0SURBdU5ERTNNekU0UXpBdU56a3dNVGc1SURBdU5ERTBNamsxSURBdU56a3dPRE00SURBdU5ERXhNRFF5SURBdU56a3dPREUxSURBdU5EQTNOelU0UXpBdU56a3dOemt4SURBdU5EQTBORGMxSURBdU56a3dNRGszSURBdU5EQXhNak15SURBdU56ZzROemMwSURBdU16azRNakkzVmpBdU16azRNakkzV2lJZ1ptbHNiRDBpSTBZd05EQTBPU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TlRBM05qVTRJREF1TlRjek5ESkRNQzQxTkRNNU1TQXdMalUzTXpReUlEQXVOVGN6TWprNUlEQXVOVFEwTURNeUlEQXVOVGN6TWprNUlEQXVOVEEzTnpjNVF6QXVOVGN6TWprNUlEQXVORGN4TlRJM0lEQXVOVFF6T1RFZ01DNDBOREl4TXprZ01DNDFNRGMyTlRnZ01DNDBOREl4TXpsRE1DNDBOekUwTURVZ01DNDBOREl4TXprZ01DNDBOREl3TVRjZ01DNDBOekUxTWpjZ01DNDBOREl3TVRjZ01DNDFNRGMzTnpsRE1DNDBOREl3TVRjZ01DNDFORFF3TXpJZ01DNDBOekUwTURVZ01DNDFOek0wTWlBd0xqVXdOelkxT0NBd0xqVTNNelF5V2lJZ1ptbHNiRDBpZFhKc0tDTndZV2x1ZERGZmNtRmthV0ZzS1NJdlBpWWplR0U3UEM5blBpWWplR0U3UEdSbFpuTStKaU40WVRzOGNtRmthV0ZzUjNKaFpHbGxiblFnYVdROUluQmhhVzUwTUY5eVlXUnBZV3dpSUdONFBTSXdJaUJqZVQwaU1DSWdjajBpTVNJZ1ozSmhaR2xsYm5SVmJtbDBjejBpZFhObGNsTndZV05sVDI1VmMyVWlJR2R5WVdScFpXNTBWSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvTUM0MU1EZ3dNVFVnTUM0MU1EazJNelVwSUhOallXeGxLREF1TkRZMU1UZzNLU0krSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpBdU1UZ2lJSE4wYjNBdFkyOXNiM0k5SWlNMVJVRXdSVVlpTHo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1DNDFOaUlnYzNSdmNDMWpiMnh2Y2owaUl6VkRPVVpGUlNJdlBpWWplR0U3UEhOMGIzQWdiMlptYzJWMFBTSXdMalk1SWlCemRHOXdMV052Ykc5eVBTSWpOVFU1UTBWRUlpOCtKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TnpnaUlITjBiM0F0WTI5c2IzSTlJaU0wUVRrM1JUa2lMejRtSTNoaE96eHpkRzl3SUc5bVpuTmxkRDBpTUM0NE5pSWdjM1J2Y0MxamIyeHZjajBpSXpNNU9UQkZOQ0l2UGlZamVHRTdQSE4wYjNBZ2IyWm1jMlYwUFNJd0xqa3pJaUJ6ZEc5d0xXTnZiRzl5UFNJak1qTTROMFJGSWk4K0ppTjRZVHM4YzNSdmNDQnZabVp6WlhROUlqQXVPVGtpSUhOMGIzQXRZMjlzYjNJOUlpTXdPRGRDUkRZaUx6NG1JM2hoT3p4emRHOXdJRzltWm5ObGREMGlNU0lnYzNSdmNDMWpiMnh2Y2owaUl6QXdOemhFTkNJdlBpWWplR0U3UEM5eVlXUnBZV3hIY21Ga2FXVnVkRDRtSTNoaE96eHlZV1JwWVd4SGNtRmthV1Z1ZENCcFpEMGljR0ZwYm5ReFgzSmhaR2xoYkNJZ1kzZzlJakFpSUdONVBTSXdJaUJ5UFNJeElpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0lnWjNKaFpHbGxiblJVY21GdWMyWnZjbTA5SW5SeVlXNXpiR0YwWlNnd0xqVXdOemN4TWlBd0xqUXdOelF6TVNrZ2MyTmhiR1VvTUM0eE5EQXpNRGdwSWo0bUkzaGhPenh6ZEc5d0lHOW1abk5sZEQwaU1DNHhPU0lnYzNSdmNDMWpiMnh2Y2owaUl6aERPRVU1TUNJdlBpWWplR0U3UEhOMGIzQWdiMlptYzJWMFBTSXdMak0xSWlCemRHOXdMV052Ykc5eVBTSWpPRFE0TmpnNElpOCtKaU40WVRzOGMzUnZjQ0J2Wm1aelpYUTlJakF1TmlJZ2MzUnZjQzFqYjJ4dmNqMGlJelpGTnpBM01TSXZQaVlqZUdFN1BITjBiM0FnYjJabWMyVjBQU0l3TGpreElpQnpkRzl3TFdOdmJHOXlQU0lqTkVFMFFqUkRJaTgrSmlONFlUczhjM1J2Y0NCdlptWnpaWFE5SWpFaUlITjBiM0F0WTI5c2IzSTlJaU16UlROR00wWWlMejRtSTNoaE96d3ZjbUZrYVdGc1IzSmhaR2xsYm5RK0ppTjRZVHM4WTJ4cGNGQmhkR2dnYVdROUltTnNhWEF3SWo0bUkzaGhPenh5WldOMElIZHBaSFJvUFNJd0xqazRORFl4TlNJZ2FHVnBaMmgwUFNJd0xqazRORFl4TVNJZ1ptbHNiRDBpZDJocGRHVWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0RBdU1ERTFNekU1T0NBd0xqQXhOVE00TURrcElpOCtKaU40WVRzOEwyTnNhWEJRWVhSb1BpWWplR0U3UEM5a1pXWnpQaVlqZUdFN1BDOXpkbWMrO3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjMiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjUwMSIgeT0iMTYwIiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIyMiIgdmFsdWU9IkF6dXJlIFZQTiBHYXRld2F5IC0mZ3Q7IEF6dXJlIE1vbml0b3IiIHN0eWxlPSJpci5yZWY9N2E5ZTRmYmQtNzU5Zi00Y2U3LWEwZWEtMTgxYTJlOGMwNmYwO2VkZ2VTdHlsZT1ub25lO2N1cnZlZD0xO2h0bWw9MTtpci5zeW5jaHJvbml6ZWQ9MTtleGl0WD0xO2V4aXRZPTAuNTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MC43NTtlbnRyeVk9MTtlbnRyeUR4PTA7ZW50cnlEeT0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSIzIiBzb3VyY2U9IjEwIiB0YXJnZXQ9IjIxIiBlZGdlPSIxIj4KICAgICAgPG14R2VvbWV0cnkgcmVsYXRpdmU9IjEiIGFzPSJnZW9tZXRyeSI+CiAgICAgICAgPEFycmF5IGFzPSJwb2ludHMiPgogICAgICAgICAgPG14UG9pbnQgeD0iNTYwIiB5PSIzMzgiLz4KICAgICAgICA8L0FycmF5PgogICAgICA8L214R2VvbWV0cnk+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjIzIiB2YWx1ZT0iQXp1cmUgQmFzdGlvbiAtJmd0OyBBenVyZSBNb25pdG9yIiBzdHlsZT0iaXIucmVmPWM3YjlkMjQ1LWJjOWMtNDk0Ny1hYjAxLWMyZjY0NjhjYmUzZDtlZGdlU3R5bGU9bm9uZTtjdXJ2ZWQ9MTtodG1sPTE7aXIuc3luY2hyb25pemVkPTE7ZXhpdFg9MTtleGl0WT0wLjc1O2V4aXREeD0wO2V4aXREeT0wO2VudHJ5WD0wLjc1O2VudHJ5WT0wO2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW5kQXJyb3c9b3BlbjtlbmRGaWxsPTA7ZW5kU2l6ZT00O3NvdXJjZVBlcmltZXRlclNwYWNpbmc9OTtzdHJva2VDb2xvcj0jQkZCRkJGO3N0cm9rZVdpZHRoPTI7IiBwYXJlbnQ9IjMiIHNvdXJjZT0iOCIgdGFyZ2V0PSIyMSIgZWRnZT0iMSI+CiAgICAgIDxteEdlb21ldHJ5IHJlbGF0aXZlPSIxIiBhcz0iZ2VvbWV0cnkiPgogICAgICAgIDxBcnJheSBhcz0icG9pbnRzIj4KICAgICAgICAgIDxteFBvaW50IHg9IjU2MCIgeT0iMTE2Ii8+CiAgICAgICAgPC9BcnJheT4KICAgICAgPC9teEdlb21ldHJ5PgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIyNiIgdmFsdWU9IlNvdXJjZSAtJmFtcDtuYnNwO2h0dHBzOi8vbGVhcm4ubWljcm9zb2Z0LmNvbS9lbi11cy9henVyZS9hcmNoaXRlY3R1cmUvcmVmZXJlbmNlLWFyY2hpdGVjdHVyZXMvaHlicmlkLW5ldHdvcmtpbmcvaHViLXNwb2tlP3RhYnM9Y2xpIiBzdHlsZT0idGV4dDtodG1sPTE7YWxpZ249Y2VudGVyO3ZlcnRpY2FsQWxpZ249bWlkZGxlO3Jlc2l6YWJsZT0wO3BvaW50cz1bXTthdXRvc2l6ZT0xO3N0cm9rZUNvbG9yPW5vbmU7ZmlsbENvbG9yPW5vbmU7Zm9udENvbG9yPSM4QzhDOEM7IiBwYXJlbnQ9IjEiIHZlcnRleD0iMSI+CiAgICAgIDxteEdlb21ldHJ5IHg9Ii0yOTEiIHk9IjUxMyIgd2lkdGg9IjY0MCIgaGVpZ2h0PSIxOCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICA8L3Jvb3Q+CjwvbXhHcmFwaE1vZGVsPgo=</schema>
  </diagram>
  <trustZones>
    <trustZone ref="public" uuid="6376d53e-6461-412b-8e04-7b3fe2b397de" name="Public" desc="Untrusted public zone" trustRating="1"/>
  </trustZones>
  <questions/>
  <assets/>
  <settings/>
  <dataflows>
    <dataflow name="Spoke Network -&gt; Hub Network" ref="0ecb9686-9205-45df-8836-fad981485f3e" source="0f699b05-6196-4ae5-82fe-c7c2a76b9ac9" target="8e8c4c80-77f1-47f0-b475-881a7095a777">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Azure VPN Gateway -&gt; Azure Monitor" ref="7a9e4fbd-759f-4ce7-a0ea-181a2e8c06f0" source="8d6bde54-d227-4029-84f7-ce509a52b41e" target="7254a12e-6d3f-403f-96a5-1665707b7d32">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Spoke Network -&gt; Hub Network" ref="7b682d36-41a2-4692-b321-3949555c784b" source="b4e9b90e-29fd-48fe-8465-bc30c9d76c73" target="8e8c4c80-77f1-47f0-b475-881a7095a777">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Azure Bastion -&gt; Azure Monitor" ref="c7b9d245-bc9c-4947-ab01-c2f6468cbe3d" source="f871a3d9-0098-412e-82fc-c6109c5b5747" target="7254a12e-6d3f-403f-96a5-1665707b7d32">
      <assets/>
      <tags/>
    </dataflow>
  </dataflows>
  <customFields>
    <customField ref="APT" value=""/>
    <customField ref="Application Details" value=""/>
    <customField ref="Application Downtime Cost" value=""/>
    <customField ref="Application Type" value=""/>
    <customField ref="Apply Standard at all times" value="1"/>
    <customField ref="Contact Email" value=""/>
    <customField ref="Custom Field A" value=""/>
    <customField ref="DEL" value=""/>
    <customField ref="GPS Environment" value="NO"/>
    <customField ref="Hosting Location" value="GCP"/>
    <customField ref="Milestone 1" value=""/>
    <customField ref="Milestone 1 - Deadline" value=""/>
    <customField ref="Milestone 2" value=""/>
    <customField ref="Milestone 2 - Deadline" value=""/>
    <customField ref="Milestone 3" value=""/>
    <customField ref="Milestone 3 - Deadline" value=""/>
    <customField ref="Product Review Session Details" value=""/>
    <customField ref="Project Management Details" value=""/>
    <customField ref="Project Manager" value=""/>
    <customField ref="Project Number" value="_::_"/>
    <customField ref="Project Owner Email" value="jrabe@iriusrisk.com"/>
    <customField ref="Ready for Workflow advancement?" value="NO"/>
    <customField ref="Requirements" value=""/>
    <customField ref="Test Custom" value=""/>
    <customField ref="Third Party Contact" value=""/>
    <customField ref="Third Party Organization" value=""/>
    <customField ref="UPS Template Picker" value="GCP Template"/>
    <customField ref="Use Case" value=""/>
    <customField ref="User Email Field" value=""/>
    <customField ref="VZ - Requirements" value="Type 1||Type 2"/>
  </customFields>
  <components>
    <component uuid="32d92cd0-2104-403f-b8bf-af83b3fe8df0" diagramComponentId="a1599e06-bcd2-4818-b376-835d8d067c74" ref="7d1a8f52-1392-4092-aa84-3c471f0980a3" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="b4e9b90e-29fd-48fe-8465-bc30c9d76c73" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.947">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.946">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.946">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.946">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.946">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.946">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.864">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.865">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.865">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.865">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.866">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="12f041b4-a915-4855-b7f1-593569a75dad" diagramComponentId="211a5496-3073-4af2-9f72-a5e6c64b73c2" ref="9c0b8516-22cf-40aa-8f05-fc871e654e36" name="Azure Environment" desc="" library="Microsoft-Azure" parentComponentRef="" componentDefinitionRef="microsoft-azure-environment">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.744">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.495">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON02" name="Excessive use of administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON03" name="Lack of 2FA" state="0" impact="100" issueId="" issueLink="">
          <desc>Logging into the console without using Multi-factor Authentication (MFA) and without being detected. The connection without MFA must be audited and monitored, the correct security group must be informed and the connection must be validated.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.931">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZ-W04" name="Misconfigured Authentication Method for Administrator Accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The authentication method &amp;quot;Multi-factor Authentication&amp;quot; for the Administrator accounts is not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="LOST-SECURITY-ALERTS" name="Misconfigured Security contact details" state="0" impact="100" issueId="" issueLink="">
          <desc>The security contact details for the Azure subscription are not properly configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security
                            contact details&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fields are filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-IDENTITY-03" name="Misconfigured User Account" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Key security settings such as resetting the password and other password controls are not
                        configured.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-ACCESS-01" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        The credentials for groups and roles are not correctly configured and there are user accounts with more privileges than necessary.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles to achieve principle of
                            least privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the roles for the Cloud Service are well assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;div&gt;
                            &lt;/div&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-EXPIRATION-DATE" name="Misconfigured password expiration" state="0" impact="100" issueId="" issueLink="">
          <desc>The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            More information: Doc MS Azure
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.494">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VNET01" name="Networks for Azure resources are not properly segmented. Without proper segmentation, when attackers gain access to one resource, any other resources in the same VNet are compromised" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Identify the resources and the Microsoft Azure instances.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the resources are in the correct VNet.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the Microsoft Azure instances&amp;nbsp;are into different VNets.
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.153">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-LOGS02" name="Non-auditable connections to the web application" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        The status connection or failed attempts cannot be audited because they are not recorded into
                        the logs.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Detailed error messages&amp;quot; is enabled.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Failed request tracing&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.744">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-LOGS01" name="Non-auditable resource changes" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        The Diagnostic Logs are not activated and configured. Therefore, the changes or the access to
                        the resources are not recorded into the logs.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that &amp;quot;Application Logging (Filesystem)&amp;quot; and &amp;quot;Application
                            Logging (Blob)&amp;quot; are enabled.&lt;/li&gt;
                            &lt;li&gt;Check that the type &amp;quot;Storage&amp;quot; or &amp;quot;File System&amp;quot;
                            are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.744">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="LOST-ACCESS-ROOT-01" name="The Root Account is mis-configured" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator account is not configured. The security question to recover or reset the
                        password and the authentication method are not configured.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.493">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON06" name="Undetected brute force attempts on MS Azure management console" state="0" impact="100" issueId="" issueLink="">
          <desc>The failure connection attempts (brute force) must be audited and monitored and correspondent
                        personnel must be alerted and informed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when several console login failure attempts
                            occur.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.931">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON05" name="Undetected changes in data encryption configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes on the database encryption must be audited and monitored. When there are changes
                        on the database encryption, the security group must be alerted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Transparent Data Encryption is
                            disabled.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.931">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON07" name="Undetected changes in network configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Changes in network configurations (NACLs, route and gateway tables) are not detected because
                        monitoring and alerting on the network is not configured to detect these changes.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC NACL changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC route table changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC gateway changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.931">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON01" name="Undetected changes in security configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Monitoring and alerting for security configurations are not configured and changes cannot be
                        detected.&amp;nbsp;
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Activity Logs configuration
                            changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the security policy changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the recommended configuration changes.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when activity alerts changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.931">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON04" name="Undetected changes in security groups" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in security groups must be traced and monitored and the correspondent personnel
                        must approve these changes. If the situation is not the correct, attackers can access to
                        security systems.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the security groups or security group
                            configurations change.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.930">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-A09" name="Apply RBAC with pre-defined policies added into groups or roles" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        All the users in an IAM group inherit the permissions assigned to the group. That way, you can
                        make changes for everyone in a group in just one place. As people move around in your company,
                        you can simply change what IAM group their IAM user belongs to. This method is known as Role
                        Based Access Control (RBAC).&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Remove a user from a group:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on the user name. All the groups the user belongs are there.&lt;/li&gt;
                        &lt;li&gt;Choose the group and &amp;quot;Remove&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a group and add user:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;New Group&amp;quot; and fill the information.&lt;/li&gt;
                        &lt;li&gt;Search and add the user.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A08" name="Configure a strong security challenge questions for the user account" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        Activate and configure the security challenge question and the possibility of resetting the
                        password by confirming the user's identity is allowed. Make sure that the security confirmation
                        measures match the security criteria. Otherwise, it could make a weak confirmation and allow the&amp;nbsp;password
                        reset to malicious users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Choose the security confirmation measures that match the security criteria and click
                        &amp;quot;Save&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Azure AD self-service password reset" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A12" name="Configure password expiration" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        &lt;div&gt;
                        Configure the password expiration to force after a determinate time, the password code shall be
                        changed for the users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Configure password management to match security criteria. This value is configurable
                        using the Set-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for Windows
                        PowerShell. With the following command as the example:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        Set-MsolPasswordPolicy -ValidityPeriod 60 -NotificationDays 14&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;This command updates the tenant so that all users passwords expire after 60
                        days. The users receive notification 14 days prior to that expiry.
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        More information:&amp;nbsp;
                        &lt;a
                        href="https://docs.microsoft.com/en-us/powershell/module/msonline/set-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                        MS Azure&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Password policies and restrictions in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-policy"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;More information:
                            &lt;a
                            href="https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                            MS Azure&lt;/a&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A11" name="Configure roles for the Cloud Service" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Define and create the roles for the Azure Cloud Service. For each role, define the permissions and also configure how that role runs. When you launch an Azure instance, you shall specify a role for the instance as a launch parameter. Applications that run on the Cloud instance use the role's credentials when they access Azure resources. This role's permissions determine what the application is allowed to do.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Configure an Azure cloud service from Solution Explorer in Visual Studio.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the roles for the Cloud Service are well assigned.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A02" name="Configure the security challenge questions for the administrator account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Activate and configure the security challenge question and the possibility of resetting the password by confirming the user's identity is allowed. In case of being an owner account of the subscription that has full administration access, it is necessary to do this, as a security measure that this password is lost. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The security confirmation measures will depend on those specified by the Active Directory administrator. Make sure that the security confirmation measures match the security criteria. Otherwise, it could make a weak confirmation and allow the password reset to malicious users. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Using the console:&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt; 
 &lt;ol&gt; 
  &lt;ol&gt; 
   &lt;li&gt;Open https://aka.ms/ssprsetup and Log into the account.&lt;/li&gt; 
   &lt;li&gt;Respond to security measures.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;Once all needed controls are finished, click on accept.&lt;/li&gt; 
  &lt;/ol&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Using the portal:&lt;/li&gt; 
  &lt;ol&gt; 
   &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
   &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
   &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt; 
   &lt;li&gt;Choose the security confirmation measures that match the security criteria and click &amp;quot;Save&amp;quot;.&lt;/li&gt; 
  &lt;/ol&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Azure AD self-service password reset" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-getting-started"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Using the portal:
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are filled
                            and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M04" name="Create alerts due of Transparent Data Encryption Deletion" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes of
                        Transparent Data Encryption to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the Transparent Data Encryption is
                            disabled.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.860">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M12" name="Create alerts for changes in security groups and in security groups configurations" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the security groups or in security groups configurations to the correspondent personnel. It's
                        vital that these unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the security groups or security group
                            configurations change.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M01" name="Create alerts for changes on Activity Logs configuration" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for the Activity Logs changes to monitor, audit and notify about the changes to the correspondent personnel. It's vital that these unauthorized changes are detected.&lt;/p&gt;&lt;p&gt;Checklist:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ensure that Activity Log Alert exists for:&amp;nbsp;&lt;ul&gt;&lt;li&gt;Create Policy Assignment&lt;/li&gt;&lt;li&gt;Delete Policy Assignment&lt;/li&gt;&lt;li&gt;Create or Update Network Security Group&lt;/li&gt;&lt;li&gt;Delete Network Security Group&lt;/li&gt;&lt;li&gt;Create or Update Network Security Group Rule&lt;/li&gt;&lt;li&gt;Delete Network Security Group Rule&lt;/li&gt;&lt;li&gt;Create or Update Security Solution&lt;/li&gt;&lt;li&gt;Delete Security Solution&lt;/li&gt;&lt;li&gt;Create or Update or Delete SQL Server Firewall Rule&lt;br&gt;&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Monitor&lt;/li&gt;&lt;li&gt;Select Alerts&lt;ol&gt;&lt;li&gt;For each one of the elements in the checklist, click On New Alert Rule&lt;ol&gt;&lt;li&gt;Under Scope, click Select resource&lt;/li&gt;&lt;li&gt;Select the appropriate subscription under Filter by subscription&lt;/li&gt;&lt;li&gt;Select Policy Assignment under Filter by resource type&lt;/li&gt;&lt;li&gt;Select All for Filter by location&lt;/li&gt;&lt;li&gt;Click on the subscription resource from the entries populated under Resource&lt;/li&gt;&lt;li&gt;Verify Selection preview shows All Policy assignment (policyAssignments) and your selected subscription name&lt;/li&gt;&lt;li&gt;Click Done&lt;/li&gt;&lt;li&gt;Under Condition click Add Condition&lt;/li&gt;&lt;li&gt;Select the corresponding element from the checklist&lt;/li&gt;&lt;li&gt;Click Done&lt;/li&gt;&lt;li&gt;Under Action group, select Add action groups and complete creation process or select appropriate action group&lt;/li&gt;&lt;li&gt;Under Alert rule details, enter Alert rule name and Description&lt;/li&gt;&lt;li&gt;Select appropriate resource group to save the alert to&lt;/li&gt;&lt;li&gt;Check Enable alert rule upon creation checkbox&lt;/li&gt;&lt;li&gt;Click Create alert rule&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.2.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.2" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.3" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.7" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.7" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.8" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.8" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.2.9" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.2.9" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="LT-4" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Go to "Monitor" and then to "Alerts".&lt;/li&gt;&lt;li&gt;Check that there is any rule to alert when the Activity Logs configuration changes.&lt;/li&gt;&lt;li&gt;Check if these rules are enabled.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M02" name="Create alerts for security policy changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the Management
                        Security Policies changes to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the security policy changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M08" name="Create alerts for VPC gateway changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC gateway tables to the correspondent personnel. It's vital that these unauthorized
                        changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;VPC gateways are used as a means of sending traffic outside of VPC (i.e. to the
                        Internet) and are vital in ensuring traffic flows to correct destination. Therefore alerting on
                        changes to VPC gateways ensuring traffic continues to flow as expected via the correct gateway.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC gateway changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M06" name="Create alerts for VPC NACL changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the Network Access Control Lists (NACLs) to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The Network Access Control Lists (NACLs) control inbound and outbound access to &amp;amp; from
                        MS Azure subnets and work like packet filters to protect the network. Therefore alerting on
                        changes to NACLs help ensure that the subnets protected by them are not exposed.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC NACL changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M07" name="Create alerts for VPC route table changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the VPC route tables to the correspondent personnel. It's vital that these unauthorized changes
                        are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        VPC route table provides a means of routing network traffic between subnets and via gateways and
                        ensures traffic flows via the correct path. Therefore alerting on changes to route tables
                        ensuring the traffic continues to flow as expected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when the VPC route table changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M03" name="Create alerts to detect changes in the recommendation configurations" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the changes in
                        the recommendation configurations to the correspondent personnel. It's vital that these
                        unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to alert when the recommended configuration changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M09" name="Create alerts to detect changes on activity alerts" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the alert
                        modifications to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when activity alerts&amp;nbsp;changes.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M10" name="Create alerts to notify a bad usage of the root account" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the usage of the
                        root accounts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M11" name="Create alerts to notify about the console login without MFA" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for Activity Log changes to monitor, audit and notify about the user's login into
                        the console without Multi-factor Authentication to the correspondent personnel. It's vital that
                        these unauthorized changes are detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-M05" name="Create alerts to notify the console login failure attempts" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts for the Activity Logs changes to monitor, audit and notify about the console login
                        failure attempts to the correspondent personnel. It's vital that these unauthorized changes are
                        detected.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Add activity log alert&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Filling the fields with the corresponding values.&lt;/li&gt;
                        &lt;li&gt;Select in actions the personnel should be received this information.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create activity log alerts" url="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when several&amp;nbsp;console login failure
                            attempts occur.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.861">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-AD19" name="Create a resource lock administrator role" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Resource locking is a powerful protection mechanism that can prevent inadvertent modification/deletion of resources within Azure subscriptions/Resource Groups and is a recommended NIST configuration.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Given the resource lock functionality is outside of standard Role Based Access Control(RBAC), it would be prudent to create a resource lock administrator role to prevent inadvertent unlocking of resources.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;By adding this role is you can have specific permissions granted for managing just resource locks rather than needing to provide the wide owner or contributor role reducing the risk of the user being able to do unintentional damage.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Azure Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;In the Azure portal, open a subscription or resource group where you want the custom role to be assignable.&lt;/li&gt;&lt;li&gt;Select Access control (IAM)&lt;/li&gt;&lt;li&gt;Click Add&lt;/li&gt;&lt;li&gt;Select Add custom role`.&lt;/li&gt;&lt;li&gt;In the Custom Role Name field enter Resource Lock Administrator&lt;/li&gt;&lt;li&gt;In the Description field enter Can Administer Resource Locks&lt;/li&gt;&lt;li&gt;For Baseline permissions select Start from scratch&lt;/li&gt;&lt;li&gt;Click next&lt;/li&gt;&lt;li&gt;In the Permissions tab select Add permissions&lt;/li&gt;&lt;li&gt;In the Search for a permission box, type in Microsoft.Authorization/locks to search for permissions.&lt;/li&gt;&lt;li&gt;Select the check box next to the permission called Microsoft.Authorization/locks&lt;/li&gt;&lt;li&gt;Click add&lt;/li&gt;&lt;li&gt;Click Review+create&lt;/li&gt;&lt;li&gt;Click Create&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Assign the newly created role to the appropriate user. Using PowerShell: Below is a power shell definition for a resource lock administrator role created at an Azure Management group level&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Import-Module Az.Accounts Connect-AzAccount $role = Get-AzRoleDefinition "User Access Administrator" $role.Id = $null $role.Name = "Resource Lock Administrator" $role.Description = "Can Administer Resource Locks" $role.Actions.Clear() $role.Actions.Add("Microsoft.Authorization/locks/*") $role.AssignableScopes.Clear() * Scope at the Management group level Management group $role.AssignableScopes.Add("/providers/Microsoft.Management/managementGroups/MG-Name") New-AzRoleDefinition -Role $role Get-AzureRmRoleDefinition "Resource Lock Administrator"&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="1.23" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="GS-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="GS-6" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PA-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PA-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PA-5" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PA-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Azure Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;In the Azure portal, open a subscription or resource group where you want the view assigned roles.&lt;/li&gt;&lt;li&gt;Select Access control (IAM)&lt;/li&gt;&lt;li&gt;Select Roles&lt;/li&gt;&lt;li&gt;Search for the custom role named &amp;lt;role_name&amp;gt; Ex. from remediation "Resource Lock Administrator"&lt;/li&gt;&lt;li&gt;Ensure that the role is assigned the appropriate user/users&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A03" name="Create Individual Accounts for the administrator users" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user's account. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Add New User&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Fill the required information and click &amp;quot;Create&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Add new users to Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/add-users-azure-active-directory"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got a user account assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A10" name="Create mechanisms to ensure the principle of least privilege is applied" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create the mechanisms to review periodically the group and user permissions to ensure the least privilege for the user accounts. Granting least privilege ensures that users only have the permissions required to complete their jobs rather than additional privileges that are not required. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Following this model ensures that, should an account be compromised, the blast radius of damage is limited&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Allocate privileges via groups or roles via the recommendation in "Use RBAC with pre-defined policies added into groups or roles".&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the principle of least privilege is achieved in the assignation of roles and
                            groups to the users.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L03" name="Enable Detailed error messages" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Enable the detailed error information for HTTP status codes that indicate a failure (status code
                        400 or greater) is saved into the logs files. This may contain information that can help
                        determine why the server returned the error code.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                        &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                        &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Enable the &amp;quot;Detailed error messages&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Push &amp;quot;Save&amp;quot; to save the changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Detailed error messages&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L01" name="Enable diagnostic logs auditing for Microsoft Azure" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Diagnostic Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself, for example, getting a secret from a Key Vault. Currently, 32 Azure resources support Diagnostic Logging (See the references section for a complete list), including Network Security Groups, Load Balancers, Key Vault, AD, Logic Apps and CosmosDB. The content of these logs varies by resource type. For example, Windows event system logs are a category of diagnostics logs for VMs, and blob, table, and queue logs are categories of diagnostics logs for storage accounts.&lt;/p&gt;&lt;p&gt;A number of back-end services were not configured to log and store Diagnostic Logs for certain activities or for a sufficient length. It is crucial that logging systems are correctly configured to log all relevant activities and retain those logs for a sufficient length of time. By default, Diagnostic Logs are not enabled. Given that the mean time to detection in an enterprise is 240 days, a minimum retention period of two years is recommended.&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The specific steps for configuring resources within the Azure console vary depending on resource, but typically the steps are:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="LT-4" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="LT-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L04" name="Enable Failed Request Tracing" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable to obtain the detailed information on failed requests, including a trace of the IIS components used to process the request and the time taken in each component. This can be useful if you are attempting to increase site performance or isolate what is causing a specific HTTP error to be returned. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to the Azure portal.&lt;/li&gt; 
  &lt;li&gt;Go to the blade for your web app and in "Monitoring" &amp;gt;&amp;gt; "Diagnostics logs".&lt;/li&gt; 
  &lt;li&gt;Enable the "Failed request tracing".&lt;/li&gt; 
  &lt;li&gt;Push "Save" to save the changes.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the &amp;quot;Failed request tracing&amp;quot; is enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A04" name="Enable MFA for Administrator &amp; Co Administrator accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp;amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into "Users and groups" &amp;gt; "All users".&lt;/li&gt; 
  &lt;li&gt;Select "Multi-Factor Authentication".&lt;/li&gt; 
  &lt;li&gt;Choose all the Service Administrator &amp;amp; Co Administrator accounts and enable MFA.&amp;nbsp;&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to require two-step verification for a user or group" url="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-get-started-user-states"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L02" name="Enable Web Server Logging" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable the Web Server logging to receive information about HTTP transactions using the W3C extended log file format. This is useful when determining overall site metrics such as the number of requests handled or how many requests are from a specific IP address. There are two ways to save the data: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;&lt;b&gt;File system: &lt;/b&gt;stores the application diagnostics information to the web app file system. These files can be accessed by FTP, or downloaded as a Zip archive by using the Azure PowerShell or Azure Command-Line Interface (Azure CLI).&lt;/li&gt; 
  &lt;li&gt;&lt;b&gt;Storage:&lt;/b&gt; stores the application diagnostics information in the specified Azure Storage Account and the logs are only accessible with a client account.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to the Azure portal.&lt;/li&gt; 
  &lt;li&gt;Go to the blade for your web app and in "Monitoring" &amp;gt;&amp;gt; "Diagnostics logs".&lt;/li&gt; 
  &lt;li&gt;Enable the type "Storage" or "File System" to activate this function.&lt;/li&gt; 
  &lt;li&gt;Push "Save" to save the changes.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to the Azure portal.&lt;/li&gt;
                            &lt;li&gt;Go to the blade for your web app and in &amp;quot;Monitoring&amp;quot; &amp;gt;&amp;gt;
                            &amp;quot;Diagnostics logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the type &amp;quot;Storage&amp;quot; or &amp;quot;File System&amp;quot;
                            are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L05" name="Export the Audit Logs to a storage account" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Export the information of Audit Logs to a storage account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to "Monitor" and then to "Activity Logs".&lt;/li&gt; 
  &lt;li&gt;Push the button "Export".&lt;/li&gt; 
  &lt;li&gt;Select "All Regions".&lt;/li&gt; 
  &lt;li&gt;Select "Export to a storage account" and select your account.&lt;/li&gt; 
  &lt;li&gt;Select the "Retention (days)" as minimum 90 days.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N09" name="Isolate Azure instances into different VNets" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud instance can use the VNet security configuration when they access Azure resources.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can configure an Azure cloud service from Solution Explorer in Visual Studio. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a virtual network with multiple subnets" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the Azure instances are into different VNets.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.117">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N08" name="Isolate Azure resources into separate VNets by function" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Place the resources into separate VNets according to their use (production, development, test).
                        Placing such resources accordingly ensures that a resource of a higher security level is not
                        exposed by the security settings of a lower labeled VNet.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the resources that exist in an incorrect VNet.&lt;/li&gt;
                        &lt;li&gt;Migrate or move it to the correct Vnet.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Azure Virtual Network" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Identify the resources that exist in an incorrect VNet.&lt;/li&gt;
                            &lt;li&gt;Check that the resources are into the correct Vnet.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.117">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A07" name="Recertify user access" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Do regular reviews of accounts on the system and verify that it doesn't exist stoled or fake
                        accounts. With this process is ensured that there are not compromised accounts by former
                        employees or by attackers.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist:&lt;/li&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Delete&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Assign a user or group to an enterprise app in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-coreapps-assign-user-azure-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A01" name="Register a Security contact for your Azure account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Provide the security contact details for the Azure subscription. Microsoft Security Response Center (MSRC) performs security monitoring of the Azure network and infrastructure and receives threat intelligence and abuse complaints from third parties. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Microsoft will use this information provided to contact if the MSRC discovers that customer data has been accessed by an unlawful or unauthorized party. Also, this provides the means of ensuring these advisories are routed to the security team, especially if a distribution email address is used.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security contact details&amp;quot;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Once filled, save changes.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Provide security contact details in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security
                            contact details&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fields are filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.425">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS01">
                  <countermeasures>
                    <countermeasure ref="AZ-L01" mitigation="20"/>
                    <countermeasure ref="AZ-L02" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-LOGS02">
                  <countermeasures>
                    <countermeasure ref="AZ-L03" mitigation="20"/>
                    <countermeasure ref="AZ-L04" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-L05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-L01" mitigation="20"/>
                <countermeasure ref="AZ-L02" mitigation="20"/>
                <countermeasure ref="AZ-L03" mitigation="20"/>
                <countermeasure ref="AZ-L04" mitigation="20"/>
                <countermeasure ref="AZ-L05" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHENTICATION" name="Authentication" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;div&gt;Attackers could gain unauthorized access to the administrator account due to a lack of configuration of the account and its security mechanisms, making it possible to modify credentials and add/remove user accounts.
                                &lt;/div&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZ-W04">
                  <countermeasures>
                    <countermeasure ref="AZ-A04" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON02">
                  <countermeasures>
                    <countermeasure ref="AZ-A03" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="LOST-ACCESS-ROOT-01">
                  <countermeasures>
                    <countermeasure ref="AZ-A02" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="LOST-SECURITY-ALERTS">
                  <countermeasures>
                    <countermeasure ref="AZ-A01" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A01" mitigation="25"/>
                <countermeasure ref="AZ-A02" mitigation="25"/>
                <countermeasure ref="AZ-A03" mitigation="25"/>
                <countermeasure ref="AZ-A04" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AZURE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the user account due to the lack of configuration of the account, for example, the security question to reset the password is configured incorrectly.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-IDENTITY-03">
                  <countermeasures>
                    <countermeasure ref="AZ-A07" mitigation="50"/>
                    <countermeasure ref="AZ-A08" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A07" mitigation="50"/>
                <countermeasure ref="AZ-A08" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-ACCESS-01">
                  <countermeasures>
                    <countermeasure ref="AZ-A09" mitigation="20"/>
                    <countermeasure ref="AZ-A10" mitigation="30"/>
                    <countermeasure ref="AZ-A11" mitigation="30"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-EXPIRATION-DATE">
                  <countermeasures>
                    <countermeasure ref="AZ-A12" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A09" mitigation="20"/>
                <countermeasure ref="AZ-A10" mitigation="30"/>
                <countermeasure ref="AZ-A11" mitigation="30"/>
                <countermeasure ref="AZ-A12" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZURE-AD19" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-AD19" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOG ACTIVITY ALERTS" name="Log Activity alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-SYSTEMS" name="Attackers access the systems without being detected" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers gain access to the systems and are not detected and consequently, changes made by attackers can not be audited or detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="25" availability="25" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-MON02">
                  <countermeasures>
                    <countermeasure ref="AZ-M10" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON03">
                  <countermeasures>
                    <countermeasure ref="AZ-M11" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON04">
                  <countermeasures>
                    <countermeasure ref="AZ-M12" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON05">
                  <countermeasures>
                    <countermeasure ref="AZ-M04" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON06">
                  <countermeasures>
                    <countermeasure ref="AZ-M05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-M04" mitigation="20"/>
                <countermeasure ref="AZ-M05" mitigation="20"/>
                <countermeasure ref="AZ-M10" mitigation="20"/>
                <countermeasure ref="AZ-M11" mitigation="20"/>
                <countermeasure ref="AZ-M12" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS" name="Attackers gain undetected access to the security system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain undetected access to the security system configurations and
                                changes made by attackers couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-MON01">
                  <countermeasures>
                    <countermeasure ref="AZ-M01" mitigation="25"/>
                    <countermeasure ref="AZ-M02" mitigation="25"/>
                    <countermeasure ref="AZ-M03" mitigation="25"/>
                    <countermeasure ref="AZ-M09" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-M01" mitigation="25"/>
                <countermeasure ref="AZ-M02" mitigation="25"/>
                <countermeasure ref="AZ-M03" mitigation="25"/>
                <countermeasure ref="AZ-M09" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-ACCESS-NETWORK" name="Sensitive data is compromised through network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers gain undetected access to the network systems and changes made by the
                                attackers couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-MON07">
                  <countermeasures>
                    <countermeasure ref="AZ-M06" mitigation="40"/>
                    <countermeasure ref="AZ-M07" mitigation="30"/>
                    <countermeasure ref="AZ-M08" mitigation="30"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-M06" mitigation="40"/>
                <countermeasure ref="AZ-M07" mitigation="30"/>
                <countermeasure ref="AZ-M08" mitigation="30"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VNET01">
                  <countermeasures>
                    <countermeasure ref="AZ-N08" mitigation="50"/>
                    <countermeasure ref="AZ-N09" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N08" mitigation="50"/>
                <countermeasure ref="AZ-N09" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="1fe348c8-c99e-4706-9d9f-fd5b2a98f72c" diagramComponentId="09d0f96d-852b-40f9-820f-d04e50855502" ref="f6b674e5-489a-4507-a356-83a5ffda20a0" name="Cross Premise Network" desc="" library="CS-Default" parentComponentRef="9c0b8516-22cf-40aa-8f05-fc871e654e36" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="62343a67-838d-418a-a28f-0ffd0b2f0d26" diagramComponentId="e582f56b-594c-43f4-8cbd-abf145215c9a" ref="a3062d9b-1a73-47a6-b89a-2dfe42f577b2" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="0f699b05-6196-4ae5-82fe-c7c2a76b9ac9" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.311">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.311">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.024">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="25e54264-957d-4601-91c1-f5ad73bfce08" diagramComponentId="49d91052-a64b-456a-bb84-8e060d68b130" ref="b4e9b90e-29fd-48fe-8465-bc30c9d76c73" name="Spoke Network" desc="" library="CS-Default" parentComponentRef="9c0b8516-22cf-40aa-8f05-fc871e654e36" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="e1dd197a-cf8a-4adb-82d4-57d3cd5102b3" diagramComponentId="b511b9b4-ff0f-407c-a26a-6651b509df6b" ref="f871a3d9-0098-412e-82fc-c6109c5b5747" name="Azure Bastion" desc="" library="Microsoft-Azure" parentComponentRef="8e8c4c80-77f1-47f0-b475-881a7095a777" componentDefinitionRef="CD-MICROSOFT-AZURE-BASTION">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-VNET01" name="Networks for Azure resources are not properly segmented. Without proper segmentation, when attackers gain access to one resource, any other resources in the same VNet are compromised" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Identify the resources and the Microsoft Azure instances.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the resources are in the correct VNet.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the Microsoft Azure instances&amp;nbsp;are into different VNets.
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.945">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.944">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N09" name="Isolate Azure instances into different VNets" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud instance can use the VNet security configuration when they access Azure resources.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can configure an Azure cloud service from Solution Explorer in Visual Studio. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a virtual network with multiple subnets" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the Azure instances are into different VNets.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.906">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.906">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-UNAUTHORISED-CONNECTION" name="Attackers perform unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could perform unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-VNET01">
                  <countermeasures>
                    <countermeasure ref="AZ-N09" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="50"/>
                <countermeasure ref="AZ-N09" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="a1f20f69-5d8b-4eb3-8495-b5bd1a76da16" diagramComponentId="3ea3914e-7c91-4658-8e20-96cde19a4dc5" ref="3433e317-d296-4a92-bf9d-dedb41cbbac9" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="f6b674e5-489a-4507-a356-83a5ffda20a0" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.606">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.605">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.605">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.605">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.605">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.604">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.493">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.498">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.499">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="464e7a91-2f2b-449f-9390-588600bd0421" diagramComponentId="924f3813-06ad-42f3-8555-d4e3dbea0366" ref="c4e5280c-c5c0-4fb9-bf75-3ef381718f72" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="0f699b05-6196-4ae5-82fe-c7c2a76b9ac9" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.424">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.423">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.338">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.339">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.339">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.339">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.339">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.339">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:25.340">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="753ff421-c9ef-4c05-b767-8dad325958e9" diagramComponentId="32eb20c5-0a57-48f1-a326-4f975eacaf1e" ref="0f699b05-6196-4ae5-82fe-c7c2a76b9ac9" name="Spoke Network" desc="" library="CS-Default" parentComponentRef="9c0b8516-22cf-40aa-8f05-fc871e654e36" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="69d90578-12a2-412a-b610-3c8c1ba48474" diagramComponentId="2832e105-2480-4b3e-9bda-36c1dbb862b5" ref="8e8c4c80-77f1-47f0-b475-881a7095a777" name="Hub Network" desc="" library="CS-Default" parentComponentRef="9c0b8516-22cf-40aa-8f05-fc871e654e36" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="4bb2919f-433f-423f-a922-bc2f5dbbf02d" diagramComponentId="01f17f3c-708e-4877-94ed-806a820428ca" ref="7254a12e-6d3f-403f-96a5-1665707b7d32" name="Azure Monitor" desc="" library="Microsoft-Azure" parentComponentRef="9c0b8516-22cf-40aa-8f05-fc871e654e36" componentDefinitionRef="microsoft-azure-monitor">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.000">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="DATA-TRANSMIT-CLEAR" name="Data is transmitted in clear text" state="0" impact="100" issueId="" issueLink="">
          <desc>Data is not protected when transmitted to applications or customers and it can be read or modified by unauthorized actors.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:24.000">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON02" name="Excessive use of administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NON-IDENTIFY" name="Insufficient resource identification" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources are not registered in the safety net systems, and/or additional unidentified resources exist. As such, additional weaknesses might be introduced.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON03" name="Lack of 2FA" state="0" impact="100" issueId="" issueLink="">
          <desc>Logging into the console without using Multi-factor Authentication (MFA) and without being detected. The connection without MFA must be audited and monitored, the correct security group must be informed and the connection must be validated.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZ-W04" name="Misconfigured Authentication Method for Administrator Accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The authentication method &amp;quot;Multi-factor Authentication&amp;quot; for the Administrator accounts is not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-IDENTITY-03" name="Misconfigured User Account" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Key security settings such as resetting the password and other password controls are not
                        configured.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-ACCESS-01" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        The credentials for groups and roles are not correctly configured and there are user accounts with more privileges than necessary.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles to achieve principle of
                            least privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the roles for the Cloud Service are well assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;div&gt;
                            &lt;/div&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-EXPIRATION-DATE" name="Misconfigured password expiration" state="0" impact="100" issueId="" issueLink="">
          <desc>The password expiration is not configured and users are not obliged to change their passwords.
                        Not change frequently the passwords gives facilities to attackers to obtain them.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            More information: Doc MS Azure
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VNET01" name="Networks for Azure resources are not properly segmented. Without proper segmentation, when attackers gain access to one resource, any other resources in the same VNet are compromised" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Identify the resources and the Microsoft Azure instances.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the resources are in the correct VNet.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the Microsoft Azure instances&amp;nbsp;are into different VNets.
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MONITOR-BACKUPS" name="There is not a recover or backup mechanism" state="0" impact="100" issueId="" issueLink="">
          <desc>There are not any processes or mechanisms to regularly save the data to another place in order to have an older version of the data to restore in case of loss. Consequently the data cannot be easily recovered or they cannot be recovered at all.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.999">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.996">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-A09" name="Apply RBAC with pre-defined policies added into groups or roles" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        All the users in an IAM group inherit the permissions assigned to the group. That way, you can
                        make changes for everyone in a group in just one place. As people move around in your company,
                        you can simply change what IAM group their IAM user belongs to. This method is known as Role
                        Based Access Control (RBAC).&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Remove a user from a group:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on the user name. All the groups the user belongs are there.&lt;/li&gt;
                        &lt;li&gt;Choose the group and &amp;quot;Remove&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a group and add user:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;New Group&amp;quot; and fill the information.&lt;/li&gt;
                        &lt;li&gt;Search and add the user.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.869">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR7" name="Configure diagnostics settings" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;There are some options that must be configured properly to configure diagnostics settings.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Checklist:&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ensure that a 'Diagnostics Setting' exists&lt;/li&gt;&lt;li&gt;Ensure Diagnostic Setting captures appropriate categories&lt;/li&gt;&lt;li&gt;Ensure the storage container storing the activity logs is not publicly accessible&lt;/li&gt;&lt;li&gt;Ensure the storage account containing the container with activity logs is encrypted with BYOK (Use Your Own Key)&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Click on the resource that has a diagnostic status of disabled&lt;ol&gt;&lt;li&gt;Select Add Diagnostic Settings&lt;ol&gt;&lt;li&gt;Enter a Diagnostic setting name&lt;ol&gt;&lt;li&gt;Select the appropriate log, metric, and destination. (This may be Log Analytics/Storage account or Event Hub)&lt;/li&gt;&lt;li&gt;Click save&lt;/li&gt;&lt;li&gt;Repeat these step for all resources as needed.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Azure Monitor&lt;ol&gt;&lt;li&gt;Click Activity log&lt;ol&gt;&lt;li&gt;Click on Diagnostic settings&lt;ol&gt;&lt;li&gt;Click on Edit Settings for the diagnostic settings entry&lt;ol&gt;&lt;li&gt;Ensure that the following categories are checked: Administrative, Alert, Policy, and Security&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Search for Storage Accounts to access Storage account blade&lt;ol&gt;&lt;li&gt;Click on the storage account name&lt;ol&gt;&lt;li&gt;In Section Blob Service click Containers. It will list all the containers in next blade&lt;ol&gt;&lt;li&gt;Look for a record with container named as insight-operational-logs. Click ... from right most column to open Context menu&lt;ol&gt;&lt;li&gt;Click Access Policy from Context Menu and set Public Access Level to Private (no anonymous access)&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;In Section SETTINGS click Encryption. It will show Storage service encryption configuration pane.&lt;ol&gt;&lt;li&gt;Check Use your own key which will expand Encryption Key Settings&lt;ol&gt;&lt;li&gt;Use option Enter key URI or Select from Key Vault to set up encryption with your own key&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.1.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.1.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.1.2" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.1.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.1.3" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.1.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="5.1.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="LT-4" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="LT-5" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Follow the paths detailed in the description and ensure that the values are set correctly.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.870">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A12" name="Configure password expiration" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        &lt;div&gt;
                        Configure the password expiration to force after a determinate time, the password code shall be
                        changed for the users.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Configure password management to match security criteria. This value is configurable
                        using the Set-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for Windows
                        PowerShell. With the following command as the example:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        Set-MsolPasswordPolicy -ValidityPeriod 60 -NotificationDays 14&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;This command updates the tenant so that all users passwords expire after 60
                        days. The users receive notification 14 days prior to that expiry.
                        &lt;/blockquote&gt;
                        &lt;div&gt;
                        &lt;div&gt;
                        More information:&amp;nbsp;
                        &lt;a
                        href="https://docs.microsoft.com/en-us/powershell/module/msonline/set-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                        MS Azure&lt;/a&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Password policies and restrictions in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-passwords-policy"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Check that the password expiration has got the correct values. Therefore, we can obtain the
                            values using the Get-MsolPasswordPolicy cmdlet from the Azure Active Directory Module for
                            Windows PowerShell. With the following command:
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            PS C:\&amp;gt; Get-MsolPasswordPolicy -DomainName contoso.com
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;More information:
                            &lt;a
                            href="https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolpasswordpolicy?view=azureadps-1.0"&gt;Doc
                            MS Azure&lt;/a&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A11" name="Configure roles for the Cloud Service" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Define and create the roles for the Azure Cloud Service. For each role, define the permissions and also configure how that role runs. When you launch an Azure instance, you shall specify a role for the instance as a launch parameter. Applications that run on the Cloud instance use the role's credentials when they access Azure resources. This role's permissions determine what the application is allowed to do.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Configure an Azure cloud service from Solution Explorer in Visual Studio.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the roles for the Cloud Service are well assigned.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR1" name="Connect computers without Internet access by using the Log Analytics gateway in Azure Monitor" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Connect computers without Internet access by using the Log Analytics gateway in Azure Monitor 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  The Log Analytics gateway is an HTTP forward proxy that supports HTTP tunneling using the HTTP CONNECT command. This gateway sends data to Azure Automation and a Log Analytics workspace in Azure Monitor on behalf of the computers that cannot directly connect to the Internet. 
&lt;/div&gt; 
&lt;div&gt;
  Some IT security policies don't allow Internet connection for network computers. These unconnected computers could be point of sale (POS) devices or servers supporting IT services, for example. To connect these devices to Azure Automation or a Log Analytics workspace so you can manage and monitor them, configure them to communicate directly with the Log Analytics gateway. The Log Analytics gateway can receive configuration information and forward data on their behalf. If the computers are configured with the Log Analytics agent to directly connect to a Log Analytics workspace, the computers instead communicate with the Log Analytics gateway. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Supported encryption protocols 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The Log Analytics gateway supports only Transport Layer Security (TLS) 1.0, 1.1, and 1.2. It doesn't support Secure Sockets Layer (SSL). To ensure the security of data in transit to Log Analytics, configure the gateway to use at least TLS 1.2. Older versions of TLS or SSL are vulnerable. Although they currently allow backward compatibility, avoid using them. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Download the Log Analytics gateway 
&lt;/div&gt; 
&lt;div&gt;
  - Get the latest version of the Log Analytics gateway Setup file from either Microsoft Download Center (Download Link) or the Azure portal. 
&lt;/div&gt; 
&lt;div&gt;
  - Install Log Analytics gateway using setup wizard or the command line 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For more information please follow Reference URL. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Connect computers without Internet access by using the Log Analytics gateway in Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/platform/gateway"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that you are using Log Analytics gateway to send data to a Log Analytics workspace in Azure Monitor on behalf of the computers that cannot directly connect to the Internet preventing need of computers to be connected to Internet.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR5" name="Create activity log alerts by using Azure Monitor" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create activity log alerts by using Azure Monitor 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Activity log alerts are the alerts that get activated when a new activity log event occurs that matches the conditions specified in the alert. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  These alerts are for Azure resources and can be created by using an Azure Resource Manager template. They also can be created, updated, or deleted in the Azure portal. Typically, you create activity log alerts to receive notifications when specific changes occur to resources in your Azure subscription. Alerts are often scoped to particular resource groups or resources. For example, you might want to be notified when any virtual machine in the sample resource group myProductionResourceGroup is deleted. Or, you might want to get notified if any new roles are assigned to a user in your subscription. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Create with the Azure portal 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Use the following procedure. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. In the Azure portal, select Monitor &amp;gt; Alerts. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Select New alert rule in the upper-left corner of the Alerts window. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The Create rule window appears. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. Under Define alert condition, provide the following information, and select Done: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Alert target: To view and select the target for the new alert, use Filter by subscription / Filter by resource type. Select the resource or resource group from the list displayed. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: You can select only Azure Resource Manager tracked resource, resource group, or an entire subscription for an activity log signal. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Under Target criteria, select Add criteria. All available signals for the target are displayed, which includes those from various categories of Activity Log. The category name is appended to the Monitor Service name. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Select the signal from the list displayed of various operations possible for the type Activity Log. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can select the log history time-line and the corresponding alert logic for this target signal: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: In order to have a high quality and effective rules, Azure asks to add at least one more condition to rules with the signal "All Administrative". As a part of the definition of the alert you must fill one of the drop downs: "Event level", "Status" or "Initiated by" and by that the rule will be more specific. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - History time: Events available for the selected operation can be plotted over the last 6, 12, or 24 hours or over the last week. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Alert logic: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -- Event level: The severity level of the event: Verbose, Informational, Warning, Error, or Critical. 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -- Status: The status of the event: Started, Failed, or Succeeded. 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -- Event initiated by: Also known as the caller. The email address or Azure Active Directory identifier of the user who performed the operation. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. Under Define alert details, provide the following details: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Alert rule name: The name for the new alert rule. 
&lt;/div&gt; 
&lt;div&gt;
  - Description: The description for the new alert rule. 
&lt;/div&gt; 
&lt;div&gt;
  - Save alert to resource group: Select the resource group where you want to save this new rule. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  5. Under Action group, from the drop-down menu, specify the action group that you want to assign to this new alert rule. Or, create a new action group and assign it to the new rule. To create a new group, select + New group. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  6. To enable the rules after you create them, select Yes for the Enable rule upon creation option. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  7. Select Create alert rule. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The new alert rule for the activity log is created, and a confirmation message appears in the upper-right corner of the window. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can enable, disable, edit, or delete a rule. Learn more about how to manage activity log rules. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  A simple analogy for understanding conditions on which alert rules can be created in an activity log is to explore or filter events via the activity log in the Azure portal. In the Azure Monitor - Activity log screen, you can filter or find the necessary event and then create an alert by using the Add activity log alert button. Then follow steps 4 through 7 as previously shown. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Create, view, and manage activity log alerts by using Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/platform/alerts-activity-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  View and manage in the Azure portal 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. In the Azure portal, select Monitor &amp;gt; Alerts. Select Manage alert rules in the upper-left corner of the window. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The list of available rules appears. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Search for the activity log rule to modify. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can use the available filters, Subscription, Resource group, Resource, Signal type, or Status, to find the activity rule that you want to edit. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: You can edit only Description, Target criteria, and Action groups. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. Select the rule, and double-click to edit the rule options. Make the required changes, and then select Save. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. You can enable, disable, or delete a rule. Select the appropriate option at the top of the window after you select the rule as described in step 2. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A03" name="Create Individual Accounts for the administrator users" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user's account. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Add New User&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Fill the required information and click &amp;quot;Create&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Add new users to Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/add-users-azure-active-directory"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got a user account assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A10" name="Create mechanisms to ensure the principle of least privilege is applied" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create the mechanisms to review periodically the group and user permissions to ensure the least privilege for the user accounts. Granting least privilege ensures that users only have the permissions required to complete their jobs rather than additional privileges that are not required. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Following this model ensures that, should an account be compromised, the blast radius of damage is limited&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Allocate privileges via groups or roles via the recommendation in "Use RBAC with pre-defined policies added into groups or roles".&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the principle of least privilege is achieved in the assignation of roles and
                            groups to the users.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR6" name="Enable and use Traffic Analytics" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable and use Traffic Analytics 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Traffic Analytics is a cloud-based solution that provides visibility into user and application activity in cloud networks. Traffic analytics analyzes Network Watcher network security group (NSG) flow logs to provide insights into traffic flow in your Azure cloud. With traffic analytics, you can: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Visualize network activity across your Azure subscriptions and identify hot spots. 
&lt;/div&gt; 
&lt;div&gt;
  - Identify security threats to, and secure your network, with information such as open-ports, applications attempting Internet access, and virtual machines (VM) connecting to rogue networks. 
&lt;/div&gt; 
&lt;div&gt;
  - Understand traffic flow patterns across Azure regions and the Internet to optimize your network deployment for performance and capacity. 
&lt;/div&gt; 
&lt;div&gt;
  - Pinpoint network misconfigurations leading to failed connections in your network. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Enable Network Watcher 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To analyze traffic, you need to have an existing network watcher, or enable a network watcher in each region that you have NSGs that you want to analyze traffic for. Traffic analytics can be enabled for NSGs hosted in any of the supported regions. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Select a network security group 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Before enabling NSG flow logging, you must have a network security group to log flows for. If you don't have a network security group, see Create a network security group to create one. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  In Azure portal, go to Network watcher, and then select NSG flow logs. Select the network security group that you want to enable an NSG flow log for. 
&lt;/div&gt; 
&lt;div&gt;
  If you try to enable traffic analytics for an NSG that is hosted in any region other than the supported regions, you receive a "Not found" error. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Enable flow log settings 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Before enabling flow log settings, you must complete the following tasks: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Register the Azure Insights provider, if it's not already registered for your subscription: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Register-AzResourceProvider -ProviderNamespace Microsoft.Insights 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  If you don't already have an Azure Storage account to store NSG flow logs in, you must create a storage account. You can create a storage account with the command that follows. Before running the command, replace &amp;lt;replace-with-your-unique-storage-account-name&amp;gt; with a name that is unique across all Azure locations, between 3-24 characters in length, using only numbers and lower-case letters. You can also change the resource group name, if necessary. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  New-AzStorageAccount ` 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -Location westcentralus ` 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -Name &amp;lt;replace-with-your-unique-storage-account-name&amp;gt; ` 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -ResourceGroupName myResourceGroup ` 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -SkuName Standard_LRS ` 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; -Kind StorageV2 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Select the following options: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. Select On for Status 
&lt;/div&gt; 
&lt;div&gt;
  2. Select Version 2 for Flow Logs version. Version 2 contains flow-session statistics (Bytes and Packets) 
&lt;/div&gt; 
&lt;div&gt;
  3. Select an existing storage account to store the flow logs in. Ensure that your storage does not have "Data Lake Storage Gen2 Hierarchical Namespace Enabled" set to true. 
&lt;/div&gt; 
&lt;div&gt;
  4. Set Retention to the number of days you want to store data for. If you want to store the data forever, set the value to 0. You incur Azure Storage fees for the storage account. 
&lt;/div&gt; 
&lt;div&gt;
  5. Select On for Traffic Analytics Status. 
&lt;/div&gt; 
&lt;div&gt;
  6. Select processing interval. Based on your choice, flow logs will be collected from storage account and processed by Traffic Analytics. You can choose processing interval of every 1 hour or every 10 mins. 
&lt;/div&gt; 
&lt;div&gt;
  7. Select an existing Log Analytics (OMS) Workspace, or select Create New Workspace to create a new one. A Log Analytics workspace is used by Traffic Analytics to store the aggregated and indexed data that is then used to generate the analytics. If you select an existing workspace, it must exist in one of the supported regions and have been upgraded to the new query language. If you do not wish to upgrade an existing workspace, or do not have a workspace in a supported region, create a new one. For more information about query languages, see Azure Log Analytics upgrade to new log search. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: The log analytics workspace hosting the traffic analytics solution and the NSGs do not have to be in the same region. For example, you may have traffic analytics in a workspace in the West Europe region, while you may have NSGs in East US and West US. Multiple NSGs can be configured in the same workspace. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  8. Select Save. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Repeat the previous steps for any other NSGs for which you wish to enable traffic analytics for. Data from flow logs is sent to the workspace, so ensure that the local laws and regulations in your country/region permit data storage in the region where the workspace exists. If you have set different processing intervals for different NSGs, data will be collected at different intervals. For example: You can choose to enable processing interval of 10 mins for critical VNETs and 1 hour for noncritical VNETs. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can also configure traffic analytics using the Set-AzNetworkWatcherConfigFlowLog PowerShell cmdlet in Azure PowerShell. Run Get-Module -ListAvailable Az to find your installed version. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Traffic Analytics" url="https://docs.microsoft.com/en-us/azure/network-watcher/traffic-analytics"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  View traffic analytics 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To view Traffic Analytics, search for Network Watcher in the portal search bar. Once inside Network Watcher, to explore traffic analytics and its capabilities, select Traffic Analytics from the left menu. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The dashboard may take up to 30 minutes to appear the first time because Traffic Analytics must first aggregate enough data for it to derive meaningful insights, before it can generate any reports. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L01" name="Enable diagnostic logs auditing for Microsoft Azure" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Diagnostic Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself, for example, getting a secret from a Key Vault. Currently, 32 Azure resources support Diagnostic Logging (See the references section for a complete list), including Network Security Groups, Load Balancers, Key Vault, AD, Logic Apps and CosmosDB. The content of these logs varies by resource type. For example, Windows event system logs are a category of diagnostics logs for VMs, and blob, table, and queue logs are categories of diagnostics logs for storage accounts.&lt;/p&gt;&lt;p&gt;A number of back-end services were not configured to log and store Diagnostic Logs for certain activities or for a sufficient length. It is crucial that logging systems are correctly configured to log all relevant activities and retain those logs for a sufficient length of time. By default, Diagnostic Logs are not enabled. Given that the mean time to detection in an enterprise is 240 days, a minimum retention period of two years is recommended.&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The specific steps for configuring resources within the Azure console vary depending on resource, but typically the steps are:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="LT-4" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="LT-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.871">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A04" name="Enable MFA for Administrator &amp; Co Administrator accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp;amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into "Users and groups" &amp;gt; "All users".&lt;/li&gt; 
  &lt;li&gt;Select "Multi-Factor Authentication".&lt;/li&gt; 
  &lt;li&gt;Choose all the Service Administrator &amp;amp; Co Administrator accounts and enable MFA.&amp;nbsp;&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to require two-step verification for a user or group" url="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-get-started-user-states"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-USER-MFA" name="Enable per-user MFA" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable per-user MFA 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Multi-factor authentication (MFA) is a process where a user is prompted during a sign-in event for additional forms of identification. This prompt could be to enter a code on their cellphone or to provide a fingerprint scan. When you require a second form of authentication, security is increased as this additional factor isn't something that's easy for an attacker to obtain or duplicate. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  To secure user sign-in events in Azure AD, you can require multi-factor authentication (MFA). Enabling Azure AD Multi-Factor Authentication using Conditional Access policies is the recommended approach to protect users. Conditional Access is an Azure AD Premium P1 or P2 feature that lets you apply rules to require MFA as needed in certain scenarios 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For Azure AD free tenants without Conditional Access, you can use security defaults to protect users. Users are prompted for MFA as needed, but you can't define your own rules to control the behavior. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Features and licenses for Azure AD Multi-Factor Authentication" url="https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-mfa-licensing"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  1. Log into the Azure portal as an owner. 
&lt;/div&gt; 
&lt;div&gt;
  2. Select Azure Active Directory. 
&lt;/div&gt; 
&lt;div&gt;
  3. Go into "Users and groups" &amp;gt; "All users". 
&lt;/div&gt; 
&lt;div&gt;
  4. Select "Multi-Factor Authentication". 
&lt;/div&gt; 
&lt;div&gt;
  5. Ensure your users have the MFA flag enabled. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR04" name="Ensure regular automated back-ups to Azure Monitor and related resources" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Ensure regular automated back-ups to Azure Monitor and related resources 
&lt;/div&gt; 
&lt;div&gt;
  &amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Create and apply back-up mechanisms to Azure Monitor and any related resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Use Azure Resource Manager to export the Azure Monitor and related resources in a JavaScript Object Notation (JSON) template which can be used as backup for Azure Monitor and related configurations. Use Azure Automation to run the backup scripts automatically. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For more information please see Reference URLs. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="An introduction to Azure Automation" url="https://docs.microsoft.com/en-us/azure/automation/automation-intro"/>
            <reference name="Azure security baseline for Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/security-baseline"/>
            <reference name="Resource Manager template samples for Log Analytics workspaces in Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/samples/resource-manager-workspace"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that regular back-ups are performed.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references>
              <reference name="Azure security baseline for Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/security-baseline"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L05" name="Export the Audit Logs to a storage account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Export the information of Audit Logs to a storage account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to "Monitor" and then to "Activity Logs".&lt;/li&gt; 
  &lt;li&gt;Push the button "Export".&lt;/li&gt; 
  &lt;li&gt;Select "All Regions".&lt;/li&gt; 
  &lt;li&gt;Select "Export to a storage account" and select your account.&lt;/li&gt; 
  &lt;li&gt;Select the "Retention (days)" as minimum 90 days.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N09" name="Isolate Azure instances into different VNets" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud instance can use the VNet security configuration when they access Azure resources.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can configure an Azure cloud service from Solution Explorer in Visual Studio. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a virtual network with multiple subnets" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the Azure instances are into different VNets.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-APPROVED-LOCATIONS" name="Manage Azure resources from only approved locations" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Manage Azure resources from only approved locations 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Use Conditional Access Named Locations to allow access from only specific logical groupings of IP address ranges or countries/regions. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Prerequisites 
&lt;/div&gt; 
&lt;div&gt;
  You need: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - An Azure AD tenant. Sign up for a free trial. 
&lt;/div&gt; 
&lt;div&gt;
  - A user, who is a global administrator for the tenant. 
&lt;/div&gt; 
&lt;div&gt;
  - An IP range that is established and credible in your organization. The IP range needs to be in Classless Interdomain Routing (CIDR) format. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Configure named locations 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. Sign in to the Azure portal. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. In the left pane, select Azure Active Directory, then select Conditional Access from the Security section. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. On the Conditional Access page, select Named locations and select New location. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. Fill out the form on the new page. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - In the Name box, type a name for your named location. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - In the IP ranges box, type the IP range in CIDR format. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Click Create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Quickstart: Configure named locations in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/quickstart-configure-named-locations"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that you have configured named locations in your Azure environment.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A07" name="Recertify user access" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Do regular reviews of accounts on the system and verify that it doesn't exist stoled or fake
                        accounts. With this process is ensured that there are not compromised accounts by former
                        employees or by attackers.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist:&lt;/li&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Delete&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Assign a user or group to an enterprise app in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-coreapps-assign-user-azure-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR3" name="Use Azure Private Link to securely connect networks to Azure Monitor" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Azure Private Link to securely connect networks to Azure Monitor 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Azure Private Link allows you to securely link Azure PaaS services to your virtual network using private endpoints. For many services, you just set up an endpoint per resource. However, Azure Monitor is a constellation of different interconnected services that work together to monitor your workloads. As a result, Microsoft Azure has built a resource called an Azure Monitor Private Link Scope (AMPLS) that allows you to define the boundaries of your monitoring network and connect to your virtual network.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Example connection 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Start by creating an Azure Monitor Private Link Scope resource. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. Go to Create a resource in the Azure portal and search for Azure Monitor Private Link Scope. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Click create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. Pick a Subscription and Resource Group. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. Give the AMPLS a name. It is best to use a name that is clear what purpose and security boundary the Scope will be used for so that someone won't accidentally break network security boundaries. For example, "AppServerProdTelem". 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  5. Click Review + Create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  6. Let the validation pass, and then click Create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Connect Azure Monitor resources 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can connect your AMPLS first to private endpoints and then to Azure Monitor resources or vice versa, but the connection process goes faster if you start with your Azure Monitor resources. Here's how we connect Azure Monitor Log Analytics workspaces and Application Insights components to an AMPLS 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. In your Azure Monitor Private Link scope, click on Azure Monitor Resources in the left-hand menu. Click the Add button. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Add the workspace or component. Clicking the Add button brings up a dialog where you can select Azure Monitor resources. You can browse through your subscriptions and resource groups, or you can type in their name to filter down to them. Select the workspace or component and click Apply to add them to your scope. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: Deleting Azure Monitor resources requires that you first disconnect them from any AMPLS objects they are connected to. It's not possible to delete resources connected to an AMPLS. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Connect to a private endpoint 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Now that you have resources connected to your AMPLS, create a private endpoint to connect our network. You can do this task in the Azure portal Private Link center, or inside your Azure Monitor Private Link Scope, as done in this example. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. In your scope resource, click on Private Endpoint connections in the left-hand resource menu. Click on Private Endpoint to start the endpoint create process. You can also approve connections that were started in the Private Link center here by selecting them and clicking Approve. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Pick the subscription, resource group, and name of the endpoint, and the region it should live in. The region needs to be the same region as the virtual network you will connect it to. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. Click Next: Resource. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. In the Resource screen, 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  a. Pick the Subscription that contains your Azure Monitor Private Scope resource. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  b. For resource type, choose Microsoft.insights/privateLinkScopes. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  c. From the resource drop-down, choose your Private Link scope you created earlier. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  d. Click Next: Configuration &amp;gt;. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  5. On the configuration pane, 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  a. Choose the virtual network and subnet that you want to connect to your Azure Monitor resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  b. Choose Yes for Integrate with private DNS zone, and let it automatically create a new Private DNS Zone. The actual DNS zones may be different from what is shown in the screenshot below. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Note: If you choose No and prefer to manage DNS records manually, first complete setting up your Private Link - including this Private Endpoint and the AMPLS configuration. Then, configure your DNS according to the instructions in Azure Private Endpoint DNS configuration. Make sure not to create empty records as preparation for your Private Link setup. The DNS records you create can override existing settings and impact your connectivity with Azure Monitor. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  c. Click Review + create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  d. Let validation pass. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  e. Click Create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You have now created a new private endpoint that is connected to this Azure Monitor Private Link scope. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Use Azure Private Link to securely connect networks to Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/platform/private-link-security"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that you use Azure Private Link with Azure Monitor.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MONITOR2" name="Use VNet Service tags for Azure Monitor" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use VNet Service tags for Azure Monitor 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  You can simplify network security rules by using VNet Service tags. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Use Virtual Network Service tags to define network access controls on network security groups configured for your Azure Monitor resources. Service tags can be used in place of specific IP addresses when creating security rules 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  To allow traffic to reach Azure Monitor, use the "AzureMonitor" service tags to allow inbound and outbound traffic through Network Security Groups. To allow availability monitoring test traffic to reach Azure Monitor, use the "ApplicationInsightsAvailability" service tag to all inbound traffic through network security groups. Microsoft manages the address prefixes encompassed by the service tag and automatically updates the service tag as addresses change. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure security baseline for Azure Monitor" url="https://docs.microsoft.com/en-us/azure/azure-monitor/security-baseline"/>
            <reference name="Virtual network service tags" url="https://docs.microsoft.com/en-us/azure/virtual-network/service-tags-overview"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that your network security rules are simplified by using VNet Service tags.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:23.872">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="authentication" name="Authentication" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;div&gt;Attackers could gain unauthorized access to the administrator account due to a lack of configuration of the account and its security mechanisms, making it possible to modify credentials and add/remove user accounts.
                                &lt;/div&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZ-W04">
                  <countermeasures>
                    <countermeasure ref="AZ-A04" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON02">
                  <countermeasures>
                    <countermeasure ref="AZ-A03" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A03" mitigation="50"/>
                <countermeasure ref="AZ-A04" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AZURE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the user account due to the lack of configuration of the account, for example, the security question to reset the password is configured incorrectly.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-IDENTITY-03">
                  <countermeasures>
                    <countermeasure ref="AZ-A07" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON03">
                  <countermeasures>
                    <countermeasure ref="AZURE-USER-MFA" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A07" mitigation="50"/>
                <countermeasure ref="AZURE-USER-MFA" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="authorization" name="Authorization" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-ACCESS-01">
                  <countermeasures>
                    <countermeasure ref="AZ-A09" mitigation="25"/>
                    <countermeasure ref="AZ-A10" mitigation="25"/>
                    <countermeasure ref="AZ-A11" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-EXPIRATION-DATE">
                  <countermeasures>
                    <countermeasure ref="AZ-A12" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A09" mitigation="25"/>
                <countermeasure ref="AZ-A10" mitigation="25"/>
                <countermeasure ref="AZ-A11" mitigation="25"/>
                <countermeasure ref="AZ-A12" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="general" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZURE-MONITOR7" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-MONITOR7" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AZURE-DATA-DELETED-EASY" name="Data is intentionally or accidentally deleted" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Data can be deleted intentionally or accidentally and cannot be recovered. Attackers could rely on the lack of backup and recovery mechanisms.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-MONITOR-BACKUPS">
                  <countermeasures>
                    <countermeasure ref="AZURE-MONITOR04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-MONITOR04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="logging-and-monitoring" name="Logging and Monitoring" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="OWASP A10:2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.&lt;br /&gt;
 Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="AZ-L01" mitigation="25"/>
                    <countermeasure ref="AZ-L05" mitigation="25"/>
                    <countermeasure ref="AZURE-MONITOR5" mitigation="25"/>
                    <countermeasure ref="AZURE-MONITOR6" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-L01" mitigation="25"/>
                <countermeasure ref="AZ-L05" mitigation="25"/>
                <countermeasure ref="AZURE-MONITOR5" mitigation="25"/>
                <countermeasure ref="AZURE-MONITOR6" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="networking" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-UNAUTHORISED-CONNECTION" name="Attackers perform unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could perform unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZURE-APPROVED-LOCATIONS" mitigation="25"/>
                    <countermeasure ref="AZURE-MONITOR3" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NON-IDENTIFY">
                  <countermeasures>
                    <countermeasure ref="AZURE-MONITOR2" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-VNET01">
                  <countermeasures>
                    <countermeasure ref="AZ-N09" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N09" mitigation="25"/>
                <countermeasure ref="AZURE-APPROVED-LOCATIONS" mitigation="25"/>
                <countermeasure ref="AZURE-MONITOR2" mitigation="25"/>
                <countermeasure ref="AZURE-MONITOR3" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="DATA-EXPOSED-CHANNEL" name="The data is exposed through the transmission channel" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can obtain the data through the transmitted channel because this does not have the security measures in place to protect the data&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="DATA-TRANSMIT-CLEAR">
                  <countermeasures>
                    <countermeasure ref="AZURE-MONITOR1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-MONITOR1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="c12f07c0-1d0a-422e-8cba-2f69fed0e5fa" diagramComponentId="8ddcfdb6-99fe-4cf2-b551-9555f40f3790" ref="7faadf87-7625-4f0d-a3b2-9b1d7b38b679" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="f6b674e5-489a-4507-a356-83a5ffda20a0" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.401">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.400">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.312">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.313">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.313">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.313">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="e0efb7aa-6063-45f6-8bc6-c91954501720" diagramComponentId="974ff134-f9ee-48de-9401-008e593db10e" ref="ab16a963-406e-4eb7-9467-2230ff1ac0af" name="Azure Firewall" desc="" library="Microsoft-Azure" parentComponentRef="8e8c4c80-77f1-47f0-b475-881a7095a777" componentDefinitionRef="microsoft-azure-firewall">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-UNSECURE-CREDENTIALS" name="Credentials are not securely stored" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials used to access the resources are not securely stored and can be accessed by unauthorized personnel.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON02" name="Excessive use of administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator accounts are used for all actions, not only for administrative actions. This
                        is because these users have not got a personal or a user account to do the daily actions.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when there is a bad usage of the root
                            account.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NON-IDENTIFY" name="Insufficient resource identification" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources are not registered in the safety net systems, and/or additional unidentified resources exist. As such, additional weaknesses might be introduced.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MON03" name="Lack of 2FA" state="0" impact="100" issueId="" issueLink="">
          <desc>Logging into the console without using Multi-factor Authentication (MFA) and without being detected. The connection without MFA must be audited and monitored, the correct security group must be informed and the connection must be validated.&amp;nbsp;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Alerts&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is any rule to notify when someone tries to login into the
                            console without MFA.&lt;/li&gt;
                            &lt;li&gt;Check if these rules are enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZ-W04" name="Misconfigured Authentication Method for Administrator Accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The authentication method &amp;quot;Multi-factor Authentication&amp;quot; for the Administrator accounts is not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-IDENTITY-03" name="Misconfigured User Account" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Key security settings such as resetting the password and other password controls are not
                        configured.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Password reset&amp;quot; &amp;gt; &amp;quot;Authentication Method&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that the security confirmation measures and the security criteria are well
                            filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-ACCESS-01" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        The credentials for groups and roles are not correctly configured and there are user accounts with more privileges than necessary.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles to achieve principle of
                            least privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the roles for the Cloud Service are well assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;div&gt;
                            &lt;/div&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VNET01" name="Networks for Azure resources are not properly segmented. Without proper segmentation, when attackers gain access to one resource, any other resources in the same VNet are compromised" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            Identify the resources and the Microsoft Azure instances.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the resources are in the correct VNet.
                            &lt;/div&gt;
                            &lt;div&gt;
                            Check that the Microsoft Azure instances&amp;nbsp;are into different VNets.
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.361">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.360">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-MONITOR-BACKUPS" name="There is not a recover or backup mechanism" state="0" impact="100" issueId="" issueLink="">
          <desc>There are not any processes or mechanisms to regularly save the data to another place in order to have an older version of the data to restore in case of loss. Consequently the data cannot be easily recovered or they cannot be recovered at all.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.360">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.360">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-A09" name="Apply RBAC with pre-defined policies added into groups or roles" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &amp;nbsp;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        All the users in an IAM group inherit the permissions assigned to the group. That way, you can
                        make changes for everyone in a group in just one place. As people move around in your company,
                        you can simply change what IAM group their IAM user belongs to. This method is known as Role
                        Based Access Control (RBAC).&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Remove a user from a group:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click on the user name. All the groups the user belongs are there.&lt;/li&gt;
                        &lt;li&gt;Choose the group and &amp;quot;Remove&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Create a group and add user:&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ol&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;New Group&amp;quot; and fill the information.&lt;/li&gt;
                        &lt;li&gt;Search and add the user.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got assigned the correct groups.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each group has got assigned the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.243">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A11" name="Configure roles for the Cloud Service" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Define and create the roles for the Azure Cloud Service. For each role, define the permissions and also configure how that role runs. When you launch an Azure instance, you shall specify a role for the instance as a launch parameter. Applications that run on the Cloud instance use the role's credentials when they access Azure resources. This role's permissions determine what the application is allowed to do.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Configure an Azure cloud service from Solution Explorer in Visual Studio.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the roles for the Cloud Service are well assigned.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.244">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-FIREWALL1" name="Create backup for Azure Firewall and related configurations" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create backup for Azure Firewall and related configurations&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Use Azure Resource Manager to export the Azure Firewall and related resources in a JavaScript Object Notation (JSON) template which can be used as backup for Azure Firewall and related configurations. You can also export Azure Firewall configuration using Export template feature of Azure Firewall from Azure portal. Use Azure Automation to run the backup scripts automatically.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Export template from a resource group&lt;/p&gt; 
&lt;p&gt;To export one or more resources from a resource group:&lt;/p&gt; 
&lt;p&gt;1. Select the resource group that contains the resources you want to export.&lt;/p&gt; 
&lt;p&gt;2. Select one or more resources by selecting the checkboxes. To select all, select the checkbox on the left of Name. The Export template menu item only becomes enabled after you have selected at least one resource.&lt;/p&gt; 
&lt;p&gt;3. Select Export template.&lt;/p&gt; 
&lt;p&gt;4. The exported template is displayed, and is available to download and deploy.&lt;/p&gt; 
&lt;p&gt;Include parameters is selected by default. When selected, all template parameters will be included when the template is generated. If you'd like to author your own parameters, toggle this checkbox to not include them.&lt;/p&gt; 
&lt;p&gt;Export template from a resource&lt;/p&gt; 
&lt;p&gt;To export one resource:&lt;/p&gt; 
&lt;p&gt;1. Select the resource group containing the resource you want to export.&lt;/p&gt; 
&lt;p&gt;2. Select the resource that you want to export to open the resource.&lt;/p&gt; 
&lt;p&gt;3. For that resource, select Export template in the left pane.&lt;/p&gt; 
&lt;p&gt;4. The exported template is displayed, and is available to download and deploy. The template only contains the single resource. Include parameters is selected by default. When selected, all template parameters will be included when the template is generated. If you'd like to author your own parameters, toggle this checkbox to not include them.&lt;/p&gt; 
&lt;p&gt;Export template before deployment&lt;/p&gt; 
&lt;p&gt;1. Select the Azure service you want to deploy.&lt;/p&gt; 
&lt;p&gt;2. Fill in the values for the new service.&lt;/p&gt; 
&lt;p&gt;3. After passing validation, but before starting the deployment, select Download a template for automation.&lt;/p&gt; 
&lt;p&gt;4. The template is displayed and is available for download and deploy.&lt;/p&gt; 
&lt;p&gt;Export template after deployment&lt;/p&gt; 
&lt;p&gt;You can export the template that was used to deploy existing resources. The template you get is exactly the one that was used for deployment.&lt;/p&gt; 
&lt;p&gt;1. Select the resource group you want to export.&lt;/p&gt; 
&lt;p&gt;2. Select the link under Deployments.&lt;/p&gt; 
&lt;p&gt;3. Select one of the deployments from the deployment history.&lt;/p&gt; 
&lt;p&gt;4. Select Template. The template used for this deployment is displayed, and is available for download.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Quickstart: Deploy Azure Firewall with Availability Zones - ARM template" url="https://docs.microsoft.com/en-us/azure/firewall/deploy-template"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure ability to periodically perform restoration using Azure Resource Manager template backed files.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A03" name="Create Individual Accounts for the administrator users" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create an individual account for the administrator users and with this new accounts By creating individual Azure users for people accessing your account, you can give each Azure user a unique set of security credentials.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for the administrative actions and for giving or revoke credentials to the user's account. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Select &amp;quot;Add New User&amp;quot;.&lt;/li&gt; 
  &lt;li&gt;Fill the required information and click &amp;quot;Create&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Add new users to Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/add-users-azure-active-directory"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got a user account assigned.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A10" name="Create mechanisms to ensure the principle of least privilege is applied" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Create the mechanisms to review periodically the group and user permissions to ensure the least privilege for the user accounts. Granting least privilege ensures that users only have the permissions required to complete their jobs rather than additional privileges that are not required. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Following this model ensures that, should an account be compromised, the blast radius of damage is limited&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Allocate privileges via groups or roles via the recommendation in "Use RBAC with pre-defined policies added into groups or roles".&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a group and add members in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-groups-create-azure-portal"/>
            <reference name="MS Azure - Use Role-Based Access Control to manage access to your Azure subscription resources" url="https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-configure"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the principle of least privilege is achieved in the assignation of roles and
                            groups to the users.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-ENABLE-ALERTS" name="Enable alerts for anomalous activities" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable alerts for anomalous activities 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Azure Security Center generates detailed security alerts and recommendations. You can view them in the portal or through programmatic tools. You may also need to export some or all of this information for tracking with other monitoring tools in your environment. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Continuous export lets you fully customize what will be exported, and where it will go. For example, you can configure it so that: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  All high severity alerts are sent to an Azure Event Hub 
&lt;/div&gt; 
&lt;div&gt;
  All medium or higher severity findings from vulnerability assessment scans of your SQL servers are sent to a specific Log Analytics workspace 
&lt;/div&gt; 
&lt;div&gt;
  Specific recommendations are delivered to an Event Hub or Log Analytics workspace whenever they're generated 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Set up a continuous export 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can configure continuous export from the Security Center pages in Azure portal, via the Security Center REST API, or at scale using the supplied Azure Policy templates. Select the appropriate tab below for details of each. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Configure continuous export from the Security Center pages in Azure portal 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The steps below are necessary whether you're setting up a continuous export to Log Analytics workspace or Azure Event Hubs. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. From Security Center's sidebar, select Pricing &amp;amp; settings. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. Select the specific subscription for which you want to configure the data export. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. From the sidebar of the settings page for that subscription, select Continuous Export. 
&lt;/div&gt; 
&lt;div&gt;
  Here you see the export options. There's a tab for each available export target. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. Select the data type you'd like to export and choose from the filters on each type (for example, export only high severity alerts). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  5. Optionally, if your selection includes one of these four recommendations, you can include the vulnerability assessment findings together with them: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Vulnerability Assessment findings on your SQL databases should be remediated 
&lt;/div&gt; 
&lt;div&gt;
  - Vulnerability Assessment findings on your SQL servers on machines should be remediated (Preview) 
&lt;/div&gt; 
&lt;div&gt;
  - Vulnerabilities in Azure Container Registry images should be remediated (powered by Qualys) 
&lt;/div&gt; 
&lt;div&gt;
  - Vulnerabilities in your virtual machines should be remediated 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To include the findings with these recommendations, enable the include security findings option. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  6. From the "Export target" area, choose where you'd like the data saved. Data can be saved in a target on a different subscription (for example on a Central Event Hub instance or a central Log Analytics workspace). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  7. Select Save. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Continuously export Security Center data" url="https://docs.microsoft.com/en-us/azure/security-center/continuous-export?tabs=azure-portal"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  View exported alerts and recommendations in Azure Monitor 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  In some cases, you may choose to view the exported Security Alerts and/or recommendations in Azure Monitor. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Azure Monitor provides a unified alerting experience for a variety of Azure alerts including Diagnostic Log, Metric alerts, and custom alerts based on Log Analytics workspace queries. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To view alerts and recommendations from Security Center in Azure Monitor, configure an Alert rule based on Log Analytics queries (Log Alert): 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. From Azure Monitor's Alerts page, select New alert rule. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. In the create rule page, configure your new rule (in the same way you'd configure a log alert rule in Azure Monitor): 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - For Resource, select the Log Analytics workspace to which you exported security alerts and recommendations. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - For Condition, select Custom log search. In the page that appears, configure the query, look-back period, and frequency period. In the search query, you can type SecurityAlert or SecurityRecommendation to query the data types that Security Center continuously exports to as you enable the Continuous export to Log Analytics feature. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Optionally, configure the Action Group that you'd like to trigger. Action groups can trigger email sending, ITSM tickets, WebHooks, and more. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You'll now see new Azure Security Center alerts or recommendations (depending on your configured continuous export rules and the condition you defined in your Azure Monitor alert rule) in Azure Monitor alerts, with automatic triggering of an action group (if provided). 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-AD11" name="Enable Azure AD Identity Protection" issueId="" issueLink="" platform="" cost="1" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Azure Active Directory Identity Protection&lt;/p&gt;

  &lt;p&gt;Rationale:&lt;br /&gt;
Identity Protection is a tool that allows organizations to accomplish three key tasks:&lt;/p&gt;

  &lt;p&gt;- Automate the detection and remediation of identity-based risks.&lt;br /&gt;
- Investigate risks using data in the portal.&lt;br /&gt;
- Export risk detection data to third-party utilities for further analysis.&lt;/p&gt;

  &lt;p&gt;Identity Protection uses the learnings Microsoft has acquired from their position in organizations with Azure AD, the consumer space with Microsoft Accounts, and in gaming with Xbox to protect your users. Microsoft analyses 6.5 trillion signals per day to identify and protect customers from threats.&lt;/p&gt;

  &lt;p&gt;The signals generated by and fed to Identity Protection, can be further fed into tools like Conditional Access to make access decisions, or fed back to a security information and event management (SIEM) tool for further investigation based on your organization's enforced policies.&lt;/p&gt;

  &lt;p&gt;Remediation:&lt;br /&gt;
Using this feature requires an Azure AD Premium P2 license.&lt;/p&gt;

  &lt;p&gt;Then in the Azure portal under Azure Active Directory &gt; Security &gt; Identity Protection you can:&lt;/p&gt;

  &lt;p&gt;- Configure the MFA registration policy&lt;br /&gt;
- Configure risk policies&lt;br /&gt;
- Configure notifications&lt;/p&gt;

  &lt;p&gt;For more information please see Reference URLs.&lt;/p&gt;

  &lt;p&gt;Impact:&lt;br /&gt;
None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure Active Directory Identity Protection notifications" url="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-notifications"/>
            <reference name="How To: Configure and enable risk policies" url="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies"/>
            <reference name="How To: Configure the Azure AD Multi-Factor Authentication registration policy" url="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-mfa-policy"/>
            <reference name="What is Identity Protection?" url="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that Azure Active Directory Identity Protection is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-SENTINEL" name="Enable Azure Sentinel" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Azure Sentinel&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Microsoft Azure Sentinel is a scalable, cloud-native, security information event management (SIEM) and security orchestration automated response (SOAR) solution. Azure Sentinel delivers intelligent security analytics and threat intelligence across the enterprise, providing a single solution for alert detection, threat visibility, proactive hunting, and threat response.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enable Azure Sentinel&lt;/p&gt; 
&lt;p&gt;1. Sign in to the Azure portal. Make sure that the subscription in which Azure Sentinel is created is selected.&lt;/p&gt; 
&lt;p&gt;2. Search for and select Azure Sentinel.&lt;/p&gt; 
&lt;p&gt;3. Select Add.&lt;/p&gt; 
&lt;p&gt;4. Select the workspace you want to use or create a new one. You can run Azure Sentinel on more than one workspace, but the data is isolated to a single workspace.&lt;/p&gt; 
&lt;p&gt;Note: Default workspaces created by Azure Security Center will not appear in the list; you cannot install Azure Sentinel on them.&lt;/p&gt; 
&lt;p&gt;Important: Once deployed on a workspace, Azure Sentinel does not currently support the moving of that workspace to other resource groups or subscriptions.&lt;/p&gt; 
&lt;p&gt;If you have already moved the workspace, disable all active rules under Analytics and re-enable them after five minutes. This should be effective in most cases, though, to reiterate, it is unsupported and undertaken at your own risk.&lt;/p&gt; 
&lt;p&gt;5. Select Add Azure Sentinel.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Quickstart: On-board Azure Sentinel" url="https://docs.microsoft.com/en-us/azure/sentinel/quickstart-onboard"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure Azure Sentinel is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L01" name="Enable diagnostic logs auditing for Microsoft Azure" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Diagnostic Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself, for example, getting a secret from a Key Vault. Currently, 32 Azure resources support Diagnostic Logging (See the references section for a complete list), including Network Security Groups, Load Balancers, Key Vault, AD, Logic Apps and CosmosDB. The content of these logs varies by resource type. For example, Windows event system logs are a category of diagnostics logs for VMs, and blob, table, and queue logs are categories of diagnostics logs for storage accounts.&lt;/p&gt;&lt;p&gt;A number of back-end services were not configured to log and store Diagnostic Logs for certain activities or for a sufficient length. It is crucial that logging systems are correctly configured to log all relevant activities and retain those logs for a sufficient length of time. By default, Diagnostic Logs are not enabled. Given that the mean time to detection in an enterprise is 240 days, a minimum retention period of two years is recommended.&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The specific steps for configuring resources within the Azure console vary depending on resource, but typically the steps are:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard"/>
            <standard ref="5.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="LT-4" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="LT-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Go to the resource&lt;/li&gt;&lt;li&gt;Click on Diagnostic settings&lt;/li&gt;&lt;li&gt;In the blade that appears, click "Add diagnostic setting"&lt;/li&gt;&lt;li&gt;Configure the diagnostic settings&lt;/li&gt;&lt;li&gt;Click on Save&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A04" name="Enable MFA for Administrator &amp; Co Administrator accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable multi-factor authentication (MFA) device enhances the security of the login process for the Administrator accounts. With MFA, users have a device that generates a unique authentication code (a one-time password, or OTP) and users must provide both their normal credentials (like their username and password) and the OTP. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The MFA device can either be a special piece of hardware, or it can be a virtual device. The recommendation for the Service Administrator &amp;amp; Co Administrator accounts is to use MFA to increase the level of security of the login process. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Azure Active Directory.&lt;/li&gt; 
  &lt;li&gt;Go into "Users and groups" &amp;gt; "All users".&lt;/li&gt; 
  &lt;li&gt;Select "Multi-Factor Authentication".&lt;/li&gt; 
  &lt;li&gt;Choose all the Service Administrator &amp;amp; Co Administrator accounts and enable MFA.&amp;nbsp;&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to require two-step verification for a user or group" url="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-get-started-user-states"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Multi-Factor Authentication&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check all Administrator accounts have got the MFA flag enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-USER-MFA" name="Enable per-user MFA" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Enable per-user MFA 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Multi-factor authentication (MFA) is a process where a user is prompted during a sign-in event for additional forms of identification. This prompt could be to enter a code on their cellphone or to provide a fingerprint scan. When you require a second form of authentication, security is increased as this additional factor isn't something that's easy for an attacker to obtain or duplicate. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  To secure user sign-in events in Azure AD, you can require multi-factor authentication (MFA). Enabling Azure AD Multi-Factor Authentication using Conditional Access policies is the recommended approach to protect users. Conditional Access is an Azure AD Premium P1 or P2 feature that lets you apply rules to require MFA as needed in certain scenarios 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For Azure AD free tenants without Conditional Access, you can use security defaults to protect users. Users are prompted for MFA as needed, but you can't define your own rules to control the behavior. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Features and licenses for Azure AD Multi-Factor Authentication" url="https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-mfa-licensing"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  1. Log into the Azure portal as an owner. 
&lt;/div&gt; 
&lt;div&gt;
  2. Select Azure Active Directory. 
&lt;/div&gt; 
&lt;div&gt;
  3. Go into "Users and groups" &amp;gt; "All users". 
&lt;/div&gt; 
&lt;div&gt;
  4. Select "Multi-Factor Authentication". 
&lt;/div&gt; 
&lt;div&gt;
  5. Ensure your users have the MFA flag enabled. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-AD10" name="Enable Privileged Identity Management for tracking admin role use" issueId="" issueLink="" platform="" cost="1" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Privileged Identity Management for tracking admin role use&lt;/p&gt;

  &lt;p&gt;Rationale:&lt;br /&gt;
Use Privileged Identity Management (PIM) to manage, control, and monitor access within your Azure Active Directory (Azure AD) organization. With PIM you can provide as-needed and just-in-time access to Azure resources, Azure AD resources, and other Microsoft online services like Microsoft 365 or Microsoft Intune.&lt;/p&gt;

  &lt;p&gt;Remediation:&lt;br /&gt;
Licensing requirements&lt;/p&gt;

  &lt;p&gt;To use Privileged Identity Management, your directory must have one of the following paid or trial licenses.&lt;/p&gt;

  &lt;p&gt;- Azure AD Premium P2&lt;br /&gt;
- Enterprise Mobility + Security (EMS) E5&lt;/p&gt;

  &lt;p&gt;When a user who is active in a privileged role in an Azure AD organization with a Premium P2 license goes to Roles and administrators in Azure AD and selects a role (or even just visits Privileged Identity Management):&lt;/p&gt;

  &lt;p&gt;- Azure automatically enables PIM for the organization&lt;br /&gt;
- Their experience is now that they can either assign a "regular" role assignment or an eligible role assignment&lt;br /&gt;
When PIM is enabled it doesn't have any other effect on your organization that you need to worry about. It gives you additional assignment options such as active vs eligible with start and end time. PIM also enables you to define scope for role assignments using Administrative Units and custom roles. If you are a Global Administrator or Privileged Role Administrator, you might start getting a few additional emails like the PIM weekly digest. You might also see MS-PIM service principal in the audit log related to role assignment. This is an expected change that should have no effect on your workflow.&lt;/p&gt;

  &lt;p&gt;For more PIM configurations please see Reference URL.&lt;/p&gt;

  &lt;p&gt;Impact:&lt;br /&gt;
None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Start using Privileged Identity Management" url="https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-getting-started"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that Privileged Identity Management is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-FIREWALL3" name="Enable Threat intelligence-based filtering to alert and deny traffic" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Threat intelligence-based filtering to alert and deny traffic&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Threat intelligence-based filtering can be enabled for your firewall to alert and deny traffic from/to known malicious IP addresses and domains. The IP addresses and domains are sourced from the Microsoft Threat Intelligence feed.&lt;br&gt; By default, threat intelligence-based filtering is enabled in alert mode. Azure recommends to enable it in alert and deny mode.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; By default, threat intelligence-based filtering is enabled in alert mode. You cannot turn off this feature or change the mode until the portal interface becomes available in your region.&lt;br&gt; You can then change the mode by selecting "Alert and deny" in the Azure portal interface.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; none&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure Firewall threat intelligence-based filtering" url="https://docs.microsoft.com/en-us/azure/firewall/threat-intel"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Testing&lt;/p&gt;

  &lt;p&gt;- Outbound testing - Outbound traffic alerts should be a rare occurrence, as it means that your environment has been compromised. To help test outbound alerts are working, a test FQDN has been created that triggers an alert. Use testmaliciousdomain.eastus.cloudapp.azure.com for your outbound tests.&lt;/p&gt;

  &lt;p&gt;- Inbound testing - You can expect to see alerts on incoming traffic if DNAT rules are configured on the firewall. This is true even if only specific sources are allowed on the DNAT rule and traffic is otherwise denied. Azure Firewall doesn't alert on all known port scanners; only on scanners that are known to also engage in malicious activity.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-L05" name="Export the Audit Logs to a storage account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Export the information of Audit Logs to a storage account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to "Monitor" and then to "Activity Logs".&lt;/li&gt; 
  &lt;li&gt;Push the button "Export".&lt;/li&gt; 
  &lt;li&gt;Select "All Regions".&lt;/li&gt; 
  &lt;li&gt;Select "Export to a storage account" and select your account.&lt;/li&gt; 
  &lt;li&gt;Select the "Retention (days)" as minimum 90 days.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Enable diagnostics logging for web apps in Azure App Service" url="https://docs.microsoft.com/en-us/azure/app-service-web/web-sites-enable-diagnostic-log"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-CRED-SCAN" name="Implement Credential Scanner to identify credentials within code" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Implement Credential Scanner to identify credentials within code&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Credential Scanner (aka CredScan) is a tool developed and maintained by Microsoft to identify credential leaks such as those in source code and configuration files. Some of the commonly found types of credentials are default passwords, SQL connection strings and Certificates with private keys.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Prerequisites:&lt;br&gt; 1. You are using the Azure DevOps Build system.&lt;br&gt; 2. The Microsoft Security Code Analysis Extension installed in your account.&lt;br&gt; Setup:&lt;br&gt; 1. Open your team project from your Azure DevOps Account.&lt;br&gt; 2. Navigate to the Build tab under Build and Release&lt;br&gt; 3. Select the Build Definition into which you wish to add the CredScan build task.&lt;br&gt; - New - Click New and follow the steps detailed to create a new Build Definition.&lt;br&gt; - Edit - Select the Build Definition. On the subsequent page, click Edit to begin editing the Build Definition.&lt;br&gt; 4. Click + to navigate to the Add Tasks pane.&lt;br&gt; 5. Find the CredScan build task either from the list or using the search box and then click Add.&lt;br&gt; 6. The Run CredScan build task should now be a part of the Build Definition.&lt;/p&gt; 
&lt;p&gt;Customizing the CredScan Build Task:&lt;br&gt; 1. Click the task Run CredScan to see the different options available within.&lt;br&gt; 2. Available options include&lt;br&gt; Output Format - TSV/ CSV/ SARIF/ PREfast&lt;br&gt; Tool Version (Recommended: Latest)&lt;br&gt; Scan Folder - The folder in your repository to scan&lt;br&gt; Searchers File Type - Options to locate the searchers file used for scanning.&lt;br&gt; Suppressions File - A JSON file can be used for suppressing issues in the output log (more details in the Resources section).&lt;br&gt; (New) Verbose Output - self explanatory&lt;br&gt; Batch Size - The number of concurrent threads used to run Credential Scanners in parallel. Defaults to 20 (Value must be in the range of 1 to 2147483647).&lt;br&gt; (New) Match Timeout - The amount of time to spend attempting a searcher match before abandoning the check.&lt;br&gt; (New) File Scan Read Buffer Size - Buffer size while reading content in bytes. (Defaults to 524288)&lt;br&gt; (New) Maximum File Scan Read Bytes - Maximum number of bytes to read from a given file during content analysis. (Defaults to 104857600)&lt;br&gt; Run this task (under Control Options) - Specifies when the task should run. Choose "Custom conditions" to specify more complex conditions.&lt;/p&gt; 
&lt;p&gt;*Version - Build task version within Azure DevOps. Not frequently used.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Getting started with Credential Scanner (CredScan)" url="https://secdevtools.azurewebsites.net/helpcredscan.html"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that Credential Scanner is implemented&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-SUBSCRIPTIONS" name="Implement isolation using separate subscriptions" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Implement isolation using separate subscriptions&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; You can create an additional subscription for your Enterprise Agreement (EA), Microsoft Customer Agreement or Microsoft Partner Agreement billing account in the Azure portal. You may want an additional subscription to avoid hitting subscription limits, to create separate environments for security, or to isolate data for compliance reasons.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Create a subscription in the Azure portal&lt;/p&gt; 
&lt;p&gt;1. Sign in to the Azure portal.&lt;/p&gt; 
&lt;p&gt;2. Search for Subscriptions.&lt;/p&gt; 
&lt;p&gt;3. Select Add.&lt;/p&gt; 
&lt;p&gt;4. If you have access to multiple billing accounts, select the billing account for which you want to create the subscription.&lt;/p&gt; 
&lt;p&gt;5. Fill the form and click Create.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Create an additional Azure subscription" url="https://docs.microsoft.com/en-us/azure/cost-management-billing/manage/create-subscription"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that you have implemented isolation through separate subscriptions.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N09" name="Isolate Azure instances into different VNets" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Specify a VNet for the Azure instance as a launch parameter. Applications that run on the Cloud instance can use the VNet security configuration when they access Azure resources.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  You can configure an Azure cloud service from Solution Explorer in Visual Studio. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Create a virtual network with multiple subnets" url="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-vnet-arm-pportal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the Azure instances are into different VNets.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-ADMIN-INV" name="Maintain an inventory of administrative accounts" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Maintain an inventory of administrative accounts&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Azure AD has built-in roles that must be explicitly assigned and are queryable. Use the Azure AD PowerShell module to perform ad hoc queries to discover accounts that are members of administrative groups.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; How to get a directory role in Azure AD with PowerShell&lt;/p&gt; 
&lt;p&gt;Get-AzureADDirectoryRole [-Filter ] [-InformationAction ] [-InformationVariable ] []&lt;/p&gt; 
&lt;p&gt;Get-AzureADDirectoryRole -ObjectId  [-InformationAction ] [-InformationVariable ] []&lt;/p&gt; 
&lt;p&gt;How to get members of a directory role in Azure AD with PowerShell&lt;/p&gt; 
&lt;p&gt;Get-AzureADDirectoryRoleMember -ObjectId  [-InformationAction ] [-InformationVariable ] []&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Get-AzureADDirectoryRole" url="https://docs.microsoft.com/en-us/powershell/module/azuread/get-azureaddirectoryrole?view=azureadps-2.0"/>
            <reference name="Get-AzureADDirectoryRoleMember" url="https://docs.microsoft.com/en-us/powershell/module/azuread/get-azureaddirectoryrolemember?view=azureadps-2.0"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that you maintain an inventory of administrative accounts.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-APPROVED-LOCATIONS" name="Manage Azure resources from only approved locations" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Manage Azure resources from only approved locations 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Use Conditional Access Named Locations to allow access from only specific logical groupings of IP address ranges or countries/regions. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Prerequisites 
&lt;/div&gt; 
&lt;div&gt;
  You need: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - An Azure AD tenant. Sign up for a free trial. 
&lt;/div&gt; 
&lt;div&gt;
  - A user, who is a global administrator for the tenant. 
&lt;/div&gt; 
&lt;div&gt;
  - An IP range that is established and credible in your organization. The IP range needs to be in Classless Interdomain Routing (CIDR) format. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Configure named locations 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  1. Sign in to the Azure portal. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  2. In the left pane, select Azure Active Directory, then select Conditional Access from the Security section. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  3. On the Conditional Access page, select Named locations and select New location. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  4. Fill out the form on the new page. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - In the Name box, type a name for your named location. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - In the IP ranges box, type the IP range in CIDR format. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - Click Create. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Quickstart: Configure named locations in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/quickstart-configure-named-locations"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Ensure that you have configured named locations in your Azure environment.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-FIREWALL4" name="Minimize complexity of network security rules for Azure Firewall" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Minimize complexity of network security rules for Azure Firewall&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; In an Azure Firewall, a service tag represents a group of IP address prefixes to help minimize complexity for security rule creation.&lt;/p&gt; 
&lt;p&gt;Azure Firewall service tags can be used in the network rules destination field and define network access controls on Azure Firewall. You can use service tags in place of specific IP addresses when creating security rules.&lt;/p&gt; 
&lt;p&gt;Additionally, customer-defined tags such as IP groups are also supported and can be used in a network rule or an application rule. FQDN tags in application rules are supported to allow the required outbound network traffic through your firewall.&lt;/p&gt; 
&lt;p&gt;Note that you cannot create your own service tag, nor specify which IP addresses are included within a tag. Microsoft manages the address prefixes encompassed by the service tag, and automatically updates the service tag as addresses change.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Service Tags&lt;/p&gt; 
&lt;p&gt;By default, service tags reflect the ranges for the entire cloud. Some service tags also allow more granular control by restricting the corresponding IP ranges to a specified region. For example, the service tag Storage represents Azure Storage for the entire cloud, but Storage.WestUS narrows the range to only the storage IP address ranges from the WestUS region.&lt;/p&gt; 
&lt;p&gt;By specifying the service tag name in the appropriate source or destination field of a rule, you can allow or deny the traffic for the corresponding service.&lt;/p&gt; 
&lt;p&gt;How to create an IP Group - Azure portal&lt;/p&gt; 
&lt;p&gt;To create an IP Group by using the Azure portal:&lt;/p&gt; 
&lt;p&gt;1. On the Azure portal home page, select Create a resource.&lt;/p&gt; 
&lt;p&gt;2. In the search box, enter IP Groups, and then select IP Groups.&lt;/p&gt; 
&lt;p&gt;3. Select Create.&lt;/p&gt; 
&lt;p&gt;4. Select your subscription.&lt;/p&gt; 
&lt;p&gt;5. Select a resource group or create a new one.&lt;/p&gt; 
&lt;p&gt;6. Enter a unique name for you IP Group, and then select a region.&lt;/p&gt; 
&lt;p&gt;7. Select Next: IP addresses.&lt;/p&gt; 
&lt;p&gt;8. Type an IP address, multiple IP addresses, or IP address ranges.&lt;/p&gt; 
&lt;p&gt;There are two ways to enter IP addresses:&lt;/p&gt; 
&lt;p&gt;- You can manually enter them&lt;br&gt; - You can import them from a file&lt;/p&gt; 
&lt;p&gt;To import from a file, select Import from a file. You may either drag your file to the box or select Browse for files. If necessary, you can review and edit your uploaded IP addresses.&lt;/p&gt; 
&lt;p&gt;When you type an IP address, the portal validates it to check for overlapping, duplicates, and formatting issues.&lt;/p&gt; 
&lt;p&gt;9. When finished, select Review + Create.&lt;/p&gt; 
&lt;p&gt;10. Select Create.&lt;/p&gt; 
&lt;p&gt;FQDN Tags&lt;/p&gt; 
&lt;p&gt;An FQDN tag represents a group of fully qualified domain names (FQDNs) associated with well known Microsoft services. You can use an FQDN tag in application rules to allow the required outbound network traffic through your firewall.&lt;/p&gt; 
&lt;p&gt;For example, to manually allow Windows Update network traffic through your firewall, you need to create multiple application rules per the Microsoft documentation. Using FQDN tags, you can create an application rule, include the Windows Updates tag, and now network traffic to Microsoft Windows Update endpoints can flow through your firewall.&lt;/p&gt; 
&lt;p&gt;You cannot create your own FQDN tags, nor can you specify which FQDNs are included within a tag. Microsoft manages the FQDNs encompassed by the FQDN tag, and updates the tag as FQDNs change.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure Firewall service tags" url="https://docs.microsoft.com/en-us/azure/firewall/service-tags"/>
            <reference name="FQDN tags overview" url="https://docs.microsoft.com/en-us/azure/firewall/fqdn-tags"/>
            <reference name="IP Groups in Azure Firewall" url="https://docs.microsoft.com/en-us/azure/firewall/ip-groups"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that your network security rules are simplified.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-A07" name="Recertify user access" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Do regular reviews of accounts on the system and verify that it doesn't exist stoled or fake
                        accounts. With this process is ensured that there are not compromised accounts by former
                        employees or by attackers.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                        &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist:&lt;/li&gt;
                        &lt;li&gt;Select the user.&lt;/li&gt;
                        &lt;li&gt;Click &amp;quot;Delete&amp;quot;.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Assign a user or group to an enterprise app in Azure Active Directory" url="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-coreapps-assign-user-azure-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log in to the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Azure Active Directory.&lt;/li&gt;
                            &lt;li&gt;Go into &amp;quot;Users and groups&amp;quot; &amp;gt; &amp;quot;All users&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that each user has got an assigned account.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-REPOS-GIT" name="Securely store configuration of Azure resources" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Securely store configuration of Azure resources&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; If using custom Azure Policy definitions, use Azure DevOps or Azure Repos to securely store and manage your code.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Use version control to save your work and coordinate code changes across your team. Even if you are just a single developer, version control helps you stay organized as you fix bugs and develop new features. Version control keeps a history of your development so that you can review and even rollback to any version of your code with ease.&lt;/p&gt; 
&lt;p&gt;Version control workflow&lt;/p&gt; 
&lt;p&gt;Version control has a general workflow that most developers use when writing code and sharing it with the team.&lt;/p&gt; 
&lt;p&gt;These steps are:&lt;br&gt; 1. Get a local copy of code if they do not have one yet.&lt;br&gt; 2. Make changes to code to fix bugs or add new features.&lt;br&gt; 3. Once the code is ready, make it available for review by your team.&lt;br&gt; 4. Once the code is reviewed, merge it into the team's shared codebase.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure Repos Git tutorial" url="https://docs.microsoft.com/en-us/azure/devops/repos/git/gitworkflow?view=azure-devops"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that the configuration of Azure resources is securely stored.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-FIREWALL2" name="Use approved time synchronization sources for Azure Firewall" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use approved time synchronization sources for Azure Firewall&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, virtual machines running Windows connect to time.windows.com over UDP port 123 for time synchronization. Customers need to create a network rule to allow this access, or for a time server that you use in their environment.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Create a network rule to allow access for NTP server.&lt;/p&gt; 
&lt;p&gt;None:&lt;br&gt; Impact&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Use Azure Firewall to protect Window Virtual Desktop deployments" url="https://docs.microsoft.com/en-us/azure/firewall/protect-windows-virtual-desktop"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that you are using approved time synchronization sources.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-SSO" name="Use Azure Active Directory single sign-on (SSO)" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Azure Active Directory single sign-on (SSO)&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Single sign-on means a user does not have to sign in to every application they use. The user logs in once and that credential is used for other apps too.&lt;/p&gt; 
&lt;p&gt;Single sign-on provides many benefits over traditional sign-on methods.&lt;/p&gt; 
&lt;p&gt;- With single sign-on, users sign in once with one account to access domain-joined devices, company resources, software as a service (SaaS) applications, and web applications. After signing in, the user can launch applications from the Office 365 portal or My Apps. Administrators can centralize user account management, and automatically add or remove user access to applications based on group membership.&lt;/p&gt; 
&lt;p&gt;- Without single sign-on, users must remember application-specific passwords and sign in to each application. IT staff needs to create and update user accounts for each application such as Microsoft 365, Box, and Salesforce. Users need to remember their passwords, plus spend the time to sign in to each application.&lt;/p&gt; 
&lt;p&gt;Azure Active Directory (Azure AD) has a gallery that contains thousands of pre-integrated applications. Many of the applications your organization uses are probably already in the gallery.&lt;/p&gt; 
&lt;p&gt;After an application is added to your Azure AD tenant, you can:&lt;/p&gt; 
&lt;p&gt;- Configure properties for the app.&lt;br&gt; - Manage user access to the app with a Conditional Access policy.&lt;br&gt; - Configure single sign-on so users can sign in to the app with their Azure AD credentials.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Add an app to your Azure AD tenant&lt;/p&gt; 
&lt;p&gt;To add an application to your Azure AD tenant:&lt;/p&gt; 
&lt;p&gt;1. In the Azure portal, on the left navigation panel, select Azure Active Directory.&lt;/p&gt; 
&lt;p&gt;2. In the Azure Active Directory pane, select Enterprise applications. The All applications pane opens and displays a random sample of the applications in your Azure AD tenant.&lt;/p&gt; 
&lt;p&gt;3. In the Enterprise applications pane, select New application. Select New application to add a gallery app to your tenant&lt;/p&gt; 
&lt;p&gt;4. Switch to the new gallery preview experience: In the banner at the top of the Add an application page, select the link that says Click here to try out the new and improved app gallery.&lt;/p&gt; 
&lt;p&gt;5. The Browse Azure AD Gallery (Preview) pane opens and displays tiles for cloud platforms, on-premises applications, and featured applications. Applications listed in the Featured applications section have icons indicating whether they support federated single sign-on (SSO) and provisioning.&lt;/p&gt; 
&lt;p&gt;6. You can browse the gallery for the application you want to add, or search for the application by entering its name in the search box. Then select the application from the results.&lt;/p&gt; 
&lt;p&gt;7. The next step depends on the way the developer of the application implemented single sign-on (SSO). Single sign-on can be implemented by app developers in four ways. The four ways are SAML, OpenID Connect, Password, and Linked. When you add an app, you can choose to filter and see only apps using a particular SSO implementation as shown in the screenshot. For example, a popular standard to implement SSO is called Security Assertion Markup Language (SAML). Another standard that is popular is called OpenId Connect (OIDC). The way you configure SSO with these standards is different so take note of the type of SSO that is implemented by the app that you are adding.&lt;/p&gt; 
&lt;p&gt;- If the developer of the app used the OIDC standard for SSO then select Sign Up. A setup page appears. Next, go to the quickstart on setting up OIDC-based single sign-on. Screenshot shows adding an OIDC-based SSO app.&lt;/p&gt; 
&lt;p&gt;- If the developer of the app used the SAML standard for SSO then select Create. A getting started page appears with the options for configuring the application for your organization. In the form, you can edit the name of the application to match the needs of your organization. Next, go to the quickstart on setting up SAML-based single sign-on. Screenshot shows adding an SAML-based SSO app.&lt;/p&gt; 
&lt;p&gt;Important: There are some key differences between SAML-based and OIDC-based SSO implementations. With SAML-based apps you can add multiple instances of the same app. For example, GitHub1, GitHub2, etc.. For OIDC-based apps you can only add one instance of an app. If you have already added an OIDC-based app and try to add the same app again and provide consent twice, it will not be added again in the tenant.&lt;/p&gt; 
&lt;p&gt;If the application you are looking for is not in the gallery then you can select the link Create your own application and then under What are you looking to do with your application? choose Integrate any other application you do not find in the gallery. Microsoft has already worked with many application developers to pre-configure them to work with Azure AD. The pre-configured apps show up in the gallery. But if the app you want to add is not listed then you can create a new, generic, app and then configure it yourself or with the guidance of the developer that created it.&lt;/p&gt; 
&lt;p&gt;You have finished adding an application. &lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Quickstart: Add an application to your Azure Active Directory (Azure AD) tenant" url="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal"/>
            <reference name="What is single sign-on (SSO)?" url="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/what-is-single-sign-on"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that, wherever possible, you are using Azure Active Directory SSO instead of configuring individual stand-alone credentials per-service.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-RESOURCE-MANAGER" name="Use Azure Resource Manager" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Azure Resource Manager&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; The Resource Manager and classic deployment models represent two different ways of deploying and managing your Azure solutions. You work with them through two different API sets, and the deployed resources can contain important differences. The two models are not compatible with each other.&lt;br&gt; With Resource Manager, you can:&lt;br&gt; - Manage your infrastructure through declarative templates rather than scripts.&lt;br&gt; - Deploy, manage, and monitor all the resources for your solution as a group, rather than handling these resources individually.&lt;br&gt; - Redeploy your solution throughout the development life-cycle and have confidence your resources are deployed in a consistent state.&lt;br&gt; - Define the dependencies between resources so they are deployed in the correct order.&lt;br&gt; - Apply access control to all services because Azure role-based access control (Azure RBAC) is natively integrated into the management platform.&lt;br&gt; - Apply tags to resources to logically organize all the resources in your subscription.&lt;br&gt; - Clarify your organization's billing by viewing costs for a group of resources sharing the same tag.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To simplify the deployment and management of resources, Microsoft recommends that you use Resource Manager for all new resources. If possible, Microsoft recommends that you redeploy existing resources through Resource Manager.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Resource Manager and classic deployment models are not compatible with each other.&lt;br&gt; There are three scenarios to be aware of:&lt;br&gt; 1. Cloud Services does not support Resource Manager deployment model.&lt;br&gt; 2. Virtual machines, storage accounts, and virtual networks support both Resource Manager and classic deployment models.&lt;br&gt; 3. All other Azure services support Resource Manager.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Azure Resource Manager vs. classic deployment: Understand deployment models and the state of your resources" url="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/deployment-models"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that you are using Resource Manager for all new resources.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-MANAGED-ID" name="Use Managed Identities" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Managed Identities&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Use Managed Identities to provide Azure services with an automatically managed identity in Azure AD. Managed Identities allows you to authenticate to any service that supports Azure AD authentication to Azure Resource Manager and can be used with API/Azure Portal/CLI/PowerShell.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enable system-assigned managed identity during creation of a VM&lt;/p&gt; 
&lt;p&gt;To enable system-assigned managed identity on a VM during its creation, your account needs the Virtual Machine Contributor role assignment. No additional Azure AD directory role assignments are required.&lt;/p&gt; 
&lt;p&gt;- Under the Management tab in the Identity section, switch Managed service identity to On.&lt;/p&gt; 
&lt;p&gt;Enable system-assigned managed identity on an existing VM&lt;/p&gt; 
&lt;p&gt;To enable system-assigned managed identity on a VM that was originally provisioned without it, your account needs the Virtual Machine Contributor role assignment. No additional Azure AD directory role assignments are required.&lt;/p&gt; 
&lt;p&gt;1. Sign in to the Azure portal using an account associated with the Azure subscription that contains the VM.&lt;/p&gt; 
&lt;p&gt;2. Navigate to the desired Virtual Machine and select Identity.&lt;/p&gt; 
&lt;p&gt;3. Under System assigned, Status, select On and then click Save:&lt;/p&gt; 
&lt;p&gt;Assign a user-assigned managed identity to an existing VM&lt;/p&gt; 
&lt;p&gt;To assign a user-assigned identity to a VM, your account needs the Virtual Machine Contributor and Managed Identity Operator role assignments. No additional Azure AD directory role assignments are required.&lt;/p&gt; 
&lt;p&gt;1. Sign in to the Azure portal using an account associated with the Azure subscription that contains the VM.&lt;/p&gt; 
&lt;p&gt;2. Navigate to the desired VM and click Identity, User assigned and then +Add.&lt;/p&gt; 
&lt;p&gt;3. Click the user-assigned identity you want to add to the VM and then click Add.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure managed identities for Azure resources on a VM using the Azure portal" url="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/qs-configure-portal-windows-vm"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that you manage identities securely and automatically.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.246">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="AUTHENTICATION" name="Authentication" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;div&gt;Attackers could gain unauthorized access to the administrator account due to a lack of configuration of the account and its security mechanisms, making it possible to modify credentials and add/remove user accounts.
                                &lt;/div&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZ-W04">
                  <countermeasures>
                    <countermeasure ref="AZ-A04" mitigation="33"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON02">
                  <countermeasures>
                    <countermeasure ref="AZ-A03" mitigation="34"/>
                    <countermeasure ref="AZURE-SUBSCRIPTIONS" mitigation="33"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A03" mitigation="34"/>
                <countermeasure ref="AZ-A04" mitigation="33"/>
                <countermeasure ref="AZURE-SUBSCRIPTIONS" mitigation="33"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AZURE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to the lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the user account due to the lack of configuration of the account, for example, the security question to reset the password is configured incorrectly.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-IDENTITY-03">
                  <countermeasures>
                    <countermeasure ref="AZ-A07" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-MON03">
                  <countermeasures>
                    <countermeasure ref="AZURE-USER-MFA" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A07" mitigation="50"/>
                <countermeasure ref="AZURE-USER-MFA" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-ACCESS-01">
                  <countermeasures>
                    <countermeasure ref="AZ-A09" mitigation="15"/>
                    <countermeasure ref="AZ-A10" mitigation="15"/>
                    <countermeasure ref="AZ-A11" mitigation="14"/>
                    <countermeasure ref="AZURE-ADMIN-INV" mitigation="14"/>
                    <countermeasure ref="AZURE-MANAGED-ID" mitigation="14"/>
                    <countermeasure ref="AZURE-RESOURCE-MANAGER" mitigation="14"/>
                    <countermeasure ref="AZURE-SSO" mitigation="14"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-A09" mitigation="15"/>
                <countermeasure ref="AZ-A10" mitigation="15"/>
                <countermeasure ref="AZ-A11" mitigation="14"/>
                <countermeasure ref="AZURE-ADMIN-INV" mitigation="14"/>
                <countermeasure ref="AZURE-MANAGED-ID" mitigation="14"/>
                <countermeasure ref="AZURE-RESOURCE-MANAGER" mitigation="14"/>
                <countermeasure ref="AZURE-SSO" mitigation="14"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="34"/>
                    <countermeasure ref="AZURE-FIREWALL2" mitigation="33"/>
                    <countermeasure ref="AZURE-REPOS-GIT" mitigation="33"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="34"/>
                <countermeasure ref="AZURE-FIREWALL2" mitigation="33"/>
                <countermeasure ref="AZURE-REPOS-GIT" mitigation="33"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AZURE-DATA-DELETED-EASY" name="Data is intentionally or accidentally deleted" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Data can be deleted intentionally or accidentally and cannot be recovered. Attackers could rely on the lack of backup and recovery mechanisms.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-MONITOR-BACKUPS">
                  <countermeasures>
                    <countermeasure ref="AZURE-FIREWALL1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-FIREWALL1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to data storage" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;A data breach is a security violation in which sensitive, protected or confidential data is copied, transmitted, viewed, stolen or used by an individual unauthorized to do so. Sensitive data could be exposed due to a bad configuration in user permissions.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-UNSECURE-CREDENTIALS">
                  <countermeasures>
                    <countermeasure ref="AZURE-CRED-SCAN" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-CRED-SCAN" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="OWASP A10:2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.&lt;br /&gt;
 Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="AZ-ENABLE-ALERTS" mitigation="17"/>
                    <countermeasure ref="AZ-L01" mitigation="16"/>
                    <countermeasure ref="AZ-L05" mitigation="16"/>
                    <countermeasure ref="AZURE-AD10" mitigation="17"/>
                    <countermeasure ref="AZURE-AD11" mitigation="17"/>
                    <countermeasure ref="AZURE-SENTINEL" mitigation="17"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-ENABLE-ALERTS" mitigation="17"/>
                <countermeasure ref="AZ-L01" mitigation="16"/>
                <countermeasure ref="AZ-L05" mitigation="16"/>
                <countermeasure ref="AZURE-AD10" mitigation="17"/>
                <countermeasure ref="AZURE-AD11" mitigation="17"/>
                <countermeasure ref="AZURE-SENTINEL" mitigation="17"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-UNAUTHORISED-CONNECTION" name="Attackers perform unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could perform unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZURE-APPROVED-LOCATIONS" mitigation="25"/>
                    <countermeasure ref="AZURE-FIREWALL3" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NON-IDENTIFY">
                  <countermeasures>
                    <countermeasure ref="AZURE-FIREWALL4" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-VNET01">
                  <countermeasures>
                    <countermeasure ref="AZ-N09" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N09" mitigation="25"/>
                <countermeasure ref="AZURE-APPROVED-LOCATIONS" mitigation="25"/>
                <countermeasure ref="AZURE-FIREWALL3" mitigation="25"/>
                <countermeasure ref="AZURE-FIREWALL4" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="d1b4880f-a2d6-4d1e-ace7-b2f7f47050d2" diagramComponentId="c9a95a68-3a4d-41c2-b66f-a361bf9a0e5c" ref="1444bbe3-0af4-42b9-a595-64f2194d1e0e" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="b4e9b90e-29fd-48fe-8465-bc30c9d76c73" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.194">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.193">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.193">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.193">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.110">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.111">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.112">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.112">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:28.112">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="caa752cf-049f-4d0b-ae1d-04c9951e3169" diagramComponentId="b1a2e607-5dbb-4a23-82fc-51c65d0ce09f" ref="075b2b1f-7e94-4ee6-924b-f7d82d679ac7" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="b4e9b90e-29fd-48fe-8465-bc30c9d76c73" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.789">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.788">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.788">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.691">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.692">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.693">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="bd71f2e6-0067-4343-969d-94acbcb35ff0" diagramComponentId="6eafecd7-25da-45fa-b95a-a009fe5a9140" ref="e0f5844a-801c-46d3-aa23-74b832fd9aaf" name="Azure Virtual Machines" desc="" library="Microsoft-Azure" parentComponentRef="0f699b05-6196-4ae5-82fe-c7c2a76b9ac9" componentDefinitionRef="azure-virtual-machines">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover
                        them.ed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Go to &amp;quot;Monitor&amp;quot; and then to &amp;quot;Activity Logs&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Push the button &amp;quot;Export&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;All Regions&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Export to a storage account&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields are correctly filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-05" name="Communication is not allowed from/to Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>IP allocation of virtual machines, DNS resolution, and node monitorization is performed by a
                        Microsoft host node. It is necessary to allow the communication with this virtual IP to be able
                        to make the communication from/to the virtual machine of Azure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-16" name="Configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Weaknesses in this category are typically introduced during the
                        configuration of the software.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM01" name="Security policies exposing system resources" state="0" impact="100" issueId="" issueLink="">
          <desc>The security policies are not adequately configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-04" name="Unauthorized connection attempts on Azure resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to Azure resources is most likely to be receiving an
                        attack. To avoid this, access to the network must be as restricted as possible using Network
                        Access Control Lists for blacklisting.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-02" name="Unauthorized connection attempts on port 22" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 22 is most likely to be receiving an SSH attack. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-NET-03" name="Unauthorized connection attempts on port 3389" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to port 3389 is most likely to be receiving an RDP attack.
                        To avoid this, access to the network must be as restricted as possible, so that only the
                        necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Login&amp;nbsp;into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.020">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM02" name="Undetected changes in Virtual Machine configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>The changes in virtual machines configurations are not detected because the monitorization and
                        alerts of the security configuration are not configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.019">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AZURE-VM-NOT_LICENSE" name="Unlicensed Virtual Machines" state="0" impact="100" issueId="" issueLink="">
          <desc>Azure is a system formed by Microsoft machines, therefore, it is necessary that Microsoft
                        perform periodic verification of the licenses of the products.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:27.018">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZ-N06" name="Allow Key Management Service request" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow Key Management Service host server to handle the periodic request to ensure Microsoft
                        licensing. Set the limit outbound access to port 1688 (Service Request) in the Network Security
                        Groups to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Outbound security rules&amp;quot;: Allow port 1688 outbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic outbound
                            through the port 1688 is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.938">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N05" name="Allow Virtual IP of the Microsoft host node" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Allow inbound accesses in Network Security Groups from the IP address 168.63.129.16 to
                        communicate with the Azure Service. This IP belongs to Microsoft and acts as DHCP server, DNS
                        server and monitoring the host node hosting the Azure Virtual Machine.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;: Allow IP 168.63.129.16 inbound traffic.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the IP 168.63.129.16
                            inbound traffic is allowed.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V07" name="Apply common security best practices in virtual machine's configuration" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Only install organization-approved extensions on VMs.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Azure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.&lt;/p&gt;&lt;p&gt;Windows and Linux virtual machines should be kept updated to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Address a specific bug or flaw&lt;/li&gt;&lt;li&gt;Improve an OS or application's general stability&lt;/li&gt;&lt;li&gt;Fix a security vulnerability&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.&lt;/p&gt;&lt;p&gt;Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on Azure systems.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;If there are unapproved extensions, uninstall them.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Follow Microsoft Azure documentation to apply security patches and install endpoint protection from the security center. Alternatively, you can employ your own patch assessment and management tool or endpoint protection tool to periodically assess, report and install the required security patches for your OS.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM. az vm extension delete --resource-group &amp;lt;resourceGroupName&amp;gt; --vm-name &amp;lt;vmName&amp;gt; --name &amp;lt;extensionName&amp;gt;&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.4" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.5" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="ES-1" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-2" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="ES-3" supportedStandardRef="azure-security-benchmark"/>
            <standard ref="PV-7" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Extensions&lt;/li&gt;&lt;li&gt;Ensure that the listed extensions are approved for use.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Security Center - Recommendations&lt;ol&gt;&lt;li&gt;Ensure that there are no recommendations for Apply system updates&lt;/li&gt;&lt;li&gt;Ensure that there are no recommendations for Endpoint Protection not installed on Azure VMs&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Use the below command to list the extensions attached to a VM, and ensure the listed extensions are approved for use.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az vm extension list --vm-name &amp;lt;vmName&amp;gt; --resource-group &amp;lt;sourceGroupName&amp;gt; --query [*].name&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V03" name="Create alerts for Virtual Machines" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Create alerts based on specific performance metrics:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the average CPU usage exceeds a certain
                        threshold.&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the available free disk space drops below a
                        certain amount,&lt;/li&gt;
                        &lt;li&gt;Notify to the correspondent personnel when the security configuration of the Virtual
                        Machines changes.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then select
                        myVM in the resource list.&lt;/li&gt;
                        &lt;li&gt;Click Alert rules on the VM blade, then click Add metric alert across the top of the
                        alerts blade.&lt;/li&gt;
                        &lt;li&gt;Provide a Name for your alert, such as myAlertRule&lt;/li&gt;
                        &lt;li&gt;To trigger an alert when CPU percentage exceeds 1.0 for five minutes, leave all the
                        other defaults selected.&lt;/li&gt;
                        &lt;li&gt;Optionally, check the box for Email owners, contributors, and readers to send an email
                        notification. The default action is to present a notification in the portal.&lt;/li&gt;
                        &lt;li&gt;Click the OK button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Microsoft Azure Virtual Machine Monitoring with Azure Diagnostics Extension" url="https://azure.microsoft.com/en-us/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;In the Azure portal, click Resource Groups, select myResourceGroup, and then
                            select myVM in the resource list.&lt;/li&gt;
                            &lt;li&gt;Click Alert rules on the VM blade.&lt;/li&gt;
                            &lt;li&gt;Check there are some metric alerts and they are correctly configured and enabled.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V04" name="Disable Internet exposed UDP ports on network security groups" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable Internet exposed UDP ports on network security groups.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Disable direct UDP access to your Azure Virtual Machines from the Internet. After direct UDP access from the Internet is disabled, you have other options you can use to access UDP based services running on these virtual machines:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal"&gt;Point-to-site VPN&lt;/a&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal"&gt;Site-to-site VPN&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/expressroute/"&gt;ExpressRoute&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard"/>
            <standard ref="6.6" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="NS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Networking blade for the specific Virtual machine in Azure portal&lt;/li&gt;&lt;li&gt;Verify that the INBOUND PORT RULES does not have a rule for UDP such as&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;protocol = UDP,&lt;/li&gt;&lt;li&gt;Source = Any OR Internet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Using Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;List Network security groups with corresponding non-default Security rules:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az network nsg list --query [*].[name,securityRules]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure that none of the NSGs have security rule as below&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;"access" : "Allow"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"destinationPortRange" : "*" or "[port range containing 53, 123, 161, 389, 1900, or other configured UDP-based services]"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"direction" : "Inbound"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"protocol" : "UDP"&amp;nbsp;&lt;/p&gt;&lt;p&gt;"sourceAddressPrefix" : "*" or "0.0.0.0" or "&amp;lt;nw&amp;gt;/0" or "/0" or "internet" or "any"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V06" name="Encrypt disks with CMK" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Encrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Using CMK/BYOK will entail additional management of keys.&lt;/p&gt;&lt;p&gt;NOTE: You must have your key vault setup to utilize this.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Note: Disks must be detached from VMs to have encryption changed.&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;/li&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Click the X to detach the disk from the VM&lt;/li&gt;&lt;li&gt;Now search for Disks and locate the unattached disk&lt;/li&gt;&lt;li&gt;Click the disk then select Encryption&lt;/li&gt;&lt;li&gt;Change your encryption type, then select your encryption set&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;li&gt;Go back to the VM and re-attach the disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$KVRGname = 'MyKeyVaultResourceGroup'; $VMRGName = 'MyVirtualMachineResourceGroup'; $vmName = 'MySecureVM'; $KeyVaultName = 'MySecureVault'; $KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName $KVRGname; $diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId; Set-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $KeyVaultResourceId;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Managed disks are encrypted by default with Platform-managed keys. Using Customer-managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks which may lead to sensitive information disclosure and tampering.&lt;/p&gt;&lt;p&gt;If data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/delete&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az-disk-delete&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If data stored in the disk is important, To encrypt the disk refer azure documentation at:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable-customer-managed-keys-portal&lt;/li&gt;&lt;li&gt;https://docs.microsoft.com/en-us/rest/api/compute/disks/update#encryptionsettings&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NOTE: During encryption it is likely that a reboot will be required, it may take up to 15 minutes to complete the process. NOTE 2: This may differ for Linux Machines as you may need to set the -skipVmBackup parameter&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.2" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="7.3" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="DP-5" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Virtual machines&lt;ol&gt;&lt;li&gt;For each virtual machine, go to Settings&lt;/li&gt;&lt;li&gt;Click on Disks&lt;/li&gt;&lt;li&gt;Ensure that the OS disk and Data disks have encryption set to CMK.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Go to Disks&lt;ol&gt;&lt;li&gt;Click on Add Filter&lt;/li&gt;&lt;li&gt;In the filter field select Disk state&lt;/li&gt;&lt;li&gt;In the Value field select Unattached&lt;/li&gt;&lt;li&gt;Click Apply&lt;/li&gt;&lt;li&gt;For each disk listed ensure that Encryption type in the encryption blade is `Encryption at-rest with a customer-managed key'&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;$ResourceGroupName="yourResourceGroupName" $DiskName="yourDiskName" $disk=Get-AzDisk -ResourceGroupName $ResourceGroupName -DiskName $DiskName $disk.Encryption.Type&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;From Azure Command Line Interface 2.0&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ensure command below does not return any output.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;az disk list --query '[? diskstate == `Unattached`].{encryptionSettings: encryptionSettings, name: name}' -o json&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N01" name="Set Network Security Groups to be as restrictive as possible" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit all the traffic (ingress/egress) on the NSG in order to force the use of least privilege into the NSG.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Identify Azure resources for each NSG.&lt;/li&gt; 
  &lt;li&gt;Create a set of least privilege NSG for those resources.&lt;/li&gt; 
  &lt;li&gt;Place the resources in those security groups.&lt;/li&gt; 
  &lt;li&gt;Change the inbound/outbound security rules to fulfill the least privilege.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources has got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V01" name="Set up data collection" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Set up the Security Center Data Collection to create an Azure storage account to hold the
                        collected data.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                        subscription.&lt;/li&gt;
                        &lt;li&gt;For Data collection, select On.&lt;/li&gt;
                        &lt;li&gt;To create a storage account, select Choose a storage account. Then, select OK.&lt;/li&gt;
                        &lt;li&gt;On the Security Policy blade, select Save.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure auto provisioning for agents and extensions from Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, click Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Check that the Data collection is enabled and correctly configured.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V02" name="Set up the security policy" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Set up the security policies to define the items for which Security Center collects data and makes recommendations. Apply different security policies to different sets of Azure resources. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your subscription.&lt;/li&gt; 
  &lt;li&gt;Select Prevention policy.&lt;/li&gt; 
  &lt;li&gt;Turn on or turn off policy items that you want to apply to all Azure resources.&lt;/li&gt; 
  &lt;li&gt;When you're finished selecting your settings, select OK.&lt;/li&gt; 
  &lt;li&gt;On the Security policy blade, select Save.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt; 
&lt;div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - Set security policies in Azure Security Center" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-policies"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;On the Security Center dashboard, select Security policy, and then select your
                            subscription.&lt;/li&gt;
                            &lt;li&gt;Select Prevention policy.&lt;/li&gt;
                            &lt;li&gt;Check that the required policy items are enabled.&amp;nbsp;&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-V05" name="Use Managed disks for virtual machines" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Disk Encryption&lt;/li&gt;&lt;li&gt;Resilience as Microsoft will managed the disk storage and move around if underlying hardware goes faulty&lt;/li&gt;&lt;li&gt;Reduction of costs over storage accounts&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.&lt;/p&gt;&lt;p&gt;For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;There is no operational impact of migrating to managed disks other than the benefits mentioned above.&lt;/p&gt;&lt;p&gt;NOTE: When converting to managed disks VMs will be powered off and back on.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select the virtual machine you would like to convert&lt;/li&gt;&lt;li&gt;Select Disks in the menu for the VM&lt;/li&gt;&lt;li&gt;At the top select Migrate to managed disks&lt;/li&gt;&lt;li&gt;You may follow the prompts to convert the disk and finish by selecting `Migrate' to start the process&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;NOTE VMs will be stopped and restarted after migration is complete.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Stop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard"/>
            <standard ref="7.1" supportedStandardRef="cis-azure-standard-level-2"/>
            <standard ref="GS-1" supportedStandardRef="azure-security-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;From Azure Console&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Using the search feature, go to Virtual Machines&lt;/li&gt;&lt;li&gt;Select Edit columns&lt;/li&gt;&lt;li&gt;Add Uses managed disks to the selected columns&lt;/li&gt;&lt;li&gt;Select Apply&lt;/li&gt;&lt;li&gt;Ensure virtual machine listed are using a managed disk&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Using Powershell&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Get-AzVM | ForEach-Object {"Name: " + $_.Name;"ManagedDisk Id: " + $_.StorageProfile.OsDisk.ManagedDisk.Id;""}&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N07" name="Use Network Access Control Lists (NACLs) for blacklisting" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Access Control Lists (NACLs) as a method of blacklisting IP addresses to filters the
                        traffic across endpoints to allow or deny traffic per pre-created rules.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation: &amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on &amp;quot;Inbound
                        security rules&amp;quot;.&lt;/li&gt;
                        &lt;li&gt;Add a DENY rule that will restrict inbound access from a blacklisted IP address or
                        range to a designated port or port range.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;ol&gt;
                        &lt;ul&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select &amp;quot;Network security groups&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Select the Network Security Group (NSG) for your virtual machine and click on
                            &amp;quot;Inbound security rules&amp;quot;.&lt;/li&gt;
                            &lt;li&gt;Check that there is a rule to deny the inbound access from a blacklisted IP
                            address or range to a designated port or port range.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N02" name="Use Network Security Groups to block inbound port traffic from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure resources. Set the limit inbound access to all TCP or all ports to avoid undue exposure to risk.&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt; 
  &lt;li&gt;Select Network Security Groups.&lt;/li&gt; 
  &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt; 
  &lt;li&gt;In "Inbound security rules":&lt;/li&gt; 
 &lt;/ol&gt; 
 &lt;ul&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Remove all rules that allow port traffic.&lt;/li&gt; 
   &lt;li&gt;Add a rule to deny port traffic&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0 is are blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N04" name="Use Network Security Groups to block ingress to port 22 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 22 (Secure Desk) to IP addresses that require
                        this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow SSH port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 22 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 22 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZ-N03" name="Use Network Security Groups to block ingress to port 3389 from 0.0.0.0/0" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
                        Use Network Security Groups (NSG) to filter the ingress/egress network traffic to Azure
                        resources. Set the limit inbound access to port 3389 (Remote Desk Protocol) to IP addresses that
                        require this access to avoid undue exposure to risk.&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                        &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                        &lt;li&gt;Choose the NSG to edit (or create a new one).&lt;/li&gt;
                        &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;:&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Allow RDP port traffic just to/from IPs that require the access.&lt;/li&gt;
                        &lt;li&gt;Otherwise, remove all rules that allow port 3389 traffic.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="MS Azure - How to open ports to a virtual machine with the Azure portal" url="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Log into the Azure portal as an owner.&lt;/li&gt;
                            &lt;li&gt;Select Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Choose the NSG to view one of them.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that the traffic through the
                            port 3389 is blocked.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.939">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-VIRTUAL-MACHINES" name="Attackers gain undetected access to the system by changing Virtual Machine configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers can gain undetected access to the virtual machine configurations and these
                                changes couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM02">
                  <countermeasures>
                    <countermeasure ref="AZ-V03" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V03" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="API LOGGING AND AUDITING" name="API Logging and Auditing" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUDITABLE-CHANGES-AZURE" name="Attackers make undetected and unaudited changes to system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>If audit trails are not properly protected, an attacker could gain access to the
                                system, modify the status of resources or exfiltrate sensitive data without being
                                noticed.</desc>
              <riskRating confidentiality="25" integrity="75" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="AZ-V01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNCONFIGURED-SECURITY" name="Attackers gain access to the system by exploiting weak security configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Weak security configurations like using sharing passwords in plain text, using weak passwords, using obsolete encryption algorithms, etc. can lead attackers to gain access to the system.</desc>
              <riskRating confidentiality="75" integrity="50" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM01">
                  <countermeasures>
                    <countermeasure ref="AZ-V02" mitigation="25"/>
                    <countermeasure ref="AZ-V05" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-16">
                  <countermeasures>
                    <countermeasure ref="AZ-V07" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="AZ-V06" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V02" mitigation="25"/>
                <countermeasure ref="AZ-V05" mitigation="25"/>
                <countermeasure ref="AZ-V06" mitigation="25"/>
                <countermeasure ref="AZ-V07" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-N01" mitigation="20"/>
                    <countermeasure ref="AZ-N02" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-02">
                  <countermeasures>
                    <countermeasure ref="AZ-N04" mitigation="10"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-03">
                  <countermeasures>
                    <countermeasure ref="AZ-N03" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-04">
                  <countermeasures>
                    <countermeasure ref="AZ-N07" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="AZURE-NET-05">
                  <countermeasures>
                    <countermeasure ref="AZ-N05" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N01" mitigation="20"/>
                <countermeasure ref="AZ-N02" mitigation="10"/>
                <countermeasure ref="AZ-N03" mitigation="20"/>
                <countermeasure ref="AZ-N04" mitigation="10"/>
                <countermeasure ref="AZ-N05" mitigation="20"/>
                <countermeasure ref="AZ-N07" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZ-V04" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-V04" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PATCHING" name="Patching" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-VM-NOT_LICENSE">
                  <countermeasures>
                    <countermeasure ref="AZ-N06" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZ-N06" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="bb825862-3362-4986-92b6-3175a4332d61" diagramComponentId="bc6bf9db-ed58-43de-9fc9-e2f8d4f9ba59" ref="c018471a-3de4-4bdb-9779-5bf3af1290d5" name="VPN Device (Empty)" desc="" library="CS-Default" parentComponentRef="f6b674e5-489a-4507-a356-83a5ffda20a0" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="d681858d-c4c8-4ffd-8013-8b6df58822e4" diagramComponentId="2b80e862-6e50-4055-bc56-2595cf039169" ref="8d6bde54-d227-4029-84f7-ce509a52b41e" name="Azure VPN Gateway" desc="" library="Microsoft-Azure" parentComponentRef="8e8c4c80-77f1-47f0-b475-881a7095a777" componentDefinitionRef="CD-MICROSOFT-AZURE-VPN-GW">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="AZURE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;div&gt;
                        Receiving unauthorized connections to open ports makes systems vulnerable to attacks. To
                        avoid this, access to the network must be as restricted as possible, so that only the necessary
                        ports are open and the minimum inbound traffic is accepted.
                        &lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check that each Azure resources have got their Network Security Groups.&lt;/li&gt;
                            &lt;li&gt;Check that a set of these groups achieve with the principle of the least
                            privilege.&lt;/li&gt;
                            &lt;li&gt;Check that the inbound/outbound security rules are enabled and correctly
                            configured.&lt;/li&gt;
                            &lt;li&gt;In &amp;quot;Inbound security rules&amp;quot;, check that all the traffic from
                            0.0.0.0/0&amp;nbsp;is blocked.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.826">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="AZURE-IDS-IPS" name="Deploy network-based IDS/IPS" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Deploy network-based intrusion detection/intrusion prevention systems (IDS/IPS)&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Select an offer from Azure Marketplace that supports IDS/IPS functionality with payload inspection capabilities. If intrusion detection and/or prevention based on payload inspection is not a requirement, Azure Firewall with Threat Intelligence can be used. Azure Firewall Threat intelligence-based filtering can alert and deny traffic to and from known malicious IP addresses and domains. The IP addresses and domains are sourced from the Microsoft Threat Intelligence feed.&lt;/p&gt; 
&lt;p&gt;Deploy the firewall solution of your choice at each of your organization's network boundaries to detect and/or deny malicious traffic.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Set up the network&lt;/p&gt; 
&lt;p&gt;First, create a resource group to contain the resources needed to deploy the firewall. Then create a VNet, subnets, and a test server.&lt;br&gt; For more information please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Deploy the firewall&lt;/p&gt; 
&lt;p&gt;Deploy the firewall into the VNet.&lt;/p&gt; 
&lt;p&gt;1. On the Azure portal menu or from the Home page, select Create a resource.&lt;/p&gt; 
&lt;p&gt;2. Type firewall in the search box and press Enter.&lt;/p&gt; 
&lt;p&gt;3. Select Firewall and then select Create.&lt;/p&gt; 
&lt;p&gt;4. On the Create a Firewall page, use the following values to configure the firewall:&lt;/p&gt; 
&lt;p&gt;Subscription: &lt;br&gt; Resource group: Test-FW-RG&lt;br&gt; Name: Test-FW01&lt;br&gt; Location: Select the same location that you used previously&lt;br&gt; Choose a virtual network: Use existing: Test-FW-VN&lt;br&gt; Public IP address: Add new&lt;br&gt; Name: fw-pip&lt;/p&gt; 
&lt;p&gt;5. Select Review + create.&lt;/p&gt; 
&lt;p&gt;6. Review the summary, and then select Create to create the firewall.&lt;/p&gt; 
&lt;p&gt;This will take a few minutes to deploy.&lt;/p&gt; 
&lt;p&gt;7. After deployment completes, go to the Test-FW-RG resource group, and select the Test-FW01 firewall.&lt;/p&gt; 
&lt;p&gt;8. Note the firewall private and public IP addresses. You will use these addresses later.&lt;/p&gt; 
&lt;p&gt;Create a default route&lt;/p&gt; 
&lt;p&gt;For the Workload-SN subnet, configure the outbound default route to go through the firewall.&lt;/p&gt; 
&lt;p&gt;1. On the Azure portal menu, select All services or search for and select All services from any page.&lt;/p&gt; 
&lt;p&gt;2. Under Networking, select Route tables.&lt;/p&gt; 
&lt;p&gt;3. Select Add.&lt;/p&gt; 
&lt;p&gt;4. For Name, type Firewall-route.&lt;/p&gt; 
&lt;p&gt;5. For Subscription, select your subscription.&lt;/p&gt; 
&lt;p&gt;6. For Resource group, select Test-FW-RG.&lt;/p&gt; 
&lt;p&gt;7. For Location, select the same location that you used previously.&lt;/p&gt; 
&lt;p&gt;8. Select Create.&lt;/p&gt; 
&lt;p&gt;9. Select Refresh, and then select the Firewall-route route table.&lt;/p&gt; 
&lt;p&gt;10. Select Subnets and then select Associate.&lt;/p&gt; 
&lt;p&gt;11. Select Virtual network &amp;gt; Test-FW-VN.&lt;/p&gt; 
&lt;p&gt;12. For Subnet, select Workload-SN. Make sure that you select only the Workload-SN subnet for this route, otherwise your firewall will not work correctly.&lt;/p&gt; 
&lt;p&gt;13. Select OK.&lt;/p&gt; 
&lt;p&gt;14. Select Routes and then select Add.&lt;/p&gt; 
&lt;p&gt;15. For Route name, type fw-dg.&lt;/p&gt; 
&lt;p&gt;16. For Address prefix, type 0.0.0.0/0.&lt;/p&gt; 
&lt;p&gt;17. For Next hop type, select Virtual appliance.&lt;/p&gt; 
&lt;p&gt;Azure Firewall is actually a managed service, but virtual appliance works in this situation.&lt;/p&gt; 
&lt;p&gt;18. For Next hop address, type the private IP address for the firewall that you noted previously.&lt;/p&gt; 
&lt;p&gt;19. Select OK.&lt;/p&gt; 
&lt;p&gt;Configure an application rule&lt;/p&gt; 
&lt;p&gt;This is the application rule that allows outbound access to www.google.com.&lt;/p&gt; 
&lt;p&gt;1. Open the Test-FW-RG, and select the Test-FW01 firewall.&lt;br&gt; 2. On the Test-FW01 page, under Settings, select Rules.&lt;br&gt; 3. Select the Application rule collection tab.&lt;br&gt; 4. Select Add application rule collection.&lt;br&gt; 5. For Name, type App-Coll01.&lt;br&gt; 6. For Priority, type 200.&lt;br&gt; 7. For Action, select Allow.&lt;br&gt; 8. Under Rules, Target FQDNs, for Name, type Allow-Google.&lt;br&gt; 9. For Source type, select IP address.&lt;br&gt; 10. For Source, type 10.0.2.0/24.&lt;br&gt; 11. For Protocol:port, type http, https.&lt;br&gt; 12. For Target FQDNS, type www.google.com&lt;br&gt; 13. Select Add.&lt;/p&gt; 
&lt;p&gt;Azure Firewall includes a built-in rule collection for infrastructure FQDNs that are allowed by default. These FQDNs are specific for the platform and cannot be used for other purposes. For more information, see Infrastructure FQDNs.&lt;/p&gt; 
&lt;p&gt;Configure a network rule&lt;/p&gt; 
&lt;p&gt;This is the network rule that allows outbound access to two IP addresses at port 53 (DNS).&lt;/p&gt; 
&lt;p&gt;1. Select the Network rule collection tab.&lt;/p&gt; 
&lt;p&gt;2. Select Add network rule collection.&lt;/p&gt; 
&lt;p&gt;3. For Name, type Net-Coll01.&lt;/p&gt; 
&lt;p&gt;4. For Priority, type 200.&lt;/p&gt; 
&lt;p&gt;5. For Action, select Allow.&lt;/p&gt; 
&lt;p&gt;6. Under Rules, IP addresses, for Name, type Allow-DNS.&lt;/p&gt; 
&lt;p&gt;7. For Protocol, select UDP.&lt;/p&gt; 
&lt;p&gt;8. For Source type, select IP address.&lt;/p&gt; 
&lt;p&gt;9. For Source, type 10.0.2.0/24.&lt;/p&gt; 
&lt;p&gt;10. For Destination type select IP address.&lt;/p&gt; 
&lt;p&gt;11. For Destination address, type 209.244.0.3,209.244.0.4&lt;/p&gt; 
&lt;p&gt;These are public DNS servers operated by CenturyLink.&lt;/p&gt; 
&lt;p&gt;12. For Destination Ports, type 53.&lt;/p&gt; 
&lt;p&gt;13. Select Add.&lt;/p&gt; 
&lt;p&gt;Configure a DNAT rule&lt;/p&gt; 
&lt;p&gt;This rule allows you to connect a remote desktop to the Srv-Work virtual machine through the firewall.&lt;/p&gt; 
&lt;p&gt;1. Select the NAT rule collection tab.&lt;br&gt; 2. Select Add NAT rule collection.&lt;br&gt; 3. For Name, type rdp.&lt;br&gt; 4. For Priority, type 200.&lt;br&gt; 5. Under Rules, for Name, type rdp-nat.&lt;br&gt; 6. For Protocol, select TCP.&lt;br&gt; 7. For Source type, select IP address.&lt;br&gt; 8. For Source, type *.&lt;br&gt; 9. For Destination address, type the firewall public IP address.&lt;br&gt; 10. For Destination Ports, type 3389.&lt;br&gt; 11. For Translated address, type the Srv-work private IP address.&lt;br&gt; 12. For Translated port, type 3389.&lt;br&gt; 13. Select Add.&lt;/p&gt; 
&lt;p&gt;Change the primary and secondary DNS address for the Srv-Work network interface&lt;/p&gt; 
&lt;p&gt;For testing purposes in this tutorial, configure the server's primary and secondary DNS addresses. This is not a general Azure Firewall requirement.&lt;/p&gt; 
&lt;p&gt;1. On the Azure portal menu, select Resource groups or search for and select Resource groups from any page. Select the Test-FW-RG resource group.&lt;br&gt; 2. Select the network interface for the Srv-Work virtual machine.&lt;br&gt; 3. Under Settings, select DNS servers.&lt;br&gt; 4. Under DNS servers, select Custom.&lt;br&gt; 5. Type 209.244.0.3 in the Add DNS server text box, and 209.244.0.4 in the next text box.&lt;br&gt; 6. Select Save.&lt;br&gt; 7. Restart the Srv-Work virtual machine.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Tutorial: Deploy and configure Azure Firewall using the Azure portal" url="https://docs.microsoft.com/en-us/azure/firewall/tutorial-firewall-deploy-portal"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Test the firewall&lt;/p&gt;

  &lt;p&gt;Now, test the firewall to confirm that it works as expected.&lt;/p&gt;

  &lt;p&gt;1. Connect a remote desktop to firewall public IP address and sign in to the Srv-Work virtual machine.&lt;/p&gt;

  &lt;p&gt;2. Open Internet Explorer and browse to https://www.google.com.&lt;/p&gt;

  &lt;p&gt;3. Select OK &gt; Close on the Internet Explorer security alerts.&lt;/p&gt;

  &lt;p&gt;You should see the Google home page.&lt;/p&gt;

  &lt;p&gt;4. Browse to https://www.microsoft.com.&lt;/p&gt;

  &lt;p&gt;You should be blocked by the firewall.&lt;/p&gt;

  &lt;p&gt;So now you've verified that the firewall rules are working:&lt;/p&gt;

  &lt;p&gt;- You can browse to the one allowed FQDN, but not to any others.&lt;br /&gt;
- You can resolve DNS names using the configured external DNS server.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.790">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AZURE-ADAPTIVE-NET-HARDENING" name="Use Security Center's Adaptive Network Hardening" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Microsoft-Azure" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Security Center's Adaptive Network Hardening&lt;/p&gt;

	&lt;p&gt;Rationale:&lt;br /&gt;
Applying network security groups (NSG) to filter traffic to and from resources, improves your network security posture. However, there can still be some cases in which the actual traffic flowing through the NSG is a subset of the NSG rules defined. In these cases, further improving the security posture can be achieved by hardening the NSG rules, based on the actual traffic patterns.&lt;/p&gt;

	&lt;p&gt;Adaptive network hardening provides recommendations to further harden the NSG rules. It uses a machine learning algorithm that factors in actual traffic, known trusted configuration, threat intelligence, and other indicators of compromise, and then provides recommendations to allow traffic only from specific IP/port tuples.&lt;/p&gt;

	&lt;p&gt;Note: Adaptive network hardening recommendations are only supported on the following specific ports (for both UDP and TCP): 13, 17, 19, 22, 23, 53, 69, 81, 111, 119, 123, 135, 137, 138, 139, 161, 162, 389, 445, 512, 514, 593, 636, 873, 1433, 1434, 1900, 2049, 2301, 2323, 2381, 3268, 3306, 3389, 4333, 5353, 5432, 5555, 5800, 5900, 5900, 5985, 5986, 6379, 6379, 7000, 7001, 7199, 8081, 8089, 8545, 9042, 9160, 9300, 11211, 16379, 26379, 27017, 37215&lt;/p&gt;

	&lt;p&gt;Remediation:&lt;br /&gt;
View and manage hardening alerts and rules&lt;/p&gt;

	&lt;p&gt;1. From Security Center's menu, open the Azure Defender dashboard and select the adaptive network hardening tile, or the insights panel item related to adaptive network hardening.&lt;/p&gt;

	&lt;p&gt;Tip: The insights panel shows the percentage of your VMs currently defended with adaptive network hardening.&lt;/p&gt;

	&lt;p&gt;The details page for the Adaptive Network Hardening recommendations should be applied on internet facing virtual machines recommendation opens with your network VMs grouped into three tabs:&lt;/p&gt;

	&lt;p&gt;a. Unhealthy resources: VMs that currently have recommendations and alerts that were triggered by running the adaptive network hardening algorithm.&lt;/p&gt;

	&lt;p&gt;b. Healthy resources: VMs without alerts and recommendations.&lt;/p&gt;

	&lt;p&gt;c. Unscanned resources: VMs that the adaptive network hardening algorithm cannot be run on because of one of the following reasons:&lt;br /&gt;
i. VMs are Classic VMs: Only Azure Resource Manager VMs are supported.&lt;br /&gt;
ii. Not enough data is available: In order to generate accurate traffic hardening recommendations, Security Center requires at least 30 days of traffic data.&lt;br /&gt;
iii. VM is not protected by Azure Defender: Only VMs protected with Azure Defender for servers are eligible for this feature.&lt;/p&gt;

	&lt;p&gt;3. From the Unhealthy resources tab, select a VM to view its alerts and the recommended hardening rules to apply.&lt;/p&gt;

	&lt;p&gt;- The Rules tab lists the rules that adaptive network hardening recommends you add&lt;br /&gt;
- The Alerts tab lists the alerts that were generated due to traffic, flowing to the resource, which is not within the IP range allowed in the recommended rules.&lt;/p&gt;

	&lt;p&gt;4. Optionally, edit the rules:&lt;/p&gt;

	&lt;p&gt;- Modify a rule&lt;br /&gt;
- Delete a rule&lt;br /&gt;
- Add a rule&lt;/p&gt;

	&lt;p&gt;5. Select the rules that you want to apply on the NSG, and click Enforce.&lt;/p&gt;

	&lt;p&gt;Tip: If the allowed source IP ranges shows as 'None', it means that recommended rule is a deny rule, otherwise, it is an allow rule.&lt;/p&gt;

	&lt;p&gt;Note: The enforced rules are added to the &lt;acronym title="s"&gt;NSG&lt;/acronym&gt; protecting the VM. (A VM could be protected by an NSG that is associated to its NIC, or the subnet in which the VM resides, or both)&lt;/p&gt;

	&lt;p&gt;Impact:&lt;br /&gt;
None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Improve your network security posture with adaptive network hardening" url="https://docs.microsoft.com/en-us/azure/security-center/security-center-adaptive-network-hardening"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that Security Center's Adaptive Network Hardening recommendations are enforced  to your NSG configurations.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-24T03:56:26.790">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Microsoft-Azure">
          <threats>
            <threat ref="AZURE-UNAUTHORISED-CONNECTION" name="Attackers perform unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Microsoft-Azure" editable="true">
              <desc>&lt;p&gt;Attackers could perform unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AZURE-NET-01">
                  <countermeasures>
                    <countermeasure ref="AZURE-ADAPTIVE-NET-HARDENING" mitigation="50"/>
                    <countermeasure ref="AZURE-IDS-IPS" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AZURE-ADAPTIVE-NET-HARDENING" mitigation="50"/>
                <countermeasure ref="AZURE-IDS-IPS" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
  </components>
</template>
