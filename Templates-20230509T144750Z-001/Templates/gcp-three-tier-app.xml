<?xml version="1.0" encoding="UTF-8"?>
<template ref="gcp-three-tier-app" name="GCP - Three Tier App" tags="">
  <desc/>
  <diagram draft="false">
    <schema>PG14R3JhcGhNb2RlbCBkeD0iMTYxMCIgZHk9Ijk2MyIgZ3JpZD0iMCIgZ3JpZFNpemU9IjEwIiBndWlkZXM9IjEiIHRvb2x0aXBzPSIxIiBjb25uZWN0PSIxIiBhcnJvd3M9IjEiIGZvbGQ9IjEiIHBhZ2U9IjAiIHBhZ2VTY2FsZT0iMSIgcGFnZVdpZHRoPSI4NTAiIHBhZ2VIZWlnaHQ9IjExMDAiIG1hdGg9IjAiIHNoYWRvdz0iMCIgaXJEcmF3aW9WZXJzaW9uPSI0LjYuMCI+CiAgPHJvb3Q+CiAgICA8bXhDZWxsIGlkPSIwIi8+CiAgICA8bXhDZWxsIGlkPSIxIiBwYXJlbnQ9IjAiLz4KICAgIDxteENlbGwgaWQ9IjIiIHZhbHVlPSJQdWJsaWMiIHN0eWxlPSJpci5yZWY9NjM3NmQ1M2UtNjQ2MS00MTJiLThlMDQtN2IzZmUyYjM5N2RlO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7cmVjdXJzaXZlUmVzaXplPTA7aHRtbD0xO3ZlcnRpY2FsQWxpZ249dG9wO2FsaWduPWxlZnQ7ZGFzaGVkPTE7c3Ryb2tlV2lkdGg9MTthcmNTaXplPTM7YWJzb2x1dGVBcmNTaXplPTE7c3BhY2luZ1RvcD0xO3NwYWNpbmdMZWZ0PTMyO3N0cm9rZUNvbG9yPSM3NTc1RUI7ZmlsbENvbG9yPSNGMEYwRkY7ZmlsbE9wYWNpdHk9MzA7Zm9udENvbG9yPSM1NjUxRTA7Y29ubmVjdGFibGU9MDtjb250YWluZXI9MTtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9VFJVU1RaT05FOyIgcGFyZW50PSIxIiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSItMTM0IiB5PSItMTAiIHdpZHRoPSIxMDgwIiBoZWlnaHQ9IjU4OSIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxvYmplY3QgbGFiZWw9IkdDUCBQbGF0Zm9ybSBFbnZpcm9ubWVudCIgaXIuc291cmNlU3R5bGU9InJvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWdvb2dsZS1jbG91ZC1wbGF0Zm9ybS1lbnZpcm9ubWVudDtpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQR2NnWTJ4cGNDMXdZWFJvUFNKMWNtd29JMk5zYVhBd0tTSStKaU40WVRzOFp5QmpiR2x3TFhCaGRHZzlJblZ5YkNnalkyeHBjREVwSWo0bUkzaGhPenh3WVhSb0lHWnBiR3d0Y25Wc1pUMGlaWFpsYm05a1pDSWdZMnhwY0MxeWRXeGxQU0psZG1WdWIyUmtJaUJrUFNKTk1DNDJNak01TVRNZ01DNHpOVGM0T1RWTU1DNDJOVEExTnpRZ01DNHpOVGd6TlRKTU1DNDNNak13TVRZZ01DNHlPRFU1TURsTU1DNDNNalkxTWpjZ01DNHlOVFV5TVRkRE1DNDJOamN3TXpVZ01DNHlNREl4TURNZ01DNDFPVEF3TlRjZ01DNHhOekkzT0RJZ01DNDFNVEF6TURZZ01DNHhOekk0TlRKRE1DNHpOakF5TVRnZ01DNHhOekk0TlRJZ01DNHlNek0xTkRJZ01DNHlOelE1TnpRZ01DNHhPVFl3TkRVZ01DNDBNVE16TURSRE1DNHlNRE01TlRNZ01DNDBNRGMzT0RnZ01DNHlNakE0TlRrZ01DNDBNVEU1TWpZZ01DNHlNakE0TlRrZ01DNDBNVEU1TWpaTU1DNHpOalUyTVRVZ01DNHpPRGd4TWpaRE1DNHpOalUyTVRVZ01DNHpPRGd4TWpZZ01DNHpOek13TlRRZ01DNHpOelU0TVNBd0xqTTNOamd5TkNBd0xqTTNOalF5TWtNd0xqUXhNVEExSURBdU16TTRPREUzSURBdU5EVTVOVFE1SURBdU16RTNNemsxSURBdU5URXdNemt6SURBdU16RTNOREUxUXpBdU5UVXpNekUwSURBdU16RTNOVEExSURBdU5Ua3lPRFV4SURBdU16TXlOamNnTUM0Mk1qTTVNU0F3TGpNMU56YzFPRll3TGpNMU56ZzVPRWd3TGpZeU16a3hNMVl3TGpNMU56ZzVOVm9pSUdacGJHdzlJaU5GUVRRek16VWlMejRtSTNoaE96eHdZWFJvSUdacGJHd3RjblZzWlQwaVpYWmxibTlrWkNJZ1kyeHBjQzF5ZFd4bFBTSmxkbVZ1YjJSa0lpQmtQU0pOTUM0NE1qUTJOeUF3TGpReE16UTVPRU13TGpnd056ZzFNaUF3TGpNMU1UUTJJREF1Tnpjek1Ua3lJREF1TWprMk5qZ3hJREF1TnpJMk5ERXlJREF1TWpVMU1USTNUREF1TmpJek9ETTJJREF1TXpVM056QXpRekF1TmpZME9UTTJJREF1TXprd09EWTNJREF1TmpreE1qazRJREF1TkRReE5qRTFJREF1TmpreE1qazRJREF1TkRrNE5ESTBWakF1TlRFMk5USTRRekF1TnpReE1pQXdMalV4TmpVeU9DQXdMamM0TVRjMElEQXVOVFUzTVRVNElEQXVOemd4TnpRZ01DNDJNRFk1TjBNd0xqYzRNVGMwSURBdU5qVTJPRGN5SURBdU56UXhNVEVnTUM0Mk9UYzBNVE1nTUM0Mk9URXlPVGdnTUM0Mk9UYzBNVE5JTUM0MU1UQTBNVE5NTUM0ME9USXpNU0F3TGpjeE5UWXlNVll3TGpneU5ERTJPRXd3TGpVeE1EUXhNeUF3TGpnME1qRTNPVWd3TGpZNU1USTVPRU13TGpneU1URXhPU0F3TGpnME1UazVOeUF3TGpreU5qTXhNaUF3TGpjek5qZ3dOeUF3TGpreU5qVXdOaUF3TGpZd05qazROVU13TGpreU5qUXhOQ0F3TGpVeU5qa3pOaUF3TGpnNE5qRTRPQ0F3TGpRMU5qRXhPQ0F3TGpneU5EWTNNaUF3TGpReE16VXhNMVl3TGpReE16Vk1NQzQ0TWpRMk55QXdMalF4TXpRNU9Gb2lJR1pwYkd3OUlpTTBNamcxUmpRaUx6NG1JM2hoT3p4d1lYUm9JR1pwYkd3dGNuVnNaVDBpWlhabGJtOWtaQ0lnWTJ4cGNDMXlkV3hsUFNKbGRtVnViMlJrSWlCa1BTSk5NQzR6TWprek5qY2dNQzQ0TkRJME1qSklNQzQxTVRBeE5EbFdNQzQyT1RjMU5EUklNQzR6TWprek5qZERNQzR6TVRZMU1qSWdNQzQyT1RjMU5EWWdNQzR6TURNNE1qa2dNQzQyT1RRM09EY2dNQzR5T1RJeE5EVWdNQzQyT0RrME5UTk1NQzR5TmpZd05ETWdNQzQyT1RjME5URk1NQzR4T1RNMk1ERWdNQzQzTmprNE9Vd3dMakU0TnpJMU5pQXdMamM1TkRNME1VTXdMakl5T0RBM09TQXdMamd5TlRRNE5DQXdMakkzT0RBd09TQXdMamcwTWpNME5DQXdMak15T1RNMU55QXdMamcwTWpNeE9Vd3dMak15T1RNM0lEQXVPRFF5TkRJeVNEQXVNekk1TXpZM1dpSWdabWxzYkQwaUl6TTBRVGcxTXlJdlBpWWplR0U3UEhCaGRHZ2dabWxzYkMxeWRXeGxQU0psZG1WdWIyUmtJaUJqYkdsd0xYSjFiR1U5SW1WMlpXNXZaR1FpSUdROUlrMHdMak15T1RNeU9DQXdMak0zTVRneU5rTXdMakU1T1RVd05TQXdMak0zTWpFek9DQXdMakE1TkRJNU9EVWdNQzQwTnpjek1qa2dNQzR3T1RReE1UWXlJREF1TmpBM01UVTFRekF1TURrME1URTJNaUF3TGpZNE16VXpPU0F3TGpFek1EY3dOQ0F3TGpjMU1UUTFOaUF3TGpFNE56TXhOaUF3TGpjNU5EUTNPRXd3TGpJNU1qRTVNeUF3TGpZNE9UVTVPVU13TGpJMU9UYzNJREF1TmpjME9UYzJJREF1TWpNNE9URXlJREF1TmpReU56STBJREF1TWpNNE9EZ3lJREF1TmpBM01UVTFRekF1TWpNNE9EZ3lJREF1TlRVM01qVXlJREF1TWpjNU5URXpJREF1TlRFMk56RXhJREF1TXpJNU16STFJREF1TlRFMk56RXhRekF1TXpZMklEQXVOVEUyTnpFeElEQXVNemszTlRJNUlEQXVOVE00T0RJeElEQXVOREV4TnpneklEQXVOVGN3TURNM1REQXVOVEUyTmpZeUlEQXVORFkxTVRVNFF6QXVORGN6TmpVeElEQXVOREE0TlRRMElEQXVOREExTnpJeUlEQXVNemN4T1RVNUlEQXVNekk1TXpRZ01DNHpOekU1TlRsTU1DNHpNamt6TWpnZ01DNHpOekU0TWpaYUlpQm1hV3hzUFNJalJrSkNRekExSWk4K0ppTjRZVHM4TDJjK0ppTjRZVHM4TDJjK0ppTjRZVHM4WkdWbWN6NG1JM2hoT3p4amJHbHdVR0YwYUNCcFpEMGlZMnhwY0RBaVBpWWplR0U3UEhKbFkzUWdkMmxrZEdnOUlqQXVPVGcwTmpFMUlpQm9aV2xuYUhROUlqQXVPVGcwTmpBMklpQm1hV3hzUFNKM2FHbDBaU0lnZEhKaGJuTm1iM0p0UFNKMGNtRnVjMnhoZEdVb01DNHdNVFV6T0RBNUlEQXVNREUxTXpnd09Ta2lMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOFkyeHBjRkJoZEdnZ2FXUTlJbU5zYVhBeElqNG1JM2hoT3p4eVpXTjBJSGRwWkhSb1BTSXdMamd6TWpNM05DSWdhR1ZwWjJoMFBTSXdMalkyT1RVek5pSWdabWxzYkQwaWQyaHBkR1VpSUhSeVlXNXpabTl5YlQwaWRISmhibk5zWVhSbEtEQXVNRGswTVRFMk1pQXdMakUzTWpnMU1pa2lMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOEwyUmxabk0rSmlONFlUczhMM04yWno0PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0wOyIgaWQ9IjYiPgogICAgICA8bXhDZWxsIHN0eWxlPSJpci5yZWY9OThmNmJhYmYtMGRlMy00YjE4LTk5MGItNGNmZGQ4MmMxNmRiO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWxlZnQ7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTM7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMztzb3VyY2U9Y3VzdG9tO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWdvb2dsZS1jbG91ZC1wbGF0Zm9ybS1lbnZpcm9ubWVudDt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTtjb250YWluZXI9MTtwZXJpbWV0ZXI9cmVjdGFuZ2xlUGVyaW1ldGVyO3JlY3Vyc2l2ZVJlc2l6ZT0wO3N0cm9rZVdpZHRoPTE7dGV4dERpcmVjdGlvbj1sdHI7c3BhY2luZ1RvcD0xO3NwYWNpbmdMZWZ0PTMyOyIgcGFyZW50PSIyIiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICAgIDxteEdlb21ldHJ5IHg9IjE3IiB5PSIzOCIgd2lkdGg9IjEwNDMiIGhlaWdodD0iNTI2IiBhcz0iZ2VvbWV0cnkiLz4KICAgICAgPC9teENlbGw+CiAgICA8L29iamVjdD4KICAgIDxvYmplY3QgbGFiZWw9IkJ1aWxkIFByb2Nlc3MiIGlyLnNvdXJjZVN0eWxlPSJyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxMYWJlbFBvc2l0aW9uPW1pZGRsZTt2ZXJ0aWNhbEFsaWduPW1pZGRsZTtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSIxMiI+CiAgICAgIDxteENlbGwgc3R5bGU9ImlyLnJlZj03MjBhN2UyOS0yMDQ4LTQxNmEtYjRmYy03YmU4NDdjODIxZmU7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249bGVmdDtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9MzthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEzO3NvdXJjZT1jdXN0b207aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9ZW1wdHktY29tcG9uZW50O3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xO2NvbnRhaW5lcj0xO3BlcmltZXRlcj1yZWN0YW5nbGVQZXJpbWV0ZXI7cmVjdXJzaXZlUmVzaXplPTA7c3Ryb2tlV2lkdGg9MTt0ZXh0RGlyZWN0aW9uPWx0cjtzcGFjaW5nVG9wPTE7c3BhY2luZ0xlZnQ9MzI7IiBwYXJlbnQ9IjYiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgICAgPG14R2VvbWV0cnkgeD0iMzgiIHk9IjM1OSIgd2lkdGg9Ijk3MyIgaGVpZ2h0PSIxMzkiIGFzPSJnZW9tZXRyeSIvPgogICAgICA8L214Q2VsbD4KICAgIDwvb2JqZWN0PgogICAgPG9iamVjdCBsYWJlbD0iQ0kvQ0QgTGF5ZXIgQ2xvdWQgQnVpbGQgLSBTZXJ2ZXJsZXNzIENJL0NEIiBpZD0iMTMiPgogICAgICA8bXhDZWxsIHN0eWxlPSJpci5yZWY9YzQ2YTdjM2EtOTM2MC00NDJkLTgyOTMtOTdmYWFhZDAxZDVkO3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPUNELUdPT0dMRS1DTE9VRC1CVUlMRDtpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQR2NnWTJ4cGNDMXdZWFJvUFNKMWNtd29JMk5zYVhBd1h6RTNPREJmTWpRNU9EUXBJajRtSTNoaE96eHdZWFJvSUdROUlrMHdMamt5T1RVeE5pQXdMalExT1RZeU5Fd3dMamMwT0Rjd015QXdMakUwTlRFMk1VTXdMamMwTVRrd05DQXdMakV6TXpFd015QXdMamN6TWpBM01pQXdMakV5TXpBeklEQXVOekl3TVRneklEQXVNVEUxT1RNNVF6QXVOekE0TWpreklEQXVNVEE0T0RRNUlEQXVOamswTnpVM0lEQXVNVEEwT1RnM0lEQXVOamd3T1RFMklEQXVNVEEwTnpNMlNEQXVNekU1TWpJeVF6QXVNekExTXpjNUlEQXVNVEEwT1RnZ01DNHlPVEU0TkRFZ01DNHhNRGc0TXprZ01DNHlOems1TlNBd0xqRXhOVGt6UXpBdU1qWTRNRFU1SURBdU1USXpNREl4SURBdU1qVTRNakk1SURBdU1UTXpNRGs0SURBdU1qVXhORE0xSURBdU1UUTFNVFl4VERBdU1EY3dOVFV6TXlBd0xqUTFPRGM1T1VNd0xqQTJNelkzTnpJZ01DNDBOekEzTmpRZ01DNHdOakF3TlRnMklEQXVORGcwTXpJeklEQXVNRFl3TURVNE5pQXdMalE1T0RFeU5FTXdMakEyTURBMU9EWWdNQzQxTVRFNU1qUWdNQzR3TmpNMk56Y3lJREF1TlRJMU5EZ3pJREF1TURjd05UVXpNeUF3TGpVek56UTBPVXd3TGpJMU1UTTJOaUF3TGpnMU16WTVPVU13TGpJMU9EQTVNeUF3TGpnMk5Ua3pNeUF3TGpJMk56ZzNNU0F3TGpnM05qSXhPQ0F3TGpJM09UYzBPU0F3TGpnNE16VTFORU13TGpJNU1UWXlPQ0F3TGpnNU1EZzVNU0F3TGpNd05USXdNaUF3TGpnNU5UQXlPU0F3TGpNeE9URTFNeUF3TGpnNU5UVTJOMGd3TGpZNE1EZzBOME13TGpZNU5EYzVOaUF3TGpnNU5UQTRPU0F3TGpjd09ETTRNaUF3TGpnNU1EazVPQ0F3TGpjeU1ESTNOaUF3TGpnNE16WTVOVU13TGpjek1qRTNJREF1T0RjMk16a3lJREF1TnpReE9UWTFJREF1T0RZMk1USTRJREF1TnpRNE56QXpJREF1T0RVek9UQTFUREF1T1RJNU5URTJJREF1TlRNNU5EUXpRekF1T1RNMk5EUXlJREF1TlRJM01qZ3lJREF1T1RRd01EZzBJREF1TlRFek5USTRJREF1T1RRd01EZzBJREF1TkRrNU5UTXpRekF1T1RRd01EZzBJREF1TkRnMU5UTTRJREF1T1RNMk5EUXlJREF1TkRjeE56ZzFJREF1T1RJNU5URTJJREF1TkRVNU5qSTBWakF1TkRVNU5qSTBXaUlnWm1sc2JEMGlJelF5T0RWR05DSXZQaVlqZUdFN1BIQmhkR2dnYjNCaFkybDBlVDBpTUM0d055SWdaRDBpVFRBdU9Ea3lPVEkxSURBdU5qQXpNVE0xVERBdU5qY3lPVEkxSURBdU16Z3pNVE0xVERBdU5UQXdNRGc0SURBdU16STJOREUyVERBdU16STNOall6SURBdU16Z3pOVFEzVERBdU5ETXhNek00SURBdU5EZzNNamt4VmpBdU5EazBNVFkyVERBdU16a3pOek15SURBdU5EVTJOVFpNTUM0ek1USTNORFFnTUM0Mk1EZzNOekpNTUM0MU9Ua3lPVFFnTUM0NE9UVXpNakpJTUM0Mk9ERXhOelZETUM0Mk9UVXhNalFnTUM0NE9UUTRORE1nTUM0M01EZzNNU0F3TGpnNU1EYzFNeUF3TGpjeU1EWXdOQ0F3TGpnNE16UTFRekF1TnpNeU5EazRJREF1T0RjMk1UUTNJREF1TnpReU1qa3pJREF1T0RZMU9EZ3lJREF1TnpRNU1ETXlJREF1T0RVek5qWk1NQzQ0T1RJNU1qVWdNQzQyTURNeE16VmFJaUJtYVd4c1BTSmliR0ZqYXlJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UQXdNalV6SURBdU5UZzRORE15VERBdU5UYzJORGszSURBdU5UUTBORE15VmpBdU5EVTJORE15VERBdU5UVXdPRFV6SURBdU5EUXhOalZNTUM0ME56UTJNRGtnTUM0MU56TTJOVXd3TGpVd01ESTFNeUF3TGpVNE9EUXpNbG9pSUdacGJHdzlJbmRvYVhSbElpOCtKaU40WVRzOGNHRjBhQ0JrUFNKTk1DNDBNalF3TnpJZ01DNDBOVFl6TlRSV01DNDFORFF6TlROTU1DNDBORGszTVRZZ01DNDFOVGt4TXpWTU1DNDFNalU1TmlBd0xqUXlOekV6TlV3d0xqVXdNRE14TmlBd0xqUXhNak0xTkV3d0xqUXlOREEzTWlBd0xqUTFOak0xTkZvaUlHWnBiR3c5SW5kb2FYUmxJaTgrSmlONFlUczhjR0YwYUNCa1BTSk5NQzQwT0RVek56VWdNQzQyTVRRM05EbE1NQzR6T1RRd01EY2dNQzQxTmpJd01UaFdNQzQwTlRZMk1qUk1NQzR6TVRJM05EUWdNQzQwTURrMk5qaFdNQzQyTURnNU56Uk1NQzQwT0RVek56VWdNQzQzTURnMk5qSldNQzQyTVRRM05EbGFJaUJtYVd4c1BTSjNhR2wwWlNJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5EQTRPVFk0SURBdU5ETXdOVGM1VERBdU5UQXdOREExSURBdU16YzNOemM1VERBdU5Ua3hPRFF6SURBdU5ETXdOVGM1VERBdU5qY3pNVGMwSURBdU16Z3pOamt5VERBdU5UQXdOREExSURBdU1qZ3pPVE0yVERBdU16STNOak0zSURBdU16Z3pOamt5VERBdU5EQTRPVFk0SURBdU5ETXdOVGM1V2lJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMall3TmpZNE1TQXdMalExTmpVMU5WWXdMalUyTVRrME9Vd3dMalV4TlRNNE1TQXdMall4TkRZNFZqQXVOekE0TlRrelREQXVOamc0TURFeUlEQXVOakE0T1RBMVZqQXVOREE1TmpZNFREQXVOakEyTmpneElEQXVORFUyTlRVMVdpSWdabWxzYkQwaWQyaHBkR1VpTHo0bUkzaGhPend2Wno0bUkzaGhPenhrWldaelBpWWplR0U3UEdOc2FYQlFZWFJvSUdsa1BTSmpiR2x3TUY4eE56Z3dYekkwT1RnMElqNG1JM2hoT3p4eVpXTjBJSGRwWkhSb1BTSXdMamc0SWlCb1pXbG5hSFE5SWpBdU9EZ2lJR1pwYkd3OUluZG9hWFJsSWlCMGNtRnVjMlp2Y20wOUluUnlZVzV6YkdGMFpTZ3dMakEyTURBMU9EWWdNQzR3TmpBd05UZzJLU0l2UGlZamVHRTdQQzlqYkdsd1VHRjBhRDRtSTNoaE96d3ZaR1ZtY3o0bUkzaGhPend2YzNablBnPT07dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTsiIHBhcmVudD0iMTIiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgICAgPG14R2VvbWV0cnkgeD0iMTY2IiB5PSIxOSIgd2lkdGg9IjI0NCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICAgIDwvbXhDZWxsPgogICAgPC9vYmplY3Q+CiAgICA8bXhDZWxsIGlkPSIxNSIgdmFsdWU9IlN0b3JlIFNlY3JldHMgU2VjcmV0cyBNYW5hZ2VyIC0gU2Vuc2l0aXZlIGRhdGEgc3RvcmFnZSAtJmd0OyBDSS9DRCBMYXllciBDbG91ZCBCdWlsZCAtIFNlcnZlcmxlc3MgQ0kvQ0QiIHN0eWxlPSJpci5yZWY9OGNhZmE4Y2YtYzU3Ni00Mzc5LWIwZjktMzE5NDM5NzBhMzNmO2VkZ2VTdHlsZT1ub25lO2N1cnZlZD0xO2h0bWw9MTtpci5zeW5jaHJvbml6ZWQ9MTtleGl0WD0wO2V4aXRZPTAuNTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MTtlbnRyeVk9MC41O2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW5kQXJyb3c9b3BlbjtlbmRGaWxsPTA7ZW5kU2l6ZT00O3NvdXJjZVBlcmltZXRlclNwYWNpbmc9OTtzdHJva2VDb2xvcj0jQkZCRkJGO3N0cm9rZVdpZHRoPTI7IiBwYXJlbnQ9IjEyIiBzb3VyY2U9IjE0IiB0YXJnZXQ9IjEzIiBlZGdlPSIxIj4KICAgICAgPG14R2VvbWV0cnkgcmVsYXRpdmU9IjEiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8b2JqZWN0IGxhYmVsPSJTdG9yZSBTZWNyZXRzIFNlY3JldHMgTWFuYWdlciAtIFNlbnNpdGl2ZSBkYXRhIHN0b3JhZ2UiIGlkPSIxNCI+CiAgICAgIDxteENlbGwgc3R5bGU9ImlyLnJlZj05M2QxYzIwZC0zNzZkLTRiMDgtYmQ1Ny0yMjRhMzk4ZDAxZTM7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9Z29vZ2xlLXNlY3JldC1tYW5hZ2VyO3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1taWRkbGU7dmVydGljYWxBbGlnbj1taWRkbGU7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjEyIiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICAgIDxteEdlb21ldHJ5IHg9IjY2NSIgeT0iMjQuNSIgd2lkdGg9IjI2OSIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICAgIDwvbXhDZWxsPgogICAgPC9vYmplY3Q+CiAgICA8b2JqZWN0IGxhYmVsPSJBcHBsaWNhdGlvbiIgaXIuc291cmNlU3R5bGU9InJvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWVtcHR5LWNvbXBvbmVudDt2ZXJ0aWNhbExhYmVsUG9zaXRpb249bWlkZGxlO3ZlcnRpY2FsQWxpZ249bWlkZGxlO2lyLnN5bmNocm9uaXplZD0wOyIgaWQ9IjI1Ij4KICAgICAgPG14Q2VsbCBzdHlsZT0iaXIucmVmPTg5ZTg2MDEwLTFhZTctNDE4MS1iZGE0LWMxMGE1NWQ5MGU2NDtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1sZWZ0O2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT0zO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTM7c291cmNlPWN1c3RvbTtpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1lbXB0eS1jb21wb25lbnQ7dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7Y29udGFpbmVyPTE7cGVyaW1ldGVyPXJlY3RhbmdsZVBlcmltZXRlcjtyZWN1cnNpdmVSZXNpemU9MDtzdHJva2VXaWR0aD0xO3RleHREaXJlY3Rpb249bHRyO3NwYWNpbmdUb3A9MTtzcGFjaW5nTGVmdD0zMjsiIHBhcmVudD0iNiIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgICA8bXhHZW9tZXRyeSB4PSIzNCIgeT0iNDIiIHdpZHRoPSI5NzUiIGhlaWdodD0iMjg3IiBhcz0iZ2VvbWV0cnkiLz4KICAgICAgPC9teENlbGw+CiAgICA8L29iamVjdD4KICAgIDxteENlbGwgaWQ9IjciIHZhbHVlPSJHQ1AgUnVuIiBzdHlsZT0iaXIucmVmPTY3NTU3OGM0LTUyNTItNGJhMS05YTllLWY4ZGNkZTdkMzU5Yjtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1DRC1HT09HTEUtQ0xPVUQtUlVOO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3WHpFM09EQmZNalV3TlRVcElqNG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTXhPVEl4TWlBd0xqRXdNekF5TjBNd0xqSTVNVEEwTmlBd0xqRXdNelV5TXlBd0xqSTJOVEkxTWlBd0xqRXhPRGt3TnlBd0xqSTFNVFF5TnlBd0xqRTBNelExTVV3d0xqQTNNRFUxTWpRZ01DNDBOVGN3TnpWRE1DNHdOVFkxTmpBMklEQXVORGd4TkRJMUlEQXVNRFUyTlRZd05pQXdMalV4TVRNM05TQXdMakEzTURVMU1qUWdNQzQxTXpVM01qTk1NQzR5TlRFek5UZ2dNQzQ0TlRFNU5qSkRNQzR5TmpVd05ESWdNQzQ0TnpZNE5EY2dNQzR5T1RBM05qWWdNQzQ0T1RJM016WWdNQzR6TVRreE5ESWdNQzQ0T1RNNE16SklNQzQyT0RBNE1qUkRNQzQzTURreE9Ua2dNQzQ0T1RJNE5UWWdNQzQzTXpRNU55QXdMamczTnpBek1TQXdMamMwT0RZM09DQXdMamcxTWpFM1REQXVPVEk1TkRneklEQXVOVE0zTnpFNFF6QXVPVE0yTlRJNUlEQXVOVEkxTXpRNUlEQXVPVFF3TURVeElEQXVOVEV4TlRjNUlEQXVPVFF3TURVeElEQXVORGszT0RGRE1DNDVOREF3TlRFZ01DNDBPRFF3TkRJZ01DNDVNelkxTWprZ01DNDBOekF5TnpJZ01DNDVNamswT0RNZ01DNDBOVGM1TURGTU1DNDNORGcyTnpnZ01DNHhORE0wTlRGRE1DNDNNelE0TkRNZ01DNHhNVGc1TVRZZ01DNDNNRGt3TlRZZ01DNHhNRE0xTXpjZ01DNDJPREE0T1RJZ01DNHhNRE13TWpkSU1DNHpNVGt5TVRKYUlpQm1hV3hzUFNJak5ESTROVVkwSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NE56STVPRGNnTUM0Mk16VTROakZNTUM0M05EZzJOVFFnTUM0NE5USXdPVGRETUM0M016UTVORFlnTUM0NE56WTVOVGtnTUM0M01Ea3hOellnTUM0NE9USTNPRE1nTUM0Mk9EQTRJREF1T0Rrek56VTVTREF1TlRRek1ETTVUREF1TXpReU1EUXhJREF1Tmprd09UWXpUREF1TkRBeE1qazFJREF1TkRrNU9EazJUREF1TXpReU1EUXhJREF1TXpBMk5qUXhUREF1TkRBeU9UQXlJREF1TXpRM05USXlUREF1TkRnME56TTBJREF1TkRNd01EZzRUREF1TkRRMk5URWdNQzR6TURZMk5ERk1NQzQzTXpNeE1USWdNQzQwT1RreE5qZE1NQzQ0TnpJNU9EY2dNQzQyTXpVNE5qRmFJaUJtYVd4c1BTSmliR0ZqYXlJZ1ptbHNiQzF2Y0dGamFYUjVQU0l3TGpBM0lpOCtKaU40WVRzOGNHRjBhQ0JrUFNKTk1DNHpOREl3TkRFZ01DNHpNRFkyTkRKTU1DNDBNREk1TURJZ01DNHpORGMxTWpWTU1DNDBOVEEyTVNBd0xqVXdNRGxNTUM0ME1ETTNOVEVnTUM0Mk5EazJOamRNTUM0ek5ESXdOREVnTUM0Mk9UQTVOalpNTUM0ME1ERTJOVFlnTUM0ME9Ua3hOamhNTUM0ek5ESXdOREVnTUM0ek1EWTJOREphVFRBdU5EazNPVEl5SURBdU16YzBPREk0VERBdU5USTNORFU0SURBdU5EY3dNell5U0RBdU5qUXdPRFU0VERBdU5EazNPVEl5SURBdU16YzBPREk0V2swd0xqY3pNekV4TVNBd0xqUTVPVEUyT1V3d0xqUTBOalV4SURBdU5qa3dPVFkxVERBdU5UQTJNVEkwSURBdU5EazVNVFk1VERBdU5EUTJOVEVnTUM0ek1EWTJOREZNTUM0M016TXhNVEVnTUM0ME9Ua3hOamxhSWlCbWFXeHNQU0ozYUdsMFpTSXZQaVlqZUdFN1BDOW5QaVlqZUdFN1BHUmxabk0rSmlONFlUczhZMnhwY0ZCaGRHZ2dhV1E5SW1Oc2FYQXdYekUzT0RCZk1qVXdOVFVpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9EZ2lJR2hsYVdkb2REMGlNQzQ0T0NJZ1ptbHNiRDBpZDJocGRHVWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0RBdU1EWXdNRFU0TmlBd0xqQTJNREExT0RZcElpOCtKaU40WVRzOEwyTnNhWEJRWVhSb1BpWWplR0U3UEM5a1pXWnpQaVlqZUdFN1BDOXpkbWMrO3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjI1IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSIxNSIgeT0iNzQiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxvYmplY3QgbGFiZWw9IkdDUCBWUEMgKFZpcnR1YWwgUHJpdmF0ZSBDbG91ZCkiIGlyLnNvdXJjZVN0eWxlPSJyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1DRC1HT09HTEUtQ0xPVUQtVlBDO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3WHpFNU5EWmZNalUwTXpjcElqNG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqa3lPVFExTlNBd0xqUTFPVFl5TkV3d0xqYzBPRFkwTWlBd0xqRTBOVEUyTVVNd0xqYzBNVGcwTXlBd0xqRXpNekV3TXlBd0xqY3pNakF4TVNBd0xqRXlNekF6SURBdU56SXdNVEl4SURBdU1URTFPVE01UXpBdU56QTRNak15SURBdU1UQTRPRFE1SURBdU5qazBOamsySURBdU1UQTBPVGczSURBdU5qZ3dPRFUxSURBdU1UQTBOek0yU0RBdU16RTVNVFl4UXpBdU16QTFNekU0SURBdU1UQTBPVGdnTUM0eU9URTNPQ0F3TGpFd09EZ3pPU0F3TGpJM09UZzRPU0F3TGpFeE5Ua3pRekF1TWpZM09UazRJREF1TVRJek1ESXhJREF1TWpVNE1UWTRJREF1TVRNek1EazRJREF1TWpVeE16YzBJREF1TVRRMU1UWXhUREF1TURjd05Ea3lNeUF3TGpRMU9EYzVPVU13TGpBMk16WXhOakVnTUM0ME56QTNOalFnTUM0d05UazVPVGMySURBdU5EZzBNekl6SURBdU1EVTVPVGszTmlBd0xqUTVPREV5TkVNd0xqQTFPVGs1TnpZZ01DNDFNVEU1TWpRZ01DNHdOak0yTVRZeElEQXVOVEkxTkRneklEQXVNRGN3TkRreU15QXdMalV6TnpRME9Vd3dMakkxTVRNd05TQXdMamcxTXpZNU9VTXdMakkxT0RBek1pQXdMamcyTlRrek15QXdMakkyTnpneElEQXVPRGMyTWpFNElEQXVNamM1TmpnNElEQXVPRGd6TlRVMFF6QXVNamt4TlRZM0lEQXVPRGt3T0RreElEQXVNekExTVRReElEQXVPRGsxTURJNUlEQXVNekU1TURreUlEQXVPRGsxTlRZNFNEQXVOamd3TnpnMlF6QXVOamswTnpNMUlEQXVPRGsxTURnNUlEQXVOekE0TXpJeElEQXVPRGt3T1RrNElEQXVOekl3TWpFMUlEQXVPRGd6TmprMVF6QXVOek15TVRBNUlEQXVPRGMyTXpreUlEQXVOelF4T1RBMElEQXVPRFkyTVRJNElEQXVOelE0TmpReUlEQXVPRFV6T1RBMVREQXVPVEk1TkRVMUlEQXVOVE01TkRRelF6QXVPVE0yTXpneElEQXVOVEkzTWpneUlEQXVPVFF3TURJeUlEQXVOVEV6TlRJNElEQXVPVFF3TURJeUlEQXVORGs1TlRNelF6QXVPVFF3TURJeUlEQXVORGcxTlRNNElEQXVPVE0yTXpneElEQXVORGN4TnpnMUlEQXVPVEk1TkRVMUlEQXVORFU1TmpJMFZqQXVORFU1TmpJMFdpSWdabWxzYkQwaUl6UXlPRFZHTkNJdlBpWWplR0U3UEhCaGRHZ2diM0JoWTJsMGVUMGlNQzR3TnlJZ1pEMGlUVEF1TmpZeU5UQTJJREF1TXpNM01UVTRUREF1TlRFNE56UTVJREF1TkRBMk1qVXlUREF1TkRRNU9UazVJREF1TXpNM05UQXlUREF1TXpNM05qWXlJREF1TkRVd016ZzVUREF1TkRFeU5EWXlJREF1TlRJMU1UZzVUREF1TXpNM05USTBJREF1TmpZeU5qZzVUREF1TlRjd05EUTVJREF1T0RrMU5EQTRTREF1Tmpnd056a3pRekF1TmprME56UXlJREF1T0RrME9USTVJREF1TnpBNE16STRJREF1T0Rrd09ETTVJREF1TnpJd01qSXlJREF1T0Rnek5UTTJRekF1TnpNeU1URTJJREF1T0RjMk1qTXpJREF1TnpReE9URXhJREF1T0RZMU9UWTRJREF1TnpRNE5qUTVJREF1T0RVek56UTJUREF1T1RBMU5qQTJJREF1TlRnd05EWTBUREF1TmpZeU5UQTJJREF1TXpNM01UVTRXaUlnWm1sc2JEMGlZbXhoWTJzaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqUXhOelE1TXlBd0xqUXpORGd4TkVnd0xqTTRNekV4T0ZZd0xqVTJPRGczTjBnd0xqUXhOelE1TTFZd0xqUXpORGd4TkZvaUlHWnBiR3c5SW5kb2FYUmxJaTgrSmlONFlUczhjR0YwYUNCa1BTSk5NQzQyTVRZNE16TWdNQzQwTVRnME5UZElNQzQxT0RJME5UaFdNQzQxTmpnME5qbElNQzQyTVRZNE16TldNQzQwTVRnME5UZGFJaUJtYVd4c1BTSjNhR2wwWlNJdlBpWWplR0U3UEhCaGRHZ2daRDBpVFRBdU5UWTJNVEl4SURBdU16Z3pNekF4U0RBdU5ETXpOemMzVmpBdU5ERTNOamMyU0RBdU5UWTJNVEl4VmpBdU16Z3pNekF4V2lJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMalUyTmpFeU1TQXdMalU0TWpVeVNEQXVORE16TnpjM1ZqQXVOakUyT0RrMFNEQXVOVFkyTVRJeFZqQXVOVGd5TlRKYUlpQm1hV3hzUFNKM2FHbDBaU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TkRRME9UWXhJREF1TXpNMU1qQTFTREF1TXpReE9ETTJRekF1TXpNNE1ETTVJREF1TXpNMU1qQTFJREF1TXpNME9UWXhJREF1TXpNNE1qZ3pJREF1TXpNME9UWXhJREF1TXpReU1EaFdNQzQwTkRVeU1EVkRNQzR6TXpRNU5qRWdNQzQwTkRrd01ESWdNQzR6TXpnd016a2dNQzQwTlRJd09DQXdMak0wTVRnek5pQXdMalExTWpBNFNEQXVORFEwT1RZeFF6QXVORFE0TnpVNElEQXVORFV5TURnZ01DNDBOVEU0TXpZZ01DNDBORGt3TURJZ01DNDBOVEU0TXpZZ01DNDBORFV5TURWV01DNHpOREl3T0VNd0xqUTFNVGd6TmlBd0xqTXpPREk0TXlBd0xqUTBPRGMxT0NBd0xqTXpOVEl3TlNBd0xqUTBORGsyTVNBd0xqTXpOVEl3TlZvaUlHWnBiR3c5SW5kb2FYUmxJaTgrSmlONFlUczhjR0YwYUNCa1BTSk5NQzQyTlRnd016VWdNQzR6TXpVeU1EVklNQzQxTlRRNU1VTXdMalUxTVRFeE15QXdMak16TlRJd05TQXdMalUwT0RBek5TQXdMak16T0RJNE15QXdMalUwT0RBek5TQXdMak0wTWpBNFZqQXVORFExTWpBMVF6QXVOVFE0TURNMUlEQXVORFE1TURBeUlEQXVOVFV4TVRFeklEQXVORFV5TURnZ01DNDFOVFE1TVNBd0xqUTFNakE0U0RBdU5qVTRNRE0xUXpBdU5qWXhPRE15SURBdU5EVXlNRGdnTUM0Mk5qUTVNU0F3TGpRME9UQXdNaUF3TGpZMk5Ea3hJREF1TkRRMU1qQTFWakF1TXpReU1EaERNQzQyTmpRNU1TQXdMak16T0RJNE15QXdMalkyTVRnek1pQXdMak16TlRJd05TQXdMalkxT0RBek5TQXdMak16TlRJd05Wb2lJR1pwYkd3OUluZG9hWFJsSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0ME5EUTVOakVnTUM0MU5EZ3pORWd3TGpNME1UZ3pOa013TGpNek9EQXpPU0F3TGpVME9ETTBJREF1TXpNME9UWXhJREF1TlRVeE5ERTRJREF1TXpNME9UWXhJREF1TlRVMU1qRTFWakF1TmpVNE16UkRNQzR6TXpRNU5qRWdNQzQyTmpJeE16Y2dNQzR6TXpnd016a2dNQzQyTmpVeU1UVWdNQzR6TkRFNE16WWdNQzQyTmpVeU1UVklNQzQwTkRRNU5qRkRNQzQwTkRnM05UZ2dNQzQyTmpVeU1UVWdNQzQwTlRFNE16WWdNQzQyTmpJeE16Y2dNQzQwTlRFNE16WWdNQzQyTlRnek5GWXdMalUxTlRJeE5VTXdMalExTVRnek5pQXdMalUxTVRReE9DQXdMalEwT0RjMU9DQXdMalUwT0RNMElEQXVORFEwT1RZeElEQXVOVFE0TXpSYUlpQm1hV3hzUFNKM2FHbDBaU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TmpVNE1ETTFJREF1TlRRNE16UklNQzQxTlRRNU1VTXdMalUxTVRFeE15QXdMalUwT0RNMElEQXVOVFE0TURNMUlEQXVOVFV4TkRFNElEQXVOVFE0TURNMUlEQXVOVFUxTWpFMVZqQXVOalU0TXpSRE1DNDFORGd3TXpVZ01DNDJOakl4TXpjZ01DNDFOVEV4TVRNZ01DNDJOalV5TVRVZ01DNDFOVFE1TVNBd0xqWTJOVEl4TlVnd0xqWTFPREF6TlVNd0xqWTJNVGd6TWlBd0xqWTJOVEl4TlNBd0xqWTJORGt4SURBdU5qWXlNVE0zSURBdU5qWTBPVEVnTUM0Mk5UZ3pORll3TGpVMU5USXhOVU13TGpZMk5Ea3hJREF1TlRVeE5ERTRJREF1TmpZeE9ETXlJREF1TlRRNE16UWdNQzQyTlRnd016VWdNQzQxTkRnek5Gb2lJR1pwYkd3OUluZG9hWFJsSWk4K0ppTjRZVHM4TDJjK0ppTjRZVHM4WkdWbWN6NG1JM2hoT3p4amJHbHdVR0YwYUNCcFpEMGlZMnhwY0RCZk1UazBObDh5TlRRek55SStKaU40WVRzOGNtVmpkQ0IzYVdSMGFEMGlNQzQ0T0NJZ2FHVnBaMmgwUFNJd0xqZzRJaUJtYVd4c1BTSjNhR2wwWlNJZ2RISmhibk5tYjNKdFBTSjBjbUZ1YzJ4aGRHVW9NQzR3TlRrNU9UYzJJREF1TURZd01EVTROaWtpTHo0bUkzaGhPend2WTJ4cGNGQmhkR2crSmlONFlUczhMMlJsWm5NK0ppTjRZVHM4TDNOMlp6ND07dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MDsiIGlkPSI4Ij4KICAgICAgPG14Q2VsbCBzdHlsZT0iaXIucmVmPWFiMjM0OWYyLWE5ZTMtNDc1MS1iNmRjLTZiYTQwZWQ4NGI0Mjtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1sZWZ0O2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT0zO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTM7c291cmNlPWN1c3RvbTtpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1DRC1HT09HTEUtQ0xPVUQtVlBDO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xO2NvbnRhaW5lcj0xO3BlcmltZXRlcj1yZWN0YW5nbGVQZXJpbWV0ZXI7cmVjdXJzaXZlUmVzaXplPTA7c3Ryb2tlV2lkdGg9MTt0ZXh0RGlyZWN0aW9uPWx0cjtzcGFjaW5nVG9wPTE7c3BhY2luZ0xlZnQ9MzI7IiBwYXJlbnQ9IjI1IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICAgIDxteEdlb21ldHJ5IHg9IjEzNiIgeT0iNDQiIHdpZHRoPSI4MDMiIGhlaWdodD0iMjEyIiBhcz0iZ2VvbWV0cnkiLz4KICAgICAgPC9teENlbGw+CiAgICA8L29iamVjdD4KICAgIDxteENlbGwgaWQ9IjE5IiB2YWx1ZT0iR0NQIFJ1biAtJmd0OyBSZWRpcyBTZXJ2ZXIiIHN0eWxlPSJpci5yZWY9NDViNWIzODAtZmNmNC00MDhlLTliN2EtNGUwZWMxZGZjYTNmO2VkZ2VTdHlsZT1ub25lO2N1cnZlZD0xO2h0bWw9MTtpci5zeW5jaHJvbml6ZWQ9MTtleGl0WD0xO2V4aXRZPTAuNzU7ZXhpdER4PTA7ZXhpdER5PTA7ZW50cnlYPTA7ZW50cnlZPTAuNTtlbnRyeUR4PTA7ZW50cnlEeT0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSI4IiBzb3VyY2U9IjkiIHRhcmdldD0iMTEiIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ij4KICAgICAgICA8QXJyYXkgYXM9InBvaW50cyI+CiAgICAgICAgICA8bXhQb2ludCB4PSIzODQiIHk9IjE5NyIvPgogICAgICAgIDwvQXJyYXk+CiAgICAgIDwvbXhHZW9tZXRyeT4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMjAiIHZhbHVlPSJHQ1AgUnVuIC0mZ3Q7IEdDUCBNeVNRTCIgc3R5bGU9ImlyLnJlZj1kNTRiNzg0Yi00YzExLTQxNDAtODQ0MC1hNzQ1ZDRkYmQ3NmM7ZWRnZVN0eWxlPW5vbmU7Y3VydmVkPTE7aHRtbD0xO2lyLnN5bmNocm9uaXplZD0xO2V4aXRYPTE7ZXhpdFk9MC4yNTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MDtlbnRyeVk9MC41O2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW5kQXJyb3c9b3BlbjtlbmRGaWxsPTA7ZW5kU2l6ZT00O3NvdXJjZVBlcmltZXRlclNwYWNpbmc9OTtzdHJva2VDb2xvcj0jQkZCRkJGO3N0cm9rZVdpZHRoPTI7IiBwYXJlbnQ9IjgiIHNvdXJjZT0iOSIgdGFyZ2V0PSIxMCIgZWRnZT0iMSI+CiAgICAgIDxteEdlb21ldHJ5IHJlbGF0aXZlPSIxIiBhcz0iZ2VvbWV0cnkiPgogICAgICAgIDxBcnJheSBhcz0icG9pbnRzIj4KICAgICAgICAgIDxteFBvaW50IHg9IjMwOCIgeT0iNTUiLz4KICAgICAgICA8L0FycmF5PgogICAgICA8L214R2VvbWV0cnk+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjkiIHZhbHVlPSJHQ1AgUnVuIiBzdHlsZT0iaXIucmVmPTFlMjkyMDJiLWI4NzQtNGVkZi04ZWFlLTgzMDk4ZjIyZjgzYTtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1DRC1HT09HTEUtQ0xPVUQtUlVOO2ltYWdlPWRhdGE6aW1hZ2Uvc3ZnK3htbCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlIWnBaWGRDYjNnOUlqQWdNQ0F4SURFaUlHWnBiR3c5SW01dmJtVWlQaVlqZUdFN1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnNhWEF3WHpFM09EQmZNalV3TlRVcElqNG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqTXhPVEl4TWlBd0xqRXdNekF5TjBNd0xqSTVNVEEwTmlBd0xqRXdNelV5TXlBd0xqSTJOVEkxTWlBd0xqRXhPRGt3TnlBd0xqSTFNVFF5TnlBd0xqRTBNelExTVV3d0xqQTNNRFUxTWpRZ01DNDBOVGN3TnpWRE1DNHdOVFkxTmpBMklEQXVORGd4TkRJMUlEQXVNRFUyTlRZd05pQXdMalV4TVRNM05TQXdMakEzTURVMU1qUWdNQzQxTXpVM01qTk1NQzR5TlRFek5UZ2dNQzQ0TlRFNU5qSkRNQzR5TmpVd05ESWdNQzQ0TnpZNE5EY2dNQzR5T1RBM05qWWdNQzQ0T1RJM016WWdNQzR6TVRreE5ESWdNQzQ0T1RNNE16SklNQzQyT0RBNE1qUkRNQzQzTURreE9Ua2dNQzQ0T1RJNE5UWWdNQzQzTXpRNU55QXdMamczTnpBek1TQXdMamMwT0RZM09DQXdMamcxTWpFM1REQXVPVEk1TkRneklEQXVOVE0zTnpFNFF6QXVPVE0yTlRJNUlEQXVOVEkxTXpRNUlEQXVPVFF3TURVeElEQXVOVEV4TlRjNUlEQXVPVFF3TURVeElEQXVORGszT0RGRE1DNDVOREF3TlRFZ01DNDBPRFF3TkRJZ01DNDVNelkxTWprZ01DNDBOekF5TnpJZ01DNDVNamswT0RNZ01DNDBOVGM1TURGTU1DNDNORGcyTnpnZ01DNHhORE0wTlRGRE1DNDNNelE0TkRNZ01DNHhNVGc1TVRZZ01DNDNNRGt3TlRZZ01DNHhNRE0xTXpjZ01DNDJPREE0T1RJZ01DNHhNRE13TWpkSU1DNHpNVGt5TVRKYUlpQm1hV3hzUFNJak5ESTROVVkwSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NE56STVPRGNnTUM0Mk16VTROakZNTUM0M05EZzJOVFFnTUM0NE5USXdPVGRETUM0M016UTVORFlnTUM0NE56WTVOVGtnTUM0M01Ea3hOellnTUM0NE9USTNPRE1nTUM0Mk9EQTRJREF1T0Rrek56VTVTREF1TlRRek1ETTVUREF1TXpReU1EUXhJREF1Tmprd09UWXpUREF1TkRBeE1qazFJREF1TkRrNU9EazJUREF1TXpReU1EUXhJREF1TXpBMk5qUXhUREF1TkRBeU9UQXlJREF1TXpRM05USXlUREF1TkRnME56TTBJREF1TkRNd01EZzRUREF1TkRRMk5URWdNQzR6TURZMk5ERk1NQzQzTXpNeE1USWdNQzQwT1RreE5qZE1NQzQ0TnpJNU9EY2dNQzQyTXpVNE5qRmFJaUJtYVd4c1BTSmliR0ZqYXlJZ1ptbHNiQzF2Y0dGamFYUjVQU0l3TGpBM0lpOCtKaU40WVRzOGNHRjBhQ0JrUFNKTk1DNHpOREl3TkRFZ01DNHpNRFkyTkRKTU1DNDBNREk1TURJZ01DNHpORGMxTWpWTU1DNDBOVEEyTVNBd0xqVXdNRGxNTUM0ME1ETTNOVEVnTUM0Mk5EazJOamRNTUM0ek5ESXdOREVnTUM0Mk9UQTVOalpNTUM0ME1ERTJOVFlnTUM0ME9Ua3hOamhNTUM0ek5ESXdOREVnTUM0ek1EWTJOREphVFRBdU5EazNPVEl5SURBdU16YzBPREk0VERBdU5USTNORFU0SURBdU5EY3dNell5U0RBdU5qUXdPRFU0VERBdU5EazNPVEl5SURBdU16YzBPREk0V2swd0xqY3pNekV4TVNBd0xqUTVPVEUyT1V3d0xqUTBOalV4SURBdU5qa3dPVFkxVERBdU5UQTJNVEkwSURBdU5EazVNVFk1VERBdU5EUTJOVEVnTUM0ek1EWTJOREZNTUM0M016TXhNVEVnTUM0ME9Ua3hOamxhSWlCbWFXeHNQU0ozYUdsMFpTSXZQaVlqZUdFN1BDOW5QaVlqZUdFN1BHUmxabk0rSmlONFlUczhZMnhwY0ZCaGRHZ2dhV1E5SW1Oc2FYQXdYekUzT0RCZk1qVXdOVFVpUGlZamVHRTdQSEpsWTNRZ2QybGtkR2c5SWpBdU9EZ2lJR2hsYVdkb2REMGlNQzQ0T0NJZ1ptbHNiRDBpZDJocGRHVWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0RBdU1EWXdNRFU0TmlBd0xqQTJNREExT0RZcElpOCtKaU40WVRzOEwyTnNhWEJRWVhSb1BpWWplR0U3UEM5a1pXWnpQaVlqZUdFN1BDOXpkbWMrO3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjgiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjcxIiB5PSI1OSIgd2lkdGg9IjkwIiBoZWlnaHQ9IjkwIiBhcz0iZ2VvbWV0cnkiLz4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMTciIHZhbHVlPSJHQ1AgTXlTUUwgLSZndDsgR0NQIFJ1biIgc3R5bGU9ImlyLnJlZj05NDc1MTdhMy03ZGU4LTQ5NjAtOThjYS1kOGUwMWEwYmQ1M2Y7ZWRnZVN0eWxlPW5vbmU7Y3VydmVkPTE7aHRtbD0xO2lyLnN5bmNocm9uaXplZD0xO2V4aXRYPTA7ZXhpdFk9MC43NTtleGl0RHg9MDtleGl0RHk9MDtlbmRBcnJvdz1vcGVuO2VuZEZpbGw9MDtlbmRTaXplPTQ7c291cmNlUGVyaW1ldGVyU3BhY2luZz05O3N0cm9rZUNvbG9yPSNCRkJGQkY7c3Ryb2tlV2lkdGg9MjsiIHBhcmVudD0iOCIgc291cmNlPSIxMCIgdGFyZ2V0PSI5IiBlZGdlPSIxIj4KICAgICAgPG14R2VvbWV0cnkgcmVsYXRpdmU9IjEiIGFzPSJnZW9tZXRyeSI+CiAgICAgICAgPEFycmF5IGFzPSJwb2ludHMiPgogICAgICAgICAgPG14UG9pbnQgeD0iMzAxIiB5PSI3NiIvPgogICAgICAgIDwvQXJyYXk+CiAgICAgIDwvbXhHZW9tZXRyeT4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMTAiIHZhbHVlPSJHQ1AgTXlTUUwiIHN0eWxlPSJpci5yZWY9OWZhMmMwNGYtYzMyOS00Y2Y3LThjY2UtN2M2Y2I3NjI1OTg1O3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPWdvb2dsZS1teXNxbDtpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1T1Rjek1qRTFJREF1TkRZeU5UQXpUREF1Tnpjek9UY3pJREF1TVRFd05qWkRNQzQzTmpZME9DQXdMakE1TnpFMk9ESWdNQzQzTlRVMk5EWWdNQzR3T0RVNE9UYzNJREF1TnpReU5UUTFJREF1TURjM09UWTBORU13TGpjeU9UUTBNeUF3TGpBM01EQXpNVEVnTUM0M01UUTFNamdnTUM0d05qVTNNVEF6SURBdU5qazVNamMySURBdU1EWTFOREk1TjBnd0xqTXdNRGN4TmtNd0xqSTROVFEyTWlBd0xqQTJOVGN3TWpZZ01DNHlOekExTkRRZ01DNHdOekF3TWpBeklEQXVNalUzTkRReElEQXVNRGMzT1RVME0wTXdMakkwTkRNek9DQXdMakE0TlRnNE9EUWdNQzR5TXpNMU1EWWdNQzR3T1RjeE5qTXhJREF1TWpJMk1ERTVJREF1TVRFd05qWk1NQzR3TWpZM01ERXlJREF1TkRZeE5UaERNQzR3TVRreE1qUXhJREF1TkRjME9UWTNJREF1TURFMU1UTTJOeUF3TGpRNU1ERXpPQ0F3TGpBeE5URXpOamNnTUM0MU1EVTFOemxETUM0d01UVXhNelkzSURBdU5USXhNRElnTUM0d01Ua3hNalF4SURBdU5UTTJNVGt4SURBdU1ESTJOekF4TWlBd0xqVTBPVFUzT1V3d0xqSXlOVGswTXlBd0xqa3dNelF5TWtNd0xqSXpNek0xTmlBd0xqa3hOekV4SURBdU1qUTBNVE14SURBdU9USTROakU0SURBdU1qVTNNaklnTUM0NU16WTRNalpETUM0eU56QXpNRGtnTUM0NU5EVXdNelVnTUM0eU9EVXlOamNnTUM0NU5EazJOalVnTUM0ek1EQTJOQ0F3TGprMU1ESTJOMGd3TGpZNU9USkRNQzQzTVRRMU56RWdNQzQ1TkRrM016SWdNQzQzTWprMU5ERWdNQzQ1TkRVeE5UVWdNQzQzTkRJMk5EZ2dNQzQ1TXpZNU9EUkRNQzQzTlRVM05UUWdNQzQ1TWpnNE1UTWdNQzQzTmpZMU5EZ2dNQzQ1TVRjek1qZ2dNQzQzTnpNNU56TWdNQzQ1TURNMk5UTk1NQzQ1TnpNeU1UVWdNQzQxTlRFNE1VTXdMams0TURnME55QXdMalV6T0RJd015QXdMams0TkRnMklEQXVOVEl5T0RFMUlEQXVPVGcwT0RZZ01DNDFNRGN4TlRaRE1DNDVPRFE0TmlBd0xqUTVNVFE1T0NBd0xqazRNRGcwTnlBd0xqUTNOakV3T1NBd0xqazNNekl4TlNBd0xqUTJNalV3TTFZd0xqUTJNalV3TTFvaUlHWnBiR3c5SWlNME1qZzFSalFpTHo0bUkzaGhPenh0WVhOcklHbGtQU0p0WVhOck1DSWdiV0Z6YXkxMGVYQmxQU0poYkhCb1lTSWdiV0Z6YTFWdWFYUnpQU0oxYzJWeVUzQmhZMlZQYmxWelpTSWdlRDBpTUNJZ2VUMGlNQ0lnZDJsa2RHZzlJakVpSUdobGFXZG9kRDBpTVNJK0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0NU56TXpNemdnTUM0ME5qSTFNRE5NTUM0M056UXdPVFlnTUM0eE1UQTJOa013TGpjMk5qWXdNeUF3TGpBNU56RTJPRElnTUM0M05UVTNOeUF3TGpBNE5UZzVOemNnTUM0M05ESTJOamdnTUM0d056YzVOalEwUXpBdU56STVOVFkySURBdU1EY3dNRE14TVNBd0xqY3hORFkxTVNBd0xqQTJOVGN4TURNZ01DNDJPVGt6T1RrZ01DNHdOalUwTWprM1NEQXVNekF3T0RNNFF6QXVNamcxTlRnMUlEQXVNRFkxTnpBeU5pQXdMakkzTURZMk55QXdMakEzTURBeU1ETWdNQzR5TlRjMU5qUWdNQzR3TnpjNU5UUXpRekF1TWpRME5EWXhJREF1TURnMU9EZzROQ0F3TGpJek16WXlPQ0F3TGpBNU56RTJNekVnTUM0eU1qWXhOREVnTUM0eE1UQTJOa3d3TGpBeU5qZ3lNeklnTUM0ME5qRTFPRU13TGpBeE9USTBOaklnTUM0ME56UTVOamNnTUM0d01UVXlOVGc0SURBdU5Ea3dNVE00SURBdU1ERTFNalU0T0NBd0xqVXdOVFUzT1VNd0xqQXhOVEkxT0RnZ01DNDFNakV3TWlBd0xqQXhPVEkwTmpJZ01DNDFNell4T1RFZ01DNHdNalk0TWpNeUlEQXVOVFE1TlRjNVREQXVNakkyTURZMklEQXVPVEF6TkRJeVF6QXVNak16TkRjNUlEQXVPVEUzTVRFZ01DNHlORFF5TlRNZ01DNDVNamcyTVRnZ01DNHlOVGN6TkRJZ01DNDVNelk0TWpaRE1DNHlOekEwTXpFZ01DNDVORFV3TXpVZ01DNHlPRFV6T1NBd0xqazBPVFkyTlNBd0xqTXdNRGMyTXlBd0xqazFNREkyTjBnd0xqWTVPVE15TTBNd0xqY3hORFk1TkNBd0xqazBPVGN6TWlBd0xqY3lPVFkyTkNBd0xqazBOVEUxTlNBd0xqYzBNamMzTVNBd0xqa3pOams0TkVNd0xqYzFOVGczTnlBd0xqa3lPRGd4TXlBd0xqYzJOalkzTVNBd0xqa3hOek15T0NBd0xqYzNOREE1TmlBd0xqa3dNelkxTTB3d0xqazNNek16T0NBd0xqVTFNVGd4UXpBdU9UZ3dPVGNnTUM0MU16Z3lNRE1nTUM0NU9EUTVPRE1nTUM0MU1qSTRNVFVnTUM0NU9EUTVPRE1nTUM0MU1EY3hOVFpETUM0NU9EUTVPRE1nTUM0ME9URTBPVGdnTUM0NU9EQTVOeUF3TGpRM05qRXdPU0F3TGprM016TXpPQ0F3TGpRMk1qVXdNMVl3TGpRMk1qVXdNMW9pSUdacGJHdzlJaU0wTWpnMVJqUWlMejRtSTNoaE96d3ZiV0Z6YXo0bUkzaGhPenhuSUcxaGMyczlJblZ5YkNnamJXRnphekFwSWo0bUkzaGhPenh3WVhSb0lHOXdZV05wZEhrOUlqQXVNRGNpSUdROUlrMHdMalV3TlRFd01pQXdMakl5TVRFNU1Vd3dMalkxTVRVME1TQXdMakkzTWpFNU1Vd3dMams0TURBeU5pQXdMall3TlRrMU4wd3dMamMwTWpRMUlEQXVPVFl3TkRFMVREQXVNelE0TlRFeElEQXVOVFV4T1RVM1REQXVORFF3TnpBNElEQXVOVFF3TkRFNVREQXVNelE1TnprNUlEQXVORFE0TVRFeVREQXVORFEyT1RrMklEQXVORE00TkRrM1REQXVNelV3TVRBeUlEQXVNelF3TVRFelREQXVOVEExTVRBeUlEQXVNakl4TVRreFdpSWdabWxzYkQwaVlteGhZMnNpTHo0bUkzaGhPenh3WVhSb0lHUTlJazB3TGpVd01EQXlOaUF3TGpFNE1qZzJNVXd3TGpNME9EVXhNU0F3TGpJM01UY3dOMVl3TGpNME1ETTVPRXd3TGpVd01EQXlOaUF3TGpReU9URTJOMHd3TGpZMU1UVTBNU0F3TGpNME1ETTVPRll3TGpJM01UY3dOMHd3TGpVd01EQXlOaUF3TGpFNE1qZzJNVnBOTUM0MU9UQTFOVFlnTUM0ek1EVXdNVFJNTUM0MU1EQXdNallnTUM0ek5UZ3dNVE5NTUM0ME1EazFOekVnTUM0ek1EVXdNVFJNTUM0MU1EQXdNallnTUM0eU5URTVNemhNTUM0MU9UQTBPQ0F3TGpNd05Ea3pOMHd3TGpVNU1EVTFOaUF3TGpNd05UQXhORm9pSUdacGJHdzlJbmRvYVhSbElpOCtKaU40WVRzOGNHRjBhQ0JrUFNKTk1DNHpORGcxTVRFZ01DNHpOemt4TlZZd0xqUTBOemcwTWt3d0xqVXdNREF5TmlBd0xqVXpOalk0TjB3d0xqWTFNVFUwTVNBd0xqUTBOemcwTWxZd0xqTTNPVEUxVERBdU5UQXdNREkySURBdU5EWTNPVGsyVERBdU16UTROVEV4SURBdU16YzVNVFZhSWlCbWFXeHNQU0ozYUdsMFpTSXZQaVlqZUdFN1BIQmhkR2dnWkQwaVRUQXVNelE0TlRFeElEQXVORGd6TVRVMFZqQXVOVFV4T0RRMlREQXVOVEF3TURJMklEQXVOalF3TmpreFREQXVOalV4TlRReElEQXVOVFV4T0RRMlZqQXVORGd6TVRVMFREQXVOVEF3TURJMklEQXVOVGN5VERBdU16UTROVEV4SURBdU5EZ3pNVFUwV2lJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96eHlaV04wSUhnOUlqQXVNamN5TURrMUlpQjVQU0l3TGpZNU5EVTRJaUIzYVdSMGFEMGlNQzQwTlRVM05UY2lJR2hsYVdkb2REMGlNQzR4TnpjeU1qa2lJSEo0UFNJd0xqQTRPRFl4TkRVaUlHWnBiR3c5SW1Kc1lXTnJJaUJtYVd4c0xXOXdZV05wZEhrOUlqQXVOU0l2UGlZamVHRTdQSEJoZEdnZ1pEMGlUVEF1TXpRd09UQXlJREF1TnpNNE56QXpUREF1TXpZME56WTJJREF1T0RBek1EZzNUREF1TXpnNE5UY3lJREF1TnpNNE56QXpTREF1TkRBM01UVXlWakF1T0RJeU56QXlTREF1TXpreU9ETTBWakF1TnprMU1ERk1NQzR6T1RReU5UUWdNQzQzTlRjNU56Sk1NQzR6TmprNE1qSWdNQzQ0TWpJM01ESklNQzR6TlRrMU16aE1NQzR6TXpVeE5qTWdNQzQzTlRnd01qbE1NQzR6TXpZMU9EUWdNQzQzT1RVd01WWXdMamd5TWpjd01rZ3dMak15TWpJMk5sWXdMamN6T0Rjd00wZ3dMak0wTURrd01sb2lJR1pwYkd3OUluZG9hWFJsSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0ME5EUXpOamdnTUM0NE1ESTJNalZNTUM0ME5UWTROamdnTUM0M05qQXlOemxJTUM0ME56RTFPRE5NTUM0ME5EY3hOVElnTUM0NE16SXhOak5ETUM0ME5ETTBNRElnTUM0NE5ESTJOak1nTUM0ME16Y3dNemdnTUM0NE5EYzVNVE1nTUM0ME1qZ3dOakVnTUM0NE5EYzVNVE5ETUM0ME1qWXdOVE1nTUM0NE5EYzVNVE1nTUM0ME1qTTRNemNnTUM0NE5EYzFOamNnTUM0ME1qRTBNVE1nTUM0NE5EWTROelZXTUM0NE16WXdNamxNTUM0ME1qUXdNamNnTUM0NE16WXlNREpETUM0ME1qYzFNVElnTUM0NE16WXlNRElnTUM0ME16QXhNalVnTUM0NE16VTFORGdnTUM0ME16RTROamdnTUM0NE16UXlORU13TGpRek16WTBPQ0F3TGpnek1qazNNU0F3TGpRek5UQTBPU0F3TGpnek1EZ3hOeUF3TGpRek5qQTNNaUF3TGpneU56YzNPVXd3TGpRek9EQTJNU0F3TGpneU1qUXhNMHd3TGpReE5qUTNJREF1TnpZd01qYzVTREF1TkRNeE16VTJUREF1TkRRME16WTRJREF1T0RBeU5qSTFXaUlnWm1sc2JEMGlkMmhwZEdVaUx6NG1JM2hoT3p4d1lYUm9JR1E5SWswd0xqVXlOREUwSURBdU9EQXhNRFkzUXpBdU5USTBNVFFnTUM0M09UY3pOelVnTUM0MU1qSTROVElnTUM0M09UUTFNamtnTUM0MU1qQXlOemNnTUM0M09USTFNamxETUM0MU1UYzNNemtnTUM0M09UQTFNamtnTUM0MU1UTXhNellnTUM0M09EZzFNU0F3TGpVd05qUTNJREF1TnpnMk5EY3hRekF1TkRrNU9EQXpJREF1TnpnME5ETXpJREF1TkRrME5TQXdMamM0TWpFMk5DQXdMalE1TURVMk1TQXdMamMzT1RZMk5FTXdMalE0TXpBeU15QXdMamMzTkRnMU5pQXdMalEzT1RJMU5DQXdMamMyT0RVNE55QXdMalEzT1RJMU5DQXdMamMyTURnMU5rTXdMalEzT1RJMU5DQXdMamMxTkRBNE55QXdMalE0TVRrMk1pQXdMamMwT0RVeElEQXVORGczTXpjNUlEQXVOelEwTVRJMlF6QXVORGt5T0RNeklEQXVOek01TnpReElEQXVORGs1T0RrNElEQXVOek0zTlRRNUlEQXVOVEE0TlRjeUlEQXVOek0zTlRRNVF6QXVOVEUwTXpNZ01DNDNNemMxTkRrZ01DNDFNVGswTmpJZ01DNDNNemcyTWpZZ01DNDFNak01TnlBd0xqYzBNRGM0UXpBdU5USTRORGMzSURBdU56UXlPVE16SURBdU5UTXlNREU1SURBdU56UTJNREVnTUM0MU16UTFPVFVnTUM0M05UQXdNVU13TGpVek56RTNJREF1TnpVek9UY3lJREF1TlRNNE5EVTRJREF1TnpVNE16YzJJREF1TlRNNE5EVTRJREF1TnpZek1qSXlTREF1TlRJME1UUkRNQzQxTWpReE5DQXdMamMxT0Rnek55QXdMalV5TWpjM055QXdMamMxTlRReE5DQXdMalV5TURBME9TQXdMamMxTWprMU0wTXdMalV4TnpNMklEQXVOelV3TkRVeklEQXVOVEV6TkRrMklEQXVOelE1TWpBeklEQXVOVEE0TkRVNElEQXVOelE1TWpBelF6QXVOVEF6TnpZeElEQXVOelE1TWpBeklEQXVOVEF3TVRBMklEQXVOelV3TWpJeUlEQXVORGszTkRreUlEQXVOelV5TWpaRE1DNDBPVFE1TVRjZ01DNDNOVFF5T1RrZ01DNDBPVE0yTWprZ01DNDNOVGN4TkRVZ01DNDBPVE0yTWprZ01DNDNOakEzT1RsRE1DNDBPVE0yTWprZ01DNDNOak00TnpZZ01DNDBPVFV3TXlBd0xqYzJOalExTWlBd0xqUTVOemd6TXlBd0xqYzJPRFV5T1VNd0xqVXdNRFl6TmlBd0xqYzNNRFUyT0NBd0xqVXdOVEkxT0NBd0xqYzNNalUyT0NBd0xqVXhNVFk1TnlBd0xqYzNORFV5T1VNd0xqVXhPREV6TmlBd0xqYzNOalExTWlBd0xqVXlNek13TnlBd0xqYzNPRFkyTkNBd0xqVXlOekl3T0NBd0xqYzRNVEUyTkVNd0xqVXpNVEV4SURBdU56Z3pOakkxSURBdU5UTXpPVGNnTUM0M09EWTBOekVnTUM0MU16VTNPRGdnTUM0M09EazNNREpETUM0MU16YzJNRFlnTUM0M09USTRPVFFnTUM0MU16ZzFNVFVnTUM0M09UWTJORFFnTUM0MU16ZzFNVFVnTUM0NE1EQTVOVEpETUM0MU16ZzFNVFVnTUM0NE1EYzVOVElnTUM0MU16VTROalFnTUM0NE1UTTFNamtnTUM0MU16QTFOakVnTUM0NE1UYzJPRE5ETUM0MU1qVXlPVFVnTUM0NE1qRTNPVGdnTUM0MU1UZ3hNellnTUM0NE1qTTROVFlnTUM0MU1Ea3dPRE1nTUM0NE1qTTROVFpETUM0MU1ETXdPVGtnTUM0NE1qTTROVFlnTUM0ME9UYzFPRGNnTUM0NE1qSTNOQ0F3TGpRNU1qVTBPU0F3TGpneU1EVXhRekF1TkRnM05UUTVJREF1T0RFNE1qUWdNQzQwT0RNMk5EZ2dNQzQ0TVRVeE1qVWdNQzQwT0RBNE5EVWdNQzQ0TVRFeE5qUkRNQzQwTnpnd09DQXdMamd3TnpJd01pQXdMalEzTmpZNU55QXdMamd3TWpVNE55QXdMalEzTmpZNU55QXdMamM1TnpNeE4wZ3dMalE1TVRBM01rTXdMalE1TVRBM01pQXdMamd3TWpBNE55QXdMalE1TWpZeU5TQXdMamd3TlRjM09TQXdMalE1TlRjek1TQXdMamd3T0RNNU5FTXdMalE1T0Rnek55QXdMamd4TVRBeElEQXVOVEF6TWpnNElEQXVPREV5TXpFM0lEQXVOVEE1TURneklEQXVPREV5TXpFM1F6QXVOVEUwTURneklEQXVPREV5TXpFM0lEQXVOVEUzT0RNeklEQXVPREV4TWprNElEQXVOVEl3TXpNeklEQXVPREE1TWpaRE1DNDFNakk0TnpFZ01DNDRNRGN4T0RNZ01DNDFNalF4TkNBd0xqZ3dORFExTWlBd0xqVXlOREUwSURBdU9EQXhNRFkzV2lJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96eHdZWFJvSUdROUlrMHdMall4TmpnMk55QXdMamM0TWpnNU5VTXdMall4TmpnMk55QXdMamM1TURnMU5pQXdMall4TlRZeE55QXdMamM1TnpjMklEQXVOakV6TVRFM0lEQXVPREF6TmpBMlF6QXVOakV3TmpVMUlEQXVPREE1TkRFMElEQXVOakEzTVRnNUlEQXVPREUwTURJNUlEQXVOakF5TnpJZ01DNDRNVGMwTlRKTU1DNDJNVFk1TWpRZ01DNDRNamczTURKTU1DNDJNRGMyTURZZ01DNDRNemN5TkV3d0xqVTRPVGs1TWlBd0xqZ3lNekV3TmtNd0xqVTROelk0TWlBd0xqZ3lNell3TmlBd0xqVTROVEl3TVNBd0xqZ3lNemcxTmlBd0xqVTRNalUwT1NBd0xqZ3lNemcxTmtNd0xqVTNOVGc0TWlBd0xqZ3lNemcxTmlBd0xqVTJPVGt4TnlBd0xqZ3lNakl3TWlBd0xqVTJORFkxTVNBd0xqZ3hPRGc1TkVNd0xqVTFPVFF5TkNBd0xqZ3hOVFUwT0NBd0xqVTFOVE0zTVNBd0xqZ3hNRGM1T0NBd0xqVTFNalE1TWlBd0xqZ3dORFkwTkVNd0xqVTBPVFkxTVNBd0xqYzVPRFE1TVNBd0xqVTBPREl4TWlBd0xqYzVNVE01TkNBd0xqVTBPREUzTkNBd0xqYzRNek0xTmxZd0xqYzNPRFl5TlVNd0xqVTBPREUzTkNBd0xqYzNNRFF6TXlBd0xqVTBPVFU1TlNBd0xqYzJNekl3TWlBd0xqVTFNalF6TmlBd0xqYzFOamt6TTBNd0xqVTFOVE14TkNBd0xqYzFNRFkyTkNBd0xqVTFPVE0wT0NBd0xqYzBOVGczTmlBd0xqVTJORFV6T0NBd0xqYzBNalUyT0VNd0xqVTJPVGMyTlNBd0xqY3pPVEl5TWlBd0xqVTNOVGN6TVNBd0xqY3pOelUwT1NBd0xqVTRNalF6TlNBd0xqY3pOelUwT1VNd0xqVTRPVEkxTkNBd0xqY3pOelUwT1NBd0xqVTVOVEkxTnlBd0xqY3pPVEl3TXlBd0xqWXdNRFEwTnlBd0xqYzBNalV4UXpBdU5qQTFOamMwSURBdU56UTFOemdnTUM0Mk1EazNNRGdnTUM0M05UQTFNU0F3TGpZeE1qVTBPU0F3TGpjMU5qY3dNa013TGpZeE5UTTVJREF1TnpZeU9EVTJJREF1TmpFMk9ESTVJREF1Tnpjd01ESTVJREF1TmpFMk9EWTNJREF1TnpjNE1qSXlWakF1TnpneU9EazFXazB3TGpZd01qUXpOU0F3TGpjM09EVXhRekF1TmpBeU5ETTFJREF1TnpZNU1EUTVJREF1TmpBd05qa3pJREF1TnpZeE9EYzJJREF1TlRrM01qQTRJREF1TnpVMk9Ua3hRekF1TlRrek56SXpJREF1TnpVeU1UQTJJREF1TlRnNE56azVJREF1TnpRNU5qWTBJREF1TlRneU5ETTFJREF1TnpRNU5qWTBRekF1TlRjMk1qWXhJREF1TnpRNU5qWTBJREF1TlRjeE5ERXpJREF1TnpVeU1UUTFJREF1TlRZM09Ea2dNQzQzTlRjeE1EWkRNQzQxTmpRME1EVWdNQzQzTmpJd01qa2dNQzQxTmpJMk1qVWdNQzQzTmpnNU9URWdNQzQxTmpJMU5Ea2dNQzQzTnpjNU9URldNQzQzT0RJNE9UVkRNQzQxTmpJMU5Ea2dNQzQzT1RFNU56RWdNQzQxTmpReU9USWdNQzQzT1Rrd05qY2dNQzQxTmpjM056WWdNQzQ0TURReE9ETkRNQzQxTnpFeU9Ua2dNQzQ0TURreU9UZ2dNQzQxTnpZeU1qTWdNQzQ0TVRFNE5UWWdNQzQxT0RJMU5Ea2dNQzQ0TVRFNE5UWkRNQzQxT0RnNU5URWdNQzQ0TVRFNE5UWWdNQzQxT1RNNE5UWWdNQzQ0TURrek9UUWdNQzQxT1RjeU5qVWdNQzQ0TURRME56RkRNQzQyTURBM01USWdNQzQzT1RrMU5EZ2dNQzQyTURJME16VWdNQzQzT1RJek5UWWdNQzQyTURJME16VWdNQzQzT0RJNE9UVldNQzQzTnpnMU1Wb2lJR1pwYkd3OUluZG9hWFJsSWk4K0ppTjRZVHM4Y0dGMGFDQmtQU0pOTUM0Mk5EVTRORFFnTUM0NE1URXdORGhJTUM0Mk9ETTBNREZXTUM0NE1qSTNNREpJTUM0Mk16RTBOamxXTUM0M016ZzNNRE5JTUM0Mk5EVTRORFJXTUM0NE1URXdORGhhSWlCbWFXeHNQU0ozYUdsMFpTSXZQaVlqZUdFN1BDOW5QaVlqZUdFN1BDOXpkbWMrO3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjgiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjQ1NyIgeT0iMTQiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjE4IiB2YWx1ZT0iUmVkaXMgU2VydmVyIC0mZ3Q7IEdDUCBSdW4iIHN0eWxlPSJpci5yZWY9ZjFkZjE0OWItN2JlMS00YWFmLTk1MTctYTcwN2ZlNmE3NjdlO2VkZ2VTdHlsZT1ub25lO2N1cnZlZD0xO2h0bWw9MTtpci5zeW5jaHJvbml6ZWQ9MTtleGl0WD0wO2V4aXRZPTAuMjU7ZXhpdER4PTA7ZXhpdER5PTA7ZW50cnlYPTE7ZW50cnlZPTAuNTtlbnRyeUR4PTA7ZW50cnlEeT0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSI4IiBzb3VyY2U9IjExIiB0YXJnZXQ9IjkiIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ij4KICAgICAgICA8QXJyYXkgYXM9InBvaW50cyI+CiAgICAgICAgICA8bXhQb2ludCB4PSIzOTIiIHk9IjE3OSIvPgogICAgICAgIDwvQXJyYXk+CiAgICAgIDwvbXhHZW9tZXRyeT4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMTEiIHZhbHVlPSJSZWRpcyBTZXJ2ZXIiIHN0eWxlPSJpci5yZWY9ZmQ1MDcwMWItZTEzZS00NGM0LWE0ODMtNjNhOGNkMGM4NDM5O3JvdW5kZWQ9MTt3aGl0ZVNwYWNlPXdyYXA7aHRtbD0xO2FsaWduPWNlbnRlcjtpbWFnZUFsaWduPWNlbnRlcjtpbWFnZVdpZHRoPTgyO2ltYWdlSGVpZ2h0PTgyO2FyY1NpemU9OTA7YWJzb2x1dGVBcmNTaXplPTE7c3Ryb2tlQ29sb3I9IzIwQzlFMztmaWxsQ29sb3I9I0UzRkNGQztmb250Q29sb3I9IzAwODRBRDtmb250U2l6ZT0xMjtzb3VyY2U9aXJpdXNyaXNrO2lyLnR5cGU9Q09NUE9ORU5UO2lyLmNvbXBvbmVudERlZmluaXRpb24ucmVmPXJlZGlzLXNlcnZlcjtpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQSE4wZVd4bFBpWWplR0U3SUNBZ0lDNXBZMjl1TFdacGJHd2dleVlqZUdFN0lDQWdJQ0FnSUNCbWFXeHNPaUFqTVRGQk9FTkdPeVlqZUdFN0lDQWdJSDBtSTNoaE96d3ZjM1I1YkdVK0ppTjRZVHM4WnlCamJHbHdMWEJoZEdnOUluVnliQ2dqWTJ4cGNEQXBJajRtSTNoaE96eHdZWFJvSUdacGJHd3RjblZzWlQwaVpYWmxibTlrWkNJZ1kyeHBjQzF5ZFd4bFBTSmxkbVZ1YjJSa0lpQmtQU0pOTUM0NE16azJOamdnTUM0eU5EYzVOVFpETUM0NE16azJOamdnTUM0ek5EQTNOellnTUM0Mk9EYzBNek1nTUM0ME1UVTVOVFlnTUM0ME9UazJOamdnTUM0ME1UVTVOVFpETUM0ek1URTVNRE1nTUM0ME1UVTVOVFlnTUM0eE5UazJOamdnTUM0ek5EQTNOellnTUM0eE5UazJOamdnTUM0eU5EYzVOVFpETUM0eE5UazJOamdnTUM0eE5UVXhNellnTUM0ek1URTVNRE1nTUM0d056azVOVFl4SURBdU5EazVOalk0SURBdU1EYzVPVFUyTVVNd0xqWTROelF6TXlBd0xqQTNPVGsxTmpFZ01DNDRNemsyTmpnZ01DNHhOVFV4TXpZZ01DNDRNemsyTmpnZ01DNHlORGM1TlRaYVRUQXVPRE01TmpZNElEQXVNemMyTVRneVF6QXVPREU0TVRnMklEQXVNemswT0RVM0lEQXVOemswTWpreElEQXVOREV3TmpNeklEQXVOelk0TmpBNElEQXVOREl6TURrMlF6QXVOamsyTkRReklEQXVORFU0TnpFeUlEQXVOakF4TXpJNElEQXVORGM0T1RVMklEQXVORGs1TmpZNElEQXVORGM0T1RVMlF6QXVNems0TURBNElEQXVORGM0T1RVMklEQXVNekF5T0RreklEQXVORFU0TnpFeUlEQXVNak13TnpJNElEQXVOREl6TURrMlF6QXVNakExTURRMklEQXVOREV3TmpNeklEQXVNVGd4TVRVZ01DNHpPVFE0TlRjZ01DNHhOVGsyTmpnZ01DNHpOell4T0RKV01DNDNOVEU1TlRaRE1DNHhOVGsyTmpnZ01DNDRORFEzTnpZZ01DNHpNVEU1TURNZ01DNDVNVGs1TlRZZ01DNDBPVGsyTmpnZ01DNDVNVGs1TlRaRE1DNDJPRGMwTXpNZ01DNDVNVGs1TlRZZ01DNDRNemsyTmpnZ01DNDRORFEzTnpZZ01DNDRNemsyTmpnZ01DNDNOVEU1TlRaV01DNHpOell4T0RKYVRUQXVOREF4T1RFNUlEQXVOamc0TlRVM1F6QXVNelk1TXpBeklEQXVOamMxTURVNElEQXVNek0xT1RRNElEQXVOall4TWpVMElEQXVNekkxT0RNM0lEQXVOalUyTkRJMVF6QXVNekUyTURRZ01DNDJOVEUyTnpVZ01DNHpNVEEwSURBdU5qUTNPREUxSURBdU16QTVPREEySURBdU5qUTBNalV6VmpBdU5qQTJOVFZJTUM0ek1UQTBRekF1TXpFd05DQXdMall3TWpZNUlEQXVNekUxTnpReklEQXVOVGs1TkRJMUlEQXVNekkxTWpReklEQXVOVGsxTlRZMVF6QXVNelEwT0RNM0lEQXVOVGczT0RRM0lEQXVORFV6TnpreElEQXVOVFExTURrMklEQXVORGMyT1RRM0lEQXVOVE0yTnpnMFF6QXVOVEF3TVRBeklEQXVOVEk0TkRjeElEQXVOVEE0TVRFNUlEQXVOVEk0TVRjMUlEQXVOVEkzTnpFeUlEQXVOVE0xTTBNd0xqVXpOakkyTXlBd0xqVXpPRFV6T0NBd0xqVTJNRFkwTlNBd0xqVTBPREV4SURBdU5UZzNNREUySURBdU5UVTRORFl5UXpBdU5qSXhNRGN6SURBdU5UY3hPRE14SURBdU5qVTRORFExSURBdU5UZzJOVEF6SURBdU5qWTVNekl4SURBdU5Ua3dOVEU0UXpBdU5qYzVNVEU0SURBdU5UazBNRGd4SURBdU5qZzBNVFkxSURBdU5UazNNelEySURBdU5qZzBNVFkxSURBdU5qQXhNakEyVmpBdU5qTTRNekUxUXpBdU5qZzBNVFkxSURBdU5qUXhPRGM0SURBdU5qYzVOekV5SURBdU5qUTJNRE0wSURBdU5qWTVOakU1SURBdU5qVXhNemM0UXpBdU5qWXdNRE01SURBdU5qVTJNemd5SURBdU5qTXhNVEV5SURBdU5qWTROelV6SURBdU5qQXhNalFnTUM0Mk9ERTFNamhETUM0MU5qa3dPRFVnTUM0Mk9UVXlPQ0F3TGpVek5UZ3pOU0F3TGpjd09UVWdNQzQxTWpRME5EWWdNQzQzTVRVMU1ETkRNQzQxTURJME56Z2dNQzQzTWpZM09EUWdNQzQwT1RBd01Ea2dNQzQzTWpZM09EUWdNQzQwTnpJM09URWdNQzQzTVRnME56SkRNQzQwTmpRek1qUWdNQzQzTVRRek9EVWdNQzQwTXpNME5qY2dNQzQzTURFMk1UUWdNQzQwTURFNU1Ua2dNQzQyT0RnMU5UZGFUVEF1TkRRME9EZzBJREF1TmpNMk9ETXhUREF1TlRBMU1UVWdNQzQyTmpFM05qaE1NQzQxTXpFeU56VWdNQzQyTWpNME56Rk1NQzQwTkRRNE9EUWdNQzQyTXpZNE16RmFUVEF1TlRnMU1EQTVJREF1TmpJeU5UZ3hUREF1TmpNMk1EY3hJREF1TmpBeU16a3pUREF1TlRnMU1EQTVJREF1TlRneU1qQTJUREF1TlRJNE16QTJJREF1TmpBME5EY3hUREF1TlRjNU16WTVJREF1TmpJME5qVTVUREF1TlRnMU1EQTVJREF1TmpJeU5UZ3hXazB3TGpRM056VTBJREF1TlRRNU9EUTJUREF1TkRnMU9EVXpJREF1TlRZMU1qZzBUREF1TkRVNE1qUXpJREF1TlRjMU5qYzFUREF1TkRrMU5qUTVJREF1TlRjNE9UUk1NQzQxTURjeU1qZ2dNQzQxT1RneU16ZE1NQzQxTVRRek5UTWdNQzQxT0RBM01qRk1NQzQxTkRZM01USWdNQzQxTnpjME5UWk1NQzQxTWpFM056UWdNQzQxTmpjNU5UWk1NQzQxTWpnek1EWWdNQzQxTlRFNU1qUk1NQzQxTURNMk5qVWdNQzQxTlRrNU5Fd3dMalEzTnpVMElEQXVOVFE1T0RRMldrMHdMalEyTnpjME15QXdMall3TkRjMk9FTXdMalEyTnpjME15QXdMalU1TkRrM01TQXdMalEwTmprMk1pQXdMalU0TmprMU5pQXdMalF5TVRRek1TQXdMalU0TmprMU5rTXdMak01TlRrZ01DNDFPRFk1TlRZZ01DNHpOelV4TVRnZ01DNDFPVFE1TnpFZ01DNHpOelV4TVRnZ01DNDJNRFEzTmpoRE1DNHpOelV4TVRnZ01DNDJNVFExTmpVZ01DNHpPVFU1SURBdU5qSXlOVGd4SURBdU5ESXhORE14SURBdU5qSXlOVGd4UXpBdU5EUTJPVFl5SURBdU5qSXlOVGd4SURBdU5EWTNOelF6SURBdU5qRTBOVFkxSURBdU5EWTNOelF6SURBdU5qQTBOelk0V2swd0xqVTVOemt5TWlBd0xqY3dPVEkwTjBNd0xqWXlPRGt5TWlBd0xqWTVOVGt5SURBdU5qVTVOalk1SURBdU5qZ3lOeUF3TGpZMk9UWXhPU0F3TGpZM056VXdNME13TGpZM09UUXhOaUF3TGpZM01qUTFOaUF3TGpZNE5ERTJOU0F3TGpZMk9ESTVPU0F3TGpZNE5ERTJOU0F3TGpZMk5UQXpORll3TGpjd01qRTBNME13TGpZNE5ERTJOU0F3TGpjd05UY3dOaUF3TGpZM09UY3hNaUF3TGpjd09UZzJNaUF3TGpZMk9UWXhPU0F3TGpjeE5USXdOa013TGpZMk1EQXpPU0F3TGpjeU1ESXhJREF1TmpNeE1URWdNQzQzTXpJMU9ESWdNQzQyTURFeU16Z2dNQzQzTkRVek5UaERNQzQxTmprd09ETWdNQzQzTlRreE1Ea2dNQzQxTXpVNE16VWdNQzQzTnpNek1qa2dNQzQxTWpRME5EWWdNQzQzTnprek16RkRNQzQxTURJME56Z2dNQzQzT1RBMk1USWdNQzQwT1RBd01Ea2dNQzQzT1RBMk1USWdNQzQwTnpJM09URWdNQzQzT0RJelF6QXVORFkwTXpJMUlEQXVOemM0TWpFeklEQXVORE16TkRZNUlEQXVOelkxTkRReUlEQXVOREF4T1RJeElEQXVOelV5TXpnMlF6QXVNelk1TXpBMElEQXVOek00T0RnM0lEQXVNek0xT1RRNElEQXVOekkxTURneUlEQXVNekkxT0RNM0lEQXVOekl3TWpVelF6QXVNekUyTURRZ01DNDNNVFUxTURNZ01DNHpNVEEwSURBdU56RXhOalF6SURBdU16RXdOQ0F3TGpjd056YzRORll3TGpZM01EQTRNVU13TGpNeE1EUWdNQzQyTnpNNU5DQXdMak14TmpBMElEQXVOamMzTnprNUlEQXVNekkyTVRNMElEQXVOamd5TlRRNVF6QXVNek0yTXpFNElEQXVOamczTkRnM0lEQXVNemN4TURRM0lEQXVOekF4T0RFZ01DNDBNRFEwTnlBd0xqY3hOVFU1TkVNd0xqUXpOVE0wT1NBd0xqY3lPRE15T1NBd0xqUTJOVEV4TmlBd0xqYzBNRFl3TlNBd0xqUTNNek00TkNBd0xqYzBORFU1TmtNd0xqUTVNRFl3TWlBd0xqYzFNamt3T1NBd0xqVXdNamMzTkNBd0xqYzFNekl3TmlBd0xqVXlORGMwTXlBd0xqYzBNVFl5T0VNd0xqVXpOVGN5TXlBd0xqY3pOVGs0T1NBd0xqVTJOamswT0NBd0xqY3lNalUyTkNBd0xqVTVOemt5TWlBd0xqY3dPVEkwTjFwTk1DNDFPVGM1TWpJZ01DNDNOekEzUXpBdU5qSTRPVEl5SURBdU56VTNNemN6SURBdU5qVTVOalk1SURBdU56UTBNVFV6SURBdU5qWTVOakU1SURBdU56TTRPVFUyUXpBdU5qYzVOREUySURBdU56TXpPVEE1SURBdU5qZzBNVFkxSURBdU56TXdNRFVnTUM0Mk9EUXhOalVnTUM0M01qWTBPRGRXTUM0M05qTTFPVGRETUM0Mk9EUXhOalVnTUM0M05qY3hOVGtnTUM0Mk56azNNVElnTUM0M056RXpNVFVnTUM0Mk5qazJNVGtnTUM0M056WTJOVGxETUM0Mk5qQXdNemtnTUM0M09ERTJOak1nTUM0Mk16RXhNU0F3TGpjNU5EQXpOU0F3TGpZd01USXpPQ0F3TGpnd05qZ3hNVU13TGpVMk9UQTRNeUF3TGpneU1EVTJNaUF3TGpVek5UZ3pOU0F3TGpnek5EYzRNaUF3TGpVeU5EUTBOaUF3TGpnME1EYzRORU13TGpVd01qUTNPQ0F3TGpnMU1qQTJOU0F3TGpRNU1EQXdPU0F3TGpnMU1qQTJOU0F3TGpRM01qYzVNU0F3TGpnME16YzFNME13TGpRMk5ETXlOU0F3TGpnek9UWTJOaUF3TGpRek16UTNNU0F3TGpneU5qZzVOaUF3TGpRd01Ua3lOU0F3TGpneE16ZzBNVU13TGpNMk9UTXdOeUF3TGpnd01ETTBNU0F3TGpNek5UazBPU0F3TGpjNE5qVXpOU0F3TGpNeU5UZ3pOeUF3TGpjNE1UY3dOa013TGpNeE5qQTBJREF1TnpjMk9UVTJJREF1TXpFd05DQXdMamMzTXpBNU5pQXdMak14TURRZ01DNDNOamt5TXpkV01DNDNNekUxTXpSRE1DNHpNVEEwSURBdU56TTFNemt6SURBdU16RTJNRFFnTUM0M016azFOU0F3TGpNeU5qRXpOQ0F3TGpjME5EQXdNME13TGpNek5qTXhPQ0F3TGpjME9EazBJREF1TXpjeE1EUTNJREF1TnpZek1qWXpJREF1TkRBME5EY2dNQzQzTnpjd05EZERNQzQwTXpVek5Ea2dNQzQzT0RrM09ESWdNQzQwTmpVeE1UWWdNQzQ0TURJd05UZ2dNQzQwTnpNek9EUWdNQzQ0TURZd05VTXdMalE1TURZd01pQXdMamd4TkRNMk1pQXdMalV3TWpjM05DQXdMamd4TkRZMU9TQXdMalV5TkRjME15QXdMamd3TXpBNE1VTXdMalV6TlRjeU15QXdMamM1TnpRME1pQXdMalUyTmprME9DQXdMamM0TkRBeE55QXdMalU1TnpreU1pQXdMamMzTURkYUlpQmpiR0Z6Y3owaWFXTnZiaTFtYVd4c0lpOCtKaU40WVRzOEwyYytKaU40WVRzOFpHVm1jejRtSTNoaE96eGpiR2x3VUdGMGFDQnBaRDBpWTJ4cGNEQWlQaVlqZUdFN1BISmxZM1FnZDJsa2RHZzlJakVpSUdobGFXZG9kRDBpTVNJZ1ptbHNiRDBpZDJocGRHVWlMejRtSTNoaE96d3ZZMnhwY0ZCaGRHZytKaU40WVRzOEwyUmxabk0rSmlONFlUczhMM04yWno0PTt2ZXJ0aWNhbExhYmVsUG9zaXRpb249Ym90dG9tO3ZlcnRpY2FsQWxpZ249dG9wO2lyLnN5bmNocm9uaXplZD0xOyIgcGFyZW50PSI4IiB2ZXJ0ZXg9IjEiIGlzVGh1bWI9IjAiPgogICAgICA8bXhHZW9tZXRyeSB4PSI2NjciIHk9IjkxIiB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIGFzPSJnZW9tZXRyeSIvPgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIyMSIgdmFsdWU9IkdDUCBSdW4gLSZndDsgR0NQIFJ1biIgc3R5bGU9ImlyLnJlZj00YWUyYTAzMS1iYzg0LTQxNDgtYjkwMC1iZGY1YWYzYTA1M2U7ZWRnZVN0eWxlPW5vbmU7Y3VydmVkPTE7aHRtbD0xO2lyLnN5bmNocm9uaXplZD0xO2V4aXRYPTA7ZXhpdFk9MC4yNTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MTtlbnRyeVk9MC4yNTtlbnRyeUR4PTA7ZW50cnlEeT0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSIyNSIgc291cmNlPSI5IiB0YXJnZXQ9IjciIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ij4KICAgICAgICA8QXJyYXkgYXM9InBvaW50cyI+CiAgICAgICAgICA8bXhQb2ludCB4PSIxNzYiIHk9IjU3Ii8+CiAgICAgICAgPC9BcnJheT4KICAgICAgPC9teEdlb21ldHJ5PgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIyMiIgdmFsdWU9IkdDUCBSdW4gLSZndDsgR0NQIFJ1biIgc3R5bGU9ImlyLnJlZj0zOTFlYzkzYS1iNTgwLTRjNDItOWExNS0zOWY2NmM2ZDVmNjI7ZWRnZVN0eWxlPW5vbmU7Y3VydmVkPTE7aHRtbD0xO2lyLnN5bmNocm9uaXplZD0xO2V4aXRYPTE7ZXhpdFk9MC43NTtleGl0RHg9MDtleGl0RHk9MDtlbnRyeVg9MC4xMTM7ZW50cnlZPTAuODtlbnRyeUR4PTA7ZW50cnlEeT0wO2VudHJ5UGVyaW1ldGVyPTA7ZW5kQXJyb3c9b3BlbjtlbmRGaWxsPTA7ZW5kU2l6ZT00O3NvdXJjZVBlcmltZXRlclNwYWNpbmc9OTtzdHJva2VDb2xvcj0jQkZCRkJGO3N0cm9rZVdpZHRoPTI7IiBwYXJlbnQ9IjI1IiBzb3VyY2U9IjciIHRhcmdldD0iOSIgZWRnZT0iMSI+CiAgICAgIDxteEdlb21ldHJ5IHJlbGF0aXZlPSIxIiBhcz0iZ2VvbWV0cnkiPgogICAgICAgIDxBcnJheSBhcz0icG9pbnRzIj4KICAgICAgICAgIDxteFBvaW50IHg9IjE3MyIgeT0iMTQ2Ii8+CiAgICAgICAgPC9BcnJheT4KICAgICAgPC9teEdlb21ldHJ5PgogICAgPC9teENlbGw+CiAgICA8bXhDZWxsIGlkPSIxNiIgdmFsdWU9IkNJL0NEIExheWVyIENsb3VkIEJ1aWxkIC0gU2VydmVybGVzcyBDSS9DRCAtJmd0OyBHQ1AgUnVuIiBzdHlsZT0iaXIucmVmPTE0ZWYyMDBjLTlkMzEtNGEzOC1hZTc2LWY2NzEwZTI2OWVkNTtlZGdlU3R5bGU9bm9uZTtjdXJ2ZWQ9MTtodG1sPTE7aXIuc3luY2hyb25pemVkPTE7ZXhpdFg9MC4yNTtleGl0WT0wO2V4aXREeD0wO2V4aXREeT0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSI2IiBzb3VyY2U9IjEzIiB0YXJnZXQ9IjkiIGVkZ2U9IjEiPgogICAgICA8bXhHZW9tZXRyeSByZWxhdGl2ZT0iMSIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjMiIHZhbHVlPSJJbnRlcm5ldCIgc3R5bGU9ImlyLnJlZj1mMGJhNzcyMi0zOWI2LTRjODEtODI5MC1hMzBhMjQ4YmI4ZDk7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtyZWN1cnNpdmVSZXNpemU9MDtodG1sPTE7dmVydGljYWxBbGlnbj10b3A7YWxpZ249bGVmdDtkYXNoZWQ9MTtzdHJva2VXaWR0aD0xO2FyY1NpemU9MzthYnNvbHV0ZUFyY1NpemU9MTtzcGFjaW5nVG9wPTE7c3BhY2luZ0xlZnQ9MzI7c3Ryb2tlQ29sb3I9Izc1NzVFQjtmaWxsQ29sb3I9I0YwRjBGRjtmaWxsT3BhY2l0eT0zMDtmb250Q29sb3I9IzU2NTFFMDtjb25uZWN0YWJsZT0wO2NvbnRhaW5lcj0xO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1UUlVTVFpPTkU7IiBwYXJlbnQ9IjEiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9Ii0xMzMiIHk9Ii0yMDkiIHdpZHRoPSIxMDc5IiBoZWlnaHQ9IjE4MCIgYXM9Imdlb21ldHJ5Ii8+CiAgICA8L214Q2VsbD4KICAgIDxteENlbGwgaWQ9IjQiIHZhbHVlPSJHZW5lcmljIENsaWVudCIgc3R5bGU9ImlyLnJlZj01N2VkMjU5Mi1hODEwLTQ1NzktYTNjYS04ZmE3YjBhNzFlN2E7cm91bmRlZD0xO3doaXRlU3BhY2U9d3JhcDtodG1sPTE7YWxpZ249Y2VudGVyO2ltYWdlQWxpZ249Y2VudGVyO2ltYWdlV2lkdGg9ODI7aW1hZ2VIZWlnaHQ9ODI7YXJjU2l6ZT05MDthYnNvbHV0ZUFyY1NpemU9MTtzdHJva2VDb2xvcj0jMjBDOUUzO2ZpbGxDb2xvcj0jRTNGQ0ZDO2ZvbnRDb2xvcj0jMDA4NEFEO2ZvbnRTaXplPTEyO3NvdXJjZT1pcml1c3Jpc2s7aXIudHlwZT1DT01QT05FTlQ7aXIuY29tcG9uZW50RGVmaW5pdGlvbi5yZWY9Z2VuZXJpYy1jbGllbnQ7aW1hZ2U9ZGF0YTppbWFnZS9zdmcreG1sLFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUhacFpYZENiM2c5SWpBZ01DQXhJREVpSUdacGJHdzlJbTV2Ym1VaVBpWWplR0U3UEhOMGVXeGxQaVlqZUdFN0lDQWdJQzVwWTI5dUxXWnBiR3dnZXlZamVHRTdJQ0FnSUNBZ0lDQm1hV3hzT2lBak1URkJPRU5HT3lZamVHRTdJQ0FnSUgwbUkzaGhPend2YzNSNWJHVStKaU40WVRzOFp5QmpiR2x3TFhCaGRHZzlJblZ5YkNnalkyeHBjREFwSWo0bUkzaGhPenh3WVhSb0lHWnBiR3d0Y25Wc1pUMGlaWFpsYm05a1pDSWdZMnhwY0MxeWRXeGxQU0psZG1WdWIyUmtJaUJrUFNKTk1DNHlOVFl6TXpjZ01DNDJPVFF5T1RKRE1DNHlOREUwTnlBd0xqWTVOREk1TWlBd0xqSXlOemc0TmlBd0xqWTRPRGd3TXlBd0xqSXhOelV3TWlBd0xqWTNPVGMwTTBNd0xqSXhNVGt4SURBdU5qYzBPRFkwSURBdU1qQTNNalEySURBdU5qWTRPVFE1SURBdU1qQXpPREVnTUM0Mk5qSXlPVGhETUM0eE9UazJNalFnTUM0Mk5UUXhPVFVnTUM0eE9UY3lOakVnTUM0Mk5EUTVPVGtnTUM0eE9UY3lOakVnTUM0Mk16VXlOVEZXTUM0eU9ERXhOamhETUM0eE9UY3lOakVnTUM0eU5EZzFOaUF3TGpJeU16Y3hJREF1TWpJeU1USTNJREF1TWpVMk16TTNJREF1TWpJeU1USTNUREF1TmpNME5EUTNJREF1TWpJeU1USTNUREF1TlRrMU5qQTNJREF1TVRZek1EZzJUREF1TWpVMk16TTNJREF1TVRZek1EZzJRekF1TVRreE1EZ3pJREF1TVRZek1EZzJJREF1TVRNNE1UZzBJREF1TWpFMU9UVXpJREF1TVRNNE1UZzBJREF1TWpneE1UWTRWakF1TmpNMU1qVXhRekF1TVRNNE1UZzBJREF1TmpRNE16Y3pJREF1TVRRd016STJJREF1TmpZd09UazJJREF1TVRRME1qYzVJREF1TmpjeU56ZzVRekF1TVRVd01UUTVJREF1Tmprd01qazRJREF1TVRZd01ERXpJREF1TnpBMU9UYzRJREF1TVRjeU56a2dNQzQzTVRnM05EZERNQzR4T1RReE56SWdNQzQzTkRBeE1UWWdNQzR5TWpNM01TQXdMamMxTXpNek15QXdMakkxTmpNek55QXdMamMxTXpNek0wZ3dMak0zTkRjNE4xWXdMamd4TXpBd05Vd3dMakk0TmpJeU9TQXdMamd4TXpBd05VTXdMakkyT1RreE5pQXdMamd4TXpBd05pQXdMakkxTmpZNU1TQXdMamd5TmpJeU1pQXdMakkxTmpZNU1TQXdMamcwTWpVeU5rTXdMakkxTmpZNU1TQXdMamcxT0RneklEQXVNalk1T1RFMklEQXVPRGN5TURRMklEQXVNamcyTWpNZ01DNDROekl3TkRaTU1DNDJPVGsxTkNBd0xqZzNNakEwTTBNd0xqY3hOVGcxTkNBd0xqZzNNakEwTXlBd0xqY3lPVEEzT1NBd0xqZzFPRGd5TmlBd0xqY3lPVEEzT1NBd0xqZzBNalV5TWtNd0xqY3lPVEEzT0NBd0xqZ3lOakl4T1NBd0xqY3hOVGcxTXlBd0xqZ3hNekF3TWlBd0xqWTVPVFUwSURBdU9ERXpNREF5VERBdU5qRXdPVGN5SURBdU9ERXpNREF6VmpBdU56VXpNek16U0RBdU56STRPVFV6UXpBdU56UXlPRFV6SURBdU56VXpNek16SURBdU56VTJNVGt6SURBdU56VXdPVE0wSURBdU56WTROVGdnTUM0M05EWTFNamRETUM0NE1EY3dOelVnTUM0M016STRNelVnTUM0NE16WXpOekVnTUM0Mk9UazNOVGNnTUM0NE5EUTNNRFlnTUM0Mk5Ua3dORGxETUM0NE5EWXlPQ0F3TGpZMU1UTTJNaUF3TGpnME56RXdOeUF3TGpZME16UXdNeUF3TGpnME56RXdOeUF3TGpZek5USTFNVll3TGpJNE1URTJOME13TGpnME56RXdOeUF3TGpJeE5UazFNeUF3TGpjNU5ESXdOeUF3TGpFMk16QTROaUF3TGpjeU9EazFNeUF3TGpFMk16QTROa2d3TGpVNU5UWXdOMHd3TGpZek5EUTBOeUF3TGpJeU1qRXlOMGd3TGpjeU9EazFNME13TGpjMk1UVTRJREF1TWpJeU1USTNJREF1TnpnNE1ETWdNQzR5TkRnMU5pQXdMamM0T0RBeklEQXVNamd4TVRZM1ZqQXVOak0xTWpVeFF6QXVOemc0TURNZ01DNDJORFE1T1RrZ01DNDNPRFUyTmpZZ01DNDJOVFF4T1RVZ01DNDNPREUwT0NBd0xqWTJNakk1T0VNd0xqYzNOREk0T1NBd0xqWTNOakl4T0NBd0xqYzJNVGN5TVNBd0xqWTROamt4TXlBd0xqYzBOalV5TVNBd0xqWTVNVFl6TjBNd0xqYzBNRGszTVNBd0xqWTVNek0yTWlBd0xqY3pOVEEzTVNBd0xqWTVOREk1TWlBd0xqY3lPRGsxTXlBd0xqWTVOREk1TWtnd0xqSTFOak16TjFwTk1DNDBNek00TmpRZ01DNDRNVE13TURSTU1DNDFOVEU0T1RVZ01DNDRNVE13TUROV01DNDNOVE16TXpOSU1DNDBNek00TmpSV01DNDRNVE13TURSYUlpQmpiR0Z6Y3owaWFXTnZiaTFtYVd4c0lpOCtKaU40WVRzOEwyYytKaU40WVRzOFpHVm1jejRtSTNoaE96eGpiR2x3VUdGMGFDQnBaRDBpWTJ4cGNEQWlQaVlqZUdFN1BISmxZM1FnZDJsa2RHZzlJakF1T1RnME5qRTFJaUJvWldsbmFIUTlJakF1T1RnME5qRTFJaUJtYVd4c1BTSjNhR2wwWlNJZ2RISmhibk5tYjNKdFBTSjBjbUZ1YzJ4aGRHVW9NQzR3TURBeU5EUXhOREVnTUM0d01UVXpPREE1S1NJdlBpWWplR0U3UEM5amJHbHdVR0YwYUQ0bUkzaGhPend2WkdWbWN6NG1JM2hoT3p3dmMzWm5QZz09O3ZlcnRpY2FsTGFiZWxQb3NpdGlvbj1ib3R0b207dmVydGljYWxBbGlnbj10b3A7aXIuc3luY2hyb25pemVkPTE7IiBwYXJlbnQ9IjMiIHZlcnRleD0iMSIgaXNUaHVtYj0iMCI+CiAgICAgIDxteEdlb21ldHJ5IHg9IjQzIiB5PSI0OCIgd2lkdGg9IjkwIiBoZWlnaHQ9IjkwIiBhcz0iZ2VvbWV0cnkiLz4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iNSIgdmFsdWU9Ik1vYmlsZSBEZXZpY2UgQ2xpZW50IiBzdHlsZT0iaXIucmVmPTg5YmVjOWRkLTJlNWQtNDc2Yi04OTRiLTk4NTU1MTM3MzA3MDtyb3VuZGVkPTE7d2hpdGVTcGFjZT13cmFwO2h0bWw9MTthbGlnbj1jZW50ZXI7aW1hZ2VBbGlnbj1jZW50ZXI7aW1hZ2VXaWR0aD04MjtpbWFnZUhlaWdodD04MjthcmNTaXplPTkwO2Fic29sdXRlQXJjU2l6ZT0xO3N0cm9rZUNvbG9yPSMyMEM5RTM7ZmlsbENvbG9yPSNFM0ZDRkM7Zm9udENvbG9yPSMwMDg0QUQ7Zm9udFNpemU9MTI7c291cmNlPWlyaXVzcmlzaztpci50eXBlPUNPTVBPTkVOVDtpci5jb21wb25lbnREZWZpbml0aW9uLnJlZj1tb2JpbGUtZGV2aWNlLWNsaWVudDtpbWFnZT1kYXRhOmltYWdlL3N2Zyt4bWwsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeElpQm9aV2xuYUhROUlqRWlJSFpwWlhkQ2IzZzlJakFnTUNBeElERWlJR1pwYkd3OUltNXZibVVpUGlZamVHRTdQSE4wZVd4bFBpWWplR0U3SUNBZ0lDNXBZMjl1TFdacGJHd2dleVlqZUdFN0lDQWdJQ0FnSUNCbWFXeHNPaUFqTVRGQk9FTkdPeVlqZUdFN0lDQWdJSDBtSTNoaE96d3ZjM1I1YkdVK0ppTjRZVHM4WnlCamJHbHdMWEJoZEdnOUluVnliQ2dqWTJ4cGNEQXBJajRtSTNoaE96eHdZWFJvSUdacGJHd3RjblZzWlQwaVpYWmxibTlrWkNJZ1kyeHBjQzF5ZFd4bFBTSmxkbVZ1YjJSa0lpQmtQU0pOTUM0ek5UQTJNamNnTUM0eE1qazJNemxETUM0eU9UZzBNak1nTUM0eE1qazJNemtnTUM0eU5UWXhNRFFnTUM0eE56RTVOVGdnTUM0eU5UWXhNRFFnTUM0eU1qUXhOakZXTUM0M09URXlPVGRETUM0eU5UWXhNRFFnTUM0NE5ETTFNREVnTUM0eU9UZzBNak1nTUM0NE9EVTRNaUF3TGpNMU1EWXlOeUF3TGpnNE5UZ3lTREF1TmpNME1UazJRekF1TmpnMk16azVJREF1T0RnMU9ESWdNQzQzTWpnM01Ua2dNQzQ0TkRNMU1ERWdNQzQzTWpnM01Ua2dNQzQzT1RFeU9UZFdNQzR5TWpReE5qRkRNQzQzTWpnM01Ua2dNQzR4TnpFNU5UZ2dNQzQyT0RZek9Ua2dNQzR4TWprMk16a2dNQzQyTXpReE9UWWdNQzR4TWprMk16bElNQzR6TlRBMk1qZGFUVEF1TXpJMk9UazJJREF1TWpFeU16UTJRekF1TXpJMk9UazJJREF1TVRrNU1qazFJREF1TXpNM05UYzJJREF1TVRnNE56RTFJREF1TXpVd05qSTNJREF1TVRnNE56RTFTREF1TmpNME1UazJRekF1TmpRM01qUTNJREF1TVRnNE56RTFJREF1TmpVM09ESTNJREF1TVRrNU1qazFJREF1TmpVM09ESTNJREF1TWpFeU16UTJWakF1TnpNeU1qSXhRekF1TmpVM09ESTNJREF1TnpRMU1qY3hJREF1TmpRM01qUTNJREF1TnpVMU9EVXhJREF1TmpNME1UazJJREF1TnpVMU9EVXhTREF1TXpVd05qSTNRekF1TXpNM05UYzJJREF1TnpVMU9EVXhJREF1TXpJMk9UazJJREF1TnpRMU1qY3hJREF1TXpJMk9UazJJREF1TnpNeU1qSXhWakF1TWpFeU16UTJXazB3TGpRMk5EZzBNaUF3TGpnMU1ETTNORU13TGpRME9UWXhOaUF3TGpnMU1ETTNOQ0F3TGpRek56STNNeUF3TGpnek9EQXpJREF1TkRNM01qY3pJREF1T0RJeU9EQTBRekF1TkRNM01qY3pJREF1T0RBM05UYzRJREF1TkRRNU5qRTJJREF1TnprMU1qTTFJREF1TkRZME9EUXlJREF1TnprMU1qTTFTREF1TlRFNU9UaERNQzQxTXpVeU1EWWdNQzQzT1RVeU16VWdNQzQxTkRjMU5TQXdMamd3TnpVM09DQXdMalUwTnpVMUlEQXVPREl5T0RBMFF6QXVOVFEzTlRVZ01DNDRNemd3TXlBd0xqVXpOVEl3TmlBd0xqZzFNRE0zTkNBd0xqVXhPVGs0SURBdU9EVXdNemMwU0RBdU5EWTBPRFF5V2lJZ1kyeGhjM005SW1samIyNHRabWxzYkNJdlBpWWplR0U3UEM5blBpWWplR0U3UEdSbFpuTStKaU40WVRzOFkyeHBjRkJoZEdnZ2FXUTlJbU5zYVhBd0lqNG1JM2hoT3p4eVpXTjBJSGRwWkhSb1BTSXdMams0TkRZeE5TSWdhR1ZwWjJoMFBTSXdMams0TkRZeE5TSWdabWxzYkQwaWQyaHBkR1VpSUhSeVlXNXpabTl5YlQwaWRISmhibk5zWVhSbEtEQXVNREF3TWpRME1UUXhJREF1TURFMU16Z3dPU2tpTHo0bUkzaGhPend2WTJ4cGNGQmhkR2crSmlONFlUczhMMlJsWm5NK0ppTjRZVHM4TDNOMlp6ND07dmVydGljYWxMYWJlbFBvc2l0aW9uPWJvdHRvbTt2ZXJ0aWNhbEFsaWduPXRvcDtpci5zeW5jaHJvbml6ZWQ9MTsiIHBhcmVudD0iMyIgdmVydGV4PSIxIiBpc1RodW1iPSIwIj4KICAgICAgPG14R2VvbWV0cnkgeD0iMTU5IiB5PSI0OCIgd2lkdGg9IjkwIiBoZWlnaHQ9IjkwIiBhcz0iZ2VvbWV0cnkiLz4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMjMiIHZhbHVlPSJHZW5lcmljIENsaWVudCAtJmd0OyBHQ1AgUnVuIiBzdHlsZT0iaXIucmVmPTAxODgxNDg5LTYyMmUtNGE2Ny1iZGIyLTNhZjU5ZTY5NDYxYztlZGdlU3R5bGU9bm9uZTtjdXJ2ZWQ9MTtodG1sPTE7aXIuc3luY2hyb25pemVkPTE7ZXhpdFg9MTtleGl0WT0wLjc1O2V4aXREeD0wO2V4aXREeT0wO2VudHJ5WD0wLjc1O2VudHJ5WT0wO2VudHJ5RHg9MDtlbnRyeUR5PTA7ZW5kQXJyb3c9b3BlbjtlbmRGaWxsPTA7ZW5kU2l6ZT00O3NvdXJjZVBlcmltZXRlclNwYWNpbmc9OTtzdHJva2VDb2xvcj0jQkZCRkJGO3N0cm9rZVdpZHRoPTI7IiBwYXJlbnQ9IjEiIHNvdXJjZT0iNCIgdGFyZ2V0PSI3IiBlZGdlPSIxIj4KICAgICAgPG14R2VvbWV0cnkgcmVsYXRpdmU9IjEiIGFzPSJnZW9tZXRyeSI+CiAgICAgICAgPEFycmF5IGFzPSJwb2ludHMiPgogICAgICAgICAgPG14UG9pbnQgeD0iMTUwIiB5PSI3NCIvPgogICAgICAgIDwvQXJyYXk+CiAgICAgIDwvbXhHZW9tZXRyeT4KICAgIDwvbXhDZWxsPgogICAgPG14Q2VsbCBpZD0iMjQiIHZhbHVlPSJNb2JpbGUgRGV2aWNlIENsaWVudCAtJmd0OyBHQ1AgUnVuIiBzdHlsZT0iaXIucmVmPTY0YTIxYTdlLTdiNzAtNDUxYi05YTg3LTA1ZjE1N2Q2NTVjMjtlZGdlU3R5bGU9bm9uZTtjdXJ2ZWQ9MTtodG1sPTE7aXIuc3luY2hyb25pemVkPTE7ZXhpdFg9MTtleGl0WT0wLjc1O2V4aXREeD0wO2V4aXREeT0wO2VudHJ5WD0wLjkxODtlbnRyeVk9MC4xNDc7ZW50cnlEeD0wO2VudHJ5RHk9MDtlbnRyeVBlcmltZXRlcj0wO2VuZEFycm93PW9wZW47ZW5kRmlsbD0wO2VuZFNpemU9NDtzb3VyY2VQZXJpbWV0ZXJTcGFjaW5nPTk7c3Ryb2tlQ29sb3I9I0JGQkZCRjtzdHJva2VXaWR0aD0yOyIgcGFyZW50PSIxIiBzb3VyY2U9IjUiIHRhcmdldD0iNyIgZWRnZT0iMSI+CiAgICAgIDxteEdlb21ldHJ5IHJlbGF0aXZlPSIxIiBhcz0iZ2VvbWV0cnkiPgogICAgICAgIDxBcnJheSBhcz0icG9pbnRzIj4KICAgICAgICAgIDxteFBvaW50IHg9IjE5NiIgeT0iNiIvPgogICAgICAgIDwvQXJyYXk+CiAgICAgIDwvbXhHZW9tZXRyeT4KICAgIDwvbXhDZWxsPgogIDwvcm9vdD4KPC9teEdyYXBoTW9kZWw+Cg==</schema>
  </diagram>
  <trustZones>
    <trustZone ref="public" uuid="6376d53e-6461-412b-8e04-7b3fe2b397de" name="Public" desc="Untrusted public zone" trustRating="1"/>
    <trustZone ref="internet" uuid="f0ba7722-39b6-4c81-8290-a30a248bb8d9" name="Internet" desc="Untrusted Internet public zone" trustRating="1"/>
  </trustZones>
  <questions/>
  <assets/>
  <settings/>
  <dataflows>
    <dataflow name="Generic Client -&gt; GCP Run" ref="01881489-622e-4a67-bdb2-3af59e69461c" source="897070cb-ea96-4f0c-ae29-7aaff1085908" target="2f776b9c-0ede-4325-afc0-4e0c4c527f33">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="CI/CD Layer Cloud Build - Serverless CI/CD -&gt; GCP Run" ref="14ef200c-9d31-4a38-ae76-f6710e269ed5" source="45afc835-9418-4a86-a27d-95d1b5154a3c" target="476349e5-337c-4c19-ab7c-34bca3626737">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="GCP Run -&gt; GCP Run" ref="391ec93a-b580-4c42-9a15-39f66c6d5f62" source="2f776b9c-0ede-4325-afc0-4e0c4c527f33" target="476349e5-337c-4c19-ab7c-34bca3626737">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="GCP Run -&gt; Redis Server" ref="45b5b380-fcf4-408e-9b7a-4e0ec1dfca3f" source="476349e5-337c-4c19-ab7c-34bca3626737" target="d56d71d9-4a6f-49d8-8674-ffd52af20567">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="GCP Run -&gt; GCP Run" ref="4ae2a031-bc84-4148-b900-bdf5af3a053e" source="476349e5-337c-4c19-ab7c-34bca3626737" target="2f776b9c-0ede-4325-afc0-4e0c4c527f33">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Mobile Device Client -&gt; GCP Run" ref="64a21a7e-7b70-451b-9a87-05f157d655c2" source="44a3d4f3-907c-4276-ac6f-d519d23249bc" target="2f776b9c-0ede-4325-afc0-4e0c4c527f33">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Store Secrets Secrets Manager - Sensitive data storage -&gt; CI/CD Layer Cloud Build - Serverless CI/CD" ref="8cafa8cf-c576-4379-b0f9-31943970a33f" source="3744726d-db5e-42d5-8400-83b4419da7af" target="45afc835-9418-4a86-a27d-95d1b5154a3c">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="GCP MySQL -&gt; GCP Run" ref="947517a3-7de8-4960-98ca-d8e01a0bd53f" source="583070da-7591-4d91-ab44-c11f5c29250a" target="476349e5-337c-4c19-ab7c-34bca3626737">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="GCP Run -&gt; GCP MySQL" ref="d54b784b-4c11-4140-8440-a745d4dbd76c" source="476349e5-337c-4c19-ab7c-34bca3626737" target="583070da-7591-4d91-ab44-c11f5c29250a">
      <assets/>
      <tags/>
    </dataflow>
    <dataflow name="Redis Server -&gt; GCP Run" ref="f1df149b-7be1-4aaf-9517-a707fe6a767e" source="d56d71d9-4a6f-49d8-8674-ffd52af20567" target="476349e5-337c-4c19-ab7c-34bca3626737">
      <assets/>
      <tags/>
    </dataflow>
  </dataflows>
  <customFields>
    <customField ref="APT" value=""/>
    <customField ref="Application Details" value=""/>
    <customField ref="Application Downtime Cost" value=""/>
    <customField ref="Application Type" value=""/>
    <customField ref="Apply Standard at all times" value="1"/>
    <customField ref="Contact Email" value=""/>
    <customField ref="Custom Field A" value=""/>
    <customField ref="DEL" value=""/>
    <customField ref="GPS Environment" value="NO"/>
    <customField ref="Hosting Location" value="GCP"/>
    <customField ref="Milestone 1" value=""/>
    <customField ref="Milestone 1 - Deadline" value=""/>
    <customField ref="Milestone 2" value=""/>
    <customField ref="Milestone 2 - Deadline" value=""/>
    <customField ref="Milestone 3" value=""/>
    <customField ref="Milestone 3 - Deadline" value=""/>
    <customField ref="Product Review Session Details" value=""/>
    <customField ref="Project Management Details" value=""/>
    <customField ref="Project Manager" value=""/>
    <customField ref="Project Number" value="_::_"/>
    <customField ref="Project Owner Email" value="jrabe@iriusrisk.com"/>
    <customField ref="Ready for Workflow advancement?" value="NO"/>
    <customField ref="Requirements" value=""/>
    <customField ref="Test Custom" value=""/>
    <customField ref="Third Party Contact" value=""/>
    <customField ref="Third Party Organization" value=""/>
    <customField ref="UPS Template Picker" value="GCP Template"/>
    <customField ref="Use Case" value=""/>
    <customField ref="User Email Field" value=""/>
    <customField ref="VZ - Requirements" value="Type 1||Type 2"/>
  </customFields>
  <components>
    <component uuid="a597638e-fc60-413d-9bba-0849b5379f57" diagramComponentId="9fa2c04f-c329-4cf7-8cce-7c6cb7625985" ref="583070da-7591-4d91-ab44-c11f5c29250a" name="GCP MySQL" desc="" library="Google Cloud Platform" parentComponentRef="3d864622-5588-4925-a2cd-ac0e382b8bf5" componentDefinitionRef="google-mysql">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="GOOGLE-USECURE-CREDENTIALS" name="Credentials are not securely stored" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials that are used to access the resources are not securely stored and can be
                        accessed by unauthorized personnel.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.959">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="DATA-TRANSMIT-CLEAR" name="Data is transmitted in clear text" state="0" impact="100" issueId="" issueLink="">
          <desc>Data is not protected when transmitted to applications or customers and it can be read or modified by unauthorized actors.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.581">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON02" name="Excessive use of administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator accounts are used for all actions, not only for the administrative ones. This is because these users do not have a personal or user account to perform their daily actions.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.958">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.959">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON03" name="Lack of 2FA" state="0" impact="100" issueId="" issueLink="">
          <desc>Login to the console without using Multi-factor Authentication (MFA) is considered as suspicious activity. Therefore connection without MFA must be audited and monitored and the corresponding security group must be informed and must validate this connection.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.958">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-IAM03" name="Misconfigured User Account" state="0" impact="100" issueId="" issueLink="">
          <desc>Key security settings such as resetting the password, and other password controls are not
                        configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.959">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-IAM-01" name="Misconfigured authentication method for administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The authentication method "Multi-factor Authentication" for the Administrator accounts is not
                        configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.959">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE_IAM-02" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials for the groups and roles are incorrectly configured and there are user accounts with more privileges than necessary.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.580">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-EXPIRATION-DATE" name="Misconfigured security key expirations" state="0" impact="100" issueId="" issueLink="">
          <desc>The password and security key expiration is not configured and users are not obliged to change
                        their security credentials. Not frequently changing passwords, gives attackers the chance to
                        obtain credentials and gain access to the systems.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.959">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA" name="Sensitive data is accessible" state="0" impact="100" issueId="" issueLink="">
          <desc>Sensitive data is not encrypted and is exposed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.581">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NOT-PATCHED" name="The instances are not patched" state="0" impact="100" issueId="" issueLink="">
          <desc>The instances are not patched with the last updates for the correspondent Operative System (OS), and the instances have got weaknesses which are solved in the last updates.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.581">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-BACKUP" name="There is no recover or backup mechanism" state="0" impact="100" issueId="" issueLink="">
          <desc>There are no processes or mechanisms to regularly save the data to another place in order to
                        have an older version of the data to restore in case of loss. Consequently the data cannot be
                        easily recovered or they cannot be recovered at all.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.581">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to open ports is most likely an attack. To avoid this, access to the network must be as restricted as possible, so that only the necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.580">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON01" name="Undetected changes in the security configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>Monitoring and alerting for security configurations are not configured and changes cannot be detected.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.579">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="GOOGLE-IAM03" name="Apply RBAC with pre-defined policies added into groups and roles" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups. All the users in an IAM group inherit the permissions assigned to the group. That way,
                        you can make changes for everyone in a group in just one place. As people move around in your
                        company, you can simply change what IAM group their IAM user belongs to. This method is known as
                        Role Based Access Control (RBAC).&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        To add a team member and grant an IAM role to the member:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&lt;/li&gt;
                        &lt;li&gt;Click Add to add new members to the project and set their permissions. In the Select a
                        role drop-down menu, click on a service name to find the roles that belong to that service.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;To grant more than one role to the same project member:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&lt;/li&gt;
                        &lt;li&gt;Enter the email address of the member and select all the roles that you want to grant
                        to the member. Click Add.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;To grant a role to a member for more than one project:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM and Admin Projects page in the Cloud Platform Console and open the IAM
                        &amp;amp; ADMIN PROJECTS page.&lt;/li&gt;
                        &lt;li&gt;Select all the projects for which you want to grant permissions.&lt;/li&gt;
                        &lt;li&gt;In the IAM tab on the right pane, add the new member and select a role to grant the
                        role for all selected projects.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Granting, changing, and revoking access to resources" url="https://cloud.google.com/iam/docs/granting-changing-revoking-access"/>
          </references>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                            &lt;li&gt;Click Select a project and click Open.&lt;/li&gt;
                            &lt;li&gt;List all members from the project.&lt;/li&gt;
                            &lt;li&gt;Check that each member has been assigned to the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM08" name="Automatically rotate Google Service account keys" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>The Google Service Keys shall be rotated to avoid unauthorized access.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        To enable automatic rotation of a key, set the rotation schedule with the following gcloud
                        command-line syntax:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        gcloud kms keys update KEY_NAME \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --location LOCATION \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --keyring KEYRING_NAME \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --rotation-period ROTATION_PERIOD \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --next-rotation-time NEXT_ROTATION_TIME&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;For example:&amp;nbsp;
                        &lt;div&gt;
                        gcloud kms keys update KEY_NAME&amp;nbsp;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --rotation-period=30d&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --next-rotation-time=2016-10-12T12:34:56.1234Z
                        &lt;/div&gt;
                        &lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: KMS rotation schedule" url="https://cloud.google.com/kms/docs/rotating-keys#kms-set-rotation-schedule-cli"/>
          </references>
          <standards>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check automatic rotation of keys is enabled.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL9" name="Configure Cloud SQL MySQL instance settings" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;ul&gt;&lt;li&gt;Ensure that a MySQL database instance does not allow anyone to connect with administrative privileges&lt;/li&gt;&lt;li&gt;Ensure 'skip_show_database' database flag for Cloud SQL Mysql instance is set to 'on'&lt;/li&gt;&lt;li&gt;Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud sql users set-password [USER_NAME] [HOST] --instance=[INSTANCE_NAME] --password=[PASSWORD]&lt;/p&gt;&lt;p&gt;gcloud sql instances patch INSTANCE_NAME --database-flags &lt;strong&gt;local_infile=off&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;gcloud sql instances patch INSTANCE_NAME --database-flags &lt;strong&gt;skip_show_database=on&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Note : This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags you want set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ("=").&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="6.1.1" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="6.1.1" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="6.1.2" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="6.1.2" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="6.1.3" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="6.1.3" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Check that the flags are set correctly. For example:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud sql instances describe INSTANCE_NAME --format=json | jq '.settings.databaseFlags[] | select(.name=="skip_show_database")|.value'&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL7" name="Configure connection organization policies on Cloud SQL instances" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Configure connection organization policies on Cloud SQL instances&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Connection organization policies provide centralized control of the public IP settings for Cloud SQL, to reduce the security attack surface of Cloud SQL instances from the Internet. An organization policy administrator can use a connection policy to restrict public IP configurations of Cloud SQL at the project, folder, or organization level.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; How to add connection organization policies on Cloud SQL instances&lt;/p&gt; 
&lt;p&gt;Before you begin&lt;/p&gt; 
&lt;p&gt;1. In the Google Cloud Console, on the project selector page, select or create a Google Cloud project.&lt;br&gt; Note: If you don't plan to keep the resources that you create in this procedure, create a project instead of selecting an existing project. After you finish these steps, you can delete the project, removing all resources associated with the project.&lt;br&gt; 2. Make sure that billing is enabled for your Cloud project. Learn how to confirm that billing is enabled for your project.&lt;br&gt; 3. Install and initialize the Cloud SDK.&lt;br&gt; 4. Add the Organization Policy Administrator role (roles/ orgpolicy.policyAdmin) to your user or service account from the IAM &amp;amp; Admin page.&lt;br&gt; 5. See Restrictions before performing this procedure.&lt;/p&gt; 
&lt;p&gt;Configuring the organization policy&lt;/p&gt; 
&lt;p&gt;To configure the organization policy:&lt;/p&gt; 
&lt;p&gt;1. Go to the Organization policies page.&lt;br&gt; 2. Click projects dropdown menu in the top tab, and then select the project, folder, or organization that requires the organization policy. The Organization policies page displays a list of organization policy constraints that are available.&lt;br&gt; 3. Filter for the constraint name or display_name.&lt;br&gt; Connection policy constraints:&lt;br&gt; - To disable access to or from the Internet:&lt;/p&gt; 
&lt;p&gt;name: "constraints/sql.restrictPublicIp"&lt;br&gt; display_name: "Restrict Public IP access on Cloud SQL instances"&lt;/p&gt; 
&lt;p&gt;- To disable access from the internet when IAM authentication is missing (this does not affect access using Private IP):&lt;/p&gt; 
&lt;p&gt;name: "constraints/sql.restrictAuthorizedNetworks"&lt;br&gt; display_name: "Restrict Authorized Networks on Cloud SQL instances"&lt;/p&gt; 
&lt;p&gt;4. Select the policy Name from the list.&lt;br&gt; 5. Click Edit.&lt;br&gt; 6. Select Customize.&lt;br&gt; 7. Change Enforcement to On.&lt;br&gt; 8. Click Save. A message displays that says the constraint is updated.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configuring connection organization policies" url="https://cloud.google.com/sql/docs/mysql/org-policy/configure-org-policy"/>
            <reference name="Connection organization policies" url="https://cloud.google.com/sql/docs/mysql/org-policy/org-policy"/>
          </references>
          <standards>
            <standard ref="6.5" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="6.5" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that connection organization policies are configured for your Cloud SQL instances.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL6" name="Configure private services access for Cloud SQL instances" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Configure private services access for Cloud SQL instances&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Google Cloud and third parties (together known as service producers) can offer services with internal IP addresses that are hosted in a VPC network. Private services access enables you to reach those internal IP addresses. This is useful if you want your VM instances in your VPC network to use internal IP addresses instead of external IP addresses. Cloud SQL uses internal IP addresses for private IP.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; If you are using private IP for any of your Cloud SQL instances, you only need to configure private services access one time for every Google Cloud project that has or needs to connect to a Cloud SQL instance.&lt;/p&gt; 
&lt;p&gt;If your Google Cloud project has a Cloud SQL instance, you can either configure it yourself or let Cloud SQL do it for you to use private IP.&lt;/p&gt; 
&lt;p&gt;Cloud SQL configures private services access for you when all the conditions below are true:&lt;/p&gt; 
&lt;p&gt;- You have not yet configured private services access in the Google Cloud project.&lt;br&gt; - You are enabling private IP for the first time for any Cloud SQL instance in the Google Cloud project.&lt;br&gt; - When enabling private IP in the instance's Connections page, you select both the default associated networking and Use an automatically allocated IP range options.&lt;/p&gt; 
&lt;p&gt;You can see the results in the VPC networks page by selecting the default VPC network, and then selecting the Private service connection link.&lt;/p&gt; 
&lt;p&gt;Otherwise, you need to configure private services access manually, as described in the sections below.&lt;/p&gt; 
&lt;p&gt;Configuring private services access for Cloud SQL&lt;/p&gt; 
&lt;p&gt;You can configure private services access in the default or your own VPC network. This is recommended if:&lt;/p&gt; 
&lt;p&gt;- You want to control the size of the IP address range that is allocated. For example, if you anticipate creating many Cloud SQL instances, you might choose in advance to allocate an IP range that can hold them all. If instances are going to be created in multiple regions or different database types, a /20 or larger range is recommended.&lt;/p&gt; 
&lt;p&gt;- You want to set up private services access from the command line (using gcloud).&lt;/p&gt; 
&lt;p&gt;- You are using Shared VPC and your organization has a network administrator (IAM roles/compute.networkAdmin) in the host project. The network administrator can perform the steps below in the host project to configure private services access. Users who were delegated privileges in the service project(s) can launch Cloud SQL instances by following the instructions in the earlier sections.&lt;/p&gt; 
&lt;p&gt;Private services access is implemented as a VPC peering connection between your VPC network and the underlying Google services VPC network where your Cloud SQL instance resides. Even though multiple ip ranges can be allocated, the IP range used for the private IP will always be done by Google.&lt;/p&gt; 
&lt;p&gt;Important: When you create a private connection between your VPC network and the Cloud SQL service, it becomes available for use by any Google service that supports private services access. If you later delete the private connection, you remove private connectivity to your Cloud SQL instances and any other service that is using that connection. Removing the private connection does not delete or deprovision any resources.&lt;/p&gt; 
&lt;p&gt;There are two parts to the private services access configuration process:&lt;br&gt; - Allocating an IP address range.&lt;br&gt; - Creating a private connection from your VPC network to the service producer network.&lt;/p&gt; 
&lt;p&gt;Allocating an IP address range&lt;/p&gt; 
&lt;p&gt;1. Go to the VPC networks page in the Google Cloud Console.&lt;br&gt; 2. Select the VPC network that you want to use.&lt;br&gt; 3. Select the Private service connection tab.&lt;br&gt; 4. Select the Allocated IP ranges for services tab.&lt;br&gt; 5. Click Allocate IP range.&lt;br&gt; 6. For the Name of the allocated range, specify google-managed-services-VPC_NETWORK_NAME, where VPC_NETWORK_NAME is the name of the VPC network you are connecting (for example, google-managed-services-default). The Description is optional.&lt;br&gt; 7. Select the Custom option, then enter the IP address range to allocate, in CIDR notation.&lt;br&gt; 8. Click Allocate to create the allocated range.&lt;/p&gt; 
&lt;p&gt;Creating a private connection&lt;/p&gt; 
&lt;p&gt;1. Go to the VPC networks page in the Google Cloud Console.&lt;br&gt; 2. Select the VPC network that you want to use.&lt;br&gt; 3. Select the Private service connection tab.&lt;br&gt; 4. Select the Private connections to services tab.&lt;br&gt; 5. Click Create connection to create a private connection between your network and a service producer.&lt;br&gt; 6. For the Assigned allocation, select one or more existing allocated ranges that are not being used by other service producers.&lt;br&gt; 7. Click Connect to create the connection.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configuring private services access" url="https://cloud.google.com/sql/docs/mysql/configure-private-services-access"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that private services access for Cloud SQL instances is configured either automatically or manually.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL1" name="Control access to Cloud SQL for MySQL using IAM access control" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control access to Cloud SQL for MySQL using IAM access control&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Configuring access control involves controlling who or what can access the instance. Access control occurs on two levels:&lt;/p&gt; 
&lt;p&gt;- Instance-level access&lt;br&gt; Instance-level access authorizes access to your Cloud SQL instance from an application or client (running on App Engine or externally) or from another Google Cloud service, such as Compute Engine.&lt;br&gt; - Database access&lt;br&gt; Database access uses the MySQL Access Privilege System to control which MySQL users have access to the data in your instance.&lt;/p&gt; 
&lt;p&gt;Google Cloud offers Identity and Access Management (IAM), which lets you give more granular access to specific Google Cloud resources and prevents unwanted access to other resources. &lt;br&gt; Cloud SQL provides a set of predefined roles designed to help you control access to your Cloud SQL resources. You can also create your own custom roles, if the predefined roles do not provide the sets of permissions you need. In addition, the legacy basic roles (Editor, Viewer, and Owner) are also still available to you, although they do not provide the same fine-grained control as the Cloud SQL roles. In particular, the basic roles provide access to resources across Google Cloud, rather than just for Cloud SQL.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Predefined roles&lt;/p&gt; 
&lt;p&gt;Cloud SQL provides some predefined roles you can use to provide finer-grained permissions to project members. The role you grant to a project member controls what actions the member can take. Project members can be individuals, groups, or service accounts.&lt;/p&gt; 
&lt;p&gt;You can grant multiple roles to the same project member, and you can change the roles granted to a project member at any time, provided you have the permissions to do so.&lt;/p&gt; 
&lt;p&gt;The broader roles include the more narrowly defined roles. For example, the Cloud SQL Editor role includes all of the permissions of the Cloud SQL Viewer role, along with the addition permissions of the Cloud SQL Editor role. Likewise, the Cloud SQL Admin role includes all of the permissions of the Cloud SQL Editor role, along with its additional permissions.&lt;/p&gt; 
&lt;p&gt;The basic roles (Owner, Editor, Viewer) provide permissions across Google Cloud. The roles specific to Cloud SQL provide only Cloud SQL permissions, except for the following Google Cloud permissions, which are needed for general Google Cloud usage:&lt;/p&gt; 
&lt;p&gt;- resourcemanager.projects.get&lt;br&gt; - resourcemanager.projects.list&lt;br&gt; - serviceusage.quotas.get&lt;br&gt; - serviceusage.services.get&lt;br&gt; - serviceusage.services.use&lt;/p&gt; 
&lt;p&gt;To see the full list of predefined roles and their Cloud SQL permissions please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Custom roles&lt;/p&gt; 
&lt;p&gt;If the predefined roles do not address your unique business requirements, you can define your own custom roles with permissions that you specify. To support this, IAM offers custom roles.&lt;/p&gt; 
&lt;p&gt;When you create custom roles for Cloud SQL, make sure that if you include either cloudsql.instances.list or cloudsql.instances.get, that you include them both. Otherwise, the Cloud Console will not function correctly for Cloud SQL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Instance access control" url="https://cloud.google.com/sql/docs/mysql/instance-access-control"/>
            <reference name="Project access control" url="https://cloud.google.com/sql/docs/mysql/project-access-control"/>
          </references>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Testing permissions&lt;/p&gt;

	&lt;p&gt;Most Google Cloud resources expose the testIamPermissions() method, which allows you to programmatically check whether the currently authenticated caller has been granted one or more specific IAM permissions on the resource. The testIamPermissions() method takes a resource identifier and a set of permissions as input parameters, and returns the set of permissions that the caller is allowed.&lt;/p&gt;

	&lt;p&gt;You can use the testIamPermissions() method to determine whether a user should have access to an administrative tool in a web application. For example, you can use this method to decide, based on the user's permissions, whether to display detailed information about a Google Cloud resource.&lt;/p&gt;

	&lt;p&gt;Note: If you need to test a permission so that you can troubleshoot access to a resource, use the Policy Troubleshooter instead.&lt;/p&gt;

	&lt;p&gt;For example, to determine if the currently authenticated user has the permission to delete a project, call the projects.testIamPermissions() method by providing the project ID (such as foo-project) and the resourcemanager.projects.delete permission as input parameters. If the caller has been granted the resourcemanager.projects.delete permission, it will be listed in the response body. If the caller does not have this permission, the response body will list no permissions.&lt;/p&gt;

	&lt;p&gt;The testIamPermissions() method is intended for third-party graphical user interfaces (GUIs) that need to display Google Cloud resources based on what the authenticated user has permissions to see. For example, the Cloud Console internally uses the testIamPermissions() method to determine what resources and functionality are visible to you after authenticating. Different users are typically granted different permissions, and the Cloud Console hides or exposes items accordingly.&lt;/p&gt;

	&lt;p&gt;How to test permissions&lt;/p&gt;

	&lt;p&gt;This example shows how to test the resourcemanager.projects.get and resourcemanager.projects.delete permissions for a Google Cloud project. To test permissions for other Google Cloud resources, use the testIamPermissions() method exposed by each resource. For example, you can test the IAM permissions for a Cloud Storage bucket.&lt;/p&gt;

	&lt;p&gt;In this example, the user has an IAM role that allows them to get information about a project, but not to delete projects.&lt;/p&gt;

	&lt;p&gt;The Resource Manager API's projects.testIamPermissions method accepts a list of permissions and tests which of the permissions a member has.&lt;/p&gt;

	&lt;p&gt;Before using any of the request data below, make the following replacements:&lt;/p&gt;

	&lt;p&gt;project-id: Your Google Cloud project ID.&lt;br /&gt;
HTTP method and URL:&lt;/p&gt;

	&lt;p&gt;POST https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;Request JSON body:&lt;/p&gt;

	&lt;p&gt;{
  ""permissions"":  [
    ""resourcemanager.projects.get"",
    ""resourcemanager.projects.delete""
  ]&lt;br /&gt;
}&lt;/p&gt;

	&lt;p&gt;Note: Ensure you have set the GOOGLE_APPLICATION_CREDENTIALS environment variable to your service account private key file path.&lt;br /&gt;
Save the request body in a file called request.json, and execute the following command:&lt;/p&gt;

	&lt;p&gt;curl -X POST \&lt;br /&gt;
-H ""Authorization: Bearer ""$(gcloud auth application-default print-access-token) \&lt;br /&gt;
-H ""Content-Type: application/json; charset=utf-8"" \&lt;br /&gt;
-d @request.json \&lt;br /&gt;
https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;You should receive a JSON response similar to the following:&lt;/p&gt;

	&lt;p&gt;{
  ""permissions"": [
    ""resourcemanager.projects.get""
  ]&lt;br /&gt;
}&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.491">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL4" name="Create cross-region read replicas for Cloud SQL instances" issueId="" issueLink="" platform="" cost="1" risk="59" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create cross-region read replicas for Cloud SQL instances&lt;/p&gt;

	&lt;p&gt;Rationale:&lt;br /&gt;
Cross-region replication lets you create a read replica in a different region from the primary instance. You create a cross-region read replica the same way as you create an in-region replica.&lt;br /&gt;
The general idea is to create a replica in another region, wait until replication catches up, promote it, and then direct clients to the newly promoted instance.&lt;/p&gt;

	&lt;p&gt;Cross-region replicas:&lt;br /&gt;
- Improve read performance by making replicas available closer to your application's region.&lt;br /&gt;
- Provide additional disaster recovery capability to guard against a regional failure.&lt;br /&gt;
- Let you migrate data from one region to another with minimum downtime.&lt;/p&gt;

	&lt;p&gt;Remediation:&lt;br /&gt;
Creating a read replica&lt;/p&gt;

	&lt;p&gt;The steps for creating a read replica are below.&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Find the instance you want to create a replica for, and open its more actions menu at the far right of the listing.&lt;br /&gt;
3. Select Create read replica.&lt;br /&gt;
If you do not see that choice, the instance is a replica; you cannot create a replica of a replica.&lt;br /&gt;
4. If the instance had backups and binary logging enabled, continue with Step 6. Otherwise, select Automate backups and Enable binary logging, click Continue, and then click Save and restart to restart the instance.&lt;br /&gt;
Enabling binary logging causes the instance to be restarted.&lt;br /&gt;
5. In the Create read replica page, update the instance ID, if needed, and any other configuration options required, including name, region, and zone.&lt;br /&gt;
6. Click Create.&lt;br /&gt;
Cloud SQL creates a backup, if needed, and creates the replica. You are returned to the instance page for the primary.&lt;/p&gt;


	&lt;p&gt;Promoting a replica&lt;/p&gt;

	&lt;p&gt;To promote a replica to a standalone instance:&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Select a replica instance by clicking its name.&lt;br /&gt;
3. Click Promote replica in the button bar.&lt;br /&gt;
4. Click OK.&lt;/p&gt;

	&lt;p&gt;Impact:&lt;br /&gt;
None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Creating read replicas" url="https://cloud.google.com/sql/docs/mysql/replication/create-replica"/>
            <reference name="Promoting replicas for regional migration or disaster recovery" url="https://cloud.google.com/sql/docs/mysql/replication/cross-region-replicas"/>
            <reference name="Replication in Cloud SQL" url="https://cloud.google.com/sql/docs/mysql/replication"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Confirm that the promoted instance is configured correctly. In particular, enable automated backups and consider configuring the instance for high availability.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM05" name="Create Individual Accounts for the administrator users" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create individual accounts for administrator users and with these new accounts perform the necessary administrative actions. By creating service accounts for people accessing your account, you can give each Google user a unique set of security credentials and roles.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for administrative actions and for giving or revoking credentials to users' accounts. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console and open the IAM page.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Select a project.&lt;/li&gt; 
  &lt;li&gt;Select your project and click Open.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Create Service Account.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Enter a service account name, select a role you wish to grant to the service account and click Create.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: manage service accounts" url="https://cloud.google.com/iam/docs/creating-managing-service-accounts"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console and open the IAM
                            page.&lt;/li&gt;
                            &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select your project and click Open.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Review that each administrator user has an individual Google Service Account.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM04" name="Create mechanisms to ensure Least Privilege is applied" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create mechanisms to periodically review the group and user permissions to ensure the least
                        privilege for the user accounts. Granting least privilege ensures that users only have the
                        permissions required to complete their tasks rather than additional privileges that are not
                        required. Following this model ensures that, should an account be compromised, the blast radius
                        of damage is limited.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Allocate privileges via groups or roles via the recommendation in &amp;quot;Use RBAC with
                        pre-defined policies added into groups or roles&amp;quot;.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Google Cloud Platform Console and open the IAM page.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Review the groups and users with access to the project and their permissions.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If there is a user with more privileges, revoke the access as following:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the user to revoke privileges.&lt;/li&gt;
                        &lt;li&gt;In the Roles(s) drop-down menu in the member's row, uncheck the roles you want to
                        revoke and click Save.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Granting, changing, and revoking access to resources" url="https://cloud.google.com/iam/docs/granting-changing-revoking-access"/>
          </references>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check there is a mechanism in place to ensure the enforcement of the Least Privilege
                            principle.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM02" name="Define roles for the Google Service Accounts" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Define and create the roles for the Google Cloud. For each role, you can use one of the
                        predefined roles or create a new custom role to ensure that each role has got the least minimum
                        permissions.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;List all predefined roles and review them.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If it's necessary, create new custom roles to ensure users have the least privileges.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;List all roles.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fulfill the least privilege principle.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all roles are defined correctly.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.886">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL2" name="Disable local_infile database flag for MySQL" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Disable local_infile database flag for MySQL&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; The local_infile flag controls the server-side LOCAL capability for LOAD DATA statements. Depending on the local_infile setting, the server refuses or permits local data loading by clients that have LOCAL enabled on the client side.&lt;br&gt; To explicitly cause the server to refuse LOAD DATA LOCAL statements (regardless of how client programs and libraries are configured at build time or runtime), start mysqld with local_infile disabled. local_infile can also be set at runtime.&lt;br&gt; Due to security issues associated with the local_infile flag, it is recommended to disable it.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; How to set local_infile flag to off&lt;/p&gt; 
&lt;p&gt;From Console:&lt;br&gt; 1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br&gt; 2. Select the MySQL instance where the database flag needs to be enabled.&lt;br&gt; 3. Click Edit.&lt;br&gt; 4. Scroll down to the Flags section.&lt;br&gt; 5. To set a flag that has not been set on the instance before, click Add item, choose the flag local_infile from the drop-down menu, and set its value to off.&lt;br&gt; 6. Click Save.&lt;br&gt; 7. Confirm the changes under Flags on the Overview page.&lt;/p&gt; 
&lt;p&gt;From Command Line:&lt;br&gt; 1. List all Cloud SQL database instances using the following command: gcloud sql instances list&lt;br&gt; 2. Configure the local_infile database flag for every Cloud SQL MySQL database instance using the below command:&amp;nbsp;&lt;/p&gt; 
&lt;p&gt;gcloud sql instances patch INSTANCE_NAME -database-flags local_infile=off&lt;/p&gt; 
&lt;p&gt;Note : This command will overwrite all database flags that were previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ("=").&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Disabling local_infile makes the server refuse local data loading by clients that have LOCAL enabled on the client side.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configuring database flags" url="https://cloud.google.com/sql/docs/mysql/flags"/>
            <reference name="Security Considerations for LOAD DATA LOCAL" url="https://dev.mysql.com/doc/refman/5.7/en/load-data-local-security.html"/>
          </references>
          <standards>
            <standard ref="6.1.3" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="6.1.3" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that local_infile database flag for MySQL is disabled&lt;/p&gt;

	&lt;p&gt;From Console:&lt;br /&gt;
1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Select the instance to open its Instance Overview page&lt;br /&gt;
3. Ensure the database flag local_infile that has been set is listed under the Database flags section.&lt;/p&gt;

	&lt;p&gt;From Command Line:&lt;br /&gt;
1. List all Cloud SQL database instances: gcloud sql instances list&lt;br /&gt;
2. Ensure the below command returns off for every Cloud SQL MySQL database instance. gcloud sql instances describe INSTANCE_NAME -format=json | jq '.settings.databaseFlags[] | select(.name=="local_infile")|.value'&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.491">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG01" name="Enable all access logs" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable all access logs&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Enable all audit logs in the Google Cloud Platform to control and monitor the access of users and the configuration changes in the systems. &lt;br&gt; First, you have to know there are two types of audit logs in the Google Cloud Platform: &lt;br&gt; - Admin Activity audit logs that are enabled for all services and cannot be configured.&lt;br&gt; - Data Access audit logs that are not enabled by default and they shall be configured.&lt;/p&gt; 
&lt;p&gt;Remediation: &lt;br&gt; Configure Data Access audit logs with the Cloud console&lt;/p&gt; 
&lt;p&gt;You can also use the API or the Google Cloud CLI to perform these tasks programmatically.&lt;/p&gt; 
&lt;p&gt;To access audit log configuration options in the Cloud console, follow these steps:&lt;/p&gt; 
&lt;p&gt;1. From the Cloud console, select IAM &amp;amp; Admin &amp;gt; Audit Logs:&lt;/p&gt; 
&lt;p&gt;2. Select an existing Cloud project, folder, or organization at the top of the page.&lt;/p&gt; 
&lt;p&gt;Enable audit logs&lt;/p&gt; 
&lt;p&gt;To enable Data Access audit logs, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the main table on the Audit Logs page, select one or more Google Cloud services from the Title column.&lt;/p&gt; 
&lt;p&gt;2. In the Log Type tab, select the Data Access audit log types that you want to enable and then click Save.&lt;/p&gt; 
&lt;p&gt;3. Where you have successfully enabled audit logs, the table includes a checkmark. In the following example, you see that, for the Cloud Composer API service, Admin Read and Data Read audit logs are enabled:&lt;/p&gt; 
&lt;p&gt;You can also enable audit logs for all Google Cloud services that produce Data Access audit logs. In the main table on the Audit Logs page, select all Google Cloud services.&lt;/p&gt; 
&lt;p&gt;Note that this bulk configuration method applies only to the Google Cloud services that are currently available. If a new Google Cloud service is added, it inherits your default audit configuration.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure Data Access audit logs" url="https://cloud.google.com/logging/docs/audit/configure-data-access#config-console"/>
            <reference name="Google Cloud docs: data access" url="https://cloud.google.com/logging/docs/audit/configure-data-access#project-and-organization"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Check that all audit logs in the Google Cloud Platform are enabled and configured.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL3" name="Enable high availability on MySQL instances" issueId="" issueLink="" platform="" cost="1" risk="59" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable high availability on MySQL instances&lt;/p&gt;

	&lt;p&gt;Rationale:&lt;br /&gt;
The HA configuration, sometimes called a cluster, provides data redundancy. A Cloud SQL instance configured for HA is also called a regional instance and is located in a primary and secondary zone within the configured region. Within a regional instance, the configuration is made up of a primary instance and a standby instance. Through synchronous replication to each zone's persistent disk, all writes made to the primary instance are also made to the standby instance. In the event of an instance or zone failure, this configuration reduces downtime, and your data continues to be available to client applications.&lt;/p&gt;

	&lt;p&gt;Remediation:&lt;br /&gt;
Creating a new instance configured for high availability&lt;/p&gt;

	&lt;p&gt;When you create an instance and configure it for high availability, Cloud SQL creates it as a regional instance.&lt;/p&gt;

	&lt;p&gt;To create an instance configured for high availability:&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Create an instance.&lt;br /&gt;
3. On the Instance info page, select Show configuration options.&lt;br /&gt;
4. Open Backups, recovery, and high availability.&lt;br /&gt;
5. Select the High availability (regional) radio button.&lt;br /&gt;
Leave the Automate backups and Enable point-in-time recovery checkboxes enabled.&lt;/p&gt;


	&lt;p&gt;Configuring an existing instance for high availability&lt;/p&gt;

	&lt;p&gt;Configuring an existing instance for high availability causes a few minutes of downtime while the instance is reconfigured.&lt;/p&gt;

	&lt;p&gt;To configure an existing instance for high availability:&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Click the instance name to open its Overview page.&lt;br /&gt;
3. Click Edit.&lt;br /&gt;
4. Open Backups, recovery, and high availability.&lt;br /&gt;
5. Enable the Automate backups and Enable point-in-time recovery checkboxes.&lt;br /&gt;
6. Select High availability (regional).&lt;br /&gt;
7. Click Save.&lt;br /&gt;
You are returned to the instance page for the primary instance while the instance is updated.&lt;/p&gt;

	&lt;p&gt;Impact:&lt;br /&gt;
Once you start the high availability configuration on an instance, you cannot stop it. This operation restarts the instance. It typically takes only a few minutes for the configuration and restart to complete. But if the instance has a large disk or load, it might take up to an hour.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Enabling and disabling high availability on an instance" url="https://cloud.google.com/sql/docs/mysql/configure-ha"/>
            <reference name="Overview of the high availability configuration" url="https://cloud.google.com/sql/docs/mysql/high-availability"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Initiating failover&lt;/p&gt;

	&lt;p&gt;Testing failover is optional, but is recommended so that you can see how your application responds in the event of a failover.&lt;/p&gt;

	&lt;p&gt;Note: This feature helps you test your application's response to an automatic failover. Make sure your instance has completed any previous failover (so it is responding to connection requests) before you trigger another failover.&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Click the primary instance name to open its Instance details page.&lt;br /&gt;
3. Click Failover in the button bar.&lt;/p&gt;

	&lt;p&gt;The instance fails over and is not available to serve data for a few minutes.&lt;/p&gt;


	&lt;p&gt;Verifying an instance has high availability&lt;/p&gt;

	&lt;p&gt;To verify an instance has high availability:&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Click an instance name to open its Instance details page.&lt;br /&gt;
3. Under Configuration, it shows Highly available (regional).&lt;/p&gt;

	&lt;p&gt;Note: The new high availability does not use the legacy failover replica. You will not see a failover replica in the instances list unless you are using the legacy configuration.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL8" name="Encrypt data in transit for MySQL" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Encrypt data in transit for MySQL&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; SSL/TLS provides security when connecting to Cloud SQL. SSL/TLS is automatically provided when using:&lt;br&gt; - The Cloud SQL Proxy&lt;br&gt; - The Java Socket Library&lt;br&gt; - The built-in mechanisms in the App Engine environments.&lt;br&gt; In these situations, self-managed SSL/TLS certificates are not required.&lt;br&gt; When connecting to an instance with a public IP address, you must authorize using one of the above methods or using self-managed SSL/TLS certificates.&lt;br&gt; If requiring SSL/TLS certificates is enabled, then all connections must use certificates or the Cloud SQL Proxy, whether using public or private IP.&lt;/p&gt; 
&lt;p&gt;The Cloud SQL Proxy provides secure access to your instances without the need for Authorized networks or for configuring SSL.&lt;br&gt; Accessing your Cloud SQL instance using the Cloud SQL Proxy offers the following advantages:&lt;br&gt; - Secure connections: The proxy automatically encrypts traffic to and from the database using TLS 1.2 with a 128-bit AES cipher; SSL certificates are used to verify client and server identities.&lt;br&gt; - Easier connection management: The proxy handles authentication with Cloud SQL, removing the need to provide static IP addresses.&lt;br&gt; The proxy does not provide a new connectivity path; it relies on existing IP connectivity. To connect to a Cloud SQL instance using private IP, the proxy must be on a resource with access to the same VPC network as the instance.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Cloud SQL Proxy&lt;/p&gt; 
&lt;p&gt;To use the proxy, you must meet the following requirements:&lt;/p&gt; 
&lt;p&gt;- The Cloud SQL Admin API must be enabled.&lt;br&gt; - You must provide the proxy with Google Cloud authentication credentials.&lt;br&gt; - You must provide the proxy with a valid database user account and password.&lt;br&gt; - The instance must either have a public IPv4 address, or be configured to use private IP.&lt;/p&gt; 
&lt;p&gt;The public IP address does not need to be accessible to any external address (it does not need to be added as an authorized network address).&lt;/p&gt; 
&lt;p&gt;Installing the Cloud SQL Proxy&lt;/p&gt; 
&lt;p&gt;Download and install Cloud SQL Proxy. Please see Reference URL for specific instructions about each OS.&lt;/p&gt; 
&lt;p&gt;Proxy startup options&lt;/p&gt; 
&lt;p&gt;When you start the proxy, you provide it with the following information:&lt;/p&gt; 
&lt;p&gt;- What Cloud SQL instances to establish connections to&lt;br&gt; - Where it will listen for data coming from your application to be sent to Cloud SQL&lt;br&gt; - Where it will find the credentials it will use to authenticate your application to Cloud SQL&lt;br&gt; - If required, which IP address type to use.&lt;/p&gt; 
&lt;p&gt;The proxy startup options you provide determine whether it will listen on a TCP port or on a Unix socket. If it is listening on a Unix socket, it creates the socket at the location you choose; usually, the /cloudsql/ directory. For TCP, the proxy listens on localhost by default.&lt;/p&gt; 
&lt;p&gt;Run the cloud_sql_proxy executable with the argument -help to view the complete list of startup options.&lt;/p&gt; 
&lt;p&gt;Note: The Cloud SQL Proxy does not support Unix sockets on Windows.&lt;/p&gt; 
&lt;p&gt;You can install the proxy anywhere in your local environment. The location of the proxy binaries does not impact where it listens for data from your application.&lt;/p&gt; 
&lt;p&gt;Requiring SSL/TLS&lt;/p&gt; 
&lt;p&gt;When requiring SSL/TLS is enabled, you can either use the Cloud SQL Proxy or SSL/TLS certificates to connect to your Cloud SQL instance. If you do not require SSL/TLS, clients without a valid certificate are allowed to connect.&lt;br&gt; If you plan to connect using SSL/TLS, Google Cloud recommends that you enforce all connections to use SSL/TLS.&lt;/p&gt; 
&lt;p&gt;To enable requiring SSL/TLS:&lt;/p&gt; 
&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br&gt; 2. Click the instance name to open its Instance details page.&lt;br&gt; 3. Click the Connections link in the left navigation pane.&lt;br&gt; 4. Scroll down to the SSL connections section.&lt;br&gt; 5. Click Allow only SSL connections.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="About the Cloud SQL Proxy" url="https://cloud.google.com/sql/docs/mysql/sql-proxy"/>
            <reference name="Authorizing with SSL/TLS certificates" url="https://cloud.google.com/sql/docs/mysql/authorize-ssl"/>
            <reference name="Configuring SSL/TLS certificates" url="https://cloud.google.com/sql/docs/mysql/configure-ssl-instance"/>
          </references>
          <standards>
            <standard ref="A02:2021-Cryptographic Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A3:2017-Sensitive Data Exposure" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Server certificates&lt;/p&gt;

	&lt;p&gt;Cloud SQL creates a server certificate automatically when you create your instance. As long as the server certificate is valid, you do not need to actively manage your server certificate. However, the certificate has an expiration date of 10 years; after that date, it is no longer valid, and clients are not able to establish a secure connection to your instance using that certificate. You are notified when the server certificate is nearing expiration.&lt;/p&gt;

	&lt;p&gt;In the console you can get information about your server certificate, such as when it was created and when it expires, or manually create a new one.&lt;/p&gt;

	&lt;p&gt;1. Go to the Cloud SQL Instances page in the Google Cloud Console.&lt;br /&gt;
2. Click the instance name to open its Instance details page.&lt;br /&gt;
3. Click the Connections link in the left navigation pane.&lt;br /&gt;
4. Scroll down to the Configure SSL server certificates section.&lt;br /&gt;
You can see the expiration date of your server certificate in the table.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MYSQL5" name="Find and set maintenance windows for Cloud SQL instances" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Find and set maintenance windows for Cloud SQL instances&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Cloud SQL instances need occasional updates to fix bugs, prevent security exploits, and perform upgrades. After applying updates, Cloud SQL restarts the instances, which can cause a disruption in service. During maintenance, HA primary instances do not fail over to standby instances.&lt;/p&gt; 
&lt;p&gt;Maintenance windows are blocks of time when Cloud SQL schedules this maintenance to take place.&lt;br&gt; If you want to get notification of upcoming maintenance updates, you must do both of the following:&lt;br&gt; - Set your preferred maintenance options on instances. You can control the day of the week and time when an instance receives updates.&lt;br&gt; - Opt in to get notifications for when maintenance occurs. This helps you plan for disruptions.&lt;br&gt; If you do not specify a preferred window, disruptive updates can happen at any time, although they generally only occur every few months.&lt;br&gt; Note: Maintenance and updates for severe security issues can happen during a deny maintenance period.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Setting a preferred window for maintenance on an instance&lt;/p&gt; 
&lt;p&gt;To set a preferred maintenance window:&lt;/p&gt; 
&lt;p&gt;1. Go to the Instances page.&lt;br&gt; 2. Click an Instance name.&lt;br&gt; 3. On the Cloud SQL instance Overview page, click Edit maintenance preferences.&lt;br&gt; 4. Under Configuration options, open Maintenance.&lt;br&gt; 5. Configure the following options:&lt;br&gt; - Preferred window. Set the day and hour range when updates can occur on this instance.&lt;br&gt; - Order of update. Set the order for updating this instance, in relation to updates to other instances. Set timing to Any, Earlier, or Later. Instances using the Earlier setting receive updates up to a week before instances using the Later setting, when comparing instances that reside in the same location.&lt;/p&gt; 
&lt;p&gt;Opting in to maintenance notifications&lt;/p&gt; 
&lt;p&gt;Even when you opt in to notifications, you do not receive them unless you set a preferred window for maintenance on an instance&lt;/p&gt; 
&lt;p&gt;Note: If you select Any for the maintenance window, you do not receive notifications, even if you opt in for them.&lt;/p&gt; 
&lt;p&gt;1. Go to the Communication page.&lt;br&gt; 2. In the row for Cloud SQL, Maintenance window, select the radio button under Email to turn it ON.&lt;br&gt; Each user that needs to receive notifications must opt in separately.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Finding and setting maintenance windows" url="https://cloud.google.com/sql/docs/mysql/set-maintenance-window"/>
            <reference name="Overview of maintenance on Cloud SQL instances" url="https://cloud.google.com/sql/docs/mysql/maintenance"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Finding maintenance notifications in the Cloud Console&lt;/p&gt;

	&lt;p&gt;You can view maintenance notifications in a few places in the Cloud Console:&lt;/p&gt;

	&lt;p&gt;- On the ACTIVITY dashboard, look for instances marked with SQL Maintenance.&lt;br /&gt;
- When an instance is scheduled for maintenance, the date for maintenance is listed on the Instances page in the Maintenance column. The Maintenance column is usually hidden, but it displays automatically when maintenance is scheduled. You can also select Maintenance from the Column display options (Column display options icon is three lines) if you want the Maintenance column to always show up.&lt;br /&gt;
- Alternatively, you can select an instance to go to the Instance details page. If the instance is scheduled for maintenance, you will see a message in the Maintenance pane.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.492">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM01" name="Recertify user access" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Do regular reviews of service accounts on the system and verify they do not contain stolen or
                        fake accounts. This process ensures there are not any compromised accounts by former employees
                        or attackers.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select your project and click Open. All service accounts are listed in the Service
                        Accounts page.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist, select the user and click the Delete button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: manage service accounts" url="https://cloud.google.com/iam/docs/creating-managing-service-accounts"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select your project and click Open. All service accounts are listed in the Service
                            Accounts page.&lt;/li&gt;
                            &lt;li&gt;Check that the necessary users appear in the list.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;And check that there is a process to review the access users at least every 90
                            days.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.886">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-STO02" name="Securely store your credentials" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Make sure that you securely store your credentials. This can be done differently depending on
                        your environment and where you store your credentials. For example, if you store your
                        credentials in a configuration file, make sure that you set appropriate permissions on that file
                        to prevent unwanted access. If you are using Google App Engine, consider using StorageByKeyName
                        to store your credentials.</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Best practices storage" url="https://cloud.google.com/storage/docs/best-practices"/>
          </references>
          <standards>
            <standard ref="A02:2021-Cryptographic Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A3:2017-Sensitive Data Exposure" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the credentials are stored securely.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-USER-MFA" name="Setup Multi-factor Authentication for Google Cloud Platform accounts" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Setup Multi-factor Authentication for Google Cloud Platform accounts 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Rationale: 
&lt;/div&gt; 
&lt;div&gt;
  Multi-factor authentication requires more than one mechanism to authenticate a user. This secures user logins from attackers exploiting stolen or weak credentials. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Remediation: 
&lt;/div&gt; 
&lt;div&gt;
  Deploy 2-Step Verification 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Step 1: Notify users of 2-Step Verification deployment (required) 
&lt;/div&gt; 
&lt;div&gt;
  Before deploying 2-Step Verification, communicate your company's plans to your users, including: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  - What is 2-Step Verification and why your company is using it 
&lt;/div&gt; 
&lt;div&gt;
  - Whether 2-Step Verification is optional or required 
&lt;/div&gt; 
&lt;div&gt;
  - If required, give the date by which users must turn on 2-Step Verification 
&lt;/div&gt; 
&lt;div&gt;
  - Which 2-Step Verification method is required or recommended. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Step 2: Set up basic 2-Step Verification (required) 
&lt;/div&gt; 
&lt;div&gt;
  Next, let your users turn on 2-Step Verification. By default, users can turn on 2-Step Verification and use any verification method. (G Suite accounts created before December 2016 have 2-Step Verification turned off by default). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Applying 2-Step Verification settings 
&lt;/div&gt; 
&lt;div&gt;
  You can customize 2-Step Verification settings for organizational units and exception groups-a group of users within organizational unit. For example, require security keys for a small team in your Sales organizational unit. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  How exception groups work 
&lt;/div&gt; 
&lt;div&gt;
  - You can assign one exception group to an organizational unit. 
&lt;/div&gt; 
&lt;div&gt;
  - Users in the exception group must belong to the organizational unit. 
&lt;/div&gt; 
&lt;div&gt;
  - 2-Step Verification settings apply to users in the exception group (not to group addresses or nested groups). 
&lt;/div&gt; 
&lt;div&gt;
  - Create the groups in Admin console, Groups API, or Directory Sync (not Google Groups). 
&lt;/div&gt; 
&lt;div&gt;
  For easier identification, you might include the organizational unit in the name of exception groups (for example, exgrp_OU_name). 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Also: 
&lt;/div&gt; 
&lt;div&gt;
  - Allow users to turn on 2-Step Verification 
&lt;/div&gt; 
&lt;div&gt;
  - Tell your users to enroll in 2-Step Verification 
&lt;/div&gt; 
&lt;div&gt;
  - Track users' enrollment&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Step 3: Enforce 2-Step Verification (optional) 
&lt;/div&gt; 
&lt;div&gt;
  Make sure users are enrolled in 2-Step Verification before turning on enforcement. Users who aren't enrolled can't sign in to their accounts. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Also: 
&lt;/div&gt; 
&lt;div&gt;
  - Ensure a smooth transition to an enforcement policy 
&lt;/div&gt; 
&lt;div&gt;
  - Choose a 2-Step Verification method to enforce 
&lt;/div&gt; 
&lt;div&gt;
  - Turn on enforcement 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  For more details please follow the Reference URL. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Impact: 
&lt;/div&gt; 
&lt;div&gt;
  None 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Deploy 2-Step Verification" url="https://support.google.com/a/answer/9176657"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  For each Google Cloud Platform project, folder, or organization: 
&lt;/div&gt; 
&lt;div&gt;
  1. Identify non-service accounts. 
&lt;/div&gt; 
&lt;div&gt;
  2. Manually verify that multi-factor authentication for each account is set. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM06" name="Use Security Key for 2-Step Verification for administrator or co-administrator accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Ensure that the users with administrator and co-administrator accounts activate and configure the second factor authentication provided by Google. With 2-Step Verification, you can log into Google with a security key.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To activate and configure 2 Factor Authentication, you shall follow the following steps: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to the 2-Step Verification page section of &lt;a href="https://myaccount.google.com/signinoptions/two-step-verification"&gt;My Account&lt;/a&gt;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Add security key.&lt;/li&gt; 
  &lt;li&gt;Follow the on-screen instructions.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: mobile account" url="https://support.google.com/accounts/answer/6103523?co=GENIE.Platform%3DAndroid#phone"/>
            <reference name="Google support: answers" url="https://support.google.com/accounts/answer/6103534"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to the 2-Step Verification page section of My Account.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that 2-Step Verification authentication is enabled and configured correctly.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.887">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="AUTHENTICATION" name="Authentication" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the administrator account due to lack of configuration of the account and its security mechanisms, such as modifying credentials and adding/removing user accounts.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-IAM-01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM06" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON02">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM05" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-IAM05" mitigation="50"/>
                <countermeasure ref="GOOGLE-IAM06" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="GOOGLE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the user account due to lack of configuration of the account, for example, the security question to reset the password is configured incorrectly.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-IAM03">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM01" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON03">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-USER-MFA" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-IAM01" mitigation="50"/>
                <countermeasure ref="GOOGLE-USER-MFA" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-EXPIRATION-DATE">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM08" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE_IAM-02">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM02" mitigation="25"/>
                    <countermeasure ref="GOOGLE-IAM03" mitigation="25"/>
                    <countermeasure ref="GOOGLE-IAM04" mitigation="25"/>
                    <countermeasure ref="GOOGLE-MYSQL1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-IAM02" mitigation="25"/>
                <countermeasure ref="GOOGLE-IAM03" mitigation="25"/>
                <countermeasure ref="GOOGLE-IAM04" mitigation="25"/>
                <countermeasure ref="GOOGLE-IAM08" mitigation="25"/>
                <countermeasure ref="GOOGLE-MYSQL1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-DATA-REMOVED" name="Attackers destroy the data and the data cannot be recovered" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers gain access to the systems and data with excessive permissions and they remove all the information from the system, which might lead to permanent loss of data, including sensitive or personal data.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-BACKUP">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL3" mitigation="50"/>
                    <countermeasure ref="GOOGLE-MYSQL4" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL3" mitigation="50"/>
                <countermeasure ref="GOOGLE-MYSQL4" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHZ-SERVICES-NOT-UPDATE" name="Attackers gain access to the system exploiting a known vulnerability" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to the systems because the security patches for each system have not been applied or the licenses of the products have expired.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NOT-PATCHED">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL5" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL5" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-MON01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL9" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL9" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to data storage" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A data breach is a security violation in which sensitive, protected or confidential data is copied, transmitted, viewed, stolen or used by an individual unauthorized to do so. Sensitive data could be exposed due to a bad configuration in user permissions.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL2" mitigation="100"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-USECURE-CREDENTIALS">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-STO02" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL2" mitigation="100"/>
                <countermeasure ref="GOOGLE-STO02" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP A10:2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.&lt;br /&gt;
 Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-LOG01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-LOG01" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NET-01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL6" mitigation="50"/>
                    <countermeasure ref="GOOGLE-MYSQL7" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL6" mitigation="50"/>
                <countermeasure ref="GOOGLE-MYSQL7" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="DATA-EXPOSED-CHANNEL" name="The data is exposed through the transmission channel" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers can obtain the data through the transmitted channel because this does not have the security measures in place to protect the data&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="DATA-TRANSMIT-CLEAR">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MYSQL8" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MYSQL8" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="347bfbe3-ae5d-451b-984d-ba5a668f6926" diagramComponentId="98f6babf-0de3-4b18-990b-4cfdd82c16db" ref="ef612fc3-c2c3-4285-9142-3de04b0bfeb3" name="GCP Platform Environment" desc="" library="Google Cloud Platform" parentComponentRef="" componentDefinitionRef="google-cloud-platform-environment">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="GOOGLE-LOGS03" name="Audit logs can be deleted" state="0" impact="100" issueId="" issueLink="">
          <desc>There is no external backups of log records. If logs are deleted, there is no way to recover them.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.980">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON02" name="Excessive use of administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The administrator accounts are used for all actions, not only for the administrative ones. This is because these users do not have a personal or user account to perform their daily actions.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.589">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.980">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON03" name="Lack of 2FA" state="0" impact="100" issueId="" issueLink="">
          <desc>Login to the console without using Multi-factor Authentication (MFA) is considered as suspicious activity. Therefore connection without MFA must be audited and monitored and the corresponding security group must be informed and must validate this connection.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.209">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="LOST-SECURITY-ALERTS" name="Misconfigured Security contact details" state="0" impact="100" issueId="" issueLink="">
          <desc>The security contact details for the Azure subscription are not properly configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Access &amp;quot;Azure Security Center&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;In the &amp;quot;Recommendations&amp;quot; tab choose &amp;quot;Provide security
                            contact details&amp;quot;.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fields are filled.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.590">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-IAM03" name="Misconfigured User Account" state="0" impact="100" issueId="" issueLink="">
          <desc>Key security settings such as resetting the password, and other password controls are not
                        configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.590">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-IAM-01" name="Misconfigured authentication method for administrator accounts" state="0" impact="100" issueId="" issueLink="">
          <desc>The authentication method "Multi-factor Authentication" for the Administrator accounts is not
                        configured.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.590">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE_IAM-02" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials for the groups and roles are incorrectly configured and there are user accounts with more privileges than necessary.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.589">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-EXPIRATION-DATE" name="Misconfigured security key expirations" state="0" impact="100" issueId="" issueLink="">
          <desc>The password and security key expiration is not configured and users are not obliged to change
                        their security credentials. Not frequently changing passwords, gives attackers the chance to
                        obtain credentials and gain access to the systems.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.590">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-VNET01" name="Networks for Google Cloud resources are not properly segmented" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources in the same VNet are compromised because when one of them is attacked and the
                        attackers gain access, they also gain access to all resources.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.289">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-RESOURCES-STATUS" name="Undetected Resources status changes" state="0" impact="100" issueId="" issueLink="">
          <desc>Changes to the system status are not controlled with the consequence of system failure.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.210">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON06" name="Undetected brute force attempts on the Google Cloud console" state="0" impact="100" issueId="" issueLink="">
          <desc>Failed connection attempts (brute force) must be audited and monitored and the corresponding personnel must be alerted and informed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.209">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON05" name="Undetected changes in the data encryption configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Changes to the database encryption must be audited and monitored. When there are changes to the database encryption, the security group must be alerted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.209">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON07" name="Undetected changes in the network configuration" state="0" impact="100" issueId="" issueLink="">
          <desc>Changes in network configurations (NACLs, route and gateway tables) are not detected because monitoring and alerts of network configuration changes are not in place.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.209">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON01" name="Undetected changes in the security configurations" state="0" impact="100" issueId="" issueLink="">
          <desc>Monitoring and alerting for security configurations are not configured and changes cannot be detected.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.590">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-MON04" name="Undetected changes in the security groups" state="0" impact="100" issueId="" issueLink="">
          <desc>Changes in the security groups must be traced and monitored and the corresponding personnel must approve these changes. If the configuration is not appropriate, attackers can gain access to security systems.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.210">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="GOOGLE-IAM03" name="Apply RBAC with pre-defined policies added into groups and roles" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Define and create groups that relate to job functions (administrators, developers, accounting,
                        etc.) and assign the relevant permissions for each group, and then assign IAM users to those
                        groups. All the users in an IAM group inherit the permissions assigned to the group. That way,
                        you can make changes for everyone in a group in just one place. As people move around in your
                        company, you can simply change what IAM group their IAM user belongs to. This method is known as
                        Role Based Access Control (RBAC).&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        To add a team member and grant an IAM role to the member:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&lt;/li&gt;
                        &lt;li&gt;Click Add to add new members to the project and set their permissions. In the Select a
                        role drop-down menu, click on a service name to find the roles that belong to that service.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;To grant more than one role to the same project member:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&lt;/li&gt;
                        &lt;li&gt;Enter the email address of the member and select all the roles that you want to grant
                        to the member. Click Add.&amp;nbsp;&lt;/li&gt;
                        &lt;/ol&gt;To grant a role to a member for more than one project:
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM and Admin Projects page in the Cloud Platform Console and open the IAM
                        &amp;amp; ADMIN PROJECTS page.&lt;/li&gt;
                        &lt;li&gt;Select all the projects for which you want to grant permissions.&lt;/li&gt;
                        &lt;li&gt;In the IAM tab on the right pane, add the new member and select a role to grant the
                        role for all selected projects.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Granting, changing, and revoking access to resources" url="https://cloud.google.com/iam/docs/granting-changing-revoking-access"/>
          </references>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the IAM page in the Cloud Platform Console and open the IAM page.&lt;/li&gt;
                            &lt;li&gt;Click Select a project and click Open.&lt;/li&gt;
                            &lt;li&gt;List all members from the project.&lt;/li&gt;
                            &lt;li&gt;Check that each member has been assigned to the correct roles.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM08" name="Automatically rotate Google Service account keys" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>The Google Service Keys shall be rotated to avoid unauthorized access.
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        To enable automatic rotation of a key, set the rotation schedule with the following gcloud
                        command-line syntax:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        gcloud kms keys update KEY_NAME \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --location LOCATION \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --keyring KEYRING_NAME \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --rotation-period ROTATION_PERIOD \&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --next-rotation-time NEXT_ROTATION_TIME&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;/blockquote&gt;For example:&amp;nbsp;
                        &lt;div&gt;
                        gcloud kms keys update KEY_NAME&amp;nbsp;
                        &lt;/div&gt;
                        &lt;blockquote&gt;
                        &lt;div&gt;
                        --rotation-period=30d&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        --next-rotation-time=2016-10-12T12:34:56.1234Z
                        &lt;/div&gt;
                        &lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: KMS rotation schedule" url="https://cloud.google.com/kms/docs/rotating-keys#kms-set-rotation-schedule-cli"/>
          </references>
          <standards>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check automatic rotation of keys is enabled.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM19" name="Avoid assigning Service Account roles to IAM users at project level" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;is recommended to assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator (iam.serviceAccountTokenCreator) roles to a user for a specific service account rather than assigning the role to a user at project level.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;A service account is a special Google account that belongs to an application or a virtual machine (VM), instead of to an individual end-user. Application/VM-Instance uses the service account to call the service's Google API so that users aren't directly involved. In addition to being an identity, a service account is a resource that has IAM policies attached to it. These policies determine who can use the service account.&lt;/p&gt;&lt;p&gt;Users with IAM roles to update the App Engine and Compute Engine instances (such as App Engine Deployer or Compute Instance Admin) can effectively run code as the service accounts used to run these instances, and indirectly gain access to all the resources for which the service accounts have access. Similarly, SSH access to a Compute Engine instance may also provide the ability to execute code as that instance/Service account.&lt;/p&gt;&lt;p&gt;Based on business needs, there could be multiple user-managed service accounts configured for a project. Granting the iam.serviceAccountUser or iam.serviceAserviceAccountTokenCreatorccountUser roles to a user for a project gives the user access to all service accounts in the project, including service accounts that may be created in the future. This can result in elevation of privileges by using service accounts and corresponding Compute Engine instances.&lt;/p&gt;&lt;p&gt;In order to implement least privileges best practices, IAM users should not be assigned the Service Account User or Service Account Token Creator roles at the project level. Instead, these roles should be assigned to a user for a specific service account, giving that user access to the service account. The Service Account User allows a user to bind a service account to a long-running job service, whereas the Service Account Token Creator role allows a user to directly impersonate (or assert) the identity of a service account.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;After revoking Service Account User or Service Account Token Creator roles at the project level from all impacted user account(s), these roles should be assigned to a user(s) for specific service account(s) according to business needs.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the IAM page in the GCP Console by visiting: https://console.cloud.google.com/iam-admin/iam.&lt;/p&gt;&lt;p&gt;2. Click on the filter table text bar. Type Role: Service Account User&lt;/p&gt;&lt;p&gt;3. Click the Delete Bin icon in front of the role Service Account User for every user listed as a result of a filter.&lt;/p&gt;&lt;p&gt;4. Click on the filter table text bar. Type Role: Service Account Token Creator&lt;/p&gt;&lt;p&gt;5. Click the Delete Bin icon in front of the role Service Account Token Creator for every user listed as a result of a filter.&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. Using a text editor, remove the bindings with the roles/iam.serviceAccountUser or roles/iam.serviceAccountTokenCreator.&lt;/p&gt;&lt;p&gt;2. Update the project's IAM policy:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects set-iam-policy PROJECT_ID iam.json&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.6" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.6" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the IAM page in the GCP Console by visiting https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. Click on the filter table text bar, Type Role: Service Account User.&lt;/p&gt;&lt;p&gt;3. Ensure no user is listed as a result of the filter.&lt;/p&gt;&lt;p&gt;4. Click on the filter table text bar, Type Role: Service Account Token Creator.&lt;/p&gt;&lt;p&gt;5. Ensure no user is listed as a result of the filter.&lt;/p&gt;&lt;p&gt;From Command Line: To ensure IAM users are not assigned Service Account User role at the project level:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects get-iam-policy PROJECT_ID --format json | jq '.bindings[].role' | grep "roles/iam.serviceAccountUser"&amp;nbsp;&lt;/p&gt;&lt;p&gt;gcloud projects get-iam-policy PROJECT_ID --format json | jq '.bindings[].role' | grep "roles/iam.serviceAccountTokenCreator"&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;These commands should not return any output.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM12" name="Avoid using API keys on a project" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to use standard authentication flow instead.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Security risks involved in using API-Keys appear below:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;API keys are simple encrypted strings&lt;/li&gt;&lt;li&gt;API keys do not identify the user or the application making the API request&lt;/li&gt;&lt;li&gt;API keys are typically accessible to clients, making it easy to discover and steal an API key&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;To avoid the security risk in using API keys, it is recommended to use standard authentication flow instead.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Deleting an API key will break dependent applications (if any).&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, to delete API Keys: Click the Delete Bin Icon in front of every API Key Name.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.12" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, no API key should be listed.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM09" name="Avoid using personal accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use corporate login credentials instead of personal accounts, such as Gmail accounts.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;It is recommended fully-managed corporate Google accounts be used for increased visibility, auditing, and controlling access to Cloud Platform resources. Email accounts based outside of the user's organization, such as personal accounts, should not be used for business purposes.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Follow the documentation and setup corporate login accounts.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.1" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.1" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;For each Google Cloud Platform project, list the accounts that have been granted access to that project:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects get-iam-policy PROJECT_ID&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Also list the accounts added on each folder:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud resource-manager folders get-iam-policy FOLDER_ID&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;And list your organization's IAM policy:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud organizations get-iam-policy ORGANIZATION_ID&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;No email accounts outside the organization domain should be granted permissions in the IAM policies. This excludes Google-owned service accounts.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM20" name="Block access to Cloud KMS cryptokeys from unauthorized access" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;It is recommended that the IAM policy on Cloud KMS cryptokeys should restrict anonymous and/or public access.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Granting permissions to allUsers or allAuthenticatedUsers allows anyone to access the dataset. Such access might not be desirable if sensitive data is stored at the location. In this case, ensure that anonymous and/or public access to a Cloud KMS cryptokey is not allowed.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Removing the binding for allUsers and allAuthenticatedUsers members denies accessing cryptokeys to anonymous or public users.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. List all Cloud KMS Cryptokeys.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud kms keys list --keyring=[key_ring_name] --location=global --format=json | jq '.[].name'&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. Remove IAM policy binding for a KMS key to remove access to allUsers and allAuthenticatedUsers using the below command.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allAuthenticatedUsers' --role='[role]'&amp;nbsp;&lt;/p&gt;&lt;p&gt;gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allUsers' --role='[role]'&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.9" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.9" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. List all Cloud KMS Cryptokeys.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud kms keys list --keyring=[key_ring_name] --location=global --format=json | jq '.[].name'&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. Ensure the below command's output does not contain allUsers and allAuthenticatedUsers.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud kms keys get-iam-policy [key_name] --keyring=[key_ring_name] --location=global --format=json | jq '.bindings[].members[]'&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET05" name="Configure Cloud DNS DNSSEC" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Cloud Domain Name System (DNS) is a fast, reliable and cost-effective domain name system that powers millions of domains on the internet. Domain Name System Security Extensions (DNSSEC) in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to Cloud DNS by visiting https://console.cloud.google.com/net-services/dns/zones.&lt;/p&gt;&lt;p&gt;2. For each zone of Type Public, set DNSSEC to On.&lt;/p&gt;&lt;p&gt;From Command Line: Use the below command to enable DNSSEC for Cloud DNS Zone Name.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dns managed-zones update ZONE_NAME --dnssec-state on&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ensure RSASHA1 is not used for the key-signing/zone-signing key.&lt;/p&gt;&lt;p&gt;1. If it is necessary to change the settings for a managed zone where it has been enabled, NSSEC must be turned off and re-enabled with different settings. To turn off DNSSEC, run the following command:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dns managed-zones update ZONE_NAME --dnssec-state off&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. To update key-signing for a reported managed DNS Zone, run the following command:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dns managed-zones update ZONE_NAME --dnssec-state on --ksk-algorithm KSK_ALGORITHM --ksk-key-length KSK_KEY_LENGTH --zsk-algorithm ZSK_ALGORITHM --zsk-key-length ZSK_KEY_LENGTH --denial-of-existence DENIAL_OF_EXISTENCE&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.3" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="3.4" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="3.5" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure the property algorithm for keyType zone signing is not using RSASHA1.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dns managed-zones describe --format="json(dnsName,dnssecConfig.state,dnssecConfig.defaultKeySpecs)"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG05" name="Configure Cloud DNS Logging" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Cloud DNS logging records the queries from the name servers within your VPC to Stackdriver. Logged queries can come from Compute Engine VMs, GKE containers, or other GCP resources provisioned within the VPC.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Security monitoring and forensics cannot depend solely on IP addresses from VPC flow logs, especially when considering the dynamic IP usage of cloud resources, HTTP virtual host routing, and other technology that can obscure the DNS name used by a client from the IP address. Monitoring of Cloud DNS logs provides visibility to DNS names requested by the clients within the VPC. These logs can be monitored for anomalous domain names, evaluated against threat intelligence.&lt;/p&gt; 
&lt;p&gt;Note: For full capture of DNS, firewall must block egress UDP/53 (DNS) and TCP/443 (DNS over HTTPS) to prevent client from using external DNS name server for resolution.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enabling logging for private managed zones&lt;/p&gt; 
&lt;p&gt;Use DNS policies to enable or disable logging for your networks, or use the DNS managed zone itself to enable or disable logging for queries resolved by that zone.&lt;/p&gt; 
&lt;p&gt;Note: When you enable query logging, every DNS query to a Cloud DNS managed zone is logged.&lt;/p&gt; 
&lt;p&gt;To enable logging for a network that does not have a DNS policy, run the dns policies create command.&lt;/p&gt; 
&lt;p&gt;gcloud dns policies create POLICY_NAME \ -networks=NETWORK \ -enable-logging \ -description=DESCRIPTION&lt;/p&gt; 
&lt;p&gt;Replace the following:&lt;/p&gt; 
&lt;p&gt;- POLICY_NAME: the name of the DNS policy&lt;br&gt; - NETWORK: one or more networks in a comma-separated list&lt;br&gt; - DESCRIPTION: a description of the policy&lt;/p&gt; 
&lt;p&gt;To enable logging for a network that has an existing DNS policy, run the dns policies update command.&lt;/p&gt; 
&lt;p&gt;gcloud dns policies update POLICY_NAME \ -networks=NETWORK \ -enable-logging&lt;/p&gt; 
&lt;p&gt;Replace the following:&lt;/p&gt; 
&lt;p&gt;- POLICY_NAME: the name of the DNS policy&lt;br&gt; - NETWORK: one or more networks in a comma-separated list&lt;/p&gt; 
&lt;p&gt;Enabling and disabling logging for managed public zones&lt;/p&gt; 
&lt;p&gt;To turn on logging for an existing managed public zone, run the dns managed-zones update command.&lt;/p&gt; 
&lt;p&gt;gcloud dns managed-zones update ZONE_NAME -log-dns-queries \&lt;/p&gt; 
&lt;p&gt;Replace ZONE_NAME with the name of the DNS managed zone that you want to enable logging for.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Enabling of Cloud DNS logging might result in your project being charged for the additional logs usage.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
            <reference name="Cloud DNS Logging and monitoring" url="https://cloud.google.com/dns/docs/monitoring"/>
          </references>
          <standards>
            <standard ref="2.12" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.12" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;From Command Line:&lt;/p&gt;

	&lt;p&gt;1. List all VPCs networks in a project: &lt;/p&gt;

	&lt;p&gt;gcloud compute networks list -format="table[box,title='All VPC Networks'](name:label='VPC Network Name')"&lt;/p&gt;

	&lt;p&gt;2. List all DNS policies, logging enablement, and associated VPC networks: &lt;/p&gt;

	&lt;p&gt;gcloud dns policies list -flatten="networks[]" -format="table[box,title='All DNS Policies By VPC Network'](name:label='Policy Name',enableLogging:label='LoggingEnabled':align=center,networks.networkUrl.basename():label='VPC Network Name')"&lt;/p&gt;

	&lt;p&gt;Each VPC Network should be associated with a DNS policy with logging enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-IAM-01" name="Configure essential contacts for organization" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;It is recommended that Essential Contacts is configured to designate email addresses for Google Cloud services to notify of important technical or security information.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;Many Google Cloud services, such as Cloud Billing, send out notifications to share important information with Google Cloud users. By default, these notifications are sent to members with certain Identity and Access Management (IAM) roles. With Essential Contacts, you can customize who receives notifications by providing your own list of contacts.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Essential Contacts by visiting https://console.cloud.google.com/iam-admin/essential-contacts&lt;/li&gt;&lt;li&gt;Make sure the organization appears in the resource selector at the top of the page. The resource selector tells you what project, folder, or organization you are currently managing contacts for.&lt;/li&gt;&lt;li&gt;Click +Add contact&lt;/li&gt;&lt;li&gt;In the Email and Confirm Email fields, enter the email address of the contact.&lt;/li&gt;&lt;li&gt;From the Notification categories drop-down menu, select the notification categories that you want the contact to receive communications for.&lt;/li&gt;&lt;li&gt;Click Save&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;To add an organization Essential Contacts run a command:&lt;/li&gt;&lt;/ol&gt;&lt;blockquote&gt;&lt;p&gt;gcloud essential-contacts create --email="&amp;lt;EMAIL&amp;gt;" \ --notification-categories="&amp;lt;NOTIFICATION_CATEGORIES&amp;gt;" \ --organization=&amp;lt;ORGANIZATION_ID&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Default Value:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;By default, there are no Essential Contacts configured.&lt;/p&gt;&lt;p&gt;In the absence of an Essential Contact, the following IAM roles are used to identify users to notify for the following categories:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Legal: roles/billing.admin&lt;/li&gt;&lt;li&gt;Security: roles/resourcemanager.organizationAdmin&lt;/li&gt;&lt;li&gt;Suspension: roles/owner&lt;/li&gt;&lt;li&gt;Technical: roles/owner&lt;/li&gt;&lt;li&gt;Technical Incidents: roles/owner&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Managing notification contacts" url="https://cloud.google.com/resource-manager/docs/managing-notification-contacts"/>
          </references>
          <standards>
            <standard ref="1.16" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.16" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to Essential Contacts by visiting https://console.cloud.google.com/iam-admin/essential-contacts&lt;/li&gt;&lt;li&gt;Make sure the organization appears in the resource selector at the top of the page. The resource selector tells you what project, folder, or organization you are currently managing contacts for.&lt;/li&gt;&lt;li&gt;Ensure that appropriate email addresses are configured for each of the following notification categories:&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;Legal&lt;/li&gt;&lt;li&gt;Security&lt;/li&gt;&lt;li&gt;Suspension&lt;/li&gt;&lt;li&gt;Technical&lt;/li&gt;&lt;li&gt;Technical Incidents&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Alternatively, appropriate email addresses can be configured for the All notification category to receive all possible important notifications.&amp;nbsp;&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;To list all configured organization Essential Contacts run a command: gcloud essential-contacts list --organization=&amp;lt;ORGANIZATION_ID&amp;gt;&lt;/li&gt;&lt;li&gt;Ensure at least one appropriate email address is configured for each of the following notification categories:&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;LEGAL&lt;/li&gt;&lt;li&gt;SECURITY&lt;/li&gt;&lt;li&gt;SUSPENSION&lt;/li&gt;&lt;li&gt;TECHNICAL&lt;/li&gt;&lt;li&gt;TECHNICAL_INCIDENTS&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Alternatively, appropriate email addresses can be configured for the ALL notification category to receive all possible important notifications.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET04" name="Configure Firewall Rules for instances behind IAP" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Access to VMs should be restricted by firewall rules that allow only IAP traffic by ensuring only connections proxied by the IAP are allowed. To ensure that load balancing works correctly health checks should also be allowed.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;IAP ensure that access to VMs is controlled by authenticating incoming requests. However if the VM is still accessible from IP addresses other than the IAP it may still be possible to send unauthenticated requests to the instance. Care must be taken to ensure that loadbalancer health checks are not blocked as this would stop the loadbalancer from correctly knowing the health of the VM and loadbalancing correctly.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;If firewall rules are not configured correctly, legitimate business services could be negatively impacted.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to the Cloud Console VPC network &amp;gt; Firewall rules.&lt;/p&gt;&lt;p&gt;2. Select the checkbox next to the following rules:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;default-allow-http&lt;/li&gt;&lt;li&gt;default-allow-https&lt;/li&gt;&lt;li&gt;default-allow-internal&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;3. Click Delete.&lt;/p&gt;&lt;p&gt;4. Click Create firewall rule and set the following values:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Name: allow-iap-traffic&lt;/li&gt;&lt;li&gt;Targets: All instances in the network&lt;/li&gt;&lt;li&gt;Source IP ranges (press Enter after you paste each value in the box):&lt;ul&gt;&lt;li&gt;130.211.0.0/22&lt;/li&gt;&lt;li&gt;35.191.0.0/16&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;Protocols and ports:&lt;ul&gt;&lt;li&gt;Specified protocols and ports&lt;/li&gt;&lt;li&gt;tcp:80&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;5. When you're finished updating values, click Create.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.10" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to the Cloud Console VPC network &amp;gt; Firewall rules.&lt;/p&gt;&lt;p&gt;2. Verify that the only rules correspond to the following values:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Targets: All instances in the network&lt;/li&gt;&lt;li&gt;Source IP ranges (press Enter after you paste each value in the box):&lt;ul&gt;&lt;li&gt;130.211.0.0/22&lt;/li&gt;&lt;li&gt;35.191.0.0/16&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;Protocols and ports:&lt;ul&gt;&lt;li&gt;Specified protocols and ports&lt;/li&gt;&lt;li&gt;tcp:80&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG06" name="Configure sinks for all logs entries" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;It is recommended to create a sink that will export copies of all the log entries. This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM).&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Log entries are held in Cloud Logging. To aggregate logs, export them to a SIEM. To keep them longer, it is recommended to set up a log sink. Exporting involves writing a filter that selects the log entries to export, and choosing a destination in Cloud Storage, BigQuery, or Cloud Pub/Sub. The filter and destination are held in an object called a sink. To ensure all log entries are exported to sinks, ensure that there is no filter configured for a sink. Sinks can be created in projects, organizations, folders, and billing accounts.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Create a sink (console)&lt;/p&gt; 
&lt;p&gt;You can create up to 200 sinks per Cloud project.&lt;/p&gt; 
&lt;p&gt;After you create the sink, ensure that Logging has the appropriate permissions to write logs to your sink's destination.&lt;/p&gt; 
&lt;p&gt;To create a sink, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud console, go to the Logs Router page:&lt;/p&gt; 
&lt;p&gt;2. Select an existing Cloud project.&lt;/p&gt; 
&lt;p&gt;3. Select Create sink.&lt;/p&gt; 
&lt;p&gt;4. In the Sink details panel, enter the following details:&lt;/p&gt; 
&lt;p&gt;- Sink name: Provide an identifier for the sink; note that after you create the sink, you can't rename the sink but you can delete it and create a new sink.&lt;/p&gt; 
&lt;p&gt;- Sink description (optional): Describe the purpose or use case for the sink.&lt;/p&gt; 
&lt;p&gt;5. In the Sink destination panel, select the sink service and destination:&lt;/p&gt; 
&lt;p&gt;- Select sink service: Select the service where you want your logs routed.&lt;/p&gt; 
&lt;p&gt;Based on the service that you select, you can select from the following destinations:&lt;/p&gt; 
&lt;p&gt;- Cloud Logging bucket: Select or create a Logging bucket.&lt;br&gt; - BigQuery table: Select or create the particular dataset to receive the routed logs. You also have the option to use partitioned tables.&lt;br&gt; - Cloud Storage bucket: Select or create the particular Cloud Storage bucket to receive the routed logs.&lt;br&gt; - Pub/Sub topic: Select or create the particular topic to receive the routed logs.&lt;br&gt; - Splunk: Select the Pub/Sub topic for your Splunk service.&lt;br&gt; - Other Cloud project: Manually add the Logging, BigQuery, Cloud Storage, or Pub/Sub service and destination information in the following format:&lt;/p&gt; 
&lt;p&gt;SERVICE.googleapis.com/projects/PROJECT_ID/SINK_DESTINATION/DESTINATION_ID&lt;/p&gt; 
&lt;p&gt;For example, if your sink destination is a BigQuery dataset, the sink destination would be the following:&lt;/p&gt; 
&lt;p&gt;bigquery.googleapis.com/projects/PROJECT_ID/datasets/DATASET_ID&lt;/p&gt; 
&lt;p&gt;Note that if you are routing logs between Cloud projects, you still need the appropriate destination permissions.&lt;/p&gt; 
&lt;p&gt;6. In the Choose logs to include in sink panel, do the following:&lt;/p&gt; 
&lt;p&gt;a. In the Build inclusion filter field, enter a filter expression that matches the log entries you want to include. If you don't set a filter, all logs from your selected resource are routed to the destination.&lt;/p&gt; 
&lt;p&gt;For example, you might want to build a filter to route all Data Access logs to a single Logging bucket. This filter looks like the following:&lt;/p&gt; 
&lt;p&gt;LOG_ID("cloudaudit.googleapis.com/data_access") OR LOG_ID("externalaudit.googleapis.com/data_access")&lt;/p&gt; 
&lt;p&gt;Note that the length of a filter can't exceed 20,000 characters.&lt;/p&gt; 
&lt;p&gt;b. To verify you entered the correct filter, select Preview logs. This opens the Logs Explorer in a new tab with the filter prepopulated.&lt;/p&gt; 
&lt;p&gt;7. (Optional) In the Choose logs to filter out of sink panel, do the following:&lt;/p&gt; 
&lt;p&gt;a. In the Exclusion filter name field, enter a name.&lt;/p&gt; 
&lt;p&gt;b. In the Build an exclusion filter field, enter a filter expression that matches the log entries you want to exclude. You can also use the sample function to select a portion of the log entries to exclude.&lt;/p&gt; 
&lt;p&gt;Key Point: If you want your exclusion filter to be disabled when the sink is created, then select Disable after you enter your filter expression. You can update the sink later to enable the exclusion filter.&lt;/p&gt; 
&lt;p&gt;You can create up to 50 exclusion filters per sink. Note that the length of a filter can't exceed 20,000 characters.&lt;/p&gt; 
&lt;p&gt;8. Select Create sink.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; There are no costs or limitations in Cloud Logging for exporting logs, but the export destinations charge for storing or transmitting the log data.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
            <reference name="Configure and manage sinks" url="https://cloud.google.com/logging/docs/export/configure_export_v2"/>
          </references>
          <standards>
            <standard ref="2.2" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.2" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;From Console:&lt;/p&gt;

	&lt;p&gt;1. Go to Logging/Exports by visiting https://console.cloud.google.com/logs/exports.&lt;/p&gt;

	&lt;p&gt;2. For every sink, click the 3-dot button for Menu options and select View Filter.&lt;/p&gt;

	&lt;p&gt;3. Ensure there is at least one sink with an empty sink filter.&lt;/p&gt;

	&lt;p&gt;4. Additionally, ensure that the resource configured as Destination exists.&lt;/p&gt;

	&lt;p&gt;From Command Line:&lt;/p&gt;

	&lt;p&gt;1. Ensure that a sink with an empty filter exists. List the sinks for the project, folder or organization. If sinks are configured at a folder or organization level, they do not need to be configured for each project: &lt;/p&gt;

	&lt;p&gt;gcloud logging sinks list -folder=FOLDER_ID | -organization=ORGANIZATION_ID | -project=PROJECT_ID&lt;/p&gt;

	&lt;p&gt;The output should list at least one sink with an empty filter.&lt;/p&gt;

	&lt;p&gt;2. Additionally, ensure that the resource configured as Destination exists.&lt;/p&gt;

	&lt;p&gt;See https://cloud.google.com/sdk/gcloud/reference/beta/logging/sinks/list for more information.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-GOV01" name="Configure the reset security challenge questions for Administrator accounts" issueId="" issueLink="" platform="" cost="1" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Ensure configuration of the security challenge questions for the Administrator accounts recover or reset password process are secure.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to &lt;a href="https://myaccount.google.com/security#signin"&gt;Google Cloud Account&lt;/a&gt;.&lt;/li&gt; 
  &lt;li&gt;Fill in the fields from the &amp;quot;Recover Account Options&amp;quot; sections and click &amp;quot;Save&amp;quot;.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: Security" url="https://myaccount.google.com/security#signin"/>
          </references>
          <standards>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to &lt;a href="https://myaccount.google.com/security#signin"&gt;Google Cloud
                            account&lt;/a&gt;.&lt;/li&gt;
                            &lt;li&gt;Check that all fields from the &amp;quot;Recover Account Options&amp;quot;
                            sections are filled correctly.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.470">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON06" name="Create alerts for changes in the security groups and in the security group configurations" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for changes in the security groups and in the security group configurations&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify about changes to the Security Groups or the Security Groups configuration. It's vital that monitoring of Security Groups detects and reports any unauthorized changes in the security systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when security groups and their configurations are changed or modified.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON03" name="Create alerts for security policy changes" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for security policy changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when the Security Policy changes. It's vital that monitoring of the Security Policy detects and reports any unauthorized changes in the security configurations. &lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section shall be set up. In this case, you have to add the condition for the next methods: projects.getIamPolicy, projects.setIamPolicy, organizations.getIamPolicy and organizations.setIamPolicy&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Modify IAM policy" url="https://cloud.google.com/logging/docs/audit/configure-data-access?hl=es-419#getiampolicy-setiampolicy"/>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify for security policy changes.&lt;br /&gt;
5. Check this alert is configured correctly and notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON13" name="Create alerts for the Logging of configuration changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for the Logging of configuration changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts for Logging changes to monitor, audit and notify about changes in this section by the corresponding personnel. It's vital that any unauthorized changes are detected and reported.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. You don't have to change it.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the Logging of configuration changes.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.131">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON10" name="Create alerts for the VPC route table changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for the VPC route table changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when the VPC Route Table changes. It's vital that monitoring of the VPC Route Table detects and reports any unauthorized access to the security network systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the VPC route table configuration changes.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON11" name="Create alerts for VPC gateway changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for VPC gateway changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when the VPC Gateway changes. It's vital that monitoring of the VPC Gateway detects and reports any unauthorized access to the security network systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;br&gt; 1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt;- The Conditions section is already set up. Fill the condition correctly.&lt;br&gt;- In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt;- In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the VPC gateway configuration changes.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON09" name="Create alerts for VPC NACL changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for VPC NACL changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when the VPC NACL (Network Access Control List) changes. It's vital that monitoring of VPC NACL detects and reports any unauthorized access to the security network systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the VPC NACL configuration changes.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON08" name="Create alerts to be notified about console login failure attempts" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts to be notified about console login failure attempts&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and to be notified when there are several console login failure attempts. It's vital that monitoring of these connection attempts detects and reports any unauthorized access to the systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the console login failure attempts are greater than a fixed number.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON05" name="Create alerts to be notified about console login without 2FA" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts to be notified about console login without 2FA&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when users log into the console without a Second Factor of Authentication. It's vital that monitoring of authentication to systems detects and reports any unauthorized access to them.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when users are logged into the console without using 2 Factor authentication&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON04" name="Create alerts to detect the changes of activity alerts" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts to detect the changes of activity alerts&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify about the changes of Monitoring alerts. It's vital that the monitoring of alerts detects and reports any unauthorized changes in the Monitoring systems.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. You don't have to change it.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify about the changes of activity alerts.&lt;br /&gt;
5. Check this alert is configured correctly and notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON02A" name="Create alerts to notify about improper usage of the root account" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts to notify about improper usage of the root account&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify about usage of the root account when this account is used frequently. It's vital that monitoring of root account usage detects and reports unauthorized or improper usage.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
            <reference name="Managing metric-based alerting policies" url="https://cloud.google.com/monitoring/alerts/using-alerting-ui"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify about improper usage of administrator accounts.&lt;br /&gt;
5. Check this alert is configured correctly and notifications are configured to be sent to the corresponding users.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.129">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON07" name="Create alerts when the data encryption changes" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts when the data encryption changes&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create alerts to monitor, audit and notify when the data encryption changes. It's vital that monitoring of data encryption detects and reports any unauthorized changes in the system configurations.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; To create an alerting policy, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring. &lt;br&gt; 2. Select Alerting.&lt;br&gt; 3. Click Create Policy to see the Create alerting policy page.&lt;br&gt; 4. Fill in the sections as follows:&lt;br&gt; - The Conditions section is already set up. Fill the condition correctly.&lt;br&gt; - In the Notifications section, click Add Notification and fill in your email address or another notification method.&lt;br&gt; - In the Name this policy section, you can accept the default.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring alerts" url="https://cloud.google.com/monitoring/alerts/"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br /&gt;
2. In the navigation pane, select Alerting.&lt;br /&gt;
3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;br /&gt;
4. Check there exists an Alerting Policy to notify when the data encryption configuration changes.&lt;br /&gt;
5. Check that this alert is configured correctly and its notifications are configured to be sent to the corresponding users&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.130">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-MON01" name="Create an uptime check to alert when the server is down" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create an uptime check to alert when the server is down&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Create an uptime check to verify your web server is always accessible. The alerting policy controls who is notified when the uptime check fails.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Create an uptime check and an alerting policy&lt;/p&gt; 
&lt;p&gt;To create an uptime check, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud console, select Monitoring.&lt;br&gt; 2. In the navigation pane, click Uptime checks.&lt;br&gt; 3. Click Create Uptime check.&lt;br&gt; 4. For the title, enter My Uptime Check and then click Next.&lt;br&gt; 5. Target:&lt;br&gt; a. Select HTTP as the protocol.&lt;br&gt; b. Select Instance as the Resource Type.&lt;br&gt; c. In the Applies To field, select Single and for the instance name select lamp-1-vm.&lt;br&gt; d. Leave all other fields at their default values and click Next.&lt;br&gt; 6. Response Validation: Leave these fields at their default values and click Next&lt;br&gt; 7. Alert &amp;amp; Notification:&lt;br&gt; a. Ensure that the toggle's label is Alerting is enabled.&lt;br&gt; b. Leave the name and duration fields at their default values.&lt;br&gt; c. To add a notification channel to the alerting policy, in the text box labeled Notification channels, click Menu. Select the channels to add and click OK. The notifications are grouped alphabetically for each channel type.&lt;br&gt; To add an entry to the checkbox list, click Manage notification channels and follow the instructions. When you return to this dialog, click Refresh.&lt;br&gt; 8. To verify your uptime check configuration, click Test. If you see a "Connection error - refused" message, you might have not installed the Apache HTTP Server or you might have specified the HTTPS check type rather than HTTP.&lt;br&gt; 9. Click Create. When the create action is successful, the message Check and alert created is displayed and then the Uptime checks dashboard page is displayed.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: monitoring gs checks" url="https://cloud.google.com/monitoring/quickstart-lamp#gs-checks"/>
            <reference name="Monitor a Compute Engine virtual machine" url="https://cloud.google.com/monitoring/monitor-compute-engine-virtual-machine"/>
          </references>
          <standards>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;1. Check there exists an uptime Check alert to notify when the server is down.&lt;br /&gt;
2. Check that this uptime Check alert is configured correctly.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:10.129">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM07" name="Create a process to create and manage the Google Service Keys" issueId="" issueLink="" platform="" cost="1" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create a process or mechanism to create, manage, or revoke the assignment of keys to users and
                        give them the least necessary access to resources. There are two types of service account keys:&amp;nbsp;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;GCP-managed keys:&lt;/b&gt;&amp;nbsp;These keys are used by Cloud Platform
                        services such as the App Engine and Compute Engine. These keys cannot be downloaded. Google will
                        keep the keys and automatically rotate them daily.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;&lt;b&gt;User-managed keys:&amp;nbsp;&lt;/b&gt;These keys are created, downloadable,
                        and managed by users. For user-managed keys, you need to ensure you have processes in place to
                        address key management requirements such as:&amp;nbsp;&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Key storage&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Key distribution&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Key revocation&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Key rotation&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Protecting the keys from unauthorized users.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: IAM manage account keys" url="https://cloud.google.com/iam/docs/understanding-service-accounts#managing_service_account_keys"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check there exists a mechanism or process to create, manage or revoke the assignment of
                            keys to users.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM05" name="Create Individual Accounts for the administrator users" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create individual accounts for administrator users and with these new accounts perform the necessary administrative actions. By creating service accounts for people accessing your account, you can give each Google user a unique set of security credentials and roles.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The administrator accounts shall be used for administrative actions and for giving or revoking credentials to users' accounts. The administrator account shall be not used as a normal user account. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console and open the IAM page.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Select a project.&lt;/li&gt; 
  &lt;li&gt;Select your project and click Open.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Create Service Account.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Enter a service account name, select a role you wish to grant to the service account and click Create.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: manage service accounts" url="https://cloud.google.com/iam/docs/creating-managing-service-accounts"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console and open the IAM
                            page.&lt;/li&gt;
                            &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select your project and click Open.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Review that each administrator user has an individual Google Service Account.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG04" name="Create log metric filters and alerts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create log metric filters and alerts&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; You can use log-based alerts to notify you whenever a specific message appears in your included logs. For example, if you want to know when an audit log records a particular data-access message, you can create a log-based alert that matches the message and notifies you when it appears.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Create a log-based alert (Logs Explorer)&lt;/p&gt; 
&lt;p&gt;You can create log-based alerts from the Logs Explorer page in the Google Cloud console or by using the Monitoring API.&lt;/p&gt; 
&lt;p&gt;The Logs Explorer interface for creating and editing log-based alerts guides you through the following steps:&lt;/p&gt; 
&lt;p&gt;- Provide a name and description for the alert.&lt;br&gt; - Choose the logs for which you want to receive a notification.&lt;br&gt; - Set the time between notifications.&lt;br&gt; - Set the time for automatic closure of incidents.&lt;br&gt; - Specify whom to notify.&lt;/p&gt; 
&lt;p&gt;For example, assume that you have an application that writes a syslog log entry with NOTICE severity when the application changes a network address. The log entries for network-address changes include a JSON payload that looks like the following:&lt;/p&gt; 
&lt;p&gt;"jsonPayload": { "type": "Configuration change", "action": "Set network address", "result": "IP_ADDRESS",&lt;br&gt; }&lt;/p&gt; 
&lt;p&gt;You want to create a log-based alert that notifies you when an invalid IPv4 address appears in the jsonPayload.result field of log entries in syslog with NOTICE severity.&lt;/p&gt; 
&lt;p&gt;To create the log-based alert, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud console, select Logging, and then select Logs Explorer:&lt;/p&gt; 
&lt;p&gt;2. Use the Query pane to build a query that matches the message you want to use in your log-based alert.&lt;/p&gt; 
&lt;p&gt;For example, to find log entries with a severity level of NOTICE in the syslog log that have invalid IP addresses in the JSON payload, you can use the following query:&lt;/p&gt; 
&lt;p&gt;log_id("syslog")&lt;br&gt; severity = "NOTICE"&lt;br&gt; jsonPayload.result !~ "^((25[0-5]|2[0-4][0-9]|&lt;sup&gt;&lt;a&gt;01&lt;/a&gt;&lt;/sup&gt;?[0-9][0-9]?)(\.|$)){4}$"&lt;/p&gt; 
&lt;p&gt;Use Run query in the Query results pane to validate the query.&lt;/p&gt; 
&lt;p&gt;3. In the header of the Query results pane, click Create alert. When your window is narrow, the Create alert option might appear on the Actions menu instead.&lt;/p&gt; 
&lt;p&gt;4. In the Alert details pane, give the alert a name and description:&lt;/p&gt; 
&lt;p&gt;a. Enter a name for your alert in the Alert Name field. For example: "Network address: invalid IPv4 value".&lt;/p&gt; 
&lt;p&gt;b. Enter a description of this alert. You can also include information that might help the recipient of a notification diagnose the problem. The following string summarizes the reason for the alert:&lt;/p&gt; 
&lt;p&gt;Log-based alert in project ${project} detected an invalid IPv4 value..&lt;/p&gt; 
&lt;p&gt;5. To advance to the next step, click Next.&lt;/p&gt; 
&lt;p&gt;6. In the Choose logs to include in the alert pane, check the query and results by clicking Preview logs.&lt;/p&gt; 
&lt;p&gt;Google Cloud recommends building the query in the Logs Explorer Query pane. The query you built in the Query pane is also displayed on this pane, for example:&lt;/p&gt; 
&lt;p&gt;log_id("syslog")&lt;br&gt; severity = "NOTICE"&lt;br&gt; jsonPayload.result !~ "^((25[0-5]|2[0-4][0-9]|&lt;sup&gt;&lt;a&gt;01&lt;/a&gt;&lt;/sup&gt;?[0-9][0-9]?)(\.|$)){4}$"&lt;/p&gt; 
&lt;p&gt;You can edit the query in this pane, if necessary. If you edit the query, then check the results by clicking Preview logs.&lt;/p&gt; 
&lt;p&gt;7. Click Next.&lt;/p&gt; 
&lt;p&gt;8. Select the minimum time between notifications. This value lets you control the number of notifications you get from this alert if it is triggered multiple times. For this example, select 5 min from the options.&lt;/p&gt; 
&lt;p&gt;You can leave the incident auto-close duration at the default value, or you can set it to a different value by selecting a different option on the menu.&lt;/p&gt; 
&lt;p&gt;9. Click Next.&lt;/p&gt; 
&lt;p&gt;10. Select one or more notification channels for your alert. For this example, select an email notification channel.&lt;/p&gt; 
&lt;p&gt;If you already have an email notification channel configured, then you can select it from the list. If not, click Manage notification channels and add an email channel. For information about creating notification channels, see Managing notification channels.&lt;/p&gt; 
&lt;p&gt;11. Click Save.&lt;/p&gt; 
&lt;p&gt;Your log-based alert is now ready to test.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
            <reference name="Managing log-based alerts" url="https://cloud.google.com/logging/docs/alerting/log-based-alerts"/>
          </references>
          <standards>
            <standard ref="2.10" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.10" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.11" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.11" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.4" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.4" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.5" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.5" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.6" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.6" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.7" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.7" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.8" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.8" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="2.9" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.9" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Test the example log-based alert&lt;/p&gt;

	&lt;p&gt;To test the alert you created in the Description section, you can manually write a log entry that matches the query. To write the log entry, do the following:&lt;/p&gt;

	&lt;p&gt;1. Configure the following log entry by changing the PROJECT_ID variable to your project ID:&lt;/p&gt;

	&lt;p&gt;{
  "entries": [
  {
    "logName": "projects/PROJECT_ID/logs/syslog",
    "jsonPayload": {
      "type": "Configuration change",
      "action": "Set network address",
      "result": "999.027.405.1",
    },
    "severity": "NOTICE",
    "resource": {
      "type": "generic_task",
      "labels" : {
        "project_id": "PROJECT_ID",
        "location": "us-east1",
        "namespace": "fake-task-2",
        "job": "write-log-entry",
        "task_id": "11",
      },
    },
  ],&lt;br /&gt;
}&lt;/p&gt;

	&lt;p&gt;2. Go to the logEntries.write reference page, or click the following button:&lt;/p&gt;

	&lt;p&gt;3. Copy the log entry you configured previously.&lt;/p&gt;

	&lt;p&gt;4. In the Try this API pane, do the following:&lt;/p&gt;

	&lt;p&gt;a. Replace the content of the Request body field in APIs Explorer with the log entry you copied in the previous step.&lt;/p&gt;

	&lt;p&gt;b. Click Execute. If prompted, follow the authentication flow.&lt;/p&gt;

	&lt;p&gt;If the logEntries.write call is successful, then you get an HTTP 200 response code and an empty response body, {}.&lt;/p&gt;

	&lt;p&gt;The log entry matches the filter specified for the alert in the following ways:&lt;/p&gt;

	&lt;p&gt;- The logName value specifies the syslog log in your Cloud project.&lt;br /&gt;
- The severity value for this log entry is NOTICE.&lt;br /&gt;
- The jsonPayload.result value is not a valid IPv4 address.&lt;/p&gt;

	&lt;p&gt;After you write the log entry, the following sequence occurs:&lt;/p&gt;

	&lt;p&gt;- The new log entry appears in the Logs Explorer and triggers the alert.&lt;br /&gt;
- An incident is opened in Cloud Monitoring.&lt;br /&gt;
- You receive a notification for the incident. If you configured an email notification channel, then the notification looks like the following screenshot:&lt;/p&gt;

	&lt;p&gt;You can click View incident in the email to see the incident in Cloud Monitoring.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM04" name="Create mechanisms to ensure Least Privilege is applied" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create mechanisms to periodically review the group and user permissions to ensure the least
                        privilege for the user accounts. Granting least privilege ensures that users only have the
                        permissions required to complete their tasks rather than additional privileges that are not
                        required. Following this model ensures that, should an account be compromised, the blast radius
                        of damage is limited.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Allocate privileges via groups or roles via the recommendation in &amp;quot;Use RBAC with
                        pre-defined policies added into groups or roles&amp;quot;.
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the IAM page in the Google Cloud Platform Console and open the IAM page.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select a project and click Open.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Review the groups and users with access to the project and their permissions.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If there is a user with more privileges, revoke the access as following:&lt;/li&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Select the user to revoke privileges.&lt;/li&gt;
                        &lt;li&gt;In the Roles(s) drop-down menu in the member's row, uncheck the roles you want to
                        revoke and click Save.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Granting, changing, and revoking access to resources" url="https://cloud.google.com/iam/docs/granting-changing-revoking-access"/>
          </references>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check there is a mechanism in place to ensure the enforcement of the Least Privilege
                            principle.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM02" name="Define roles for the Google Service Accounts" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Define and create the roles for the Google Cloud. For each role, you can use one of the
                        predefined roles or create a new custom role to ensure that each role has got the least minimum
                        permissions.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;List all predefined roles and review them.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;If it's necessary, create new custom roles to ensure users have the least privileges.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;List all roles.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all fulfill the least privilege principle.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that all roles are defined correctly.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-LOG-03" name="Enable Access Approval" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Access Approval enables you to require your organizations' explicit approval whenever Google support try to access your projects. You can then select users within your organization who can approve these requests through giving them a security role in IAM. All access requests display which Google Employee requested them in an email or Pub/Sub message that you can choose to Approve. This adds an additional control and logging of who in your organization approved/denied these requests.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;Controlling access to your information is one of the foundations of information security. Google Employees do have access to your organizations' projects for support reasons. With Access Approval, organizations can then be certain that their information is accessed by only approved Google Personnel.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Impact:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;To use Access Approval your organization will need have enabled Access Transparency and have at one of the following support level: Enhanced or Premium. There will be subscription costs associated with these support levels, as well as increased storage costs for storing the logs. You will also not be able to turn the Access Transparency which Access Approval depends on, off yourself. To do so you will need to submit a service request to Google Cloud Support. There will also be additional overhead in managing user permissions. There may also be a potential delay in support times as Google Personnel will have to wait for their access to be approved.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, within the project you wish to enable, click on the Navigation hamburger menu in the top left. Hover over the Security Menu. Select Access Approval in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;The status will be displayed here. On this screen, there is an option to click Enroll. If it is greyed out and you see an error bar at the top of the screen that says Access Transparency is not enabled please view the corresponding reference within this section to enable it.&lt;/li&gt;&lt;li&gt;In the second screen click Enroll.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Grant an IAM Group or User the role with permissions to Add Users to be Access Approval message Recipients&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, within the project you wish to enable, click on the Navigation hamburger menu in the top left. Hover over the IAM and Admin. Select IAM in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;Click the blue button the says +add at the top of the screen.&lt;/li&gt;&lt;li&gt;In the principals field, select a user or group by typing in their associated email address.&lt;/li&gt;&lt;li&gt;Click on the role field to expand it. In the filter field enter Access Approval Approver and select it.&lt;/li&gt;&lt;li&gt;Click save.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Add a Group or User as an Approver for Access Approval Requests&lt;/p&gt;&lt;ol&gt;&lt;li&gt;As a user with the Access Approval Approver permission, within the project where you wish to add an email address to which request will be sent, click on the Navigation hamburger menu in the top left. Hover over the Security Menu. Select Access Approval in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;Click Manage Settings&lt;/li&gt;&lt;li&gt;Under Set up approval notifications, enter the email address associated with a Google Cloud User or Group you wish to send Access Approval requests to. All future access approvals will be sent as emails to this address.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From CLI:&lt;/p&gt;&lt;p&gt;To update all services in an entire project, run the following command from an account that has permissions as an 'Approver for Access Approval Requests'&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud access-approval settings update --project=&amp;lt;project name&amp;gt; --enrolled_services=all --notification_emails='&amp;lt;email recipient for access approval requests&amp;gt;@&amp;lt;domain name&amp;gt;'&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Default Value:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;By default Access Approval and its dependency of Access Transparency are not enabled.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Access Approval" url="https://cloud.google.com/cloud-provider-access-management/access-approval/docs/overview"/>
          </references>
          <standards>
            <standard ref="2.15" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;Determine if Access Transparency is Enabled as it is a Dependency&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home inside the project you wish to audit, click on the Navigation hamburger menu in the top left. Hover over the IAM &amp;amp; Admin Menu. Select settings in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;The status should be "Enabled' under the heading Access Transparency&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Determine if Access Approval is Enabled&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, within the project you wish to check, click on the Navigation hamburger menu in the top left. Hover over the Security Menu. Select Access Approval in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;The status will be displayed here. If you see a screen saying you need to enroll in Access Approval, it is not enabled.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From CLI:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Determine if Access Approval is Enabled&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;From within the project you wish to audit, run the following command.&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud access-approval settings get&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;The status will be displayed in the output.&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-LOG-02" name="Enable Access Transparency" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Access Transparency provides audit logs for all actions that Google personnel take in your Google Cloud resources.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;Controlling access to your information is one of the foundations of information security. Given that Google Employees do have access to your organizations' projects for support reasons, you should have logging in place to view who, when, and why your information is being accessed.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Impact&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;To use Access Transparency your organization will need to have at one of the following support level: Premium, Enterprise, Platinum, or Gold. There will be subscription costs associated with support, as well as increased storage costs for storing the logs. You will also not be able to turn Access Transparency off yourself, and you will need to submit a service request to Google Cloud Support.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Add privileges to enable Access Transparency&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, within the project you wish to check, click on the Navigation hamburger menu in the top left. Hover over the 'IAM and Admin'. Select IAM in the top of the column that opens.&lt;/li&gt;&lt;li&gt;Click the blue button the says +add at the top of the screen.&lt;/li&gt;&lt;li&gt;In the principals field, select a user or group by typing in their associated email address.&lt;/li&gt;&lt;li&gt;Click on the role field to expand it. In the filter field enter Access Transparency Admin and select it.&lt;/li&gt;&lt;li&gt;Click save.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Verify that the Google Cloud project is associated with a billing account&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, click on the Navigation hamburger menu in the top left. Select Billing.&lt;/li&gt;&lt;li&gt;If you see This project is not associated with a billing account you will need to enter billing information or switch to a project with a billing account.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Enable Access Transparency&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, click on the Navigation hamburger menu in the top left. Hover over the IAM &amp;amp; Admin Menu. Select settings in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;Click the blue button labeled Enable Access Transparency for Organization&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;Default Value:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;By default Access Transparency is not enabled.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Access Transparency" url="https://cloud.google.com/cloud-provider-access-management/access-transparency/docs/overview"/>
          </references>
          <standards>
            <standard ref="2.14" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.14" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;Determine if Access Transparency is Enabled&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;From the Google Cloud Home, click on the Navigation hamburger menu in the top left. Hover over the IAM &amp;amp; Admin Menu. Select settings in the middle of the column that opens.&lt;/li&gt;&lt;li&gt;The status will be under the heading Access Transparency. Status should be Enabled&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.910">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG01" name="Enable all access logs" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable all access logs&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Enable all audit logs in the Google Cloud Platform to control and monitor the access of users and the configuration changes in the systems. &lt;br&gt; First, you have to know there are two types of audit logs in the Google Cloud Platform: &lt;br&gt; - Admin Activity audit logs that are enabled for all services and cannot be configured.&lt;br&gt; - Data Access audit logs that are not enabled by default and they shall be configured.&lt;/p&gt; 
&lt;p&gt;Remediation: &lt;br&gt; Configure Data Access audit logs with the Cloud console&lt;/p&gt; 
&lt;p&gt;You can also use the API or the Google Cloud CLI to perform these tasks programmatically.&lt;/p&gt; 
&lt;p&gt;To access audit log configuration options in the Cloud console, follow these steps:&lt;/p&gt; 
&lt;p&gt;1. From the Cloud console, select IAM &amp;amp; Admin &amp;gt; Audit Logs:&lt;/p&gt; 
&lt;p&gt;2. Select an existing Cloud project, folder, or organization at the top of the page.&lt;/p&gt; 
&lt;p&gt;Enable audit logs&lt;/p&gt; 
&lt;p&gt;To enable Data Access audit logs, do the following:&lt;/p&gt; 
&lt;p&gt;1. In the main table on the Audit Logs page, select one or more Google Cloud services from the Title column.&lt;/p&gt; 
&lt;p&gt;2. In the Log Type tab, select the Data Access audit log types that you want to enable and then click Save.&lt;/p&gt; 
&lt;p&gt;3. Where you have successfully enabled audit logs, the table includes a checkmark. In the following example, you see that, for the Cloud Composer API service, Admin Read and Data Read audit logs are enabled:&lt;/p&gt; 
&lt;p&gt;You can also enable audit logs for all Google Cloud services that produce Data Access audit logs. In the main table on the Audit Logs page, select all Google Cloud services.&lt;/p&gt; 
&lt;p&gt;Note that this bulk configuration method applies only to the Google Cloud services that are currently available. If a new Google Cloud service is added, it inherits your default audit configuration.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configure Data Access audit logs" url="https://cloud.google.com/logging/docs/audit/configure-data-access#config-console"/>
            <reference name="Google Cloud docs: data access" url="https://cloud.google.com/logging/docs/audit/configure-data-access#project-and-organization"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Check that all audit logs in the Google Cloud Platform are enabled and configured.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-LOG-01" name="Enable Cloud Asset Inventory" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Cloud Asset Inventory is services that provides a historical view of GCP resources and IAM policies through a time-series database. The information recorded includes metadata on Google Cloud resources, metadata on policies set on Google Cloud projects or resources, and runtime information gathered within a Google Cloud resource.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The GCP resources and IAM policies captured by GCP Cloud Asset Inventory enables security analysis, resource change tracking, and compliance auditing.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Impact&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;It is recommended GCP Cloud Asset Inventory be enabled for all GCP projects.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;From Console:&amp;nbsp;&lt;/p&gt;&lt;p&gt;Enable the Cloud Asset API:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;1Go to API &amp;amp; Services/Library by visiting https://console.cloud.google.com/apis/library&lt;/li&gt;&lt;li&gt;Search for Cloud Asset API and select the result for Cloud Asset API&lt;/li&gt;&lt;li&gt;Click the ENABLE button.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;p&gt;Enable the Cloud Asset API:&lt;/p&gt;&lt;p&gt;Enable the Cloud Asset API through the services interface:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud services enable cloudasset.googleapis.com&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Default Value:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The Cloud Asset Inventory API is disabled by default in each project.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Asset Inventory" url="https://cloud.google.com/asset-inventory/docs"/>
          </references>
          <standards>
            <standard ref="2.13" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.13" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&amp;nbsp;&lt;/p&gt;&lt;p&gt;Ensure that the Cloud Asset API is enabled:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to API &amp;amp; Services/Library by visiting https://console.cloud.google.com/apis/library&lt;/li&gt;&lt;li&gt;Search for Cloud Asset API and select the result for Cloud Asset API&lt;/li&gt;&lt;li&gt;Ensure that API Enabled is displayed.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;p&gt;Ensure that the Cloud Asset API is enabled:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Query enabled services:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud services list --enabled --filter=name:cloudasset.googleapis.com&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;If the API is listed, then it is enabled. If the response is Listed 0 items the API is not enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.910">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM15" name="Enable MFA for all non-service accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Secure Sockets Layer (SSL) policies determine what port Transport Layer Security (TLS) features clients are permitted to use when connecting to load balancers. To prevent usage of insecure features, SSL policies should use (a) at least TLS 1.2 with the MODERN profile; or (b) the RESTRICTED profile, because it effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version; or (3) a CUSTOM profile that does not support any of the following features:&amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;TLS_RSA_WITH_AES_128_GCM_SHA256&amp;nbsp;&lt;/li&gt;&lt;li&gt;TLS_RSA_WITH_AES_256_GCM_SHA384&amp;nbsp;&lt;/li&gt;&lt;li&gt;TLS_RSA_WITH_AES_128_CBC_SHA&amp;nbsp;&lt;/li&gt;&lt;li&gt;TLS_RSA_WITH_AES_256_CBC_SHA&amp;nbsp;&lt;/li&gt;&lt;li&gt;TLS_RSA_WITH_3DES_EDE_CBC_SHA&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Load balancers are used to efficiently distribute traffic across multiple servers. Both SSL proxy and HTTPS load balancers are external load balancers, meaning they distribute traffic from the Internet to a GCP network. GCP customers can configure load balancer SSL policies with a minimum TLS version (1.0, 1.1, or 1.2) that clients can use to establish a connection, along with a profile (Compatible, Modern, Restricted, or Custom) that specifies permissible cipher suites. To comply with users using outdated protocols, GCP load balancers can be configured to permit insecure cipher suites. In fact, the GCP default SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the widest range of insecure cipher suites. As a result, it is easy for customers to configure a load balancer without even knowing that they are permitting outdated cipher suites.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Creating more secure SSL policies can prevent clients using older TLS versions from establishing a connection.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console: If the TargetSSLProxy or TargetHttpsProxy does not have an SSL policy configured, create a new SSL policy. Otherwise, modify the existing insecure policy.&lt;/p&gt;&lt;p&gt;1. Navigate to the SSL Policies page by visiting: https://console.cloud.google.com/net-security/sslpolicies&lt;/p&gt;&lt;p&gt;2. Click on the name of the insecure policy to go to its SSL policy details page.&lt;/p&gt;&lt;p&gt;3. Click EDIT.&lt;/p&gt;&lt;p&gt;4. Set Minimum TLS version to TLS 1.2.&lt;/p&gt;&lt;p&gt;5. Set Profile to Modern or Restricted.&lt;/p&gt;&lt;p&gt;6. Alternatively, if teh user selects the profile Custom, make sure that the following features are disabled:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_GCM_SHA256&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_GCM_SHA384&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_3DES_EDE_CBC_SHA&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. For each insecure SSL policy, update it to use secure cyphers:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute ssl-policies update NAME [--profile COMPATIBLE|MODERN|RESTRICTED|CUSTOM] --min-tls-version 1.2 [--custom-features FEATURES]&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. If the target proxy has a GCP default SSL policy, use the following command corresponding to the proxy type to update it.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute target-ssl-proxies update TARGET_SSL_PROXY_NAME --ssl-policy SSL_POLICY_NAME&amp;nbsp;&lt;/p&gt;&lt;p&gt;gcloud compute target-https-proxies update TARGET_HTTPS_POLICY_NAME --ssl-policy SSL_POLICY_NAME&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.2" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.2" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. See all load balancers by visiting https://console.cloud.google.com/net-services/loadbalancing/loadBalancers/list.&lt;/p&gt;&lt;p&gt;2. For each load balancer for SSL (Proxy) or HTTPS, click on its name to go the Load balancer details page.&lt;/p&gt;&lt;p&gt;3. Ensure that each target proxy entry in the Frontend table has an SSL Policy configured.&lt;/p&gt;&lt;p&gt;4. Click on each SSL policy to go to its SSL policy details page.&lt;/p&gt;&lt;p&gt;5. Ensure that the SSL policy satisfies one of the following conditions:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;has a Min TLS set to TLS 1.2 and Profile set to Modern profile, or&lt;/li&gt;&lt;li&gt;has Profile set to Restricted. Note that a Restricted profile effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version, or&lt;/li&gt;&lt;li&gt;has Profile set to Custom and the following features are all disabled:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_GCM_SHA256&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_GCM_SHA384&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_3DES_EDE_CBC_SHA&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. List all TargetHttpsProxies and TargetSslProxies.&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute target-https-proxies list gcloud compute target-ssl-proxies list&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. For each target proxy, list its properties:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute target-https-proxies describe TARGET_HTTPS_PROXY_NAME gcloud compute target-ssl-proxies describe TARGET_SSL_PROXY_NAME&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;3. Ensure that the sslPolicy field is present and identifies the name of the SSL policy: sslPolicy: https://www.googleapis.com/compute/v1/projects/PROJECT_ID/global/sslPolicies/SSL_POLICY_NAME&lt;/p&gt;&lt;p&gt;If the sslPolicy field is missing from the configuration, it means that the GCP default policy is used, which is insecure.&lt;/p&gt;&lt;p&gt;4. Describe the SSL policy:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute ssl-policies describe SSL_POLICY_NAME&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;5. Ensure that the policy satisfies one of the following conditions:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;has Profile set to Modern and minTlsVersion set to TLS_1_2, or&lt;/li&gt;&lt;li&gt;has Profile set to Restricted, or&lt;/li&gt;&lt;li&gt;has Profile set to Custom and enabledFeatures does not contain any of the following values:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_GCM_SHA256&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_GCM_SHA384&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_128_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_AES_256_CBC_SHA&amp;nbsp;&lt;/p&gt;&lt;p&gt;TLS_RSA_WITH_3DES_EDE_CBC_SHA&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM16" name="Enable Security Key Enforcement for all admin accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Setup Security Key Enforcement for Google Cloud Platform admin accounts.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Google Cloud Platform users with Organization Administrator roles have the highest level of privilege in the organization. These accounts should be protected with the strongest form of two-factor authentication: Security Key Enforcement. Ensure that admins use Security Keys to log in instead of weaker second factors like SMS or one-time passwords (OTP). Security Keys are actual physical keys used to access Google Organization Administrator Accounts. They send an encrypted signature rather than a code, ensuring that logins cannot be phished.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;If an organization administrator loses access to their security key, the user could lose access to their account. For this reason, it is important to set up backup security keys.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;Step 1: Identify users with the Organization Administrator role.&amp;nbsp;&lt;/p&gt;&lt;p&gt;Step 2: Setup Security Key Enforcement for each account. Learn more at: https://cloud.google.com/security-key/&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.3" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Step 1: Identify users with Organization Administrator privileges:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud organizations get-iam-policy ORGANIZATION_ID&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Look for members granted the role "roles/resourcemanager.organizationAdmin".&amp;nbsp;&lt;/p&gt;&lt;p&gt;Step 2: Manually verify that Security Key Enforcement has been enabled for each account.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET08" name="Enable VPC Flow Logs for every subnet in a VPC Network" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Flow Logs is a feature that enables users to capture information about the IP traffic going to and from network interfaces in the organization's VPC Subnets. Once a flow log is created, the user can view and retrieve its data in Stackdriver Logging. It is recommended that Flow Logs be enabled for every business-critical VPC subnet.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;VPC networks and subnetworks not reserved for internal HTTP(S) load balancing provide logically isolated and secure network partitions where GCP resources can be launched. When Flow Logs are enabled for a subnet, VMs within that subnet start reporting on all Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) flows. Each VM samples the TCP and UDP flows it sees, inbound and outbound, whether the flow is to or from another VM, a host in the on-premises datacenter, a Google service, or a host on the Internet. If two GCP VMs are communicating, and both are in subnets that have VPC Flow Logs enabled, both VMs report the flows.&lt;/p&gt;&lt;p&gt;Flow Logs supports the following use cases:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Network monitoring&lt;/li&gt;&lt;li&gt;Understanding network usage and optimizing network traffic expenses&lt;/li&gt;&lt;li&gt;Network forensics&lt;/li&gt;&lt;li&gt;Real-time security analysis&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or provide insight during security workflows.&lt;/p&gt;&lt;p&gt;Note: Subnets reserved for use by internal HTTP(S) load balancers do not support VPC flow logs.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Standard pricing for Stackdriver Logging, BigQuery, or Cloud Pub/Sub applies. VPC Flow Logs generation will be charged starting in GA as described in reference: https://cloud.google.com/vpc/&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the VPC network GCP Console visiting https://console.cloud.google.com/networking/networks/list&lt;/p&gt;&lt;p&gt;2. Click the name of a subnet, The Subnet details page displays.&lt;/p&gt;&lt;p&gt;3. Click the EDIT button.&lt;/p&gt;&lt;p&gt;4. Set Flow Logs to On.&lt;/p&gt;&lt;p&gt;5. Click Save.&lt;/p&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;p&gt;To set Private Google access for a network subnet, run the following command:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute networks subnets update [SUBNET_NAME] --region [REGION] --enable-flow-logs&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.8" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the VPC network GCP Console visiting https://console.cloud.google.com/networking/networks/list&lt;/p&gt;&lt;p&gt;2. From the list of network subnets, make sure for each subnet Flow Logs is set to On&lt;/p&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute networks list --format json | \ jq -r '.[].subnetworks | .[]' | \ xargs -I {} gcloud compute networks subnets describe {} --format json | \ jq -r '. | "Subnet: \(.name) Purpose: \(.purpose) VPC Flow Log Enabled: \(has("enableFlowLogs"))"'&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;The output of the above command will list each subnet, the subnet's purpose, and a true or false value if Flow Logs are enabled. If the subnet's purpose is PRIVATE then Flow Logs should be true.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-IAM-02" name="Encrypt Dataproc Cluster using Customer-Managed Encryption Key" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;When you use Dataproc, cluster and job data is stored on Persistent Disks (PDs) associated with the Compute Engine VMs in your cluster and in a Cloud Storage staging bucket. This PD and bucket data is encrypted using a Google-generated data encryption key (DEK) and key encryption key (KEK). The CMEK feature allows you to create, use, and revoke the key encryption key (KEK). Google still controls the data encryption key (DEK).&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;Cloud services offer the ability to protect data related to those services using encryption keys managed by the customer within Cloud KMS. These encryption keys are called customer-managed encryption keys (CMEK). When you protect data in Google Cloud services with CMEK, the CMEK key is within your control.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Login to the GCP Console and navigate to the Dataproc Cluster page by visiting https://console.cloud.google.com/dataproc/clusters.&lt;/li&gt;&lt;li&gt;Select the project from the projects dropdown list.&lt;/li&gt;&lt;li&gt;On the Dataproc Cluster page, click on the Create Cluster to create a new cluster with Customer managed encryption keys.&lt;/li&gt;&lt;li&gt;On Create a cluster page, perform below steps:&lt;ol&gt;&lt;li&gt;Inside Set up cluster section perform below steps: -In the Name textbox, provide a name for your cluster.&lt;ol&gt;&lt;li&gt;From Location select the location in which you want to deploy a cluster.&lt;/li&gt;&lt;li&gt;Configure other configurations as per your requirements.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Inside Configure Nodes and Customize cluster section configure the settings as per your requirements.&lt;/li&gt;&lt;li&gt;Inside Manage security section, perform below steps:&lt;ol&gt;&lt;li&gt;From Encryption, select Customer-managed key.&lt;/li&gt;&lt;li&gt;Select a customer-managed key from dropdown list.&lt;/li&gt;&lt;li&gt;Ensure that the selected KMS Key have Cloud KMS CryptoKey Encrypter/Decrypter role assign to Dataproc Cluster service account ("serviceAccount:service-&amp;lt;project_number&amp;gt;@compute-system.iam.gserviceaccount.com").&lt;/li&gt;&lt;li&gt;Click on Create to create a cluster.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Once the cluster is created migrate all your workloads from the older cluster to the new cluster and delete the old cluster by performing the below steps:&lt;ol&gt;&lt;li&gt;On the Clusters page, select the old cluster and click on Delete cluster.&lt;/li&gt;&lt;li&gt;On the Confirm deletion window, click on Confirm to delete the cluster.&lt;/li&gt;&lt;li&gt;Repeat step above for other Dataproc clusters available in the selected project.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Change the project from the project dropdown list and repeat the remediation procedure for other Dataproc clusters available in other projects.&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;p&gt;Before creating cluster ensure that the selected KMS Key have Cloud KMS CryptoKey Encrypter/Decrypter role assign to Dataproc Cluster service account ("serviceAccount:service-&amp;lt;project_number&amp;gt;@compute-system.iam.gserviceaccount.com"). Run clusters create command to create new cluster with customer-managed key:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dataproc clusters create &amp;lt;cluster_name&amp;gt; --region=us-central1 --gce-pd-kms-key=&amp;lt;key_resource_name&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;The above command will create a new cluster in the selected region. Once the cluster is created migrate all your workloads from the older cluster to the new cluster and Run clusters delete command to delete cluster:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dataproc clusters delete &amp;lt;cluster_name&amp;gt; --region=us-central1&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Repeat step no. 1 to create a new Dataproc cluster. Change the project by running the below command and repeat the remediation procedure for other projects:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud config set project &amp;lt;project_ID&amp;gt;"&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="Encryption at rest in Google Cloud" url="https://cloud.google.com/security/encryption-at-rest/default-encryption"/>
          </references>
          <standards>
            <standard ref="1.17" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Login to the GCP Console and navigate to the Dataproc Cluster page by visiting https://console.cloud.google.com/dataproc/clusters.&lt;/li&gt;&lt;li&gt;Select the project from the project dropdown list.&lt;/li&gt;&lt;li&gt;On the Dataproc Clusters page, select the cluster and click on the Name attribute value that you want to examine.&lt;/li&gt;&lt;li&gt;On the details page, select the Configurations tab.&lt;/li&gt;&lt;li&gt;On the Configurations tab, check the Encryption type configuration attribute value. If the value is set to Google-managed key, then Dataproc Cluster is not encrypted with Customer managed encryption keys.&lt;/li&gt;&lt;li&gt;Repeat step no. 3 - 5 for other Dataproc Clusters available in the selected project.&lt;/li&gt;&lt;li&gt;Change the project from the project dropdown list and repeat the audit procedure for other projects.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Run clusters list command to list all the Dataproc Clusters available in the region:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dataproc clusters list --region='us-central1'&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;Run clusters describe command to get the key details of the selected cluster:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud dataproc clusters describe &amp;lt;cluster_name&amp;gt; --region=us-central1 --flatten=config.encryptionConfig.gcePdKmsKeyName&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;If the above command output return "null", then the selected cluster is not encrypted with Customer managed encryption keys.&lt;/li&gt;&lt;li&gt;Repeat step no. 2 and 3 for other Dataproc Clusters available in the selected region. Change the region by updating --region and repeat step no. 2 for other clusters available in the project. Change the project by running the below command and repeat the audit procedure for other Dataproc clusters available in other projects:&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud config set project &amp;lt;project_ID&amp;gt;"&lt;/p&gt;&lt;/blockquote&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM11" name="Enforce separation of duties" issueId="" issueLink="" platform="" cost="1" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;The built-in/predefined IAM role Cloud KMS Admin allows the user/identity to create, delete, and manage service account(s). The built-in/predefined IAM role Cloud KMS CryptoKey Encrypter/Decrypter allows the user/identity (with adequate privileges on concerned resources) to encrypt and decrypt data at rest using an encryption key(s).&lt;/p&gt;&lt;p&gt;The built-in/predefined IAM role Cloud KMS CryptoKey Encrypter allows the user/identity (with adequate privileges on concerned resources) to encrypt data at rest using an encryption key(s). The built-in/predefined IAM role Cloud KMS CryptoKey Decrypter allows the user/identity (with adequate privileges on concerned resources) to decrypt data at rest using an encryption key(s).&lt;/p&gt;&lt;p&gt;Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. In Cloud KMS, this could be an action such as using a key to access and decrypt data a user should not normally have access to. Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered best practice.&lt;/p&gt;&lt;p&gt;No user(s) should have Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles assigned at the same time.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Removed roles should be assigned to another user based on business needs.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to IAM &amp;amp; Admin/IAM using https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. For any member having Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter roles granted/assigned, click the Delete Bin icon to remove the role from the member.&lt;/p&gt;&lt;p&gt;Note: Removing a role should be done based on the business requirement.&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.11" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="1.8" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to IAM &amp;amp; Admin/IAM by visiting: https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. Ensure no member has the roles Cloud KMS Admin and any of the Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter assigned.&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. List all users and role assignments:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects get-iam-policy PROJECT_ID&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. Ensure that there are no common users found in the member section for roles cloudkms.admin and any one of Cloud KMS CryptoKey Encrypter/Decrypter, Cloud KMS CryptoKey Encrypter, Cloud KMS CryptoKey Decrypter&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET02" name="Isolate Google Cloud resources into separate VNets by function" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Place the resources into separate VNets according to their use or function (production,
                        development, test). Placing such resources accordingly ensures that a resource of a high
                        security level is not exposed by the security settings of a lower labeled VNet.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Identify the resources that exist in an incorrect VNet.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Migrate or move it to the correct VNet.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Isolate resources" url="https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#use_projects_to_fully_isolate_resources"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the Google Cloud resources are isolated and separated in several VNets by the
                            function of the resources.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET01" name="Isolate groups of VM instances" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Use networks within projects to isolate groups of VM instances.

                        Each project supports up to five isolated networks. Each network constitutes a global IP address
                        space. This means that you can create resources, such as Google Compute Engine Virtual Machine
                        (VM) instances, in multiple geographic regions, and the resources will share the same IP address
                        space because they are on the same virtual network. Note that, despite the flat network address
                        space, you still incur normal egress charges when you leave your zone. You can request a quota
                        increase to support up to 15 isolated networks in each project.</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Isolate resources" url="https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#use_projects_to_fully_isolate_resources"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check the projects are isolated using groups of VM instances.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.226">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM01" name="Recertify user access" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Do regular reviews of service accounts on the system and verify they do not contain stolen or
                        fake accounts. This process ensures there are not any compromised accounts by former employees
                        or attackers.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;b&gt;Remediation:&lt;/b&gt;&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        At least every 90 days complete the following:&amp;nbsp;
                        &lt;/div&gt;
                        &lt;div&gt;
                        &lt;ol&gt;
                        &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Select your project and click Open. All service accounts are listed in the Service
                        Accounts page.&lt;/li&gt;
                        &lt;li&gt;For any user that should not exist, select the user and click the Delete button.&lt;/li&gt;
                        &lt;/ol&gt;
                        &lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: manage service accounts" url="https://cloud.google.com/iam/docs/creating-managing-service-accounts"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Open the Service Accounts page in the Cloud Platform Console.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Click Select a project.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Select your project and click Open. All service accounts are listed in the Service
                            Accounts page.&lt;/li&gt;
                            &lt;li&gt;Check that the necessary users appear in the list.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;And check that there is a process to review the access users at least every 90
                            days.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.471">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM18" name="Remove Admin privileges on Service Account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;A service account is a special Google account that belongs to an application or a VM, instead of to an individual end-user. The application uses the service account to call the service's Google API so that users aren't directly involved. It's recommended not to use admin access for ServiceAccount.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Service accounts represent service-level security of the Resources (application or a VM) which can be determined by the roles assigned to it. Enrolling ServiceAccount with Admin rights gives full access to an assigned application or a VM. A ServiceAccount Access holder can perform critical actions like delete, update change settings, etc. without user intervention. For this reason, it's recommended that service accounts not have Admin rights.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Removing *Admin or *adminorEditororOwner` role assignments from service accounts may break functionality that uses impacted service accounts. Required role(s) should be assigned to impacted service accounts in order to restore broken functionalities.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;p&gt;1. Go to IAM &amp;amp; admin/IAM using https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. Go to the Members&lt;/p&gt;&lt;p&gt;3. Identify User-Managed user created service account with roles containing *Admin or *admin or role matching Editor or role matching Owner&lt;/p&gt;&lt;p&gt;4. Click the Delete bin icon to remove the role from the member (service account in this case)&lt;/p&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects get-iam-policy PROJECT_ID --format json &amp;gt; iam.json&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;1. Using a text editor, Remove Role which contains roles/*Admin or roles/*admin or matched roles/editor or matches 'roles/owner`. Add a role to the bindings array that defines the group members and the role for those members.&lt;/p&gt;&lt;p&gt;2. Update the project's IAM policy:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud projects set-iam-policy PROJECT_ID iam.json&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.5" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.5" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to IAM &amp;amp; admin/IAM using https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. Go to the Members&lt;/p&gt;&lt;p&gt;3. Ensure that there are no User-Managed user created service account(s) with roles containing *Admin or *admin or role matching Editor or role matching Owner&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;1. Get the policy that you want to modify, and write it to a JSON file: gcloud projects get-iam-policy PROJECT_ID --format json &amp;gt; iam.json&lt;/p&gt;&lt;p&gt;2. The contents of the JSON file will look similar to the following. Note that role of members group associated with each serviceaccount does not contain *Admin or *admin or does not match roles/editor or does not match roles/owner.&lt;/p&gt;&lt;p&gt;This recommendation is only applicable to User-Managed user-created service accounts. These accounts have the nomenclature: SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com. Note that some Google-managed, Google-created service accounts have the same naming format, and should be excluded (e.g., appsdev-apps-dev-script-auth@system.gserviceaccount.com which needs the Owner role).&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET03" name="Remove default and legacy networks" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;order to prevent use of legacy networks, a project should not have a legacy network configured.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. Subnetworks cannot be created in a legacy network and are unable to switch from legacy to auto or custom subnet networks. Legacy networks can have an impact for high network traffic projects and are subject to a single point of contention or failure.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;For each Google Cloud Platform project,&lt;/p&gt;&lt;p&gt;1. Follow the documentation and create a non-legacy network suitable for the organization's requirements.&lt;/p&gt;&lt;p&gt;2. Follow the documentation and delete the networks in the legacy mode.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.1" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="3.2" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;For each Google Cloud Platform project,&lt;/p&gt;&lt;p&gt;1. Set the project name in the Google Cloud Shell:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud config set project &amp;lt;Project-ID&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;2. List the networks configured in that project:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute networks list&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;None of the listed networks should be in the legacy mode.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM14" name="Restrict API key usage to call only APIs required by an application" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;API keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API keys to use (call) only APIs required by an application.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Security risks involved in using API-Keys are below:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;API keys are simple encrypted strings&lt;/li&gt;&lt;li&gt;API keys do not identify the user or the application making the API request&lt;/li&gt;&lt;li&gt;API keys are typically accessible to clients, making it easy to discover and steal an API key&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;In light of these potential risks, Google recommends using the standard authentication flow instead of API-Keys. However, there are limited cases where API keys are more appropriate. For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.&lt;/p&gt;&lt;p&gt;In order to reduce attack surfaces by providing least privileges, API-Keys can be restricted to use (call) only APIs required by an application.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Setting API restrictions may break existing application functioning, if not done carefully.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, Click the API Key Name. The API Key properties display on a new page.&lt;/p&gt;&lt;p&gt;3. In the Key restrictions section go to API restrictions.&lt;/p&gt;&lt;p&gt;4. Click the Select API drop-down to choose an API.&lt;/p&gt;&lt;p&gt;5. Click Save.&lt;/p&gt;&lt;p&gt;6. Repeat steps 2,3,4,5 for every unrestricted API key&lt;/p&gt;&lt;p&gt;Note: Do not set API restrictions to Google Cloud APIs, as this option allows access to all services offered by Google cloud.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.14" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.14" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, Click the API Key Name. The API Key properties display on a new page.&lt;/p&gt;&lt;p&gt;3. For every API Key, ensure the section Key restrictions parameter API restrictions is not set to None.&lt;/p&gt;&lt;p&gt;Or, Ensure API restrictions is not set to Google Cloud APIs&amp;nbsp;&lt;/p&gt;&lt;p&gt;Note: Google Cloud APIs represents the API collection of all cloud services/APIs offered by Google cloud.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM13" name="Restrict API key usage to trusted hosts and apps" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Unrestricted keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API key usage to trusted hosts, HTTP referrers and apps.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Security risks involved in using API-Keys appear below:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;API keys are simple encrypted strings&lt;/li&gt;&lt;li&gt;API keys do not identify the user or the application making the API request&lt;/li&gt;&lt;li&gt;API keys are typically accessible to clients, making it easy to discover and steal an API key&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;In light of these potential risks, Google recommends using the standard authentication flow instead of API keys. However, there are limited cases where API keys are more appropriate. For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.&lt;/p&gt;&lt;p&gt;In order to reduce attack vectors, API-Keys can be restricted only to trusted hosts, HTTP referrers and applications.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Setting Application Restrictions may break existing application functioning, if not done carefully.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, Click the API Key Name. The API Key properties display on a new page.&lt;/p&gt;&lt;p&gt;3. In the Key restrictions section, set the application restrictions to any of HTTP referrers, IP Adresses, Android Apps, iOs Apps.&lt;/p&gt;&lt;p&gt;4. Click Save.&lt;/p&gt;&lt;p&gt;5. Repeat steps 2,3,4 for every unrestricted API key. Note: Do not set HTTP referrers to wild-cards (* or *.[TLD] or .[TLD]/) allowing access to any/wide HTTP referrer(s) Do not set IP addresses and referrer to any host (0.0.0.0 or 0.0.0.0/0 or ::0)&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.13" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.13" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/p&gt;&lt;p&gt;2. In the section API Keys, Click the API Key Name. The API Key properties display on a new page.&lt;/p&gt;&lt;p&gt;3. For every API Key, ensure the section Key restrictions parameter Application restrictions is not set to None.&lt;/p&gt;&lt;p&gt;Or,&amp;nbsp;&lt;/p&gt;&lt;p&gt;Ensure Application restrictions is set to HTTP referrers and the referrer is not set to wild-cards (* or *.[TLD] or *.[TLD]/*) allowing access to any/wide HTTP referrer(s)&amp;nbsp;&lt;/p&gt;&lt;p&gt;Or,&amp;nbsp;&lt;/p&gt;&lt;p&gt;Ensure Application restrictions is set to IP addresses and referrer is not set to any host (0.0.0.0 or 0.0.0.0/0 or ::0)&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET07" name="Restrict RDP access from the Internet" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow users to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances.&lt;/p&gt;&lt;p&gt;Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the Internet to a VPC or VM instance using RDP on Port 3389 can be avoided.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;GCP Firewall Rules within a VPC Network. These rules apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. Egress and ingress traffic flows are controlled even if the traffic stays within the network (for example, instance-to-instance communication). For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from the Internet through RDP with the default Port 3389. Generic access from the Internet to a specific IP Range should be restricted.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;All Remote Desktop Protocol (RDP) connections from outside of the network to the concerned VPC(s) will be blocked. There could be a business need where secure shell access is required from outside of the network to access resources associated with the VPC. In that case, specific source IP(s) should be mentioned in firewall rules to white-list access to RDP port for the concerned VPC(s).&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to VPC Network.&lt;/p&gt;&lt;p&gt;2. Go to the Firewall Rules.&lt;/p&gt;&lt;p&gt;3. Click the Firewall Rule to be modified.&lt;/p&gt;&lt;p&gt;4. Click Edit.&lt;/p&gt;&lt;p&gt;5. Modify Source IP ranges to specific IP.&lt;/p&gt;&lt;p&gt;6. Click Save.&lt;/p&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;p&gt;1.Update RDP Firewall rule with new SOURCE_RANGE from the below command:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[-PORT]],...] --source-ranges=[CIDR_RANGE,...]&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.7" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to VPC network.&lt;/p&gt;&lt;p&gt;2. Go to the Firewall Rules.&lt;/p&gt;&lt;p&gt;3. Ensure Port is not equal to 3389 and Action is not Allow.&lt;/p&gt;&lt;p&gt;4. Ensure IP Ranges is not equal to 0.0.0.0/0 under Source filters.&lt;/p&gt;&lt;p&gt;From Command Line: gcloud compute firewall-rules list --format=table'(name,direction,sourceRanges,allowed.ports)'&lt;/p&gt;&lt;p&gt;Ensure that there is no rule matching the below criteria:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;SOURCE_RANGES is 0.0.0.0/0&lt;/li&gt;&lt;li&gt;AND DIRECTION is INGRESS&lt;/li&gt;&lt;li&gt;AND IPProtocol is TCP or ALL&lt;/li&gt;&lt;li&gt;AND PORTS is set to 3389 or range containing 3389 or Null (not set)&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Note:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;When ALL TCP ports are allowed in a rule, PORT does not have any value set (NULL)&lt;/li&gt;&lt;li&gt;When ALL Protocols are allowed in a rule, PORT does not have any value set (NULL)&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-NET06" name="Restrict SSH access from the Internet" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow the user to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances.&lt;/p&gt;&lt;p&gt;Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, only an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the internet to VPC or VM instance using SSH on Port 22 can be avoided.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;GCP Firewall Rules within a VPC Network apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. Egress and ingress traffic flows are controlled even if the traffic stays within the network (for example, instance-to-instance communication). For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from the Internet through SSH with the default Port 22. Generic access from the Internet to a specific IP Range needs to be restricted.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;All Secure Shell (SSH) connections from outside of the network to the concerned VPC(s) will be blocked. There could be a business need where SSH access is required from outside of the network to access resources associated with the VPC. In that case, specific source IP(s) should be mentioned in firewall rules to white-list access to SSH port for the concerned VPC(s).&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to VPC Network.&lt;/p&gt;&lt;p&gt;2. Go to the Firewall Rules.&lt;/p&gt;&lt;p&gt;3. Click the Firewall Rule you want to modify.&lt;/p&gt;&lt;p&gt;4. Click Edit.&lt;/p&gt;&lt;p&gt;5. Modify Source IP ranges to specific IP.&lt;/p&gt;&lt;p&gt;6. Click Save.&lt;/p&gt;&lt;p&gt;From Command Line: 1.Update the Firewall rule with the new SOURCE_RANGE from the below command:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[-PORT]],...] --source-ranges=[CIDR_RANGE,...]&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="3.6" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From the Console:&lt;/p&gt;&lt;p&gt;1. Go to VPC network.&lt;/p&gt;&lt;p&gt;2. Go to the Firewall Rules.&lt;/p&gt;&lt;p&gt;3. Ensure that Port is not equal to 22 and Action is not set to Allow.&lt;/p&gt;&lt;p&gt;4. Ensure IP Ranges is not equal to 0.0.0.0/0 under Source filters.&lt;/p&gt;&lt;p&gt;From Command Line: gcloud compute firewall-rules list --format=table'(name,direction,sourceRanges,allowed)'&lt;/p&gt;&lt;p&gt;Ensure that there is no rule matching the below criteria:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;SOURCE_RANGES is 0.0.0.0/0&lt;/li&gt;&lt;li&gt;AND DIRECTION is INGRESS&lt;/li&gt;&lt;li&gt;AND IPProtocol is tcp or ALL&lt;/li&gt;&lt;li&gt;AND PORTS is set to 22 or range containing 22 or Null (not set)&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Note:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;When ALL TCP ports are allowed in a rule, PORT does not have any value set (NULL)&lt;/li&gt;&lt;li&gt;When ALL Protocols are allowed in a rule, PORT does not have any value set (NULL)&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.227">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM10" name="Rotate keys within a period of 90 days" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests users make to Google cloud services accessible to that particular service account. It is recommended that all Service Account keys are regularly rotated.&lt;/p&gt;&lt;p&gt;Google Cloud Key Management Service stores cryptographic keys in a hierarchical structure designed for useful and elegant access control management.&lt;/p&gt;&lt;p&gt;The format for the rotation schedule depends on the client library that is used. For the gcloud command-line tool, the next rotation time must be in ISO or RFC3339 format, and the rotation period must be in the form INTEGER[UNIT], where units can be one of seconds (s), minutes (m), hours (h) or days (d).&lt;/p&gt;&lt;p&gt;It is recommended to rotate API keys every 90 days.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Security risks involved in using API-Keys are listed below:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;API keys are simple encrypted strings&lt;/li&gt;&lt;li&gt;API keys do not identify the user or the application making the API request&lt;/li&gt;&lt;li&gt;API keys are typically accessible to clients, making it easy to discover and steal an API key&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Because of these potential risks, Google recommends using the standard authentication flow instead of API Keys. However, there are limited cases where API keys are more appropriate. For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.&lt;/p&gt;&lt;p&gt;Once a key is stolen, it has no expiration, meaning it may be used indefinitely unless the project owner revokes or regenerates the key. Rotating API keys will reduce the window of opportunity for an access key that is associated with a compromised or terminated account to be used.&lt;/p&gt;&lt;p&gt;API keys should be rotated to ensure that data cannot be accessed with an old key that might have been lost, cracked, or stolen.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Regenerating Key may break existing client connectivity as the client will try to connect with older API keys they have stored on devices.&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;For user-managed/external keys:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Delete any external (user-managed) Service Account Key older than 90 days:&lt;ul&gt;&lt;li&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/li&gt;&lt;li&gt;2. In the Section Service Account Keys, for every external (user-managed) service account key where creation date is greater than or equal to the past 90 days, click Delete Bin Icon to Delete Service Account key&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;Create a new external (user-managed) Service Account Key for a Service Account:&lt;ul&gt;&lt;li&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/li&gt;&lt;li&gt;2. Click Create Credentials and Select Service Account Key.&lt;/li&gt;&lt;li&gt;3. Choose the service account in the drop-down list for which an External (user-managed) Service Account key needs to be created.&lt;/li&gt;&lt;li&gt;4. Select the desired key type format among JSON or P12.&lt;/li&gt;&lt;li&gt;5. Click Create. It will download the private key. Keep it safe.&lt;/li&gt;&lt;li&gt;6. Click Close if prompted.&lt;/li&gt;&lt;li&gt;7. The site will redirect to the APIs &amp;amp; Services\Credentials page. Make a note of the new ID displayed in the Service account keys section.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;For KMS keys:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;1. Go to Cryptographic Keys by visiting: https://console.cloud.google.com/security/kms.&lt;/li&gt;&lt;li&gt;2. Click on the specific key ring&lt;/li&gt;&lt;li&gt;3. From the list of keys, choose the specific key and Click on Right side pop up the blade (3 dots).&lt;/li&gt;&lt;li&gt;4. Click on Edit rotation period.&lt;/li&gt;&lt;li&gt;5. On the pop-up window, Select a new rotation period in days which should be less than 90 and then choose Starting on date (date from which the rotation period begins).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;For API keys:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;1. Go to APIs &amp;amp; Services\Credentials using https://console.cloud.google.com/apis/credentials&lt;/li&gt;&lt;li&gt;2. In the section API Keys, Click the API Key Name. The API Key properties display on a new page.&lt;/li&gt;&lt;li&gt;3. Click REGENERATE KEY to rotate API key.&lt;/li&gt;&lt;li&gt;4. Click Save.&lt;/li&gt;&lt;li&gt;5. Repeat steps 2,3,4 for every API key that has not been rotated in the last 90 days.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Note: Do not set HTTP referrers to wild-cards (* or *.[TLD] or .[TLD]/) allowing access to any/wide HTTP referrer(s) Do not set IP addresses and referrer to any host (0.0.0.0 or 0.0.0.0/0 or ::0)&lt;/p&gt;&lt;p&gt;From Command Line:&lt;/p&gt;&lt;p&gt;For KMS keys:&lt;/p&gt;&lt;p&gt;1. Update and schedule rotation by ROTATION_PERIOD and NEXT_ROTATION_TIME for each key: gcloud kms keys update new --keyring=KEY_RING --location=LOCATION --next-rotation-time=NEXT_ROTATION_TIME --rotation-period=ROTATION_PERIOD&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.10" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.10" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="1.15" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.15" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="1.7" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.7" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A05:2021-Security Misconfiguration" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A6:2017-Security Misconfiguration" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure that all keys have a rotation period of 90 days.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-LOG07" name="Use Bucket Lock to configure retention policies" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Logs can be exported by creating one or more sinks that include a log filter and a destination. As Cloud Logging receives new log entries, they are compared against each sink. If a log entry matches a sink's filter, then a copy of the log entry is written to the destination.&lt;/p&gt; 
&lt;p&gt;Sinks can be configured to export logs in storage buckets. It is recommended to configure a data retention policy for these cloud storage buckets and to lock the data retention policy; thus permanently preventing the policy from being reduced or removed. This way, if the system is ever compromised by an attacker or a malicious insider who wants to cover their tracks, the activity logs are definitely preserved for forensics and security investigations.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Set a retention policy on a bucket&lt;/p&gt; 
&lt;p&gt;To add, modify, or remove a retention policy on a bucket:&lt;/p&gt; 
&lt;p&gt;1. In the Google Cloud console, go to the Cloud Storage Browser page.&lt;/p&gt; 
&lt;p&gt;2. In the list of buckets, click on the name of the bucket whose retention policy you want to change.&lt;/p&gt; 
&lt;p&gt;3. Select the Protection tab near the top of the page.&lt;/p&gt; 
&lt;p&gt;4. In the Retention policy section, set your retention policy:&lt;/p&gt; 
&lt;p&gt;a. If no retention policy currently applies to the bucket, click the + Set Retention Policy link. Choose a unit of time and a length of time for your retention period.&lt;/p&gt; 
&lt;p&gt;b. If a retention policy currently applies to a bucket, it appears in the section. Click Edit to modify the retention time or Delete to remove the retention policy entirely.&lt;/p&gt; 
&lt;p&gt;Lock a bucket&lt;/p&gt; 
&lt;p&gt;To lock a bucket and permanently restrict edits to the bucket's retention policy:&lt;/p&gt; 
&lt;p&gt;1. In the Google Cloud console, go to the Cloud Storage Browser page.&lt;/p&gt; 
&lt;p&gt;2. In the list of buckets, click on the name of the bucket that you want to lock the retention policy for.&lt;/p&gt; 
&lt;p&gt;3. Select the Protection tab near the top of the page.&lt;/p&gt; 
&lt;p&gt;4. In the Retention policy section, click the Lock button.&lt;/p&gt; 
&lt;p&gt;The Lock retention policy? dialog box appears.&lt;/p&gt; 
&lt;p&gt;5. Read the Permanent notice.&lt;/p&gt; 
&lt;p&gt;6. In the Bucket name text box, type in the name of your bucket.&lt;/p&gt; 
&lt;p&gt;7. Click Lock policy.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Locking a bucket is an irreversible action. Once you lock a bucket, you cannot remove the retention policy from the bucket or decrease the retention period for the policy.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
            <reference name="Retention policies and retention policy locks" url="https://cloud.google.com/storage/docs/bucket-lock"/>
          </references>
          <standards>
            <standard ref="2.3" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="2.3" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="A09:2021-Security Logging and Monitoring Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2017-Insufficient Logging-Monitoring" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;View a bucket's retention policy and lock status&lt;/p&gt;

	&lt;p&gt;To view what, if any, retention policy is set on a bucket and whether that retention policy is locked:&lt;/p&gt;

	&lt;p&gt;1. In the Google Cloud console, go to the Cloud Storage Browser page.&lt;/p&gt;

	&lt;p&gt;2. In the Column display options menu (Column options icon.), make sure Retention policy is checked.&lt;/p&gt;

	&lt;p&gt;3. In the list of buckets, if a bucket has a retention policy, the retention period is displayed in the Protection column for the bucket. If the retention policy is locked, an image of a lock appears directly to the left of the retention period.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.911">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM17" name="Use GCP-managed service account keys only for each service account" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;User managed service accounts should not have user-managed keys.&lt;/p&gt;&lt;p&gt;Rationale:&lt;/p&gt;&lt;p&gt;Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.&lt;/p&gt;&lt;p&gt;For user-managed keys, the user has to take ownership of key management activities which include:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Key storage&lt;/li&gt;&lt;li&gt;Key distribution&lt;/li&gt;&lt;li&gt;Key revocation&lt;/li&gt;&lt;li&gt;Key rotation&lt;/li&gt;&lt;li&gt;Protecting the keys from unauthorized users&lt;/li&gt;&lt;li&gt;Key recovery&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Even with key owner precautions, keys can be easily leaked by common development malpractices like checking keys into the source code or leaving them in the Downloads directory, or accidentally leaving them on support blogs/channels.&lt;/p&gt;&lt;p&gt;It is recommended to prevent user-managed service account keys.&lt;/p&gt;&lt;p&gt;Impact:&lt;/p&gt;&lt;p&gt;Deleting user-managed Service Account Keys may break communication with the applications using the corresponding keys.&lt;/p&gt;&lt;p&gt;Remediation:&lt;/p&gt;&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the IAM page in the GCP Console using https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. In the left navigation pane, click Service accounts. All service accounts and their corresponding keys are listed.&lt;/p&gt;&lt;p&gt;3. Click the service account.&lt;/p&gt;&lt;p&gt;4. Click the edit and delete the keys.&lt;/p&gt;&lt;p&gt;From CLI: To delete a user managed Service Account Key,&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud iam service-accounts keys delete --iam-account=&amp;lt;user-managed-service-account-EMAIL&amp;gt; &amp;lt;KEY-ID&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;</desc>
          <implementations/>
          <references>
            <reference name="CIS Google Cloud Platform Benchmark" url="https://www.cisecurity.org/benchmark/google_cloud_computing_platform/"/>
          </references>
          <standards>
            <standard ref="1.4" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.4" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From Console:&lt;/p&gt;&lt;p&gt;1. Go to the IAM page in the GCP Console using https://console.cloud.google.com/iam-admin/iam&lt;/p&gt;&lt;p&gt;2. In the left navigation pane, click Service accounts. All service accounts and their corresponding keys are listed.&lt;/p&gt;&lt;p&gt;3. Click the service accounts and check if keys exist.&lt;/p&gt;&lt;p&gt;From Command Line:&amp;nbsp;&lt;/p&gt;&lt;p&gt;List All the service accounts:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud iam service-accounts list&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Identify user-managed service accounts as such account EMAIL ends with iam.gserviceaccount.com&amp;nbsp;&lt;/p&gt;&lt;p&gt;For each user-managed service account, list the keys managed by the user:&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud iam service-accounts keys list --iam-account=&amp;lt;Service Account&amp;gt; --managed-by=user&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;No keys should be listed.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GCP-IAM-03" name="Use secret manager to avoid storing secrets in cloud functions environment variables" issueId="" issueLink="" platform="" cost="0" risk="56" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Google Cloud Functions allow you to host serverless code that is executed when an event is triggered, without the requiring the management a host operating system. These functions can also store environment variables to be used by the code that may contain authentication or other information that needs to remain confidential.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;It is recommended to use the Secret Manager, because environment variables are stored unencrypted, and accessible for all users who have access to the code.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Impact&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;There should be no impact on the Cloud Function. There are minor costs after 10,000 requests a month to the Secret Manager API as well for a high use of other functions. Modifying the Cloud Function to use the Secret Manager may prevent it running to completion as its environment variables are.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Enable Secret Manager API for your Project&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Within the project you wish to enable, select the Navigation hamburger menu in the top left. Hover over 'APIs &amp;amp; Services' to under the heading 'Serverless', then select 'Enabled APIs &amp;amp; Services' in the menu that opens up.&lt;/li&gt;&lt;li&gt;Click the button '+ Enable APIS and Services'&lt;/li&gt;&lt;li&gt;In the Search bar, search for 'Secret Manager API' and select it.&lt;/li&gt;&lt;li&gt;Click the blue box that says 'Enable'.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Within the project you wish to enable the API in, run the following command.&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud services enable Secret Manager API&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Reviewing Environment Variables That Should Be Migrated to Secret Manager&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Log in to the Google Cloud Web Portal (https://console.cloud.google.com/)&lt;/li&gt;&lt;li&gt;Go to Cloud Functions&lt;/li&gt;&lt;li&gt;Click on a function name from the list&lt;/li&gt;&lt;li&gt;Click on Edit and review the Runtime environment for variables that should be secrets. Leave this list open for the next step.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;To view a list of your cloud functions run cloud functions list&lt;/li&gt;&lt;li&gt;For each cloud function run the following command.&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud functions describe &amp;lt;function_name&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;Review the settings of the buildEnvironmentVariables and environmentVariables. Keep this information for the next step.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Migrating Environment Variables to Secrets within the Secret Manager&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Go to the Secret Manager page in the Cloud Console.&lt;/li&gt;&lt;li&gt;On the Secret Manager page, click Create Secret.&lt;/li&gt;&lt;li&gt;On the Create secret page, under Name, enter the name of the Environment Variable you are replacing. This will then be the Secret Variable you will reference in your code.&lt;/li&gt;&lt;li&gt;You will also need to add a version. This is the actual value of the variable that will be referenced from the code. To add a secret version when creating the initial secret, in the Secret value field, enter the value from the Environment Variable you are replacing.&lt;/li&gt;&lt;li&gt;Leave the Regions section unchanged.&lt;/li&gt;&lt;li&gt;Click the Create secret button.&lt;/li&gt;&lt;li&gt;Repeat for all Environment Variables&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Run the following command with the Environment Variable name you are replacing in the &amp;lt;secret-id&amp;gt;. It is most secure to point this command to a file with the Environment Variable value located in it, as if you entered it via command line it would show up in your shell's command history.&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud secrets create &amp;lt;secret-id&amp;gt; --data-file="/path/to/file.txt"&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Granting your Runtime's Service Account Access to Secrets&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Within the project containing your runtime login with account that has the 'roles/secretmanager.secretAccessor' permission.&lt;/li&gt;&lt;li&gt;Select the Navigation hamburger menu in the top left. Hover over 'Security' to under the then select 'Secret Manager' in the menu that opens up.&lt;/li&gt;&lt;li&gt;Click the name of a secret listed in this screen.&lt;/li&gt;&lt;li&gt;If it is not already open, click Show Info Panel in this screen to open the panel. 5.In the info panel, click Add principal. 6.In the New principals field, enter the service account your function uses for its identity. (If you need help locating or updating your runtime's service account, please see the 'docs/securing/function-identity#runtime_service_account' reference.)&lt;/li&gt;&lt;li&gt;In the Select a role dropdown, choose Secret Manager and then Secret Manager Secret Accessor.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&amp;nbsp;&lt;/p&gt;&lt;p&gt;As of the time of writing, using Google CLI to list Runtime variables is only in beta. Because this is likely to change we are not including it here.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Modifying the Code to use the Secrets in Secret Manager&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;p&gt;This depends heavily on which language your runtime is in. For the sake of the brevity of this recommendation, please see the '/docs/creating-and-accessing-secrets#access' reference for language specific instructions.&amp;nbsp;&lt;/p&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;p&gt;This depends heavily on which language your runtime is in. For the sake of the brevity of this recommendation, please see the' /docs/creating-and-accessing-secrets#access' reference for language specific instructions.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Deleting the Insecure Environment Variables&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Be certain to do this step last. Removing variables from code actively referencing them will prevent it from completing successfully.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Select the Navigation hamburger menu in the top left. Hover over 'Security' then select 'Secret Manager' in the menu that opens up.&lt;/li&gt;&lt;li&gt;Click the name of a function. Click Edit.&lt;/li&gt;&lt;li&gt;Click Runtime, build and connections settings to expand the advanced configuration options.&lt;/li&gt;&lt;li&gt;Click 'Security'. Hover over the secret you want to remove, then click 'Delete'.&lt;/li&gt;&lt;li&gt;Click Next. Click Deploy. The latest version of the runtime will now reference the secrets in Secret Manager.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&amp;nbsp;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;gcloud functions deploy &amp;lt;Function name&amp;gt;--remove-env-vars &amp;lt;env vars&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;If you need to find the env vars to remove, they are from the step where 'gcloud functions describe &amp;lt;function_name&amp;gt;' was run.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Default Value:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;By default Secret Manager is not enabled.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud docs: Managing secrets" url="https://cloud.google.com/functions/docs/configuring/env-var#managing_secrets"/>
            <reference name="Google Cloud docs: Secret Manager Overview" url="https://cloud.google.com/secret-manager/docs/overview"/>
          </references>
          <standards>
            <standard ref="1.18" supportedStandardRef="cis-gcp-standard"/>
            <standard ref="1.18" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;strong&gt;Determine if Confidential Information is Stored in your Functions in Cleartext&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Log in to the Google Cloud Web Portal (https://console.cloud.google.com/)&lt;/li&gt;&lt;li&gt;Within the project you wish to audit, select the Navigation hamburger menu in the top left. Scroll down to under the heading 'Serverless', then select 'Cloud Functions'&lt;/li&gt;&lt;li&gt;Click on a function name from the list&lt;/li&gt;&lt;li&gt;Open the Variables tab and you will see both buildEnvironmentVariables and environmentVariables&lt;/li&gt;&lt;li&gt;Review the variables whether they are secrets&lt;/li&gt;&lt;li&gt;Repeat step 3-5 until all functions are reviewed&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;To view a list of your cloud functions run&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud functions list&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;For each cloud function in the list run the following command.&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud functions describe &amp;lt;function_name&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;Review the settings of the buildEnvironmentVariables and environmentVariables. Determine if this is data that should not be publicly accessible.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;Determine if Secret Manager API is 'Enabled' for your Project&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;From Console&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Within the project you wish to audit, select the Navigation hamburger menu in the top left. Hover over 'APIs &amp;amp; Services' to under the heading 'Serverless', then select 'Enabled APIs &amp;amp; Services' in the menu that opens up.&lt;/li&gt;&lt;li&gt;Click the button '+ Enable APIS and Services'&lt;/li&gt;&lt;li&gt;In the Search bar, search for 'Secret Manager API' and select it.&lt;/li&gt;&lt;li&gt;If it is enabled, the blue box that normally says 'Enable' will instead say 'Manage'.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;From Command Line&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Within the project you wish to audit, run the following command.&amp;nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote&gt;&lt;p&gt;gcloud services list&lt;/p&gt;&lt;/blockquote&gt;&lt;ul&gt;&lt;li&gt;If 'Secret Manager API' is in the list, it is enabled.&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.473">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="GOOGLE-IAM06" name="Use Security Key for 2-Step Verification for administrator or co-administrator accounts" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Ensure that the users with administrator and co-administrator accounts activate and configure the second factor authentication provided by Google. With 2-Step Verification, you can log into Google with a security key.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
&lt;/div&gt; 
&lt;div&gt;
  To activate and configure 2 Factor Authentication, you shall follow the following steps: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ol&gt; 
  &lt;li&gt;Go to the 2-Step Verification page section of &lt;a href="https://myaccount.google.com/signinoptions/two-step-verification"&gt;My Account&lt;/a&gt;.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Click Add security key.&lt;/li&gt; 
  &lt;li&gt;Follow the on-screen instructions.&lt;/li&gt; 
 &lt;/ol&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="Google Cloud: mobile account" url="https://support.google.com/accounts/answer/6103523?co=GENIE.Platform%3DAndroid#phone"/>
            <reference name="Google support: answers" url="https://support.google.com/accounts/answer/6103534"/>
          </references>
          <standards>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Go to the 2-Step Verification page section of My Account.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that 2-Step Verification authentication is enabled and configured correctly.&lt;/li&gt;
                            &lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.472">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACTIVITY LOGS ALERTS" name="Activity Logs alerts" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="UNAUTHORIZED-ACCESS-SYSTEMS" name="Attackers access the systems without being detected" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers gain access to the systems and are not detected and consequently, changes made by attackers can not be audited or detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="25" availability="25" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-MON02">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON02A" mitigation="17"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON03">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON05" mitigation="17"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON04">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON06" mitigation="16"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON05">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON07" mitigation="17"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON06">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON08" mitigation="17"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-RESOURCES-STATUS">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON01" mitigation="16"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MON01" mitigation="17"/>
                <countermeasure ref="GOOGLE-MON02A" mitigation="17"/>
                <countermeasure ref="GOOGLE-MON05" mitigation="17"/>
                <countermeasure ref="GOOGLE-MON06" mitigation="16"/>
                <countermeasure ref="GOOGLE-MON07" mitigation="16"/>
                <countermeasure ref="GOOGLE-MON08" mitigation="17"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-ACCESS-SECURITY-SYSTEMS" name="Attackers gain undetected access to the security system configurations" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>Attackers could gain undetected access to the security system configurations and
                                changes made by attackers couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-MON01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON03" mitigation="34"/>
                    <countermeasure ref="GOOGLE-MON04" mitigation="33"/>
                    <countermeasure ref="GOOGLE-MON13" mitigation="33"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MON03" mitigation="34"/>
                <countermeasure ref="GOOGLE-MON04" mitigation="33"/>
                <countermeasure ref="GOOGLE-MON13" mitigation="33"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-ACCESS-NETWORK" name="Sensitive data is compromised through network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>Attackers gain undetected access to the network systems and changes made by the
                                attackers couldn't be audited or detected.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-MON07">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-MON09" mitigation="34"/>
                    <countermeasure ref="GOOGLE-MON10" mitigation="33"/>
                    <countermeasure ref="GOOGLE-MON11" mitigation="33"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-MON09" mitigation="34"/>
                <countermeasure ref="GOOGLE-MON10" mitigation="33"/>
                <countermeasure ref="GOOGLE-MON11" mitigation="33"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHENTICATION" name="Authentication" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-LOST-ACCESS-ROOT" name="Attackers gain unauthorized access to the root account due to lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the administrator account due to lack of configuration of the account and its security mechanisms, such as modifying credentials and adding/removing user accounts.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-IAM-01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM06" mitigation="6"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM09" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM10" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM11" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM12" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM13" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM14" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM15" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM16" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM17" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM18" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM19" mitigation="6"/>
                    <countermeasure ref="GOOGLE-IAM20" mitigation="6"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-MON02">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM05" mitigation="16"/>
                  </countermeasures>
                </weakness>
                <weakness ref="LOST-SECURITY-ALERTS">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-GOV01" mitigation="6"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-GOV01" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM05" mitigation="16"/>
                <countermeasure ref="GOOGLE-IAM06" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM09" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM10" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM11" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM12" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM13" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM14" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM15" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM16" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM17" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM18" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM19" mitigation="6"/>
                <countermeasure ref="GOOGLE-IAM20" mitigation="6"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="GOOGLE-LOST-ACCESS-USER" name="Attackers gain unauthorized access to the user account due to lack of configuration of the account" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the user account due to lack of configuration of the account, for example, the security question to reset the password is configured incorrectly.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="50" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-IAM03">
                  <countermeasures>
                    <countermeasure ref="C-GCP-IAM-01" mitigation="25"/>
                    <countermeasure ref="C-GCP-IAM-02" mitigation="25"/>
                    <countermeasure ref="C-GCP-IAM-03" mitigation="25"/>
                    <countermeasure ref="GOOGLE-IAM01" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GCP-IAM-01" mitigation="25"/>
                <countermeasure ref="C-GCP-IAM-02" mitigation="25"/>
                <countermeasure ref="C-GCP-IAM-03" mitigation="25"/>
                <countermeasure ref="GOOGLE-IAM01" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-EXPIRATION-DATE">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM08" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE_IAM-02">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-IAM02" mitigation="20"/>
                    <countermeasure ref="GOOGLE-IAM03" mitigation="20"/>
                    <countermeasure ref="GOOGLE-IAM04" mitigation="20"/>
                    <countermeasure ref="GOOGLE-IAM07" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-IAM02" mitigation="20"/>
                <countermeasure ref="GOOGLE-IAM03" mitigation="20"/>
                <countermeasure ref="GOOGLE-IAM04" mitigation="20"/>
                <countermeasure ref="GOOGLE-IAM07" mitigation="20"/>
                <countermeasure ref="GOOGLE-IAM08" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A10-2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-GCP-LOG-01" mitigation="12"/>
                    <countermeasure ref="C-GCP-LOG-02" mitigation="12"/>
                    <countermeasure ref="C-GCP-LOG-03" mitigation="12"/>
                    <countermeasure ref="GOOGLE-LOG01" mitigation="16"/>
                    <countermeasure ref="GOOGLE-LOG04" mitigation="12"/>
                    <countermeasure ref="GOOGLE-LOG05" mitigation="12"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-LOGS03">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-LOG06" mitigation="12"/>
                    <countermeasure ref="GOOGLE-LOG07" mitigation="12"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GCP-LOG-01" mitigation="12"/>
                <countermeasure ref="C-GCP-LOG-02" mitigation="12"/>
                <countermeasure ref="C-GCP-LOG-03" mitigation="12"/>
                <countermeasure ref="GOOGLE-LOG01" mitigation="16"/>
                <countermeasure ref="GOOGLE-LOG04" mitigation="12"/>
                <countermeasure ref="GOOGLE-LOG05" mitigation="12"/>
                <countermeasure ref="GOOGLE-LOG06" mitigation="12"/>
                <countermeasure ref="GOOGLE-LOG07" mitigation="12"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>Attackers could gain unauthorized connection to the resources through misconfigured
                                ports or security network configurations.
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-VNET01">
                  <countermeasures>
                    <countermeasure ref="GOOGLE-NET01" mitigation="16"/>
                    <countermeasure ref="GOOGLE-NET02" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET03" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET04" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET05" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET06" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET07" mitigation="12"/>
                    <countermeasure ref="GOOGLE-NET08" mitigation="12"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="GOOGLE-NET01" mitigation="16"/>
                <countermeasure ref="GOOGLE-NET02" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET03" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET04" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET05" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET06" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET07" mitigation="12"/>
                <countermeasure ref="GOOGLE-NET08" mitigation="12"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="b9d812b4-375c-496b-bdc2-a4596ff782d9" diagramComponentId="fd50701b-e13e-44c4-a483-63a8cd0c8439" ref="d56d71d9-4a6f-49d8-8674-ffd52af20567" name="Redis Server" desc="" library="CS-Default" parentComponentRef="3d864622-5588-4925-a2cd-ac0e382b8bf5" componentDefinitionRef="redis-server">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-250" name="Execution with Unnecessary Privileges" state="0" impact="100" issueId="" issueLink="">
          <desc>The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.211">
              <output/>
            </source>
            <references>
              <reference name="CWE-250: Execution with Unnecessary Privileges" url="https://cwe.mitre.org/data/definitions/250.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-284" name="Improper Access Control" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not restrict or incorrectly restricts access to a resource from an unauthorized actor.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.419">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-943" name="Improper Neutralization of Special Elements in Data Query Logic" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;p&gt;The application generates a query intended to access or manipulate data in a data store such as a database, but it does not neutralize or incorrectly neutralizes special elements that can modify the intended logic of the query.&lt;/p&gt;&lt;p&gt;Depending on the capabilities of the query language, an attacker could inject additional logic into the query to:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Modify the intended selection criteria, thus changing which data entities (e.g., records) are returned, modified, or otherwise manipulated&lt;/li&gt;&lt;li&gt;Append additional commands to the query&lt;/li&gt;&lt;li&gt;Return more entities than intended&lt;/li&gt;&lt;li&gt;Return fewer entities than intended&lt;/li&gt;&lt;li&gt;Cause entities to be sorted in an unexpected way&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The ability to execute additional commands or change which entities are returned has obvious risks. But when the application logic depends on the order or number of entities, this can also lead to vulnerabilities. For example, if the application query expects to return only one entity that specifies an administrative user, but an attacker can change which entities are returned, this could cause the logic to return information for a regular user and incorrectly assume that the user has administrative privileges.&lt;/p&gt;&lt;p&gt;While this weakness is most commonly associated with SQL injection, there are many other query languages that are also subject to injection attacks, including HTSQL, LDAP, DQL, XQuery, Xpath, and NoSQL languages.&lt;/p&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.853">
              <output/>
            </source>
            <references>
              <reference name="CWE-943: Improper Neutralization of Special Elements in Data Query Logic" url="https://cwe.mitre.org/data/definitions/943.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-78" name="Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')" state="0" impact="100" issueId="" issueLink="">
          <desc>The software constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component. This could allow attackers to execute unexpected, dangerous commands directly on the operating system. This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  There are at least two subtypes of OS command injection:&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system(&amp;quot;nslookup [HOSTNAME]&amp;quot;) to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.The application accepts an input that it uses to fully select which program to run, as well as which commands to use.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;The application simply redirects this entire command to the operating system. For example, the program might use &amp;quot;exec([COMMAND])&amp;quot; to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line. From a weakness standpoint, these variants represent distinct programmer errors.&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt;In the first variant, the programmer clearly intends input from untrusted parties will be part of the arguments in the command to be executed. In the second variant, the programmer does not intend for the command to be accessible to any untrusted party, but the programmer probably has not accounted for alternate ways in which malicious attackers can provide input. 
&lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.613">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-306" name="Missing Authentication for Critical Function" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.420">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="EU-GDPR-MISSING-ENCRYPTION-SENSITIVE-DATA" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;ul&gt; 
 &lt;li&gt;Weak encryption algorithms&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Loss of encryption keys&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Compromised encryption keys&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Revoked keys are still active (bad key lifecycle management)&lt;/li&gt; 
&lt;/ul&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.420">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="redis-server-exposed" name="The Redis server is exposed" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;p&gt;If access is permitted from other servers or public access, compromise is more likely, as the Redis server is exposed.&lt;/p&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.613">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="RESTRICT-ACCESS-DATABASE" name="Access the data store from an account with the least privileges necessary" issueId="" issueLink="" platform="" cost="1" risk="62" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>	&lt;p&gt;Use an account with only the minimum set of permissions required to access the data store. The account should not be able to perform operations that are not explicitly required by the component that performs these operations. For example, if a web application needs to read data from certain tables and insert and update data from others, then a database account with only those specific permissions should be used by the application server.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA AC-03 Access Enforcement" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/25-08_02_AC-03"/>
            <reference name="OSA AC-06 Least Privilege" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/28-08_02_AC-06"/>
            <reference name="OWASP Juice Shop: Injection" url="https://pwning.owasp-juice.shop/part2/injection.html"/>
            <reference name="[C3] OWASP Proactive Controls" url="https://www.owasp.org/index.php/OWASP_Proactive_Controls"/>
          </references>
          <standards>
            <standard ref="1.2.1" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.2.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="13.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="A03:2021-Injection" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A1:2017-Injection" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-3" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-6" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-6" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-6" supportedStandardRef="NIST 800-53"/>
            <standard ref="PR.AC-4" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-6" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-5" supportedStandardRef="nist-csf"/>
            <standard ref="PR.PT-3" supportedStandardRef="nist-csf"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Identify the user account used by external components to access this data store.&lt;/li&gt; 
 &lt;li&gt;Check which permissions are assigned to this user account.&lt;/li&gt; 
 &lt;li&gt;Verify that they are the minimum set of permissions necessary and no unnecessary permissions are assigned.&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.154">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="PATCH-SERVICE" name="Apply required security patches to the service" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Vendors and other maintainers of software release patches in response to security flaws and other bugs in their products.&amp;nbsp; The longer a system is exposed with a known security vulnerability, the easier to compromise it. &amp;nbsp;As the exploit enters the public domain, they get included in automated exploitation suites like Metasploit and a wider less skilled miscreant is able to leverage them.&amp;nbsp; &amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Apply patches and other software updates in a timely manner to prevent unexpected failures or exploitation.&lt;/li&gt;&lt;li&gt;Clearly define an approach for testing and applying patches, in particular security patches, with expected timescales. &amp;nbsp;There is often a small window between the release of a patch, and potentially malicious actors reverse-engineering the patch to identify and exploit the flaw.&lt;/li&gt;&lt;li&gt;Use a threat intelligence, vulnerability scanning, or other alerting services to ensure the project team is promptly aware of issues within the project or its components.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA CM-01 Configuration Management Policy And Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/152-08_02_CM-01"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="10" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14.1.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="14.1.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="18" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="19" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="3" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API1:2019-Broken Object Level Authorization" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="CM-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;br /&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Check with the software or service vendor whether security vulnerabilities and
                            their associated patches are available for the version deployed.&lt;/li&gt;
                            &lt;li&gt;Evaluate the criticality of the vulnerability and schedule a fix accordingly.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.334">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="EU-GDPR-ENCRYPT-PERSONAL-DATA" name="Encrypt personal data" issueId="" issueLink="" platform="" cost="0" risk="59" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Implement encryption at rest (see guidance below) or give a risk-based explanation as to why encryption was not implemented.&lt;br /&gt;&lt;br /&gt;Use well-known encryption libraries, taking into account the data use, and do not invent your own. 
          &lt;br /&gt;
              &lt;ul&gt;
              &lt;li&gt;personal data must be encrypted&lt;/li&gt;
              &lt;li&gt;data that is not used by the application (e.g. passwords, ...) should be hashed so they cannot be recovered easily&lt;/li&gt;
              &lt;/ul&gt;
          </desc>
          <implementations/>
          <references>
            <reference name="EU GDPR - EU Data Protection" url="https://ec.europa.eu/justice/data-protection/reform/files/regulation_oj_en.pdf"/>
            <reference name="OWASP Proactive controls [C8]" url="https://www.owasp.org/images/b/bc/OWASP_Top_10_Proactive_Controls_V3.pdf"/>
          </references>
          <standards>
            <standard ref="2.4.12.2" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.12.2" supportedStandardRef="iotsf-class-2"/>
            <standard ref="8.3.7" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="8.3.7" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="Art.32" supportedStandardRef="EU-GDPR"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
                &lt;ol&gt;
                &lt;li&gt;Verify that users' personal data processed by the application is encrypted at rest (e.g. databases).&lt;/li&gt;
                &lt;li&gt;If encryption is not being leveraged, verify that there is documentation outlining the reasoning for that decision.&lt;/li&gt;
                &lt;/ol&gt;
                &lt;/div&gt;
            </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.334">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CWE-306-SERVICE" name="Require authentication before presenting restricted data" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;The application should ensure users have undergone an Identification and Verification (ID&amp;amp;V) process before allowing access to secret, sensitive or otherwise restricted data. For less sensitive but still restricted data, simple verification of the location of the user may suffice (e.g. IP restrictions).&lt;/p&gt;&lt;ul&gt;&lt;li&gt;For non-sensitive but non-public data, access could be restricted by IP address, limiting access to internal networks, workstations, or gateways&lt;/li&gt;&lt;li&gt;For more sensitive data, TLS client-side certificates may be appropriate&lt;/li&gt;&lt;li&gt;Where secret or other sensitive data is handled, a full authentication process to identify and validate users with single or multi-factor authentication may be required&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="EU GDPR - EU Data Protection" url="https://ec.europa.eu/justice/data-protection/reform/files/regulation_oj_en.pdf"/>
            <reference name="OSA AC-14 Permitted Actions Without Identification Or Authentication" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/38-08_02_AC-14"/>
            <reference name="OSA IA-01 Identification And Authentication Policy And Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/181-08_02_IA-01"/>
            <reference name="OSA SI-04 Information System Monitoring Tools And Techniques" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/42-08_02_SI-04"/>
            <reference name="OSA SI-12 Information Output Handling And Retention" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/50-08_02_SI-12"/>
            <reference name="OWASP Juice Shop: Broken Authentication" url="https://pwning.owasp-juice.shop/part2/broken-authentication.html"/>
            <reference name="[C3] OWASP Proactive Controls" url="https://www.owasp.org/index.php/OWASP_Proactive_Controls"/>
          </references>
          <standards>
            <standard ref="1.2.2" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.2.2" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="11.1.3" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="11.1.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="11.1.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-14" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-21" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-21" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-21" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-22" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-22" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-22" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-22" supportedStandardRef="NIST 800-53"/>
            <standard ref="Art.32" supportedStandardRef="EU-GDPR"/>
            <standard ref="DE.AE-1" supportedStandardRef="nist-csf"/>
            <standard ref="DE.AE-2" supportedStandardRef="nist-csf"/>
            <standard ref="DE.AE-3" supportedStandardRef="nist-csf"/>
            <standard ref="DE.AE-4" supportedStandardRef="nist-csf"/>
            <standard ref="DE.CM-1" supportedStandardRef="nist-csf"/>
            <standard ref="DE.CM-5" supportedStandardRef="nist-csf"/>
            <standard ref="DE.CM-6" supportedStandardRef="nist-csf"/>
            <standard ref="DE.CM-7" supportedStandardRef="nist-csf"/>
            <standard ref="DE.DP-2" supportedStandardRef="nist-csf"/>
            <standard ref="DE.DP-3" supportedStandardRef="nist-csf"/>
            <standard ref="DE.DP-4" supportedStandardRef="nist-csf"/>
            <standard ref="DE.DP-5" supportedStandardRef="nist-csf"/>
            <standard ref="IA-1" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="IA-1" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="IA-1" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="IA-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
            <standard ref="ID.RA-1" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-1" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-4" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-6" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-7" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-5" supportedStandardRef="nist-csf"/>
            <standard ref="PR.IP-2" supportedStandardRef="nist-csf"/>
            <standard ref="PR.IP-8" supportedStandardRef="nist-csf"/>
            <standard ref="RS.AN-1" supportedStandardRef="nist-csf"/>
            <standard ref="RS.CO-3" supportedStandardRef="nist-csf"/>
            <standard ref="SI-12" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-4" supportedStandardRef="NIST 800-53"/>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                &lt;li&gt;Identify which parts of the service present sensitive data.&amp;nbsp;&lt;/li&gt;
                &lt;li&gt;Try to obtain access to this information without any type of authentication, for example, attempt to navigate directly to URLs that present sensitive data.&lt;/li&gt;
                &lt;/ol&gt;
            </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.333">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="RESTRICT-SERVICE" name="Restrict access to the service at the network layer to reduce exposure" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Access to services should be restricted to expected sources, limiting the exposure of the service and its attack surface; and the likelihood of a malicious actor gaining access to the system.&amp;nbsp;&lt;/p&gt; 
&lt;p&gt;Apply network layer security controls so that only the necessary and expected IP addresses are permitted access to connect to the service.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP Juice Shop: Broken Authentication" url="https://pwning.owasp-juice.shop/part2/broken-authentication.html"/>
            <reference name="OWASP Juice Shop: Insecure Deserialization" url="https://pwning.owasp-juice.shop/part2/insecure-deserialization.html"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="10" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="18" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="19" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="2.4.7.18" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.7.18" supportedStandardRef="iotsf-class-2"/>
            <standard ref="3" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="A07:2021-Identification and Authentication Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A08:2021-Software and Data Integrity Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A2:2017-Broken Authentication" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="A8:2017-Insecure Deserialization" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="API1:2019-Broken Object Level Authorization" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Check that the network access to the service is only allowed for the components which need it.&lt;/li&gt; 
 &lt;li&gt;There should be a firewall protecting the network segment in which the service is installed.&lt;/li&gt; 
 &lt;li&gt;Check that the firewall restricts all access and only permits the minimum connections required using the principal of least privilege.&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.334">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="secure-redis-access-localhost-only" name="Secure Redis Server access to localhost only" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;By default, Redis server is - and should only be - accessible from the localhost. But if access has been allowed from other servers or public access, likelihood of compromise increases.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Open the Redis configuration file, # vim /usr/local/redis/6379.conf&lt;/li&gt;&lt;li&gt;Once opened, look for 'bind' parameter &amp;amp; change it to, bind 127.0.0.1 ::1&lt;/li&gt;&lt;li&gt;Save the file &amp;amp; exit. Now restart the Redis service to implement the changes made.&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="Easy guide for Securing Redis Server" url="https://linuxtechlab.com/easy-guide-for-securing-redis-server/"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Check the Redis server is only accessible from localhost.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.565">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="secure-redis-renaming-dangerous-commands" name="Secure Redis Server by renaming or disabling dangerous commands" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;In order to avoid any serious repercussions if someone gains access to their Redis server, Redis provides a way to rename some of the dangerous commands like:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;LUSHDB,&lt;/li&gt;&lt;li&gt;FLUSHALL,&lt;/li&gt;&lt;li&gt;KEYS,&lt;/li&gt;&lt;li&gt;DEL,&lt;/li&gt;&lt;li&gt;CONFIG,&lt;/li&gt;&lt;li&gt;SHUTDOWN,&lt;/li&gt;&lt;li&gt;BGREWRITEAOF,&lt;/li&gt;&lt;li&gt;BGSAVE,&lt;/li&gt;&lt;li&gt;SAVE,&lt;/li&gt;&lt;li&gt;RENAME,&lt;/li&gt;&lt;li&gt;and DEBUG.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;There are other commands also that can be renamed but these are some of the most dangerous ones. Ensure to disable commands altogether if not needed in the application.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Remediation:&amp;nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Disabling a command is a similar process to renaming a command, for renaming, provide an alternate name for the command, but for disabling rename it to an empty name or string.&lt;/p&gt;&lt;p&gt;To rename a command, open the configuration file, # vim /usr/local/redis/6379.conf&lt;/p&gt;&lt;p&gt;Under the 'Security' section, we can rename or disable a command. To disable a command, use the following example as a reference: rename-command FLUSHALL ""&lt;/p&gt;&lt;p&gt;For renaming a command, use the following example as reference: rename-command FLUSHALL DELETEITALL&lt;/p&gt;&lt;p&gt;Here, we have renamed FLUSHALL command to DELETEITALL (Delete It All). Once changes have been made, save the file &amp;amp; restart the Redis service to implement the changes. Now login to redis-cli &amp;amp; check the renamed commands.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Easy guide for Securing Redis Server" url="https://linuxtechlab.com/easy-guide-for-securing-redis-server/"/>
          </references>
          <standards>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Try to use the following Redis Server commands in the redis-cli and verify they do not work:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;LUSHDB,&lt;/li&gt;&lt;li&gt;FLUSHALL,&lt;/li&gt;&lt;li&gt;KEYS,&lt;/li&gt;&lt;li&gt;DEL,&lt;/li&gt;&lt;li&gt;CONFIG,&lt;/li&gt;&lt;li&gt;SHUTDOWN,&lt;/li&gt;&lt;li&gt;BGREWRITEAOF,&lt;/li&gt;&lt;li&gt;BGSAVE,&lt;/li&gt;&lt;li&gt;SAVE,&lt;/li&gt;&lt;li&gt;RENAME,&lt;/li&gt;&lt;li&gt;and DEBUG.&lt;/li&gt;&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.566">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="secure-redis-with-password" name="Secure Redis Server installation with a password" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;The first operation to perform with a Redis installation, is to assign a password:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;open the configuration file. (Note:- This is the configuration file path for local installation, yours may be '/etc/redis/redis.conf' or if you have a custom installation, then go to that location. # vim /usr/local/redis/6379.conf)&lt;/li&gt;&lt;li&gt;Look for the parameter 'requirepass', and uncomment it and then assign a password, requirepass&amp;nbsp; test@9879&lt;/li&gt;&lt;li&gt;Once the changes have been made, restart the Redis service to implement the changes made. In order to connect to the redis-cli, enter the password. First, connect to redis-cli, # redis-cli&lt;/li&gt;&lt;li&gt;Now provide the password: 127.0.0.1:6379&amp;gt; auth test#9897&lt;/li&gt;&lt;li&gt;Connection to redis-cli established.&lt;/li&gt;&lt;/ol&gt;</desc>
          <implementations/>
          <references>
            <reference name="Easy guide for Securing Redis Server" url="https://linuxtechlab.com/easy-guide-for-securing-redis-server/"/>
          </references>
          <standards>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
     &lt;ol&gt;
      &lt;li&gt;Connect to redis-cli: # redis-cli&lt;/li&gt;
      &lt;li&gt;Check that the password is required.&lt;/li&gt;
      &lt;li&gt;Provide the password: 127.0.0.1:6379&amp;gt; auth test#9897&lt;/li&gt;
      &lt;li&gt;Check that the authentication is successful.&lt;/li&gt;
     &lt;/ol&gt;
    &lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.566">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CWE-89-PREPARED" name="Use prepared statements for all database queries" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Database injection attacks, such as SQLi (SQL Injection) rely on sending tainted client-side data which is used in dynamic SQL queries on the server-side in an unsafe manner. Creating queries by concatenating strings using untrusted data may result in&amp;nbsp;vulnerable code;&amp;nbsp;for example, an attacker appending an 'OR' statement to the customerName parameter in order to bypass checks and retrieve additional data from the database:&lt;/p&gt;&lt;p&gt;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;String query = "SELECT user FROM users WHERE name = '"&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&amp;nbsp;+ request.getParameter("customerName")+"'";&lt;/p&gt;&lt;p&gt;The use of prepared statements with carefully controlled and validated input conditions mitigates SQLi and related attacks.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Database queries should always be executed using prepared statements or parameterized queries.&lt;/li&gt;&lt;li&gt;Queries through an Object-Relational mapper should also be treated as tainted input, and again executed using prepared statements to mitigate the threat.&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations>
            <implementation platform="C#">
              <desc>ClN0cmluZyBxdWVyeSA9ICJTRUxFQ1QgYWNjb3VudF9iYWxhbmNlIEZST00gdXNlcl9kYXRhIFdIRVJFIHVzZXJfbmFtZSA9ID8iOwp0cnkgewogCU9sZURiQ29tbWFuZCBjb21tYW5kID0gbmV3IE9sZURiQ29tbWFuZChxdWVyeSwgY29ubmVjdGlvbik7CiAJY29tbWFuZC5QYXJhbWV0ZXJzLkFkZChuZXcgT2xlRGJQYXJhbWV0ZXIoImN1c3RvbWVyTmFtZSIsIEN1c3RvbWVyTmFtZSBOYW1lLlRleHQpKTsKIAlPbGVEYkRhdGFSZWFkZXIgcmVhZGVyID0gY29tbWFuZC5FeGVjdXRlUmVhZGVyKCk7IAkKIH0gY2F0Y2ggKE9sZURiRXhjZXB0aW9uIHNlKSB7CiAJLy8gZXJyb3IgaGFuZGxpbmcKIH0g</desc>
            </implementation>
          </implementations>
          <references>
            <reference name="OSA SI-01 System And Information Integrity Policy And Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/39-08_02_SI-01"/>
            <reference name="OSA SI-10 Information Accuracy, Completeness, Validity, And Authenticity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/48-08_02_SI-10"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="12" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="12.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="18" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="19" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="24" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="6" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API8:2019-Injection" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="CA-8" supportedStandardRef="NIST 800-53"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
            <standard ref="ID.RA-1" supportedStandardRef="nist-csf"/>
            <standard ref="SI-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-10" supportedStandardRef="NIST 800-53"/>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;For inputs receiving data that is subsequently added to - or used - in an SQL query:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Ensure SQL meta-characters are identified and properly escaped or encoded.&lt;/li&gt;&lt;li&gt;Data should used be in the form of parameterized SQL queries, rather than dynamically generated queries.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;To test data validation:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Review the code processing potentially tainted user input to SQL queries and confirm the data is executed only in pre-prepared parameterized SQL queries.&lt;/li&gt;&lt;li&gt;Review the acceptable input criteria, and build test cases that deviate from it (invalid characters, lengths, ranges etc.)&lt;/li&gt;&lt;li&gt;Pass invalid input to the application and review error trapping and handling.&lt;/li&gt;&lt;li&gt;Where unexpected exceptions occur, the application may be vulnerable to attack.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.731">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="DATA-VAL" name="Validate all data received" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;All data received should be considered tainted and a potential risk, regardless of the source or transport method. For example, while hidden form fields, cookies or other headers may be obfuscated from a user, along with parameters passed in ViewStates or other encapsulated forms. These can be modified by the user on the client-side in memory, or in transit on the network. Similarly, data passed from binary or compiled components can be modified in situ or in transit. &lt;i&gt;&lt;/i&gt; &lt;i&gt;Furthermore, encryption only secures the data in transit between the two ends of the encrypted tunnel (one of which is typically controlled by the client); data passing through the link may still be malicious.&lt;/i&gt; &lt;/p&gt; As such, all data from the client side must be subjected to strict validation, sanitization, and encoding against expected syntactic and semantic criteria. 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Define a specification of the data that is expected at each input; both the syntax (e.g. alphanumeric only) and semantics (e.g. a word of between 1 and 25 characters, or a specific list). As an example of business rule logic, &amp;quot;boat&amp;quot; may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as &amp;quot;red&amp;quot; or &amp;quot;blue.&amp;quot;&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Implement a 'known good' or white-list approach, where only inputs that meet the strict criteria for each input are accepted, and reject, transform, or encapsulate any non-compliant data.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;While useful for identifying malicious content, do not rely on looking for specific malformed or attack payloads (blacklists). It is almost impossible to maintain a comprehensive and accurate blacklist due to the complexity and evolving nature of attacks, opportunities to obfuscate payloads, and changes to the code's execution environment. As noted, blacklists can be useful for detecting and logging potential attacks, or determining which inputs are so malformed that they should be rejected outright.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Validate all data received from the client, including values such as &lt;span class="caps"&gt;HTTP&lt;/span&gt; headers and cookie values if these are used as input on the server side, X- headers, and other platform specific data objects passed between the client and server.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA SC-13 Use Of Cryptography" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/73-08_02_SC-13"/>
            <reference name="OSA SI-01 System And Information Integrity Policy And Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/39-08_02_SI-01"/>
            <reference name="OSA SI-03 Malicious Code Protection" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/41-08_02_SI-03"/>
            <reference name="OSA SI-10 Information Accuracy, Completeness, Validity, And Authenticity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/48-08_02_SI-10"/>
            <reference name="OSA SI-11 Error Handling" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/49-08_02_SI-11"/>
            <reference name="OWASP Juice Shop: Injection" url="https://pwning.owasp-juice.shop/part2/injection.html"/>
            <reference name="OWASP Juice Shop: Insecure Deserialization" url="https://pwning.owasp-juice.shop/part2/insecure-deserialization.html"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="1.5.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.5.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="11.1.5" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="11.1.5" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="11.1.5" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="12" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="12.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="12.3.5" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="12.3.5" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="12.3.5" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="12.6.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="18" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="19" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="2.4.10.10" supportedStandardRef="iotsf-class-0"/>
            <standard ref="2.4.10.10" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.10.10" supportedStandardRef="iotsf-class-2"/>
            <standard ref="2.4.10.12" supportedStandardRef="iotsf-class-0"/>
            <standard ref="2.4.10.12" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.10.12" supportedStandardRef="iotsf-class-2"/>
            <standard ref="2.4.11.9" supportedStandardRef="iotsf-class-0"/>
            <standard ref="2.4.11.9" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.11.9" supportedStandardRef="iotsf-class-2"/>
            <standard ref="24" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.1.3" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.1.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.1.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.1.4" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.1.4" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.1.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.2.2" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.2.2" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.2.2" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.2.3" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.2.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.2.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.2.6" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.2.6" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.2.6" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.2.7" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.2.7" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.2.7" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.3.10" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.3.10" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.3.10" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.3.8" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.3.8" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.3.8" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="6" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="A03:2021-Injection" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A08:2021-Software and Data Integrity Failures" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A10:2021-Server-Side Request Forgery (SSRF)" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A1:2017-Injection" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="A8:2017-Insecure Deserialization" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="API8:2019-Injection" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="CA-8" supportedStandardRef="NIST 800-53"/>
            <standard ref="DE.CM-4" supportedStandardRef="nist-csf"/>
            <standard ref="DE.DP-3" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
            <standard ref="ID.RA-1" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-5" supportedStandardRef="nist-csf"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="SC-13" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-10" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-11" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-15" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-3" supportedStandardRef="NIST 800-53"/>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Identify data input points for the application, for example:&amp;nbsp;&lt;/p&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Forms with user input (including hidden fields)&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;&lt;span class="caps"&gt;API&lt;/span&gt; calls&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt; Headers&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Application states such as &lt;span class="caps"&gt;ASP&lt;/span&gt; Viewstates&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Serialized Java objects&lt;/li&gt; 
 &lt;li&gt;Any data structure received from the client-side&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;For every input, define accepted input (both syntactic and semantic criteria)&lt;/li&gt; 
 &lt;li&gt;Where possible, define a white-list of accepted input or characters&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;For each of the inputs, ensure that the data is validated against the defined whitelists (for example with a regular expression) before being processed.&amp;nbsp;&lt;/li&gt; 
&lt;/ul&gt;To test data validation:&amp;nbsp; 
&lt;p&gt;&lt;/p&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Review the acceptable input criteria, and build test cases that deviate from it (invalid characters, lengths, ranges etc.).&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Pass invalid input to the application and review error trapping and handling.&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Where unexpected exceptions occur, the application may be vulnerable to attack.&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt; A number of tools can be used to aid in testing: 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Directly from your browser with the Developer Tools.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Using a browser extension which allows you to modify the request and responses on the fly (i.e. Tamper Data).&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Using a proxy which allows you to modify the request and response on the fly (i.e. &lt;span class="caps"&gt;OWASP&lt;/span&gt; &lt;span class="caps"&gt;ZAP&lt;/span&gt;, Burp, Fiddler, etc.).&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.732">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="ACCESS SERVICE" name="Access service" desc="" library="CS-Default">
          <threats>
            <threat ref="VULN-SERVICE" name="Attackers gain access to unauthorised data by exploiting vulnerabilities in the service" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>Attackers exploit vulnerabilities in the service and gain access to data, or to
                                services for which they are not authorized.
                            </desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-284">
                  <countermeasures>
                    <countermeasure ref="PATCH-SERVICE" mitigation="50"/>
                    <countermeasure ref="RESTRICT-SERVICE" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="PATCH-SERVICE" mitigation="50"/>
                <countermeasure ref="RESTRICT-SERVICE" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CAPEC-115" name="Authentication Bypass" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;p&gt;An attacker gains access to the application, service, or device with the privileges of an authorized or privileged user by evading - or circumventing - an authentication mechanism. The attacker is therefore able to access protected data without authentication ever having taken place. This refers to an attacker gaining access equivalent to an authenticated user without ever going through an authentication procedure. &lt;/p&gt; This is usually the result of the attacker using an unexpected access procedure that does not go through the proper checkpoints where authentication should occur. For example, a web site might assume that all users will click through a given link in order to access secure material and simply authenticate everyone that clicks the link. However, an attacker might be able to reach secured web content by explicitly entering the path to the content rather than clicking through the authentication link, thereby avoiding the check entirely. This attack pattern differs from other authentication attacks in that attacks of this pattern avoid authentication entirely, rather than faking authentication by exploiting flaws or by stealing credentials from legitimate users.</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-306">
                  <countermeasures>
                    <countermeasure ref="CWE-306-SERVICE" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="CWE-306-SERVICE" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="EU-GDPR-DATA_LEAKAGE-UNAUTHZ-PARTIES" name="Data leakage or disclosure to unauthorized parties" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;p&gt;An unauthorized party might access/breach the personal data of a data subject.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="75" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="EU-GDPR-MISSING-ENCRYPTION-SENSITIVE-DATA">
                  <countermeasures>
                    <countermeasure ref="EU-GDPR-ENCRYPT-PERSONAL-DATA" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="EU-GDPR-ENCRYPT-PERSONAL-DATA" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="authentication" name="Authentication" desc="" library="CS-Default">
          <threats>
            <threat ref="AUTH-DATASTORE-LEAST-PRIV" name="Attackers who compromise the application or application server could directly access and modify the data store" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>If attackers gain access to the application or the application server, then they could
                                directly access the data store using the privilege assigned to the application.
                                &lt;div&gt;
                                If the data store user account used by the application has elevated privileges then this
                                could allow attackers to perform unauthorized operations such as dropping tables,
                                modifying the database schema or modifying data.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality="1" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-250">
                  <countermeasures>
                    <countermeasure ref="RESTRICT-ACCESS-DATABASE" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="RESTRICT-ACCESS-DATABASE" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CAPEC-115" name="Authentication Bypass" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;p&gt;An attacker gains access to the application, service, or device with the privileges of an authorized or privileged user by evading - or circumventing - an authentication mechanism. The attacker is therefore able to access protected data without authentication ever having taken place. This refers to an attacker gaining access equivalent to an authenticated user without ever going through an authentication procedure. &lt;/p&gt; This is usually the result of the attacker using an unexpected access procedure that does not go through the proper checkpoints where authentication should occur. For example, a web site might assume that all users will click through a given link in order to access secure material and simply authenticate everyone that clicks the link. However, an attacker might be able to reach secured web content by explicitly entering the path to the content rather than clicking through the authentication link, thereby avoiding the check entirely. This attack pattern differs from other authentication attacks in that attacks of this pattern avoid authentication entirely, rather than faking authentication by exploiting flaws or by stealing credentials from legitimate users.</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-306">
                  <countermeasures>
                    <countermeasure ref="secure-redis-with-password" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="secure-redis-with-password" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="CS-Default">
          <threats>
            <threat ref="CAPEC-341" name="Attackers gain access to user data by manipulating server-side code" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;p&gt;Server-Side Code Injection happens when an attacker is able to direct input under his control and mix it with executed code on the server-side by modifying the logic executed on it.&amp;nbsp;&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-943">
                  <countermeasures>
                    <countermeasure ref="CWE-89-PREPARED" mitigation="50"/>
                    <countermeasure ref="DATA-VAL" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="CWE-89-PREPARED" mitigation="50"/>
                <countermeasure ref="DATA-VAL" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="AUTH-DATASTORE-LEAST-PRIV" name="Attackers who compromise the application or application server could directly access and modify the data store" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>If attackers gain access to the application or the application server, then they could
                                directly access the data store using the privilege assigned to the application.
                                &lt;div&gt;
                                If the data store user account used by the application has elevated privileges then this
                                could allow attackers to perform unauthorized operations such as dropping tables,
                                modifying the database schema or modifying data.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality="1" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-250">
                  <countermeasures>
                    <countermeasure ref="RESTRICT-ACCESS-DATABASE" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="RESTRICT-ACCESS-DATABASE" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="networking" name="Networking" desc="" library="CS-Default">
          <threats>
            <threat ref="CAPEC-88" name="An adversary injects operating system commands into existing application functions" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>In this type of an attack, an adversary injects operating system commands into existing application functions. An application that uses untrusted input to build command strings is vulnerable. An adversary can leverage OS command injection in an application to elevate privileges, execute arbitrary commands and compromise the underlying operating system.
    &lt;br /&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-78">
                  <countermeasures>
                    <countermeasure ref="secure-redis-renaming-dangerous-commands" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="secure-redis-renaming-dangerous-commands" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="VULN-SERVICE" name="Attackers gain access to unauthorised data by exploiting vulnerabilities in the service" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>Attackers exploit vulnerabilities in the service and gain access to data, or to
                                services for which they are not authorized.
                            </desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="redis-server-exposed">
                  <countermeasures>
                    <countermeasure ref="secure-redis-access-localhost-only" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="secure-redis-access-localhost-only" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="73e1b6f6-ee62-41d4-8bb4-8b853e028520" diagramComponentId="675578c4-5252-4ba1-9a9e-f8dcde7d359b" ref="2f776b9c-0ede-4325-afc0-4e0c4c527f33" name="GCP Run" desc="" library="Google Cloud Platform" parentComponentRef="9bc60ced-7bf6-4279-8744-cd4c4c818097" componentDefinitionRef="CD-GOOGLE-CLOUD-RUN">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-937" name="Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" state="0" impact="100" issueId="" issueLink="">
          <desc>In theory, it ought to be easy to figure out if you are currently using any vulnerable
                        components or libraries. Unfortunately, vulnerability reports for commercial or open source
                        software do not always specify exactly which versions of a component are vulnerable in a
                        standard, searchable way. Further, not all libraries use an understandable version numbering
                        system. Worst of all, not all vulnerabilities are reported to a central clearing house that is
                        easy to search, although sites like CVE and NVD are becoming easier to search.

                        Determining if you are vulnerable requires searching these databases, as well as keeping abreast
                        of project mailing lists and announcements for anything that might be a vulnerability. If one of
                        your components does have a vulnerability, you should carefully evaluate whether you are
                        actually vulnerable by checking to see if your code uses the part of the component with the
                        vulnerability and whether the flaw could result in an impact you care about.

                        Component vulnerabilities can cause almost any type of risk imaginable, ranging from the trivial
                        to sophisticated malware designed to target a specific organization. Components almost always
                        run with the full privilege of the application, so flaws in any component can be serious.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.956">
              <output/>
            </source>
            <references>
              <reference name="CWE-937: Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" url="https://cwe.mitre.org/data/definitions/937.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.956">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE_IAM-02" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials for the groups and roles are incorrectly configured and there are user accounts with more privileges than necessary.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.955">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA" name="Sensitive data is accessible" state="0" impact="100" issueId="" issueLink="">
          <desc>Sensitive data is not encrypted and is exposed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.956">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="SYSTEM-VUL-DOS" name="System is vulnerable to a denial of service attack" state="0" impact="100" issueId="" issueLink="">
          <desc>Attackers can perform a successful denial of service on the system</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.956">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to open ports is most likely an attack. To avoid this, access to the network must be as restricted as possible, so that only the necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.955">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN1" name="Control access to Cloud Run using IAM access control" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control access to Cloud Run using IAM access control&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, only project owners and editors can create, update, delete, or invoke services, and only project owners and Cloud Run Admins can modify Identity and Access Management (IAM) policies - for example, make a service public.&lt;br&gt; To grant other users or groups the ability to perform these actions, you can use IAM to grant roles to different members.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Controlling access on an individual service&lt;/p&gt; 
&lt;p&gt;If you want to control access on a per-service basis, you can use per-service IAM.&lt;/p&gt; 
&lt;p&gt;Making a service public&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to make public.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. In the Add members field, allUsers&lt;/p&gt; 
&lt;p&gt;5. Select the Cloud Run Invoker role from the Select a role drop-down menu.&lt;/p&gt; 
&lt;p&gt;6. Click Add.&lt;/p&gt; 
&lt;p&gt;When creating a new service, you will be prompted if you want to "allow unauthenticated access." Answering yes will perform the actions above to make the service publicly available. Answering no will leave the service private.&lt;/p&gt; 
&lt;p&gt;Domain Restricted Sharing&lt;/p&gt; 
&lt;p&gt;If the project is subject to the domain restricted sharing constraint in an organization policy, you will be unable to create public services. Google Cloud recommends that you create all projects in a folder not subject to this restriction, and remove it on existing projects by restoring the default constraint on the project.&lt;/p&gt; 
&lt;p&gt;Adding users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to add users to.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. In the Add members field, enter one or more identities that need access to your service.&lt;/p&gt; 
&lt;p&gt;5. Select a role (or roles) from the Select a role drop-down menu. The roles you select appear in the pane with a short description of the permissions they grant.&lt;/p&gt; 
&lt;p&gt;6. Click Add.&lt;/p&gt; 
&lt;p&gt;Removing users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to remove users from.&lt;/p&gt; 
&lt;p&gt;Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;Search for the user you want to remove, or expand a role the user has.&lt;/p&gt; 
&lt;p&gt;Click the delete trash can next to the member type within the role to remove the role from the member.&lt;/p&gt; 
&lt;p&gt;Bulk addition or removal of users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to add users to or remove users from.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;If you want to add users:&lt;/p&gt; 
&lt;p&gt;1. In the Add members field, enter multiple identities that need access to your service.&lt;/p&gt; 
&lt;p&gt;2. Select a role (or roles) from the Select a role drop-down menu. The roles you select appear in the pane with a short description of the permissions they grant.&lt;/p&gt; 
&lt;p&gt;3. Click Add.&lt;/p&gt; 
&lt;p&gt;If you want to remove users:&lt;/p&gt; 
&lt;p&gt;1. Search for the user you want to remove, or expand a role the user has.&lt;/p&gt; 
&lt;p&gt;2. Click the delete trash can next to the member type within the role to remove the role from the member.&lt;/p&gt; 
&lt;p&gt;Viewing users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to view users and roles.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. All users will be shown, grouped by role granted.&lt;/p&gt; 
&lt;p&gt;Controlling access on all services in a project&lt;/p&gt; 
&lt;p&gt;If you want to grant roles to members on all services in a project, you can use project-level IAM.&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Find the user you want to grant a project-wide role.&lt;/p&gt; 
&lt;p&gt;3. Click the edit Pencil on the right side of the user's row.&lt;/p&gt; 
&lt;p&gt;4. Click Add another role and pick the desired role.&lt;/p&gt; 
&lt;p&gt;5. Click save.&lt;/p&gt; 
&lt;p&gt;Note: the allUsers and allAuthenticatedUsers member types can't be applied at the project level, and instead must be added to each service individually.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Access control with IAM" url="https://cloud.google.com/debugger/docs/iam"/>
            <reference name="Cloud Run IAM roles" url="https://cloud.google.com/run/docs/reference/iam/roles"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Testing permissions&lt;/p&gt;

	&lt;p&gt;Most Google Cloud resources expose the testIamPermissions() method, which allows you to programmatically check whether the currently authenticated caller has been granted one or more specific IAM permissions on the resource. The testIamPermissions() method takes a resource identifier and a set of permissions as input parameters, and returns the set of permissions that the caller is allowed.&lt;/p&gt;

	&lt;p&gt;You can use the testIamPermissions() method to determine whether a user should have access to an administrative tool in a web application. For example, you can use this method to decide, based on the user's permissions, whether to display detailed information about a Google Cloud resource.&lt;/p&gt;

	&lt;p&gt;Note: If you need to test a permission so that you can troubleshoot access to a resource, use the Policy Troubleshooter instead.&lt;/p&gt;

	&lt;p&gt;For example, to determine if the currently authenticated user has the permission to delete a project, call the projects.testIamPermissions() method by providing the project ID (such as foo-project) and the resourcemanager.projects.delete permission as input parameters. If the caller has been granted the resourcemanager.projects.delete permission, it will be listed in the response body. If the caller does not have this permission, the response body will list no permissions.&lt;/p&gt;

	&lt;p&gt;The testIamPermissions() method is intended for third-party graphical user interfaces (GUIs) that need to display Google Cloud resources based on what the authenticated user has permissions to see. For example, the Cloud Console internally uses the testIamPermissions() method to determine what resources and functionality are visible to you after authenticating. Different users are typically granted different permissions, and the Cloud Console hides or exposes items accordingly.&lt;/p&gt;

	&lt;p&gt;How to test permissions&lt;/p&gt;

	&lt;p&gt;This example shows how to test the resourcemanager.projects.get and resourcemanager.projects.delete permissions for a Google Cloud project. To test permissions for other Google Cloud resources, use the testIamPermissions() method exposed by each resource. For example, you can test the IAM permissions for a Cloud Storage bucket.&lt;/p&gt;

	&lt;p&gt;In this example, the user has an IAM role that allows them to get information about a project, but not to delete projects.&lt;/p&gt;

	&lt;p&gt;The Resource Manager API's projects.testIamPermissions method accepts a list of permissions and tests which of the permissions a member has.&lt;/p&gt;

	&lt;p&gt;Before using any of the request data below, make the following replacements:&lt;/p&gt;

	&lt;p&gt;project-id: Your Google Cloud project ID.&lt;br /&gt;
HTTP method and URL:&lt;/p&gt;

	&lt;p&gt;POST https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;Request JSON body:&lt;/p&gt;

	&lt;p&gt;{
  "permissions":  [
    "resourcemanager.projects.get",
    "resourcemanager.projects.delete"
  ]&lt;br /&gt;
}&lt;/p&gt;

	&lt;p&gt;Note: Ensure you have set the GOOGLE_APPLICATION_CREDENTIALS environment variable to your service account private key file path.&lt;br /&gt;
Save the request body in a file called request.json, and execute the following command:&lt;/p&gt;

	&lt;p&gt;curl -X POST \&lt;br /&gt;
-H "Authorization: Bearer "$(gcloud auth application-default print-access-token) \&lt;br /&gt;
-H "Content-Type: application/json; charset=utf-8" \&lt;br /&gt;
-d @request.json \&lt;br /&gt;
https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;You should receive a JSON response similar to the following:&lt;/p&gt;

	&lt;p&gt;{
  "permissions": [
    "resourcemanager.projects.get"
  ]&lt;br /&gt;
}&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.901">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN5" name="Create alerts for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; You can use Cloud Monitoring to send notification about certain events, such as uptime check failures.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; General steps to create an alerting policy:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring.&lt;/p&gt; 
&lt;p&gt;2. Select Alerting.&lt;/p&gt; 
&lt;p&gt;3. Click Create Policy to see the Create alerting policy page.&lt;/p&gt; 
&lt;p&gt;a. Click Add condition and complete the dialog. For information on the fields in a condition, see Specifying conditions.&lt;/p&gt; 
&lt;p&gt;A condition describes a monitored resource, a metric for that resource, and when the condition is met. An alerting policy must have at least 1 condition, however alerting policies can contain up to 6 conditions. When an alerting policy has exactly 1 condition and when that condition is met, an incident is created. When an alerting policy has multiple conditions, you specify how these conditions are combined.&lt;/p&gt; 
&lt;p&gt;b. Click Next to advance to the notifications section.&lt;/p&gt; 
&lt;p&gt;c. To be informed when an incident is created, add a notification channel to your alerting policy. You can add multiple notification channels. For details about your choices of notification channels, see Notification options.&lt;/p&gt; 
&lt;p&gt;To add a notification channel, click Notification channels. In the dialog, select one or more notification channels from the menu and then click OK.&lt;/p&gt; 
&lt;p&gt;To add a notification channel to the list of channels, click Manage notification channels. You are taken to the Notification channels page in a new browser tab. From this page, you can update the configured notification channels. When you have completed your updates, return to the original tab, click Refresh, and then select the notification channels to add to the alerting policy.&lt;/p&gt; 
&lt;p&gt;d. (Optional) To be notified when an incident is opened and closed, then select Notify on incident closure. By default, notifications are sent only when an incident is opened.&lt;/p&gt; 
&lt;p&gt;e. (Optional) If the field Incident autoclose duration is shown, then set the value of this field to be the duration that Monitoring should wait before closing incidents when observations stop arriving. The default value of this field is seven days. The minimum auto-close duration is 30 minutes.&lt;/p&gt; 
&lt;p&gt;For example, assume that you have an alert with a metric threshold condition that monitors a virtual machine (VM). If you turn down the VM while an incident is open, then by default Monitoring waits for seven days before it closes the incident.&lt;/p&gt; 
&lt;p&gt;f. Click Next to advance to the documentation section.&lt;/p&gt; 
&lt;p&gt;g. Click Name and enter a policy name. This name is included in notifications and it is displayed in the Policies page.&lt;/p&gt; 
&lt;p&gt;h. (Optional) Specify the documentation to be included in notifications. To format your documentation, you can use Markdown. To pull information out of the policy itself to tailor the content of your documentation, you can use variables.&lt;/p&gt; 
&lt;p&gt;For example, documentation might include a title such as Addressing High CPU Usage and details that identify the project:&lt;/p&gt; 
&lt;p&gt; &lt;/p&gt;
&lt;ol&gt; 
 &lt;li&gt;Addressing High CPU Usage&lt;/li&gt; 
&lt;/ol&gt;
&lt;p&gt;&lt;/p&gt; 
&lt;p&gt;This note contains information about high CPU Usage.&lt;/p&gt; 
&lt;p&gt;You can include variables in the documentation. For example:&lt;/p&gt; 
&lt;p&gt;This alert originated from the project ${project}, using&lt;br&gt; the variable $${project}.&lt;/p&gt; 
&lt;p&gt;The value replaces the variable only in notifications. The Preview Markdown pane, and the other places in the Cloud Console that show the documentation, reflect only the Markdown formatting.&lt;/p&gt; 
&lt;p&gt;You can also include channel-specific tagging to control notifications.&lt;/p&gt; 
&lt;p&gt;4. Click Save.&lt;/p&gt; 
&lt;p&gt;For more information, please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Monitoring Health and Performance" url="https://cloud.google.com/run/docs/monitoring"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;View alerting policy&lt;/p&gt;

	&lt;p&gt;1. In the Cloud Console, select Monitoring.&lt;/p&gt;

	&lt;p&gt;2. In the navigation pane, select notifications Alerting.&lt;/p&gt;

	&lt;p&gt;3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;/p&gt;

	&lt;p&gt;4. Find the policy that you want to view, and then select it.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.902">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN2" name="Enable Binary Authorization for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Binary Authorization for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Binary Authorization is a deploy-time security control that ensures only trusted container images are deployed on Google Kubernetes Engine (GKE) or Cloud Run. With Binary Authorization, you can require images to be signed by trusted authorities during the development process and then enforce signature validation when deploying. By enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process.&lt;br&gt; With Binary Authorization and Cloud Run, you can enforce that a container:&lt;br&gt; - Was created using an approved build system&lt;br&gt; - Was approved by the QA team&lt;br&gt; - Was analyzed for vulnerabilities&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enable Binary Authorization on an existing Cloud Run service&lt;/p&gt; 
&lt;p&gt;This section describes how to enable Binary Authorization enforcement on an existing service.&lt;/p&gt; 
&lt;p&gt;Note: To activate enforcement after enabling it, you might need to deploy a revision or update service traffic.&lt;/p&gt; 
&lt;p&gt;To enable Binary Authorization enforcement on an existing service, do the following:&lt;/p&gt; 
&lt;p&gt;1. Go to the Cloud Run page in the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Click the name of the service.&lt;/p&gt; 
&lt;p&gt;3. Click the Details tab.&lt;/p&gt; 
&lt;p&gt;4. To enable Binary Authorization enforcement on the service, click Enable.&lt;/p&gt; 
&lt;p&gt;5. Optional: To configure the Binary Authorization policy, click Configure Policy.&lt;/p&gt; 
&lt;p&gt;Note: Google Cloud recommends that you require Binary Authorization for Cloud Run by configuring an organization policy to do so. If the policy is not configured, Binary Authorization can be disabled by Cloud Run developers.&lt;/p&gt; 
&lt;p&gt;View the policy&lt;/p&gt; 
&lt;p&gt;To view the policy, click View policy.&lt;/p&gt; 
&lt;p&gt;To enable Binary Authorization on a new service, do the following:&lt;/p&gt; 
&lt;p&gt;1. Go to the Cloud Run page.&lt;/p&gt; 
&lt;p&gt;2. Click Create service. In the Create service form that displays:&lt;br&gt; a. Select Cloud Run as your development platform.&lt;br&gt; b. Select the region where you want your service located.&lt;br&gt; c. Enter the service name.&lt;br&gt; d. Click Next to continue to the Configure the service's first revision page.&lt;br&gt; e. Select Deploy one revision from an existing container image.&lt;br&gt; f. Enter or select the image to deploy.&lt;br&gt; g. Expand the Advanced settings section.&lt;br&gt; h. Click the Security tab.&lt;br&gt; i. Select the Verify container deployment with Binary Authorization checkbox.&lt;br&gt; Note: This checkbox might be disabled if your organization policy is set to require Binary Authorization for Cloud Run.&lt;br&gt; j. Optional: Click Configure policy to configure the Binary Authorization policy.&lt;br&gt; k. Deploy the service.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Enable Binary Authorization for Cloud Run" url="https://cloud.google.com/binary-authorization/docs/run/enabling-binauthz-cloud-run"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that Binary Authorization for Cloud Run is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.901">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN3" name="Protect Cloud Run container images using Cloud KMS" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Protect Cloud Run container images using Cloud KMS&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, container images deployed to Cloud Run are encrypted at rest with Google-managed encryption keys. Customers with higher security needs might want more control over the encryption of their resources at rest to improve their confidence in using the public cloud. A container image is such a resource.&lt;br&gt; Protect container images deployed to Cloud Run services using Cloud KMS customer managed encryption keys (CMEK). You can use this feature to protect containers imported by Cloud Run with a CMEK key at rest.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enabling CMEK for a Cloud Run service&lt;/p&gt; 
&lt;p&gt;Any configuration change leads to the creation of a new revision. Subsequent revisions will also automatically get this configuration setting unless you make explicit updates to change it.&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service if you are configuring a new service you are deploying to. If you are configuring an existing service, click on the service, then click Edit and Deploy New Revision.&lt;/p&gt; 
&lt;p&gt;3. If you are configuring a new service, fill out the initial service settings page as desired, then click Next &amp;gt; Container, Variables &amp;amp; Secrets, Connections, Security to reach the service configuration page.&lt;/p&gt; 
&lt;p&gt;4. Click the Security tab.&lt;/p&gt; 
&lt;p&gt;5. Select the checkbox Use a customer-managed encryption key (CMEK) , then select the desired key from the Select a customer-managed key pulldown menu.&lt;/p&gt; 
&lt;p&gt;6. Click Create or Deploy.&lt;/p&gt; 
&lt;p&gt;Referencing keys from other projects&lt;/p&gt; 
&lt;p&gt;You can reference a key from another project, if your project's service account has been allowed to encrypt/decrypt the key.&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service if you are configuring a new service you are deploying to. If you are configuring an existing service, click on the service, then click Edit and Deploy New Revision.&lt;/p&gt; 
&lt;p&gt;3. If you are configuring a new service, fill out the initial service settings page as desired, then click Next &amp;gt; Container, Variables &amp;amp; Secrets, Connections, Security to reach the service configuration page.&lt;/p&gt; 
&lt;p&gt;4. Click the Security tab.&lt;/p&gt; 
&lt;p&gt;5. In the Security tab:&lt;/p&gt; 
&lt;p&gt;a. Select the checkbox Use a customer-managed encryption key (CMEK) .&lt;br&gt; b. Select Don't see your key? Enter key resource ID from the Select a customer-managed key pulldown list.&lt;br&gt; c. In the Add a secret by resource ID form, enter the secret from the other project, in the format projects/PROJECT_NAME/locations/LOCATION/keyRings/RING_NAME/cryptoKeys/KEY_NAME. You can alternatively copy and paste the resource ID from the other project if you have access to it, by selecting the key, clicking the Actions ellipsis at the right of the secret, and selecting Copy resource ID from the pulldown menu.&lt;br&gt; d. Click Deploy.&lt;/p&gt; 
&lt;p&gt;6. Click Create or Deploy.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using customer managed encryption keys" url="https://cloud.google.com/run/docs/securing/using-cmek"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Viewing security settings&lt;/p&gt;

	&lt;p&gt;To view the current security settings for your service:&lt;/p&gt;

	&lt;p&gt;1. Go to Cloud Run&lt;/p&gt;

	&lt;p&gt;2. Click the service you are interested in to open the Service details page.&lt;/p&gt;

	&lt;p&gt;3. Click the Revisions tab.&lt;/p&gt;

	&lt;p&gt;4. In the details panel at the right, the security setting is listed under the Security tab.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.901">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN6" name="Restrict ingress for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Restrict ingress for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; At a network level, by default, any resource on the internet is able to reach your Cloud Run service on its run.app URL or at a custom domain set up in Cloud Run. You can change this default by specifying a different setting for ingress.&lt;br&gt; Note that you can use this feature along with IAM authentication methods to manage access to a service.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Available ingress settings&lt;/p&gt; 
&lt;p&gt;The following settings are available:&lt;br&gt; All - Makes your service reachable from the internet. The IAM invoker permission is still enforced.&lt;/p&gt; 
&lt;p&gt;Internal - Only requests originating from a VPC network, Pub/Sub, Eventarc, or Workflows within the same project or VPC Service Controls perimeter are allowed to reach your service. The IAM invoker permission is still enforced.&lt;br&gt; There is no support for multi-tenancy, that is, multiple trust domains within the same project.&lt;/p&gt; 
&lt;p&gt;Internal and Cloud Load Balancing - Only accepts internal requests and requests coming through HTTP Load Balancing. The IAM invoker permission is still enforced.&lt;br&gt; If you use Identity-Aware Proxy, Google Cloud Armor, or Cloud CDN, this also prevents any bypassing of these by accessing the default URL.&lt;/p&gt; 
&lt;p&gt;Setting ingress&lt;/p&gt; 
&lt;p&gt;You can set ingress using any of the supported methods in the tabs below:&lt;/p&gt; 
&lt;p&gt;If deploying a new service:&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service and configure the first step (Service settings) as desired, then click Next&lt;/p&gt; 
&lt;p&gt;3. Configure the second step (Configuring the service's first revision) as desired, then click Next.&lt;/p&gt; 
&lt;p&gt;4. In the third step, Configure how this service is triggered, under the Ingress* label, select the ingress traffic you want to allow.&lt;/p&gt; 
&lt;p&gt;If you are configuring an existing service:&lt;/p&gt; 
&lt;p&gt;1. Click on the service.&lt;/p&gt; 
&lt;p&gt;2. Click the Triggers tab.&lt;/p&gt; 
&lt;p&gt;3. Under the Ingress label, select the ingress traffic you want to allow.&lt;/p&gt; 
&lt;p&gt;4. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Restricting ingress for Cloud Run" url="https://cloud.google.com/run/docs/securing/ingress"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that ingress for Cloud Run is restricted  according to your needs.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.902">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN4" name="Use Google Cloud Armor with Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Google Cloud Armor with Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Google Cloud Armor helps you protect your Google Cloud deployments from multiple types of threats, including distributed denial-of-service (DDoS) attacks and application attacks like cross-site scripting (XSS) and SQL injection (SQLi). Google Cloud Armor features some automatic protections and some that you need to configure manually&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Google Cloud Armor with Google Kubernetes Engine (GKE) Ingress&lt;/p&gt; 
&lt;p&gt;After you configure a Google Cloud Armor security policy, you can use Kubernetes Ingress to enable it with GKE.&lt;/p&gt; 
&lt;p&gt;You can reference your security policy with a BackendConfig resource by adding the name of your security policy to the BackendConfig. The following BackendConfig manifest specifies a security policy named example-security-policy:&lt;/p&gt; 
&lt;p&gt;apiVersion: cloud.google.com/v1&lt;br&gt; kind: BackendConfig&lt;br&gt; metadata: namespace: cloud-armor-how-to name: my-backendconfig&lt;br&gt; spec: securityPolicy: name: "example-security-policy"&lt;/p&gt; 
&lt;p&gt;For more information, please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Integrating Google Cloud Armor with other Google products" url="https://cloud.google.com/armor/docs/integrating-cloud-armor"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that you are protecting Cloud Run with Google Cloud Armor.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.902">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN7" name="Use VPC Service Controls for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use VPC Service Controls for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; VPC Service Controls improves your ability to mitigate the risk of data exfiltration from Google Cloud services. You can use VPC Service Controls to create perimeters that protect the resources and data of services that you explicitly specify.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Setting up your organization to support VPC Service Controls&lt;/p&gt; 
&lt;p&gt;To use VPC Service Controls with Cloud Run, you must configure a service perimeter at the organization level. This setup ensures that VPC Service Controls checks are enforced when using Cloud Run and that developers can only deploy services that comply with VPC Service Controls.&lt;/p&gt; 
&lt;p&gt;Setting up a VPC Service Controls perimeter&lt;/p&gt; 
&lt;p&gt;The following steps show how to set up a VPC Service Controls perimeter.&lt;/p&gt; 
&lt;p&gt;1. Ensure that you have the required roles for administering VPC Service Controls.&lt;/p&gt; 
&lt;p&gt;2. In the Google Cloud Console, go to the VPC Service Controls page.&lt;/p&gt; 
&lt;p&gt;3. If you are prompted, select your Organization.&lt;/p&gt; 
&lt;p&gt;4. Click New Perimeter. Type a name for the perimeter.&lt;/p&gt; 
&lt;p&gt;5. Select the projects that you want to secure within the perimeter.&lt;/p&gt; 
&lt;p&gt;a. Click Projects.&lt;/p&gt; 
&lt;p&gt;b. In the Add Projects window, select the projects you want to add.&lt;br&gt; If you are using Shared VPC, make sure to add the host project and service projects.&lt;/p&gt; 
&lt;p&gt;c. Click the Add Projects button.&lt;/p&gt; 
&lt;p&gt;6. Select Cloud Run as the service that you want to secure within the perimeter.&lt;/p&gt; 
&lt;p&gt;a. Click Restricted Services.&lt;/p&gt; 
&lt;p&gt;b. Click Add Services.&lt;/p&gt; 
&lt;p&gt;c. Search for "Cloud Run." Then select Cloud Run API.&lt;/p&gt; 
&lt;p&gt;d. Click Add Cloud Run API.&lt;/p&gt; 
&lt;p&gt;7. Enable access for developers.&lt;/p&gt; 
&lt;p&gt;Turning on VPC Service Controls for Cloud Run prevents all access from outside the perimeter, including viewing and deploying services from machines not in the perimeter, such as company laptops. In order for developers and application operators to view and deploy resources within the perimeter, you must configure the perimeter ingress policy:&lt;/p&gt; 
&lt;p&gt;a. Click Ingress Policy.&lt;/p&gt; 
&lt;p&gt;b. Specify the Source, Identity, Project, and Services.&lt;/p&gt; 
&lt;p&gt;c. Click Add Rule.&lt;/p&gt; 
&lt;p&gt;If your organization uses Access Context Manager, you can also enable access for developers by setting access levels.&lt;/p&gt; 
&lt;p&gt;8. Click Create Perimeter.&lt;/p&gt; 
&lt;p&gt;Once you have completed these steps, all calls to the Cloud Run Admin API will be checked to ensure that they originate from within the same perimeter.&lt;/p&gt; 
&lt;p&gt;For more information please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using VPC Service Controls (VPC SC)" url="https://cloud.google.com/run/docs/securing/using-vpc-service-controls"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Auditing existing services for VPC Service Controls compliance&lt;/p&gt;

	&lt;p&gt;After setting up VPC Service Controls, new services created in projects within the service perimeter are automatically checked for compliance. However, to avoid disruption of existing workloads, existing services continue to work and might not comply with organization policies.&lt;/p&gt;

	&lt;p&gt;Google recommends that you periodically audit your services to make sure your ingress and egress settings conform with the requirements, and update or redeploy services as necessary. For example, you could create a script that uses the Cloud Run Admin API to list your services and highlight those that do not specify the proper network settings.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.902">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE_IAM-02">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A1-2017" name="Attackers gain access to the sensitive data through injecting code in the repositories" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Almost any source of data can be an injection vector: environment variables, parameters, external and internal web services, and all types of users. Injection flaws occur when an attacker can send hostile data to an interpreter.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-937">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN2" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN2" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="GOOGLE-DOS" name="Attackers perform a denial of service" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A Denial of Service (DoS) attack is a deliberate attempt to make your website unavailable. Attackers use a variety of techniques that consume large amount of resources.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="SYSTEM-VUL-DOS">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN4" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN4" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to data storage" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A data breach is a security violation in which sensitive, protected or confidential data is copied, transmitted, viewed, stolen or used by an individual unauthorized to do so. Sensitive data could be exposed due to a bad configuration in user permissions.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN3" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN3" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A10-2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN5" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN5" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NET-01">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN6" mitigation="50"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN7" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN6" mitigation="50"/>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN7" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="71b2cc30-2636-4c7f-b88c-041fa29d94e2" diagramComponentId="c46a7c3a-9360-442d-8293-97faaad01d5d" ref="45afc835-9418-4a86-a27d-95d1b5154a3c" name="CI/CD Layer Cloud Build - Serverless CI/CD" desc="" library="Google Cloud Platform" parentComponentRef="e584374a-206f-43f5-a0ef-ace77965ea87" componentDefinitionRef="CD-GOOGLE-CLOUD-BUILD">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-937" name="Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" state="0" impact="100" issueId="" issueLink="">
          <desc>In theory, it ought to be easy to figure out if you are currently using any vulnerable
                        components or libraries. Unfortunately, vulnerability reports for commercial or open source
                        software do not always specify exactly which versions of a component are vulnerable in a
                        standard, searchable way. Further, not all libraries use an understandable version numbering
                        system. Worst of all, not all vulnerabilities are reported to a central clearing house that is
                        easy to search, although sites like CVE and NVD are becoming easier to search.

                        Determining if you are vulnerable requires searching these databases, as well as keeping abreast
                        of project mailing lists and announcements for anything that might be a vulnerability. If one of
                        your components does have a vulnerability, you should carefully evaluate whether you are
                        actually vulnerable by checking to see if your code uses the part of the component with the
                        vulnerability and whether the flaw could result in an impact you care about.

                        Component vulnerabilities can cause almost any type of risk imaginable, ranging from the trivial
                        to sophisticated malware designed to target a specific organization. Components almost always
                        run with the full privilege of the application, so flaws in any component can be serious.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.026">
              <output/>
            </source>
            <references>
              <reference name="CWE-937: Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" url="https://cwe.mitre.org/data/definitions/937.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-USECURE-CREDENTIALS" name="Credentials are not securely stored" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials that are used to access the resources are not securely stored and can be
                        accessed by unauthorized personnel.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE_IAM-02" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials for the groups and roles are incorrectly configured and there are user accounts with more privileges than necessary.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.025">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NON-IDENTIFY" name="Non-identify the resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources are not registered in the safety net systems, and there are more unidentified resources. This can be a problem because these unidentified resources can have unknown weaknesses.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="SYSTEM-VUL-DOS" name="System is vulnerable to a denial of service attack" state="0" impact="100" issueId="" issueLink="">
          <desc>Attackers can perform a successful denial of service on the system</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to open ports is most likely an attack. To avoid this, access to the network must be as restricted as possible, so that only the necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:09.026">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD1" name="Control access to Cloud Build resources" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control access to Cloud Build resources&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, only the creator of a Google Cloud project has access to the project and its resources. To grant other users access, you can grant Identity and Access Management (IAM) roles on the project, or on a specific Cloud Build resource.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Granting roles on the project&lt;/p&gt; 
&lt;p&gt;1. Open the IAM page in the Cloud console.&lt;/p&gt; 
&lt;p&gt;2. Select your project, and click Continue.&lt;/p&gt; 
&lt;p&gt;3. Click Add.&lt;/p&gt; 
&lt;p&gt;4. Enter the user's or service account's email address.&lt;/p&gt; 
&lt;p&gt;5. Select the desired role from the drop-down menu. Cloud Build roles are under Cloud Build.&lt;/p&gt; 
&lt;p&gt;6. Click Save.&lt;/p&gt; 
&lt;p&gt;Note: If you do not see the Cloud Build roles in the drop-down menu, you may need to enable the Cloud Build API.&lt;/p&gt; 
&lt;p&gt;Granting permissions to run gcloud commands&lt;/p&gt; 
&lt;p&gt;To run gcloud builds commands, users with only cloudbuild.builds.viewer or cloudbuild.builds.editor roles also require the serviceusage.services.use permission. To give this permission to the user, grant them the serviceusage.serviceUsageConsumer role.&lt;/p&gt; 
&lt;p&gt;User with roles/editor and roles/owner roles can run gcloud builds commands without the additional serviceusage.services.use permission.&lt;/p&gt; 
&lt;p&gt;Revoking roles on the project&lt;/p&gt; 
&lt;p&gt;1. Open the IAM page in the Cloud console.&lt;/p&gt; 
&lt;p&gt;2. Select your project, and click Continue.&lt;/p&gt; 
&lt;p&gt;3. In the permissions table, locate the email ID of the principal and click on the pencil icon.&lt;/p&gt; 
&lt;p&gt;4. Delete the role that you want to revoke.&lt;/p&gt; 
&lt;p&gt;5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configuring access to Cloud Build resources" url="https://cloud.google.com/build/docs/securing-builds/configure-access-to-resources"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Testing permissions&lt;/p&gt;

	&lt;p&gt;Most Google Cloud resources expose the testIamPermissions() method, which allows you to programmatically check whether the currently authenticated caller has been granted one or more specific IAM permissions on the resource. The testIamPermissions() method takes a resource identifier and a set of permissions as input parameters, and returns the set of permissions that the caller is allowed.&lt;/p&gt;

	&lt;p&gt;You can use the testIamPermissions() method to determine whether a user should have access to an administrative tool in a web application. For example, you can use this method to decide, based on the user's permissions, whether to display detailed information about a Google Cloud resource.&lt;/p&gt;

	&lt;p&gt;Note: If you need to test a permission so that you can troubleshoot access to a resource, use the Policy Troubleshooter instead.&lt;/p&gt;

	&lt;p&gt;For example, to determine if the currently authenticated user has the permission to delete a project, call the projects.testIamPermissions() method by providing the project ID (such as foo-project) and the resourcemanager.projects.delete permission as input parameters. If the caller has been granted the resourcemanager.projects.delete permission, it will be listed in the response body. If the caller does not have this permission, the response body will list no permissions.&lt;/p&gt;

	&lt;p&gt;The testIamPermissions() method is intended for third-party graphical user interfaces (GUIs) that need to display Google Cloud resources based on what the authenticated user has permissions to see. For example, the Cloud Console internally uses the testIamPermissions() method to determine what resources and functionality are visible to you after authenticating. Different users are typically granted different permissions, and the Cloud Console hides or exposes items accordingly.&lt;/p&gt;

	&lt;p&gt;How to test permissions&lt;/p&gt;

	&lt;p&gt;This example shows how to test the resourcemanager.projects.get and resourcemanager.projects.delete permissions for a Google Cloud project. To test permissions for other Google Cloud resources, use the testIamPermissions() method exposed by each resource. For example, you can test the IAM permissions for a Cloud Storage bucket.&lt;/p&gt;

	&lt;p&gt;In this example, the user has an IAM role that allows them to get information about a project, but not to delete projects.&lt;/p&gt;

	&lt;p&gt;The Resource Manager API's projects.testIamPermissions method accepts a list of permissions and tests which of the permissions a member has.&lt;/p&gt;

	&lt;p&gt;Before using any of the request data below, make the following replacements:&lt;/p&gt;

	&lt;p&gt;project-id: Your Google Cloud project ID.&lt;br /&gt;
HTTP method and URL:&lt;/p&gt;

	&lt;p&gt;POST https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;Request JSON body:&lt;/p&gt;

	&lt;p&gt;{
  "permissions":  [
    "resourcemanager.projects.get",
    "resourcemanager.projects.delete"
  ]&lt;br /&gt;
}&lt;/p&gt;

	&lt;p&gt;Note: Ensure you have set the GOOGLE_APPLICATION_CREDENTIALS environment variable to your service account private key file path.&lt;br /&gt;
Save the request body in a file called request.json, and execute the following command:&lt;/p&gt;

	&lt;p&gt;curl -X POST \&lt;br /&gt;
-H "Authorization: Bearer "$(gcloud auth application-default print-access-token) \&lt;br /&gt;
-H "Content-Type: application/json; charset=utf-8" \&lt;br /&gt;
-d @request.json \&lt;br /&gt;
https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;You should receive a JSON response similar to the following:&lt;/p&gt;

	&lt;p&gt;{
  "permissions": [
    "resourcemanager.projects.get"
  ]&lt;br /&gt;
}&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.973">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD3" name="Control Cloud Build deployments with Binary Authorization" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control Cloud Build deployments with Binary Authorization&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Binary Authorization is a service on Google Cloud that provides software supply-chain security for container-based applications. It enables you to configure a policy that the service enforces when an attempt is made to deploy a container image on one of the supported container-based platforms. This service aims to reduce the risk of deploying defective, vulnerable, or unauthorized software in this type of environment. Using this service, you can prevent images from being deployed unless it satisfies a policy you define.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Control deployments with Binary Authorization&lt;/p&gt; 
&lt;p&gt;A policy in Binary Authorization is a set of rules that govern the deployment of images. You can configure a rule to require digitally signed attestations.&lt;/p&gt; 
&lt;p&gt;Cloud Build generates and signs attestations at build time. With Binary Authorization you can use the built-by-cloud-build attestor to verify the attestations and only deploy images built by Cloud Build.&lt;/p&gt; 
&lt;p&gt;To create the built-by-cloud-build attestor in your project, run a build in that project.&lt;/p&gt; 
&lt;p&gt;To allow only images built by Cloud Build to be deployed, perform the following steps:&lt;/p&gt; 
&lt;p&gt;1. Go to the Binary Authorization page in the Google Cloud console.&lt;/p&gt; 
&lt;p&gt;2. In the Policy tab, click Edit Policy.&lt;/p&gt; 
&lt;p&gt;3. In the Edit Policy dialog, select Allow only images that have been approved by all of the following attestors.&lt;/p&gt; 
&lt;p&gt;4. Click Add Attestors.&lt;/p&gt; 
&lt;p&gt;5. In the Add attestors dialog box, do the following:&lt;/p&gt; 
&lt;p&gt;a. Select Add by project and attestor name and perform the following steps:&lt;br&gt; i. In the Project name field, enter the project where you run Cloud Build.&lt;br&gt; ii. Click the Attestor name field and note that the built-by-cloud-build attestor is available.&lt;br&gt; iii. Click built-by-cloud-build.&lt;/p&gt; 
&lt;p&gt;b. Alternatively, select Add by attestor resource ID. In Attestor resource ID, enter&lt;/p&gt; 
&lt;p&gt;projects/PROJECT_ID/attestors/built-by-cloud-build&lt;br&gt; Replacing PROJECT_ID with the project where you run Cloud Build.&lt;/p&gt; 
&lt;p&gt;6. Click Add 1 attestor.&lt;/p&gt; 
&lt;p&gt;7. Click Save Policy.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using Binary Authorization to control image deployment" url="https://cloud.google.com/build/docs/securing-builds/use-binary-authorization"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that Binary Authorization for Cloud Build deployments is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.973">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD5" name="Limit builds triggered from external services" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Limit builds triggered from external services&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Cloud Build enables you to define an organization policy (constraints/cloudbuild.allowedIntegrations) to control which external services can invoke build triggers. For example, if your trigger listens for changes to a GitHub repository and GitHub is denied in the organization policy, your trigger will not run. You can specify any number of allowed or denied values for your organization or project.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Setting up organization policy for allowed integrations&lt;/p&gt; 
&lt;p&gt;This section explains how you can set up the organization policy (constraints/cloudbuild.allowedIntegrations) to define builds for allowed integrations.&lt;/p&gt; 
&lt;p&gt;1. Open the Organization policies page in the Google Cloud console.&lt;/p&gt; 
&lt;p&gt;2. Click on the row containing the Allowed Integrations (Cloud Build) policy.&lt;/p&gt; 
&lt;p&gt;You will see the Policy details page.&lt;/p&gt; 
&lt;p&gt;3. To edit the policy, click Edit.&lt;/p&gt; 
&lt;p&gt;You will see the Edit policy page.&lt;/p&gt; 
&lt;p&gt;4. In the Applies to section, select Customize to set the definition for your policy.&lt;/p&gt; 
&lt;p&gt;5. In the Policy enforcement section, select Replace to define your own rules for the policy. Otherwise, select Merge with parent to ensure that rules at the parent resource are applied to your settings. To learn more, see Understanding hierarchy evaluation.&lt;/p&gt; 
&lt;p&gt;6. In the Rules section, click Add rule to add a new rule for your policy.&lt;/p&gt; 
&lt;p&gt;7. Under Policy values, select Allow all to allow builds from all services, select Deny all to deny builds from all services, or select Custom to allow or deny builds from specific services.&lt;/p&gt; 
&lt;p&gt;If you select Custom as your value, complete the following steps:&lt;/p&gt; 
&lt;p&gt;a. In the Policy type section, select Allow or Deny.&lt;/p&gt; 
&lt;p&gt;b. In the Custom values section, enter the host URL of the instance or repository you want to allow or deny builds from. For example, to allow or deny builds from GitHub, enter your URL as github.com or www.github.com.&lt;/p&gt; 
&lt;p&gt;You can also enter multiple URLs separated by a space. For example, github.com ghe.staging-test.com.&lt;/p&gt; 
&lt;p&gt;Based on the event, the host URL you specify is one of the following:&lt;/p&gt; 
&lt;p&gt;- RepoSync event: The host is source.developers.google.com.&lt;br&gt; - GitHub app event: The host is derived from the repository.html_url field in your JSON payload, which is always github.com.&lt;br&gt; - GitHub Enterprise event: The host is derived from the repository.html_url field in your JSON payload. For example, ghe.staging-test.com.&lt;br&gt; - Pub/Sub event: The host is derived from the source specified in your trigger. If there is no source specified in your trigger, there is no organization policy check.&lt;br&gt; - Webhook event: The host is derived from the source specified in your trigger. If there is no source specified in your trigger, there is organization policy check.&lt;/p&gt; 
&lt;p&gt;Note: You can enter any characters in the Custom values section except colons (:) and forward slashes (/).&lt;/p&gt; 
&lt;p&gt;8. To save your rule, click Done.&lt;/p&gt; 
&lt;p&gt;9. To add another rule, click Add rule. Otherwise, to save your policy, click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Limiting builds triggered from external services" url="https://cloud.google.com/build/docs/securing-builds/limit-builds-external-services"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Testing organization policy for allowed integrations&lt;/p&gt;

	&lt;p&gt;This section explains how you can test your organization policy (constraints/cloudbuild.allowedIntegrations) using build triggers.&lt;/p&gt;

	&lt;p&gt;1. If you have not already done so, create a build trigger.&lt;/p&gt;

	&lt;p&gt;2. Push a change to your source.&lt;/p&gt;

	&lt;p&gt;3. If your policy is set up to allow builds from your source, you will be able to view build executions from your trigger on the Build history page. Otherwise, your build will not execute. To view history for builds restricted by your policy definition, see the Logs Explorer page for the JSON payload reason and the reason for denial.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.974">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD2" name="Require that your Cloud Build images have associated provenance metadata" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Require that your Cloud Build images have associated provenance metadata&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Build provenance is a collection of verifiable data about a build run by Cloud Build. Provenance metadata includes details such as the digests of the built images, the input source locations, the build arguments, and the build duration.&lt;br&gt; By default, if Cloud Build does not generate provenance metadata, the build is still completed successfully. Overwrite this behavior and fail builds if Cloud Build does not generate provenance metadata for your image.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Add the requestedVerifyOption: VERIFIED option to your build configuration file.&lt;/p&gt; 
&lt;p&gt;steps:&lt;br&gt; - name: 'gcr.io/cloud-builders/docker' args: [ 'build', '-t', 'us-central1-docker.pkg.dev/$PROJECT_ID/quickstart-docker-repo/quickstart-image:tag1', '.' ]&lt;br&gt; images:&lt;br&gt; - 'us-central1-docker.pkg.dev/$PROJECT_ID/quickstart-docker-repo/quickstart-image:tag1'&lt;br&gt; options: requestedVerifyOption: VERIFIED&lt;/p&gt; 
&lt;p&gt;After adding the requestedVerifyOption, Cloud Build only marks the build as successful if it can generate the corresponding provenance metadata. This also affects images built in a private pool, enabling provenance metadata and attestation generation for those images.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Viewing build provenance" url="https://cloud.google.com/build/docs/securing-builds/view-build-provenance"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that Cloud Build generates provenance metadata.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.973">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD7" name="Use private pools for Cloud Build" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>	&lt;p&gt;Use private pools for Cloud Build&lt;/p&gt;

	&lt;p&gt;Rationale:&lt;br /&gt;
Private pools are private, dedicated pools of workers that offer greater customization over the build environment, including the ability to access resources in a private network (which the default pools do not have as a feature). Private pools, similar to default pools, are hosted and fully-managed by Cloud Build and scale up and down to zero, with no infrastructure to set up, upgrade, or scale. Because private pools are customer-specific resources, you can configure them in more ways.&lt;/p&gt;

	&lt;p&gt;Remediation:&lt;br /&gt;
Before you begin&lt;/p&gt;

	&lt;p&gt;1. Create a new Cloud project or choose an existing project. You'll use this project to create the private pool.&lt;/p&gt;

	&lt;p&gt;2. Enable the Cloud Build API.&lt;/p&gt;

	&lt;p&gt;3. To use the command-line examples in this guide, install and configure the Google Cloud CLI.&lt;/p&gt;

	&lt;p&gt;Note: If you've installed gcloud CLI previously, make sure you have the latest available version by running gcloud components update.&lt;/p&gt;

	&lt;p&gt;4. [Optional] For builds to access private resources from your Virtual Private Cloud network, you must set up a peering connection between your Virtual Private Cloud network and the Virtual Private Cloud network where private pools reside. For instructions, see set up your environment to create private pools.&lt;/p&gt;

	&lt;p&gt;Creating a new private pool&lt;/p&gt;

	&lt;p&gt;IAM permissions: You require Cloud Build WorkerPool Owner role to perform this task. For instructions on granting this role, see Configure access to Cloud Build resources.&lt;/p&gt;

	&lt;p&gt;You can create up to 10 private pools per Cloud project per region. To create a new private pool:&lt;/p&gt;

	&lt;p&gt;1. Open the Worker Pool page in the Google Cloud console.&lt;/p&gt;

	&lt;p&gt;2. Select the project where you want to create the private pool.&lt;/p&gt;

	&lt;p&gt;3. In the Worker pool page, click Create.&lt;/p&gt;

	&lt;p&gt;4. In the Create private pool side panel:&lt;/p&gt;

	&lt;p&gt;a. Enter a name for your private pool. This value should be 1-63 characters, and valid characters are /[a-z][0-9]-/.&lt;/p&gt;

	&lt;p&gt;b. Select the region in which you want the private pool to be created.&lt;/p&gt;

	&lt;p&gt;c. Select the Compute Engine machine type you want to use for your private pool.&lt;/p&gt;

	&lt;p&gt;d. Enter a disk size for your private pool. Specify a value greater than or equal to 100 and less than or equal to 1000. If not provided, Cloud Build uses a disk size of 100.&lt;/p&gt;

	&lt;p&gt;e. Enter the project number of the Cloud project where your Virtual Private Cloud network is located. If you leave this field blank, your private pool uses the service producer network.&lt;/p&gt;

	&lt;p&gt;f. Enter the name of your VPC network. If you leave this field blank, your private pool uses the service producer network. For information on the available network configuration options and implications, see Setting up your environment.&lt;/p&gt;

	&lt;p&gt;g. Assign external IPs is selected by default. Selecting this option allows private pool to access the public internet.&lt;/p&gt;

	&lt;p&gt;h. Click Create.&lt;/p&gt;

	&lt;p&gt;For more information, please see Reference URL.&lt;/p&gt;

	&lt;p&gt;Impact:&lt;br /&gt;
None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Creating and managing private pools" url="https://cloud.google.com/build/docs/private-pools/create-manage-private-pools"/>
            <reference name="Private pools overview" url="https://cloud.google.com/build/docs/private-pools/private-pools-overview"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;To view the details of a private pool:&lt;/p&gt;

	&lt;p&gt;1. Open the Worker pool page in the Cloud console.&lt;/p&gt;

	&lt;p&gt;2. Select the project in which you created the private pool&lt;/p&gt;

	&lt;p&gt;3. Click on the private pool name.&lt;/p&gt;

	&lt;p&gt;The Edit private pool side panel is displayed, which has the details of the private pool.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.974">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD4" name="Use secrets from Secret Manager for Cloud Build" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use secrets from Secret Manager for Cloud Build&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Secret Manager is a Google Cloud service that securely stores API keys, passwords, and other sensitive data. To include sensitive information in your builds, you can store the information in Secret Manager and then configure your build to access the information from Secret Manager.&lt;/p&gt; 
&lt;p&gt;Note: Secret Manager is the recommended technique for managing sensitive data with Cloud Build. For existing projects, you can continue using Cloud KMS, but for new projects, use Secret Manager.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Configuring builds to access UTF-8 secrets from Secret Manager&lt;/p&gt; 
&lt;p&gt;1. In your project root directory, create a Cloud Build config file named cloudbuild.yaml or cloudbuild.json.&lt;/p&gt; 
&lt;p&gt;2. In the build config file:&lt;/p&gt; 
&lt;p&gt;- After all the build steps, add an availableSecrets field to specify the secret version and environment variables to use for your secret. You can include substitution variables in the value of the secretVersion field. You can specify more than one secret in a build.&lt;br&gt; - In the build step where you want to specify the secret:&lt;br&gt; a. Add an entrypoint field pointing to bash to use the bash tool in the build step. This is required to refer to the environment variable for the secret.&lt;br&gt; b. Add a secretEnv field specifying the environment variable.&lt;br&gt; c. In the args field, add a -c flag as the first argument. Any string you pass after -c is treated as a command. For more information on running bash commands with -c, see the bash documentation.&lt;br&gt; d. When specifying the secret in the args field, specify it using the environment variable prefixed with $$.&lt;/p&gt; 
&lt;p&gt;Note: You can refer to secrets only in the args field of a build step.&lt;/p&gt; 
&lt;p&gt;Configuring builds to access non-UTF-8 secrets from Secret Manager&lt;/p&gt; 
&lt;p&gt;1. In your build config file, add a build step to access the secret version in Secret Manager and store it in a file. The following build step accesses secret-name and stores it in a file named decrypted-data.txt:&lt;/p&gt; 
&lt;p&gt;YAML&lt;br&gt; steps:&lt;br&gt; - name: gcr.io/cloud-builders/gcloud entrypoint: 'bash' args: [ 'c', "gcloud secrets versions access latest -secret=secret-name -format='get(payload.data)' | tr '_' '/+' | base64 -d &amp;gt; decrypted-data.txt" ]&lt;/p&gt; 
&lt;p&gt;2. Use the file with the decrypted data in a build step. The following code snippet uses decrypted-data.txt to login to a private Docker registry:&lt;/p&gt; 
&lt;p&gt;YAML&lt;br&gt; steps:&lt;br&gt; - name: gcr.io/cloud-builders/gcloud entrypoint: 'bash' args: [ 'c', "gcloud secrets versions access latest -secret=secret-name -format='get(payload.data)' | tr '_' '/+' | base64 -d &amp;gt; decrypted-data.txt" ]&lt;br&gt; - name: gcr.io/cloud-builders/docker entrypoint: 'bash' args: [ '-c', 'docker login -username=my-user -password-stdin &amp;lt; decrypted-data.txt']&lt;/p&gt; 
&lt;p&gt;Note: To use the secret in an environment variable, you must prefix the variable name with an underscore "_" and escape the value using '\('. For example: _VARIABLE_NAME=$(cat password.txt) &amp;amp;&amp;amp; echo -n \)_VARIABLE_NAME.&lt;/p&gt; 
&lt;p&gt;3. Use the build config file to start a build using the command line or to automate builds using triggers.&lt;/p&gt; 
&lt;p&gt;For more information and examples, please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using secrets from Secret Manager" url="https://cloud.google.com/build/docs/securing-builds/use-secrets"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that your builds are configured to access information from Secrets Manager.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.973">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-BUILD6" name="Use VPC Service Controls with Cloud Build" issueId="" issueLink="" platform="" cost="1" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>	&lt;p&gt;Use VPC Service Controls with Cloud Build&lt;/p&gt;

	&lt;p&gt;Rationale:&lt;br /&gt;
VPC Service Controls is a Google Cloud feature that allows you to set up a secure perimeter to guard against data exfiltration.&lt;br /&gt;
Note: VPC Service Controls protection is available only for builds run in private pools; you cannot use VPC Service Controls with builds run in default pools.&lt;/p&gt;

	&lt;p&gt;Remediation:&lt;br /&gt;
Set up a VPC Service Controls perimeter&lt;/p&gt;

	&lt;p&gt;Following the steps below, you specify the perimeter details, add projects and services to protect, and create the perimeter.&lt;/p&gt;

	&lt;p&gt;Add the VPC Service Controls perimeter details&lt;/p&gt;

	&lt;p&gt;1. In the Google Cloud console, go to the VPC Service Controls page.&lt;/p&gt;

	&lt;p&gt;2. To create a new perimeter by using the default access policy, select your organization from the project selector menu.&lt;/p&gt;

	&lt;p&gt;3. On the VPC Service Controls page, click New Perimeter.&lt;/p&gt;

	&lt;p&gt;4. On the New VPC Service Perimeter page, in the Perimeter Name box, type perimeter_storage_services.&lt;/p&gt;

	&lt;p&gt;5. In Perimeter Type and Config Type sections, retain the default settings.&lt;/p&gt;


	&lt;p&gt;Add projects to the perimeter&lt;/p&gt;

	&lt;p&gt;1. To add projects to the perimeter, from the New VPC Service Perimeter navigation menu, click Projects.&lt;/p&gt;

	&lt;p&gt;2. Click Add Projects.&lt;/p&gt;

	&lt;p&gt;3. In the Add Projects dialog, select the projects that you want to add to the perimeter and then click Add Projects.&lt;/p&gt;

	&lt;p&gt;4. Click Done.&lt;/p&gt;

	&lt;p&gt;Warning: If you add a project to this perimeter, the Google Cloud resources in the project cannot communicate across the perimeter.&lt;/p&gt;


	&lt;p&gt;Restrict the Cloud Build API&lt;/p&gt;

	&lt;p&gt;1. From the New VPC Service Perimeter navigation menu, click Restricted services.&lt;/p&gt;

	&lt;p&gt;2. Click Add Services.&lt;br /&gt;
In the Specify services to restrict dialog, select the checkboxes of the BigQuery and Cloud Storage APIs.&lt;/p&gt;

	&lt;p&gt;To locate the services, you can use the filter query.&lt;/p&gt;

	&lt;p&gt;4. Click Add 1 Service.&lt;/p&gt;

	&lt;p&gt;5. To create the perimeter, from the New VPC Service Perimeter navigation menu, click Create perimeter.&lt;/p&gt;

	&lt;p&gt;After setting up your service perimeter, all calls to the Cloud Build API are checked to ensure that the calls originate from within the same perimeter.&lt;/p&gt;

	&lt;p&gt;For more information please see Reference URLs.&lt;/p&gt;

	&lt;p&gt;Impact:&lt;br /&gt;
When the changes have propagated, access to the services is limited to the projects you added to the perimeter.&lt;br /&gt;
Additionally, the Cloud console interface for the services that you protected with the perimeter might become partially or fully inaccessible.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Set up a service perimeter by using VPC Service Controls" url="https://cloud.google.com/vpc-service-controls/docs/set-up-service-perimeter"/>
            <reference name="Using VPC Service Controls" url="https://cloud.google.com/build/docs/private-pools/using-vpc-service-controls"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;You can see your perimeter listed on the VPC Service Controls page. The perimeter might take up to 30 minutes to propagate and take effect.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.974">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE_IAM-02">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A1-2017" name="Attackers gain access to the sensitive data through injecting code in the repositories" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Almost any source of data can be an injection vector: environment variables, parameters, external and internal web services, and all types of users. Injection flaws occur when an attacker can send hostile data to an interpreter.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-937">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD2" mitigation="50"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD3" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD2" mitigation="50"/>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD3" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="GOOGLE-DOS" name="Attackers perform a denial of service" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A Denial of Service (DoS) attack is a deliberate attempt to make your website unavailable. Attackers use a variety of techniques that consume large amount of resources.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="SYSTEM-VUL-DOS">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD5" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD5" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to data storage" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A data breach is a security violation in which sensitive, protected or confidential data is copied, transmitted, viewed, stolen or used by an individual unauthorized to do so. Sensitive data could be exposed due to a bad configuration in user permissions.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-USECURE-CREDENTIALS">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD4" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD4" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NET-01">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD7" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-NON-IDENTIFY">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-BUILD6" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD6" mitigation="50"/>
                <countermeasure ref="C-GOOGLE-CLOUD-BUILD7" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="0f19819c-d3a8-45b0-91f8-0e701e73855a" diagramComponentId="ab2349f2-a9e3-4751-b6dc-6ba40ed84b42" ref="3d864622-5588-4925-a2cd-ac0e382b8bf5" name="GCP VPC (Virtual Private Cloud)" desc="" library="Google Cloud Platform" parentComponentRef="9bc60ced-7bf6-4279-8744-cd4c4c818097" componentDefinitionRef="CD-GOOGLE-CLOUD-VPC">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.716">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NON-IDENTIFY" name="Non-identify the resources" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources are not registered in the safety net systems, and there are more unidentified resources. This can be a problem because these unidentified resources can have unknown weaknesses.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.715">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to open ports is most likely an attack. To avoid this, access to the network must be as restricted as possible, so that only the necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.716">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC9" name="Configure network tags for all resources" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Configure network tags for all resources&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; A tag is simply a character string added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. A tag is not a separate resource, so you cannot create it separately. All resources with that string are considered to have that tag. Tags enable you to make firewall rules and routes applicable to specific VM instances.&lt;br&gt; You can assign network tags to new VMs at creation time, or you can edit the set of assigned tags at any time later. You can edit network tags without stopping a VM.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Adding tags when creating a VM&lt;/p&gt; 
&lt;p&gt;1. Go to the VM instances page.&lt;br&gt; 2. Click Create instance.&lt;br&gt; 3. Click Management, security, disks, networking, sole tenancy to open that section.&lt;br&gt; 4. Click the Networking tab.&lt;br&gt; 5. In the Network tags field, specify one or more tags, separated by commas.&lt;br&gt; 6. Populate other fields for the VM.&lt;br&gt; 7. Click Create.&lt;/p&gt; 
&lt;p&gt;Adding tags to an existing VM&lt;/p&gt; 
&lt;p&gt;1. Go to the VM instances page.&lt;br&gt; 2. Click an instance name.&lt;br&gt; 3. On the VM instance details page, click Edit.&lt;br&gt; 4. In the Network tags section, specify one or more tags, separated by commas.&lt;br&gt; 5. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Configuring network tags" url="https://cloud.google.com/vpc/docs/add-remove-network-tags"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Viewing tags&lt;/p&gt;

	&lt;p&gt;1. Go to the VM instances page.&lt;br /&gt;
2. View tags in the Network tags column.&lt;br /&gt;
If needed, click Column display options to add the Network tags column.&lt;br /&gt;
3. To view instances that are tagged with a specific tag, in the filter, select the property Network tags and enter the tags you want to filter on.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.651">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC2" name="Enable Firewall Rules Logging" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Firewall Rules Logging&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Firewall Rules Logging lets you audit, verify, and analyze the effects of your firewall rules. For example, you can determine if a firewall rule designed to deny traffic is functioning as intended. Firewall Rules Logging is also useful if you need to determine how many connections are affected by a given firewall rule.&lt;br&gt; Google Cloud recommends as a best practice to turn on Firewall Rules Logging and use Firewall Insights to verify that firewall rules are being used in the intended way.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enabling firewall rules logging&lt;/p&gt; 
&lt;p&gt;1. Go to the Firewall page in the Google Cloud console.&lt;br&gt; 2. In the Logs column, determine if firewall logging is on or off for each firewall rule.&lt;br&gt; 3. To enable logging for one or more firewall rules, select the checkbox next to each one.&lt;br&gt; 4. In the Firewall rules action bar, click Configure logs.&lt;br&gt; 5. In the Configure logs dialog, select On.&lt;br&gt; 6. To omit the metadata fields, expand Logs details and then clear Include metadata.&lt;br&gt; 7. Click Save configuration.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Firewall Rules Logging can incur costs, so you might want to consider using it selectively.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using Firewall Rules Logging" url="https://cloud.google.com/vpc/docs/using-firewall-rules-logging"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Viewing logs&lt;/p&gt;

	&lt;p&gt;Firewall rule logs are created in the project that hosts the network containing the VM instances and firewall rules. With Shared VPC, VM instances are created in service projects, but they use a Shared VPC Network located in the host project. Firewall rules logs are stored in that host project.&lt;/p&gt;

	&lt;p&gt;Use the Logs section of the Cloud console to view firewall rule logs.&lt;/p&gt;

	&lt;p&gt;The following filters demonstrate how you can search for specific firewall events.&lt;/p&gt;

	&lt;p&gt;All firewall logs&lt;/p&gt;

	&lt;p&gt;1. Go to the Logs Explorer in the Google Cloud console.&lt;br /&gt;
2. Select Subnetwork in the first pull-down menu.&lt;br /&gt;
3. Select compute.googleapis.com/firewall in the second pull-down menu.&lt;br /&gt;
4. Click OK.&lt;/p&gt;

	&lt;p&gt;Alternatively:&lt;/p&gt;

	&lt;p&gt;1. Go to the Logs Explorer in the Google Cloud console.&lt;br /&gt;
2. In right side of the Filter by label or text search field, click the down arrow and select Convert to advanced filter.&lt;br /&gt;
3. Paste the following into the field. Replace PROJECT_ID with your project ID.&lt;/p&gt;

	&lt;p&gt;resource.type="gce_subnetwork"&lt;br /&gt;
logName="projects/PROJECT_ID/logs/compute.googleapis.com%2Ffirewall" &lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.650">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC4" name="Ensure legacy networks do not exist for older projects" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;In order to prevent use of legacy networks, a project should not have a legacy network configured. As of now, Legacy Networks are gradually being phased out, and you can no longer create projects with them. This recommendation is to check older projects to ensure that they are not using Legacy Networks.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. &lt;br&gt; Subnetworks cannot be created in a legacy network and are unable to switch from legacy to auto or custom subnet networks. Legacy networks can have an impact for high network traffic projects and are subject to a single point of contention or failure.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; For each Google Cloud Platform project:&lt;br&gt; 1. Create a non-legacy network suitable for the organization's requirements.&lt;/p&gt; 
&lt;p&gt;Note: You can no longer create a legacy network.&lt;br&gt; If you try to create a legacy network, this error is displayed:&lt;br&gt; Creation of legacy mode networks is deprecated. Please create a subnet mode&lt;br&gt; network instead by removing the IPv4Range field and adding the&lt;br&gt; autoCreateSubnetworks field to your network insert request.&lt;/p&gt; 
&lt;p&gt;2. Delete the networks in the legacy mode.&lt;/p&gt; 
&lt;p&gt;For a legacy network, you can explicitly delete the network only if the network is not in use by any resources.&lt;/p&gt; 
&lt;p&gt;To delete the network:&lt;/p&gt; 
&lt;p&gt;gcloud compute networks delete LEGACY_NETWORK_NAME&lt;/p&gt; 
&lt;p&gt;Replace the following:&lt;/p&gt; 
&lt;p&gt;LEGACY_NETWORK_NAME: the name of the legacy network that you want to delete.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Creating a legacy network" url="https://cloud.google.com/vpc/docs/using-legacy#creating_a_legacy_network"/>
            <reference name="Deleting a legacy network" url="https://cloud.google.com/vpc/docs/using-legacy#deleting_a_legacy_network"/>
          </references>
          <standards>
            <standard ref="3.2" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;For each Google Cloud Platform project:&lt;/p&gt;

	&lt;p&gt;1. Set the project name in the Google Cloud Shell:&lt;/p&gt;

	&lt;p&gt;gcloud config set project &lt;Project-ID&gt; &lt;/p&gt;

	&lt;p&gt;2. List the networks configured in that project:&lt;/p&gt;

	&lt;p&gt;gcloud compute networks list &lt;/p&gt;

	&lt;p&gt;None of the listed networks should be in the legacy mode.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.650">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC5" name="Ensure that SSH and RDP access is restricted from the internet" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow the user to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances.&lt;br&gt; Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, only an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the internet to VPC or VM instance using SSH on Port 22 and/or RDP on Port 3389 can be avoided.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; GCP Firewall Rules within a VPC Network apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. Egress and ingress traffic flows are controlled even if the traffic stays within the network (for example, instance-to-instance communication). For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from the Internet through SSH with the default Port 22 and/or RDP on Port 3389. Generic access from the Internet to a specific IP Range needs to be restricted.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; From the Console:&lt;br&gt; 1. Go to VPC Network.&lt;br&gt; 2. Go to the Firewall Rules.&lt;br&gt; 3. Click the Firewall Rule you want to modify.&lt;br&gt; 4. Click Edit.&lt;br&gt; 5. Modify Source IP ranges to specific IP.&lt;br&gt; 6. Click Save.&lt;/p&gt; 
&lt;p&gt;From Command Line:&lt;br&gt; 1.Update the Firewall rule with the new SOURCE_RANGE from the below command:&lt;/p&gt; 
&lt;p&gt;gcloud compute firewall-rules update FirewallName -allow=[PROTOCOL[:PORT[-PORT]],...] -source-ranges=[CIDR_RANGE,...]&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; All Secure Shell (SSH) and/or Remote Desktop Protocol (RDP) connections from outside of the network to the concerned VPC will be blocked. There could be a business need where SSH access is required from outside of the network to access resources associated with the VPC. In that case, specific source IP(s) should be mentioned in firewall rules to white-list access to SSH and/or RDP port for the concerned VPC.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Blocked and limited traffic" url="https://cloud.google.com/vpc/docs/firewalls#blockedtraffic"/>
            <reference name="Cloud IAP enables context-aware access to VMs via SSH and RDP without bastion hosts" url="https://cloud.google.com/blog/products/identity-security/cloud-iap-enables-context-aware-access-to-vms-via-ssh-and-rdp-without-bastion-hosts"/>
          </references>
          <standards>
            <standard ref="3.6" supportedStandardRef="cis-gcp-standard-level-2"/>
            <standard ref="3.7" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;From the Console:&lt;br /&gt;
1. Go to VPC network.&lt;br /&gt;
2. Go to the Firewall Rules.&lt;br /&gt;
3. Ensure that Port is not equal to 22 and/or 3389 and Action is not set to Allow.&lt;br /&gt;
4. Ensure IP Ranges is not equal to 0.0.0.0/0 under Source filters.&lt;/p&gt;

	&lt;p&gt;From Command Line:&lt;br /&gt;
gcloud compute firewall-rules list -&lt;br /&gt;
format=table'(name,direction,sourceRanges,allowed)'&lt;/p&gt;

	&lt;p&gt;Ensure that there is no rule matching the below criteria:&lt;/p&gt;

	&lt;p&gt;- SOURCE_RANGES is 0.0.0.0/0&lt;br /&gt;
- AND DIRECTION is INGRESS&lt;br /&gt;
- AND IPProtocol is tcp or ALL&lt;br /&gt;
- AND PORTS is set to 22 or range containing 22 or 3389 or range containing 3389 or Null (not set)&lt;/p&gt;

	&lt;p&gt;Note:&lt;br /&gt;
- When ALL TCP ports are allowed in a rule, PORT does not have any value set (NULL)&lt;br /&gt;
- When ALL Protocols are allowed in a rule, PORT does not have any value set (NULL)&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.650">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC3" name="Ensure that the default network does not exist in a project" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;To prevent use of default network, a project should not have a default network.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; The default network has a preconfigured network configuration and automatically generates the following insecure firewall rules:&lt;br&gt; - default-allow-internal: Allows ingress connections for all protocols and ports among instances in the network.&lt;br&gt; - default-allow-ssh: Allows ingress connections on TCP port 22(SSH) from any source to any instance in the network.&lt;br&gt; - default-allow-rdp: Allows ingress connections on TCP port 3389(RDP) from any source to any instance in the network.&lt;br&gt; - default-allow-icmp: Allows ingress ICMP traffic from any source to any instance in the network.&lt;br&gt; These automatically created firewall rules do not get audit logged and cannot be configured to enable firewall rule logging.&lt;br&gt; Furthermore, the default network is an auto mode network, which means that its subnets use the same predefined range of IP addresses, and as a result, it's not possible to use Cloud VPN or VPC Network Peering with the default network.&lt;br&gt; Based on organization security and networking requirements, the organization should create a new network and delete the default network&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; From Console:&lt;br&gt; 1. Go to the VPC networks page by visiting: &lt;br&gt; https://console.cloud.google.com/networking/networks/list.&lt;br&gt; 2. Click the network named default.&lt;br&gt; 3. On the network detail page, click EDIT.&lt;br&gt; 4. Click DELETE VPC NETWORK.&lt;br&gt; 5. If needed, create a new network to replace the default network.&lt;/p&gt; 
&lt;p&gt;From Command Line:&lt;br&gt; For each Google Cloud Platform project,&lt;br&gt; 1. Delete the default network:&lt;br&gt; gcloud compute networks delete default&lt;br&gt; 2. If needed, create a new network to replace it:&lt;br&gt; gcloud compute networks create NETWORK_NAME&lt;/p&gt; 
&lt;p&gt;Prevention:&lt;br&gt; The user can prevent the default network and its insecure default firewall rules from being created by setting up an Organization Policy to Skip default network creation at https://console.cloud.google.com/iam-admin/orgpolicies/compute skipDefaultNetworkCreation.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; When an organization deletes the default network, it may need to migrate or service onto a new network&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Method: networks.delete" url="https://cloud.google.com/compute/docs/reference/rest/v1/networks/delete"/>
            <reference name="Method: networks.insert" url="https://cloud.google.com/compute/docs/reference/rest/v1/networks/insert"/>
            <reference name="VPC network overview - Default network" url="https://cloud.google.com/vpc/docs/vpc#default-network"/>
            <reference name="VPC network overview - Firewall rules" url="https://cloud.google.com/vpc/docs/vpc#firewall_rules"/>
            <reference name="gcloud compute networks delete" url="https://cloud.google.com/sdk/gcloud/reference/compute/networks/delete"/>
          </references>
          <standards>
            <standard ref="3.1" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;From Console:&lt;br /&gt;
1. Go to the VPC networks page by visiting: &lt;br /&gt;
https://console.cloud.google.com/networking/networks/list.&lt;br /&gt;
2. Ensure that a network with the name default is not present.&lt;/p&gt;

	&lt;p&gt;From Command Line:&lt;br /&gt;
1. Set the project name in the Google Cloud Shell:&lt;br /&gt;
gcloud config set project PROJECT_ID &lt;br /&gt;
2. List the networks configured in that project:&lt;br /&gt;
gcloud compute networks list &lt;br /&gt;
It should not list default as one of the available networks in that project&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.650">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC1" name="Ensure that VPC flow Logs is enabled for every subnet in a VPC  network" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Flow Logs is a feature that enables users to capture information about the IP traffic going to and from network interfaces in the organization's VPC Subnets. Once a flow log is created, the user can view and retrieve its data in Stackdriver Logging. It is recommended that Flow Logs be enabled for every business-critical VPC subnet.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; VPC networks and subnetworks not reserved for internal HTTP load balancing provide logically isolated and secure network partitions where GCP resources can be launched. &lt;br&gt; When Flow Logs are enabled for a subnet, VMs within that subnet start reporting on all Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) flows. Each VM samples the TCP and UDP flows it sees, inbound and outbound, whether the flow is to or from another VM, a host in the on-premises datacenter, a Google service, or a host on the Internet. If two GCP VMs are communicating, and both are in subnets that have VPC Flow Logs enabled, both VMs report the flows.&lt;br&gt; Flow Logs supports the following use cases:&lt;br&gt; - Network monitoring&lt;br&gt; - Understanding network usage and optimizing network traffic expenses&lt;br&gt; - Network forensics&lt;br&gt; - Real-time security analysis&lt;br&gt; Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or provide insight during security workflows.&lt;br&gt; The Flow Logs must be configured such that all network traffic is logged, the interval of logging is granular to provide detailed information on the connections, no logs are filtered, and metadata to facilitate investigations are included.&lt;/p&gt; 
&lt;p&gt;Note: Subnets reserved for use by internal HTTP load balancers do not support VPC flow logs.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; From Console:&lt;/p&gt; 
&lt;p&gt;1. Go to the VPC network GCP Console visiting &lt;br&gt; https://console.cloud.google.com/networking/networks/list&lt;br&gt; 2. Click the name of a subnet, The Subnet details page displays.&lt;br&gt; 3. Click the EDIT button.&lt;br&gt; 4. Set Flow Logs to On.&lt;br&gt; 5. Expand the Configure Logs section.&lt;br&gt; 6. Set Aggregation Interval to 5 SEC.&lt;br&gt; 7. Check the box beside Include metadata.&lt;br&gt; 8. Set Sample rate to 100.&lt;br&gt; 9. Click Save.&lt;/p&gt; 
&lt;p&gt;Note: It is not possible to configure a Log filter from the console.&lt;/p&gt; 
&lt;p&gt;From Command Line:&lt;/p&gt; 
&lt;p&gt;To enable VPC Flow Logs for a network subnet, run the following command:&lt;br&gt; gcloud compute networks subnets update [SUBNET_NAME] -region [REGION] -&lt;br&gt; enable-flow-logs -logging-aggregation-interval=interval-5-sec -logging flow-sampling=1 -logging-metadata=include-all&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Standard pricing for Stackdriver Logging, BigQuery, or Cloud Pub/Sub applies. VPC Flow Logs generation will be charged starting in GA as described in reference:&lt;br&gt; https://cloud.google.com/vpc/&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using VPC Flow Logs" url="https://cloud.google.com/vpc/docs/using-flow-logs#enabling_vpc_flow_logging"/>
            <reference name="Virtual Private Cloud (VPC)" url="https://cloud.google.com/vpc/"/>
          </references>
          <standards>
            <standard ref="3.8" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;From Console:&lt;/p&gt;

	&lt;p&gt;1. Go to the VPC network GCP Console visiting &lt;br /&gt;
https://console.cloud.google.com/networking/networks/list&lt;br /&gt;
2. From the list of network subnets, make sure for each subnet:&lt;br /&gt;
- Flow Logs is set to On&lt;br /&gt;
- Aggregation Interval is set to 5 sec&lt;br /&gt;
- Include metadata checkbox is checked&lt;br /&gt;
- Sample rate is set to 100%&lt;/p&gt;

	&lt;p&gt;Note: It is not possible to determine if a Log filter has been defined from the console.&lt;/p&gt;


	&lt;p&gt;From Command Line:&lt;/p&gt;

	&lt;p&gt;gcloud compute networks subnets list -format json | \
 jq -r &lt;br /&gt;
'(["Subnet","Purpose","Flow_Logs","Aggregation_Interval","Flow_Sampling","Met&lt;br /&gt;
adata","Logs_Filtered"] | (., map(length*"-"))), 
 (.[] | 
 [
 .name, 
 .purpose,
 (if has("enableFlowLogs") and .enableFlowLogs == true then &lt;br /&gt;
"Enabled" else "Disabled" end),
 (if has("logConfig") then .logConfig.aggregationInterval else &lt;br /&gt;
"N/A" end),
 (if has("logConfig") then .logConfig.flowSampling else "N/A" &lt;br /&gt;
end),
 (if has("logConfig") then .logConfig.metadata else "N/A" end),
 (if has("logConfig") then (.logConfig | has("filterExpr")) else &lt;br /&gt;
"N/A" end)
 ]
 ) | 
 @tsv' | \
 column -t&lt;/p&gt;

	&lt;p&gt;The output of the above command will list:&lt;br /&gt;
- each subnet&lt;br /&gt;
- the subnet's purpose&lt;br /&gt;
- a Enabled or Disabled value if Flow Logs are enabled&lt;br /&gt;
- the value for Aggregation Interval or N/A if disabled, the value for Flow Sampling&lt;br /&gt;
or N/A if disabled&lt;br /&gt;
- the value for Metadata or N/A if disabled&lt;br /&gt;
- 'true' or 'false' if a Logging Filter is configured or 'N/A' if disabled.&lt;br /&gt;
If the subnet's purpose is PRIVATE then Flow Logs should be Enabled.&lt;br /&gt;
If Flow Logs is enabled then:&lt;br /&gt;
- Aggregation_Interval should be INTERVAL_5_SEC&lt;br /&gt;
- Flow_Sampling should be 1&lt;br /&gt;
- Metadata should be INCLUDE_ALL_METADATA&lt;br /&gt;
- Logs_Filtered should be false.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.650">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC7" name="Follow best practices for VPC firewall rules" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Follow best practices for VPC firewall rules&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; VPC firewall rules let you allow or deny connections to or from your virtual machine (VM) instances based on a configuration that you specify. Enabled VPC firewall rules are always enforced, protecting your instances regardless of their configuration and operating system, even if they have not started up.&lt;br&gt; Every VPC network functions as a distributed firewall. While firewall rules are defined at the network level, connections are allowed or denied on a per-instance basis. You can think of the VPC firewall rules as existing not only between your instances and other networks, but also between individual instances within the same network.&lt;br&gt; Google Cloud recommends to follow the best practices for firewall rules.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; When designing and evaluating your firewall rules, keep in mind the following best practices:&lt;/p&gt; 
&lt;p&gt;- Implement least-privilege principles. Block all traffic by default and only allow the specific traffic you need. This includes limiting the rule to just the protocols and ports you need.&lt;br&gt; - Use hierarchical firewall policy rules to block traffic that should never be allowed at an organization or folder level.&lt;br&gt; - For "allow" rules, restrict them to specific VMs by specifying the service account of the VMs.&lt;br&gt; - If you need to create rules based on IP addresses, try to minimize the number of rules. It's easier to track one rule that allows traffic to a range of 16 VMs than it is to track 16 separate rules.&lt;/p&gt; 
&lt;p&gt;For more information please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="VPC firewall rules overview" url="https://cloud.google.com/vpc/docs/firewalls"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that you are following VPC firewall best practices.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.651">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC6" name="Use Identity Aware Proxy (IAP) to ensure only traffic from Google  IP addresses are allowed" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;IAP authenticates the user requests to your apps via a Google single sign in. You can then manage these users with permissions to control access. It is recommended to use both IAP permissions and firewalls to restrict this access to your apps with sensitive information.&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; IAP ensure that access to VMs is controlled by authenticating incoming requests. Access to your apps and the VMs should be restricted by firewall rules that allow only the proxy IAP IP addresses contained in the 35.235.240.0/20 subnet. Otherwise, unauthenticated requests can be made to your apps. To ensure that load balancing works correctly health checks should also be allowed.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; From the Console:&lt;br&gt; 1. Go to the Cloud Console VPC network &amp;gt; Firewall rules.&lt;br&gt; 2. Select the checkbox next to the following rules:&lt;br&gt;- default-allow-http&lt;br&gt;- default-allow-https&lt;br&gt;- default-allow-internal&lt;br&gt; 3. Click Delete.&lt;br&gt; 4. Click Create firewall rule and set the following values:&lt;br&gt;-&lt;br&gt; Name: allow-iap-traffic&lt;br&gt;-&lt;br&gt; Targets: All instances in the network&lt;/p&gt; 
&lt;p&gt;- Source IP ranges (press Enter after you paste each value in the box, copy the value below the bold text including the dash):&lt;br&gt; IAP Proxy Addresses&lt;br&gt; - 35.235.240.0/20&lt;br&gt; Google Health Check&lt;br&gt;- 130.211.0.0/22 **```Google Health Check&lt;br&gt;-&lt;br&gt; Protocols and ports:&lt;br&gt;- Specified protocols and ports required for access and management of your app. For example most health check connection protocols would be covered by;&lt;br&gt;- tcp:80 (Default HTTP Health Check port)&lt;br&gt;- tcp:443-(Default HTTPS Health Check port)&lt;br&gt; Note: if you have custom ports used by your load balancers, you will need to list them here&lt;br&gt; 5. When you're finished updating values, click Create.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; If firewall rules are not configured correctly, legitimate business services could be negatively impacted. It is recommended to make these changes during a time of low usage.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Cloud IAP enables context-aware access to VMs via SSH and RDP without bastion hosts" url="https://cloud.google.com/blog/products/identity-security/cloud-iap-enables-context-aware-access-to-vms-via-ssh-and-rdp-without-bastion-hosts"/>
            <reference name="Creating health checks" url="https://cloud.google.com/load-balancing/docs/health-checks"/>
            <reference name="Identity-Aware Proxy overview" url="https://cloud.google.com/iap/docs/concepts-overview"/>
            <reference name="Setting up an external HTTPS load balancer" url="https://cloud.google.com/iap/docs/load-balancer-howto"/>
          </references>
          <standards>
            <standard ref="3.10" supportedStandardRef="cis-gcp-standard-level-2"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;From the Console:&lt;br&gt; 1. For each of your apps that have IAP enabled go to the Cloud Console VPC network &amp;gt; &lt;br&gt; Firewall rules.&lt;br&gt; 2. Verify that the only rules correspond to the following values:&lt;br&gt;-&lt;br&gt; Targets: All instances in the network&lt;br&gt;-&lt;br&gt; Source IP ranges&lt;br&gt; IAP Proxy Addresses&lt;br&gt;- 35.235.240.0/20&lt;br&gt; Google Health Check&lt;br&gt;- 130.211.0.0/22&lt;br&gt; Google Health Check&lt;br&gt;- 35.191.0.0/16&lt;br&gt;-&lt;br&gt; Protocols and ports:&lt;br&gt;- Specified protocols and ports required for access and management of &lt;br&gt; your app. For example most health check connection protocols would &lt;br&gt; be covered by;&lt;br&gt;- tcp:80 (Default HTTP Health Check port)&lt;br&gt;- tcp:443-(Default HTTPS Health Check port)&lt;/p&gt; 
&lt;p&gt;Note: if you have custom ports used by your load balancers, you will &lt;br&gt; need to list them here&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.651">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-VPC8" name="Use Shared VPC to connect resources from multiple projects to a common VPC network" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Shared VPC to connect resources from multiple projects to a common VPC network&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Shared VPC allows an organization to connect resources from multiple projects to a common Virtual Private Cloud (VPC) network, so that they can communicate with each other securely and efficiently using internal IPs from that network. When you use Shared VPC, you designate a project as a host project and attach one or more other service projects to it. The VPC networks in the host project are called Shared VPC networks. Eligible resources from service projects can use subnets in the Shared VPC network.&lt;br&gt; Shared VPC lets organization administrators delegate administrative responsibilities, such as creating and managing instances, to Service Project Admins while maintaining centralized control over network resources like subnets, routes, and firewalls.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; A Shared VPC network is a VPC network defined in a host project and made available as a centrally shared network for eligible resources in service projects. Shared VPC networks can be either auto or custom mode, but legacy networks are not supported.&lt;/p&gt; 
&lt;p&gt;When a host project is enabled, you have two options for sharing networks:&lt;br&gt; - You can share all host project subnets. If you select this option, then any new subnets created in the host project, including subnets in new networks, will also be shared.&lt;br&gt; - You can specify individual subnets to share. If you share subnets individually, then only those subnets are shared unless you manually change the list.&lt;/p&gt; 
&lt;p&gt;Host and service projects are connected by attachments at the project level. Subnets of the Shared VPC networks in the host project are accessible by Service Project Admins&lt;/p&gt; 
&lt;p&gt;For detailed information on setting up Shared VPC please see Reference URLs.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Provisioning Shared VPC" url="https://cloud.google.com/vpc/docs/provisioning-shared-vpc"/>
            <reference name="Shared VPC overview" url="https://cloud.google.com/vpc/docs/shared-vpc"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that you are using Shared VPC to connect resources from multiple projects to a common VPC network.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.651">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A10-2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC1" mitigation="50"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC2" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC1" mitigation="50"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC2" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NET-01">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC3" mitigation="15"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC4" mitigation="15"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC5" mitigation="14"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC6" mitigation="14"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC7" mitigation="14"/>
                  </countermeasures>
                </weakness>
                <weakness ref="GOOGLE-NON-IDENTIFY">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC8" mitigation="14"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-VPC9" mitigation="14"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC3" mitigation="15"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC4" mitigation="15"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC5" mitigation="14"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC6" mitigation="14"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC7" mitigation="14"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC8" mitigation="14"/>
                <countermeasure ref="C-GOOGLE-CLOUD-VPC9" mitigation="14"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="e081d36f-ecf9-419b-91d8-1d2c38fe8f88" diagramComponentId="89e86010-1ae7-4181-bda4-c10a55d90e64" ref="9bc60ced-7bf6-4279-8744-cd4c4c818097" name="Application" desc="" library="CS-Default" parentComponentRef="ef612fc3-c2c3-4285-9142-3de04b0bfeb3" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
    <component uuid="611dc363-379a-477b-bede-2a6e01d711c2" diagramComponentId="89bec9dd-2e5d-476b-894b-985551373070" ref="44a3d4f3-907c-4276-ac6f-d519d23249bc" name="Mobile Device Client" desc="" library="OWASP-MASVS" parentComponentRef="" componentDefinitionRef="mobile-device-client">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="internet"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-388" name="An error condition is not properly handled (Error Handling)" state="0" impact="100" issueId="" issueLink="">
          <desc>Errors and error handling represent a class of API. Errors related to error handling are so
                        common that they deserve a special kingdom of their own. As with "API Abuse", there
                        are two ways to introduce an error-related security vulnerability: the most common one is handling errors poorly (or not at all). The second is producing errors that either give out too much information (to possible attackers) or are difficult to handle
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-388: An error condition is not properly handled (Error Handling)" url="https://cwe.mitre.org/data/definitions/388.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-120" name="Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')" state="0" impact="100" issueId="" issueLink="">
          <desc>The program copies an input buffer to an output buffer without verifying that the size of the
                        input buffer is less than the size of the output buffer, leading to a buffer overflow.
                        &lt;br /&gt;A buffer overflow condition exists when a program attempts to put more data in a
                        buffer than it can hold, or when a program attempts to put data in a memory area outside of the
                        boundaries of a buffer. The simplest type of error, and the most common cause of buffer
                        overflows, is the &amp;quot;classic&amp;quot; case in which the program copies the buffer
                        without restricting how much is copied. Other variants exist, but the existence of a classic
                        overflow strongly suggests that the programmer is not considering even the most basic of
                        security protections.
                        &lt;br /&gt;
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')" url="https://cwe.mitre.org/data/definitions/120.html"/>
              <reference name="Smashing The Stack For Fun And Profit" url="https://insecure.org/stf/smashstack.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-494" name="Download of Code Without Integrity Check" state="0" impact="100" issueId="" issueLink="">
          <desc>The product downloads source code or an executable from a remote location and executes the
                        code without sufficiently verifying the origin and integrity of the code.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-494: Download of Code Without Integrity Check" url="https://cwe.mitre.org/data/definitions/494.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-250" name="Execution with Unnecessary Privileges" state="0" impact="100" issueId="" issueLink="">
          <desc>The software performs an operation at a privilege level that is higher than the minimum level
                        required, which creates new weaknesses or amplifies the consequences of other weaknesses.

                        New weaknesses can be exposed because running with extra privileges, such as root or
                        Administrator, can disable the normal security checks being performed by the operating system or
                        surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if
                        they occur while operating at raised privileges. Privilege management functions can behave in
                        some less-than-obvious ways, and they have different quirks on different platforms. These
                        inconsistencies are particularly pronounced if you are transitioning from one non-root user to
                        another. Signal handlers and spawned processes run at the privilege of the owning process, so if
                        a process is running as root when a signal fires or a sub-process is executed, the signal
                        handler or sub-process will operate with root privileges.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-250: Execution with Unnecessary Privileges" url="https://cwe.mitre.org/data/definitions/250.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-749" name="Exposed Dangerous Method or Function" state="0" impact="100" issueId="" issueLink="">
          <desc>The software provides an Applications Programming Interface (API) or similar interface for
                        interaction with external actors, but the interface includes a dangerous method or function that
                        is not properly restricted.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-749: Exposed Dangerous Method or Function" url="https://cwe.mitre.org/data/definitions/749.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-79" name="Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not neutralize or incorrectly neutralizes user-controllable input before it
                        is placed in output that is used as a web page that is served to other users. Cross-site
                        scripting (XSS) vulnerabilities occur when:
                        &lt;ol&gt;
                        &lt;li&gt;Untrusted data enters a web application, typically from a web request.&lt;/li&gt;
                        &lt;li&gt;The web application dynamically generates a web page that contains this untrusted
                        data.&lt;/li&gt;
                        &lt;li&gt;During page generation, the application does not prevent the data from containing
                        content that is executable by a web browser, such as JavaScript, HTML tags, HTML attributes,
                        mouse events, Flash, ActiveX, etc.&lt;/li&gt;
                        &lt;li&gt;A victim visits the generated web page through a web browser, which contains malicious
                        script that was injected using the untrusted data.&lt;/li&gt;
                        &lt;li&gt;Since the script comes from a web page that was sent by the web server, the victim's
                        web browser executes the malicious script in the context of the web server's domain.&lt;/li&gt;
                        &lt;li&gt;This effectively violates the intention of the web browser's same-origin policy, which
                        states that scripts in one domain should not be able to access resources or run code in a
                        different domain.&lt;/li&gt;
                        &lt;/ol&gt;There are three main kinds of XSS:
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;Type 1: Reflected XSS (or Non-Persistent)&lt;/b&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;blockquote&gt;
                        The server reads data directly from the HTTP request and reflects it back in the HTTP response.
                        Reflected XSS exploits occur when an attacker causes a victim to supply dangerous content to a
                        vulnerable web application, which is then reflected back to the victim and executed by the web
                        browser. The most common mechanism for delivering malicious content is to include it as a
                        parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs constructed
                        in this manner constitute the core of many phishing schemes, whereby an attacker convinces a
                        victim to visit a URL that refers to a vulnerable site. After the site reflects the attacker's
                        content back to the victim, the content is executed by the victim's browser.
                        &lt;/blockquote&gt;
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;Type 2: Stored XSS (or Persistent)&lt;/b&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;blockquote&gt;
                        The application stores dangerous data in a database, message forum, visitor log, or other
                        trusted data store. At a later time, the dangerous data is subsequently read back into the
                        application and included in dynamic content. From an attacker's perspective, the optimal place
                        to inject malicious content is in an area that is displayed to either many users or particularly
                        interesting users. Interesting users typically have elevated privileges in the application or
                        interact with sensitive data that is valuable to the attacker. If one of these users executes
                        malicious content, the attacker may be able to perform privileged operations on behalf of the
                        user or gain access to sensitive data belonging to the user. For example, the attacker might
                        inject XSS into a log message, which might not be handled properly when an administrator views
                        the logs.
                        &lt;/blockquote&gt;
                        &lt;ul&gt;
                        &lt;li&gt;&lt;b&gt;Type 0: DOM-Based XSS&lt;/b&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;blockquote&gt;
                        In DOM-based XSS, the client performs the injection of XSS into the page; in the other types,
                        the server performs the injection. DOM-based XSS generally involves server-controlled, trusted
                        script that is sent to the client, such as Javascript that performs sanity checks on a form
                        before the user submits it. If the server-supplied script processes user-supplied data and then
                        injects it back into the web page (such as with dynamic HTML), then DOM-based XSS is
                        possible.Once the malicious script is injected, the attacker can perform a variety of malicious
                        activities. The attacker could transfer private information, such as cookies that may include
                        session information, from the victim's machine to the attacker. The attacker could send
                        malicious requests to a web site on behalf of the victim, which could be especially dangerous to
                        the site if the victim has administrator privileges to manage that site. Phishing attacks could
                        be used to emulate trusted web sites and trick the victim into entering a password, allowing the
                        attacker to compromise the victim's account on that web site. Finally, the script could exploit
                        a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes
                        referred to as &amp;quot;drive-by hacking&amp;quot;.
                        &lt;/blockquote&gt;
                        &lt;blockquote&gt;
                        &lt;br /&gt;
                        &lt;/blockquote&gt;In many cases, the attack can be launched without the victim even being aware
                        of it. Even with careful users, attackers frequently use a variety of methods to encode the
                        malicious portion of the attack, such as URL encoding or Unicode, so the request looks less
                        suspicious.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references>
              <reference name="CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')" url="https://cwe.mitre.org/data/definitions/79.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-83" name="Improper Neutralization of Script in Attributes in a Web Page" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not neutralize or incorrectly neutralizes "javascript:" or other URIs from
                        dangerous attributes within tags, such as onmouseover, onload, onerror, or style.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references>
              <reference name="CWE-83: Improper Neutralization of Script in Attributes in a Web Page" url="https://cwe.mitre.org/data/definitions/83.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="MASVS-EMULATION-TOOLS" name="Inappropriate use of emulation tools" state="0" impact="100" issueId="" issueLink="">
          <desc>The inappropriate use of emulation tools are not detected by the app, and attackers can
                        leverage them to obtain information about the app.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="MASVS-REVERSE-ENGINEERING-TOOLS" name="Inappropriate use of reverse engineering tools" state="0" impact="100" issueId="" issueLink="">
          <desc>The inappropriate use of the reverse engineering tools is not detected by the app, and
                        attackers can leverage them to obtain information about the app.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-732" name="Incorrect Permission Assignment for Critical Resource" state="0" impact="100" issueId="" issueLink="">
          <desc>The software specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.

When a resource is given a permission setting that provides access to a wider range of actors than required, it can lead to the exposure of sensitive information or to the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution or sensitive user data.  </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-732: Incorrect Permission Assignment for Critical Resource" url="https://cwe.mitre.org/data/definitions/732.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-215" name="Information Exposure Through Debug Information" state="0" impact="100" issueId="" issueLink="">
          <desc>The application contains debugging code that can expose sensitive information to untrusted parties.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-215: Information Exposure Through Debug Information" url="https://cwe.mitre.org/data/definitions/215.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="lack-automated-vuln-identification" name="Lack of automated vulnerability identification" state="0" impact="100" issueId="" issueLink="">
          <desc>Developmental security testing/evaluation is not enforced during post-design phases of the system development life cycle. Such testing/evaluation is necessary because it confirms that the required security controls are implemented correctly, operating as intended, enforcing the desired security policy, and meeting established security requirements.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.513">
              <output/>
            </source>
            <references>
              <reference name="Risk-Based and Functional Security Testing" url="https://www.us-cert.gov/bsi/articles/best-practices/security-testing/risk-based-and-functional-security-testing"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-489" name="Leftover Debug Code" state="0" impact="100" issueId="" issueLink="">
          <desc>The application can be deployed with active debugging code that can create unintended entry
                        points.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-489: Leftover Debug Code" url="https://cwe.mitre.org/data/definitions/489.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="MEMORY-LEAKAGE" name="Memory Leakage" state="0" impact="100" issueId="" issueLink="">
          <desc/>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="OUTDATED-LIBRARIES" name="Outdated libraries" state="0" impact="100" issueId="" issueLink="">
          <desc/>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.514">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-656" name="Reliance on Security Through Obscurity" state="0" impact="100" issueId="" issueLink="">
          <desc>The software uses a protection mechanism whose strength depends heavily on its obscurity, such
                        that knowledge of its algorithms or key data is sufficient to defeat the mechanism.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:07.515">
              <output/>
            </source>
            <references>
              <reference name="CWE-656: Reliance on Security Through Obscurity" url="https://cwe.mitre.org/data/definitions/656.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="MASVS-7.9" name="Activate the Free Security Features" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>For Android:&amp;nbsp; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;We shall activate the Obfuscation of the code and strip unneeded debugging information.&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt;For iOS:&amp;nbsp; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;We shall activate:&amp;nbsp;&lt;/li&gt; 
  &lt;ul&gt; 
   &lt;li&gt;ARC (Automatic Reference Counting): memory management feature, adds retain and release messages when required.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;Stack Canary: helps prevent buffer overflow attacks.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;PIE (Position Independent Executable): enables full ASLR for binary.&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Verifying Compiler Settings" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#testing-for-debugging-symbols-mstg-code-3"/>
            <reference name="OWASP MASVS - iOS - Verifying Compiler Settings" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#finding-debugging-code-and-verbose-error-logging-mstg-code-4"/>
          </references>
          <standards>
            <standard ref="7.9" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.9" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.9" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.9" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-6.6" name="Allow only the minimum set of protocol handlers required" issueId="" issueLink="" platform="" cost="1" risk="70" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Configure the WebViews to allow only the minimum set of protocol handlers required (ideally, only https). Potentially dangerous handlers, such as file, tel and app-id, are disabled.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing WebView Protocol Handlers" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05h-testing-platform-interaction#testing-webview-protocol-handlers-mstg-platform-6"/>
            <reference name="OWASP MASVS - iOS - Testing WebView Protocol Handlers" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-webview-protocol-handlers-mstg-platform-6"/>
          </references>
          <standards>
            <standard ref="6.6" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="6.6" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="6.6" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="6.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the set of protocol handlers are deactivated.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.6" name="Anonymize all data that is sent to 3rd Party services" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>All data that is sent to 3rd Party services shall be anonymized, so no PII data is available that would allow the 3rd party to identify the user account. Also all other data, like IDs in an application that can be mapped to a user account or session should not be sent to a third party.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Whether Sensitive Data Is Exposed via IPC Mechanisms" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage#determining-whether-sensitive-stored-data-has-been-exposed-via-ipc-mechanisms-mstg-storage-6"/>
            <reference name="OWASP MASVS - iOS - Testing Whether Sensitive Data Is Exposed via IPC Mechanisms" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#determining-whether-sensitive-data-is-exposed-via-ipc-mechanisms-mstg-storage-6"/>
          </references>
          <standards>
            <standard ref="2.6" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="2.6" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="2.6" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that all data that is sent to 3rd Party services is anonymized.

                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.9" name="Apply 2FA Authentication on remote services" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  A second factor of authentication exists at the remote endpoint and the 2FA requirement is consistently enforced. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Authentication and Session Management Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements"/>
          </references>
          <standards>
            <standard ref="4.9" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.9" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.13" name="Apply application level payload encryption" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;span style="white-space: pre;"&gt;As a defense in depth, next to having solid hardening of the communicating parties, application level payload encryption can be applied to further impede eavesdropping.&lt;/span&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Resilience Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x15-v8-resiliency_against_reverse_engineering_requirements"/>
          </references>
          <standards>
            <standard ref="8.13" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.13" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.992">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.6" name="Catch and handle the possible exceptions" issueId="" issueLink="" platform="" cost="1" risk="68" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Implement a well-designed and unified scheme to handle exceptions. Make sure the application has centralized handlers for exceptions that result in similar behavior. This can be a static class for instance. For specific exceptions given the methods context, specific catch blocks should be provided.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Exception Handling" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#testing-exception-handling-mstg-code-6-and-mstg-code-7"/>
            <reference name="OWASP MASVS - iOS - Testing Error Handling in Security Controls" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#testing-exception-handling-mstg-code-6"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.6" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.6" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.6" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the exceptions are well-designed and are catched and handled well.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.5" name="Check for weaknesses in 3rd party libraries" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;iOS applications often make use of third party libraries. These third party libraries accelerate development as the developer has to write less code in order to solve a problem. There are two categories of libraries:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Libraries that are not (or should not) be packed within the actual production application, such as &lt;/span&gt;&lt;span&gt;&lt;code&gt;OHHTTPStubs&lt;/code&gt;&lt;/span&gt;&lt;span&gt; used for testing.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Libraries that are packed within the actual production application, such as &lt;/span&gt;&lt;span&gt;&lt;code&gt;Alamofire&lt;/code&gt;&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;These libraries can lead to unwanted side-effects:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;A library can contain a vulnerability, which will make the application vulnerable. A good example is &lt;/span&gt;&lt;span&gt;&lt;code&gt;AFNetworking&lt;/code&gt;&lt;/span&gt;&lt;span&gt; version 2.5.1, which contained a bug that disabled certificate validation. This vulnerability would allow attackers to execute man-in-the-middle attacks against apps that are using the library to connect to their APIs.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;A library can no longer be maintained or hardly be used, which is why no vulnerabilities are reported and/or fixed. This can lead to having bad and/or vulnerable code in your application through the library.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;A library can use a license, such as LGPL2.1, which requires the application author to provide access to the source code for those who use the application and request insight in its sources. In fact the application should then be allowed to be redistributed with modifications to its source code. This can endanger the intellectual property (IP) of the application.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Note: there are two widely used package management tools: Carthage and CocoaPods. Please note that this issue can hold on multiple levels: When you use webviews with JavaScript running in the webview, the JavaScript libraries can have these issues as well. The same holds for plugins/libraries for Cordova, React-native and Xamarin apps.&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;iOS applications often make use of third party libraries. These third party libraries accelerate development as the developer has to write less code in order to solve a problem. There are two categories of libraries:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Libraries that are not (or should not) be packed within the actual production application, such as &lt;/span&gt;&lt;span&gt;&lt;code&gt;OHHTTPStubs&lt;/code&gt;&lt;/span&gt;&lt;span&gt; used for testing.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Libraries that are packed within the actual production application, such as &lt;/span&gt;&lt;span&gt;&lt;code&gt;Alamofire&lt;/code&gt;&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;These libraries can lead to unwanted side-effects:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;A library can contain a vulnerability, which will make the application vulnerable. A good example is &lt;/span&gt;&lt;span&gt;&lt;code&gt;AFNetworking&lt;/code&gt;&lt;/span&gt;&lt;span&gt; version 2.5.1, which contained a bug that disabled certificate validation. This vulnerability would allow attackers to execute man-in-the-middle attacks against apps that are using the library to connect to their APIs.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;A library can no longer be maintained or hardly be used, which is why no vulnerabilities are reported and/or fixed. This can lead to having bad and/or vulnerable code in your application through the library.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;A library can use a license, such as LGPL2.1, which requires the application author to provide access to the source code for those who use the application and request insight in its sources. In fact the application should then be allowed to be redistributed with modifications to its source code. This can endanger the intellectual property (IP) of the application.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Note: there are two widely used package management tools: Carthage and CocoaPods. Please note that this issue can hold on multiple levels: When you use webviews with JavaScript running in the webview, the JavaScript libraries can have these issues as well. The same holds for plugins/libraries for Cordova, React-native and Xamarin apps.&lt;/span&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Checking for Weaknesses in Third Party Libraries" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#checking-for-weaknesses-in-third-party-libraries-mstg-code-5"/>
            <reference name="OWASP MASVS - iOS - Checking for Weaknesses in Third Party Libraries" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings"/>
          </references>
          <standards>
            <standard ref="7.5" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.5" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.5" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.5" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;span&gt;The dynamic analysis of this section comprises validating whether the copyrights of the licenses have been adhered to. This often means that the application should have an &lt;/span&gt; 
&lt;span&gt;&lt;code&gt;about&lt;/code&gt;&lt;/span&gt; 
&lt;span&gt; or &lt;/span&gt; 
&lt;span&gt;&lt;code&gt;EULA&lt;/code&gt;&lt;/span&gt; 
&lt;span&gt; section in which the copy-right statements are noted as required by the license of the third party library.&lt;/span&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.15" name="Clean local storage after several failed attempts to authenticate user" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>The app's local storage should be wiped after an excessive number of failed authentication attempts.</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="2.15" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.15" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that local storage is cleaned after failed attempts to authenticate</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-6.10" name="Clear WebView's resources" issueId="" issueLink="" platform="" cost="0" risk="70" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;span style="white-space: pre;"&gt;A WebView's cache, storage, and loaded resources (JavaScript, etc.) should be cleared before the WebView is destroyed.&lt;/span&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Platform Interaction Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment"/>
          </references>
          <standards>
            <standard ref="6.10" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="6.10" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-1.9" name="Create a mechanism to force updates on application" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Starting from Android 5.0 (API level 21), together with the Play Core Library, apps can be forced to be updated. This mechanism is based on using the &lt;/span&gt;&lt;span&gt;&lt;code&gt;AppUpdateManager&lt;/code&gt;&lt;/span&gt;&lt;span&gt;. Before that, other mechanisms were used, such as doing http calls to the Google Play Store, which are not as reliable as the APIs of the Play Store might change. Alternatively, Firebase could be used to check for possible forced updates as well (see this &lt;/span&gt;&lt;/span&gt;&lt;a href="https://medium.com/@sembozdemir/force-your-users-to-update-your-app-with-using-firebase-33f1e0bcec5a" target="_blank"&gt;&lt;span&gt;&lt;span&gt;blog&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt;). Enforced updating can be really helpful when it comes to public key pinning (see the Testing Network communication for more details) when a pin has to be refreshed due to a certificate/public key rotation. Next, vulnerabilities are easily patched by means of forced updates.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;For iOS, enforced updating can be really helpful when it comes to public key pinning (see the Testing Network communication for more details) when a pin has to be refreshed due to a certificate/public key rotation. Next, vulnerabilities are easily patched by means of forced updates. The challenge with iOS however, is that Apple does not provide any APIs yet to automate this process, instead, developers will have to create their own mechanism, such as described at various &lt;/span&gt;&lt;/span&gt;&lt;a href="https://mobikul.com/show-update-application-latest-version-functionality-ios-app-swift-3/" target="_blank"&gt;&lt;span&gt;&lt;span&gt;blogs&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt; which boil down to looking up properties of the app using &lt;/span&gt;&lt;span&gt;&lt;code&gt;http://itunes.apple.com/lookup\?id\&amp;lt;BundleId&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span&gt; or third party libraries, such as &lt;/span&gt;&lt;/span&gt;&lt;a href="https://github.com/ArtSabintsev/Siren" target="_blank"&gt;&lt;span&gt;&lt;span&gt;Siren&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt; and &lt;/span&gt;&lt;/span&gt;&lt;a href="https://www.npmjs.com/package/react-native-appstore-version-checker" target="_blank"&gt;&lt;span&gt;&lt;span&gt;react-native-appstore-version-checker&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt;. Most of these implementations will require a certain given version offered by an API or just "latest in the appstore", which means users can be frustrated with having to update the app, even though no business/security need for an update is truly there.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Please note that newer versions of an application will not fix security issues that are living in the backends to which the app communicates. Allowing an app not to communicate with it might not be enough. Having proper API-lifecycle management is key here. Similarly, when a user is not forced to update, do not forget to test older versions of your app against your API and/or use proper API versioning.&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;br&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing enforced updating" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05h-testing-platform-interaction#testing-enforced-updating-mstg-arch-9"/>
            <reference name="OWASP MASVS - iOS - Testing enforced updating" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-enforced-updating-mstg-arch-9"/>
          </references>
          <standards>
            <standard ref="1.9" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="1.9" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M7: Client Code Quality" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;span style="white-space: pre;"&gt;In order to test for proper updating: try downloading an older version of the application with a security vulnerability, either by a release from the developers or by using a third party app-store. Next, verify whether or not you can continue to use the application without updating it. If an update prompt is given, verify if you can still use the application by canceling the prompt or otherwise circumventing it through normal application usage. This includes validating whether the backend will stop calls to vulnerable backends and/or whether the vulnerable app-version itself is blocked by the backend. Lastly, see if you can play with the version number of a man-in-the-middled app and see how the backend responds to this (and if it is recorded at all for instance).&lt;/span&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.986">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.12" name="Create an authorization model on remote endpoints" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;span style="white-space: pre;"&gt;Authorization models should be defined and enforced at the remote endpoint.&lt;/span&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Authentication and Session Management Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements"/>
          </references>
          <standards>
            <standard ref="4.12" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.12" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.12" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.12" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.5-4.6" name="Create a strong password policy" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;span style="white-space: pre;"&gt;Password strength is a key concern when passwords are used for authentication. The password policy defines requirements to which end users should adhere. A password policy typically specifies password length, password complexity, and password topologies. A "strong" password policy makes manual or automated password cracking difficult or impossible.&lt;/span&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Testing Login Activity and Device Blocking" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04e-testing-authentication-and-session-management"/>
          </references>
          <standards>
            <standard ref="4.5" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.5" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.5" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.5" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="4.6" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.6" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.6" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M4: Insecure Authentication" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M6: Insecure Authorization" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;span&gt;Automated password guessing attacks can be performed using a number of tools. For HTTP(S) services, using an interception proxy is a viable option. For example, you can use &lt;/span&gt; 
&lt;a href="https://portswigger.net/burp/help/intruder_using.html" target="_blank"&gt;&lt;span&gt;Burp Suite Intruder&lt;/span&gt;&lt;/a&gt; 
&lt;span&gt; to perform both wordlist-based and brute-force attacks.&lt;/span&gt; 
&lt;div&gt; 
 &lt;span&gt;&lt;br&gt;&lt;/span&gt; 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;span&gt;&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Execute the following steps for a wordlist based brute force attack with Burp Intruder:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;ul&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Start Burp Suite Professional.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Create a new project (or open an existing one).&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Set up your mobile device to use Burp as the HTTP/HTTPS proxy. Log into the mobile app and intercept the authentication request sent to the backend service.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Right-click this request on the &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Proxy/HTTP History&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; tab and select &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Send to Intruder&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; in the context menu.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Select the &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Intruder&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; tab. For further information on how to use &lt;/span&gt;&lt;/span&gt;&lt;a href="https://portswigger.net/burp/documentation/desktop/tools/intruder/using" target="_blank"&gt;&lt;span&gt;&lt;span&gt;Burp Intruder&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt; read the official documentation on Portswigger.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Make sure all parameters in the &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Target&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Positions&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;, and &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Options&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; tabs are appropriately set and select the &lt;/span&gt;&lt;span&gt;&lt;strong&gt;Payload&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; tab.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
   &lt;li&gt; 
    &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
     &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Load or paste the list of passwords you want to try. There are several resources available that offer password lists, like &lt;/span&gt;&lt;/span&gt;&lt;a href="https://github.com/fuzzdb-project/fuzzdb/" target="_blank"&gt;&lt;span&gt;&lt;span&gt;FuzzDB&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span&gt;, the built-in lists in Burp Intruder or the files available in &lt;/span&gt;&lt;span&gt;&lt;code&gt;/usr/share/wordlists&lt;/code&gt;&lt;/span&gt;&lt;span&gt; on Kali Linux.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
    &lt;/div&gt;&lt;/li&gt; 
  &lt;/ul&gt;&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Once everything is configured and you have a word-list selected, you're ready to start the attack!&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/span&gt; 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.11" name="Create the functionality to verify the app uses a minimum device-access-security policy" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Different checks on the Android device can be implemented by querying different system preferences from Settings.Secure. The Device Administration API offers different mechanisms to create security aware applications, that are able to enforce password policies or encryption of the device.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing the Device-Access-Security Policy" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage#testing-the-device-access-security-policy-mstg-storage-11"/>
            <reference name="OWASP MASVS - iOS - Testing the Device-Access-Security Policy" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#testing-local-data-storage-mstg-storage-1-and-mstg-storage-2"/>
          </references>
          <standards>
            <standard ref="2.11" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.11" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the app verifies the mobile device complies with the minimum
                            device-access-security policy.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.987">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.7" name="Deny the access by default when an uncaught exception appears" issueId="" issueLink="" platform="" cost="1" risk="68" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Deny the access by default to prevent the app crashing because of uncaught exception and to avoid unauthorized access.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Exception Handling" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#testing-exception-handling-mstg-code-6-and-mstg-code-7"/>
            <reference name="OWASP MASVS - iOS - Testing Error Handling in Security Controls" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#testing-exception-handling-mstg-code-6"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="7.7" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.7" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.7" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.7" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="9" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API7:2019-Security Misconfiguration" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="M7: Client Code Quality" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the application denies access to the session when the exceptions appear.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-6.5" name="Disable JavaScript by default in a WebView if it is not necessary" issueId="" issueLink="" platform="" cost="1" risk="70" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>JavaScript is disabled by default in a WebView and if not needed shouldn't be enabled. This reduces the attack surface and potential threats to the app.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing JavaScript Execution in WebViews" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05h-testing-platform-interaction#testing-javascript-execution-in-webviews-mstg-platform-5"/>
            <reference name="OWASP MASVS - iOS - Testing JavaScript Execution in WebViews" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-ios-webviews-mstg-platform-5"/>
          </references>
          <standards>
            <standard ref="6.5" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="6.5" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="6.5" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="6.5" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>For Android:&amp;nbsp;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Search in the code the following instruction:
                            webview.getSettings().setJavaScriptEnabled(true);&lt;/li&gt;
                            &lt;li&gt;Check that this instruction doesn't exist in the code.&amp;nbsp;&lt;/li&gt;
                            &lt;/ul&gt;For iOS:&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Check that the JavaScript is disabled and configured as following:&amp;nbsp;&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            #import &amp;quot;ViewController.h&amp;quot;&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            #import @interface ViewController () @property(strong,nonatomic) WKWebView *webView;
                            &lt;/div&gt;
                            &lt;div&gt;
                            @end @implementation ViewController - (void)viewDidLoad { NSURL *url = [NSURL
                            URLWithString:@&amp;quot;http://www.example.com/&amp;quot;];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            NSURLRequest *request = [NSURLRequest requestWithURL:url];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            WKPreferences *pref = [[WKPreferences alloc] init]; //Disable javascript execution: [pref
                            setJavaScriptEnabled:NO];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            [pref setJavaScriptCanOpenWindowsAutomatically:NO];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            WKWebViewConfiguration *conf = [[WKWebViewConfiguration alloc] init];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            [conf setPreferences:pref]; _webView = [[WKWebView
                            alloc]initWithFrame:CGRectMake(self.view.frame.origin.x,85, self.view.frame.size.width,
                            self.view.frame.size.height-85) configuration:conf] ;&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            [_webView loadRequest:request];&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            [self.view addSubview:_webView]; }
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.5" name="Disable keyboard cache on sensitive data text inputs" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>A general best practice is overwriting different functions in the input field to disable the clipboard specifically for it. Also longclickable should be deactivated for the input field.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Whether Sensitive Data Is Exposed via IPC Mechanisms" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage#determining-whether-sensitive-stored-data-has-been-exposed-via-ipc-mechanisms-mstg-storage-6"/>
            <reference name="OWASP MASVS - iOS - Testing for Sensitive Data in the Clipboard" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#finding-sensitive-data-in-the-keyboard-cache-mstg-storage-5"/>
          </references>
          <standards>
            <standard ref="2.5" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="2.5" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="2.5" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.5" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check the clipboard is disabled when sensitive data is used.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.10" name="Do not use the SSAID for 'device binding'" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Do not use the SSAID for device binding because the behavior of the SSAID has changed since
                        Android O and the behavior of MAC addresses have changed in Android N.

                        Google has set a new set of recommendations in their SDK documentation regarding identifiers as
                        well. Because of this new behavior, we recommend developers not rely on the SSAID alone, as the
                        identifier has become less stable. For instance: The SSAID might change upon a factory reset or
                        when the app is reinstalled after the upgrade to Android O. Please note that there are a number
                        of devices which have the same ANDROID_ID and/or have an ANDROID_ID that can be overridden.
                        Also, the Build.Serial was often used but now apps targeting Android O will get "UNKNOWN" when
                        they request the Build.Serial.
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Device Binding" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-device-binding-mstg-resilience-10"/>
            <reference name="OWASP MASVS - iOS - Testing Device Binding" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#device-binding-mstg-resilience-10"/>
          </references>
          <standards>
            <standard ref="8.10" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.10" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt;
                            &lt;li&gt;Dynamic Analysis using an Emulator.&lt;/li&gt;
                            &lt;li&gt;Run the application on an Emulator.&lt;/li&gt;
                            &lt;li&gt;Make sure you can raise the trust in the instance of the application (e.g.
                            authenticate).&lt;/li&gt;
                            &lt;li&gt;Retrieve the data from the Emulator. This has a few steps:&amp;nbsp;&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;ol&gt;
                            &lt;ol&gt;
                            &lt;li&gt;ssh to your emulator using ADB shell&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;run-as&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;chmod 777 the contents of cache and shared-preferences&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;exit the current user&lt;/li&gt;
                            &lt;li&gt;copy the contents of /dat/data//cache &amp;amp; shared-preferences to the sdcard&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;use ADB or the DDMS to pull the contents&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Install the application on another Emulator&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;&amp;nbsp;Overwrite the data from step 3 in the data folder of the application.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;copy the contents of step 3 to the sdcard of the second emulator.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;ssh to your emulator using ADB shell&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;run-as&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;chmod 777 the folders cache and shared-preferences&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;copy the older contents of the sdcard to /dat/data//cache &amp;amp;
                            shared-preferences&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Can you continue in an authenticated state? If so, then binding might not be
                            working properly.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.992">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.3" name="Don't write any sensitive data on logs" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;There are many legitimate reasons for creating log files on a mobile device, including keeping track of crashes or errors that are stored locally while the device is offline (so that they can be sent to the app's developer once online), and storing usage statistics. However, logging sensitive data, such as credit card numbers and session information, may expose the data to attackers or malicious applications. Log files can be created in several ways.&amp;nbsp;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;The following list includes two classes that are available for Android:&lt;/p&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Log Class&lt;/li&gt; 
 &lt;li&gt;Logger Class&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;p&gt;Use a centralized logging class and mechanism and remove logging statements from the production release because other applications may be able to read them.&lt;/p&gt; 
&lt;p&gt;The following list shows the methods available on iOS:&lt;/p&gt; 
&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;NSLog Method&lt;/li&gt; 
 &lt;li&gt;printf-like function&lt;/li&gt; 
 &lt;li&gt;NSAssert-like function&lt;/li&gt; 
 &lt;li&gt;Macro&lt;/li&gt; 
&lt;/ul&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;p&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Data Storage" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05d-testing-data-storage"/>
            <reference name="OWASP MASVS - iOS - Testing Data Storage" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage"/>
          </references>
          <standards>
            <standard ref="2.3" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="2.3" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="2.3" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.3" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M1: Improper Platform Usage" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M2: Insecure Data Storage" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt; 
 &lt;li&gt;Review app logs in search of sensitive data&lt;/li&gt; 
&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.11" name="Encrypt and pack all executable files and libraries belonging to the app" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Ensure that all executable files and libraries belonging to the app are encrypted on the file level and/or important code and data segments inside the executables are encrypted or packed.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Advanced Obfuscation" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-obfuscation-mstg-resilience-9"/>
            <reference name="OWASP MASVS - iOS - Testing Simple Obfuscation" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#testing-obfuscation-mstg-resilience-9"/>
          </references>
          <standards>
            <standard ref="8.11" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.11" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that all executable files and libraries belonging to the app are encrypted or
                            packed.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.992">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.14" name="Encrypt sensitive data stored locally" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>If sensitive data is still required to be stored locally, it should be encrypted using a key derived from hardware backed storage which requires authentication</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="2.14" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.14" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that sensitive data is not stored in plain text.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-2.13" name="Ensure sensitive data is not stored locally on the mobile device" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>No sensitive data should be stored locally on the mobile device. Instead, data should be retrieved from a remote endpoint when needed and only be kept in memory.</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="2.13" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="2.13" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check if any sensitive data is stored on the device and analyze if it is necessary.</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.7" name="Ensure that the app responds correctly against tampering, debugging and emulation" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Ensure the app implements multiple different responses to tampering, debugging and emulation,
                        including stealthy responses that don't simply terminate the app.
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Verifying the Variability of Tampering Responses" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05c-reverse-engineering-and-tampering"/>
            <reference name="OWASP MASVS - iOS - Verifying the Variability of Tampering Responses" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06c-reverse-engineering-and-tampering"/>
          </references>
          <standards>
            <standard ref="8.7" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.7" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check the app implements multiple different responses to tampering, debugging and
                            emulation, including stealthy responses that don't simply terminate the app.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-5.6" name="Ensure the app only depends on up-to-date connectivity and security libraries" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Android relies on a security provider to provide SSL/TLS-based connections. The problem with this kind of security provider (one example is OpenSSL), which comes with the device, is that it often has bugs and/or vulnerabilities. To avoid known vulnerabilities, developers need to make sure that the application will install a proper security provider. Since July 11, 2016, Google has been rejecting Play Store application submissions (both new applications and updates) that use vulnerable versions of OpenSSL.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing the Security Provider" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05g-testing-network-communication#testing-the-security-provider-mstg-network-6"/>
          </references>
          <standards>
            <standard ref="5.6" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="5.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;When you have the source code:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Run the application in debug mode, then create a breakpoint where the app will first contact the endpoint(s).&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Right click the highlighted code and select &lt;/span&gt;&lt;span&gt;&lt;code&gt;Evaluate Expression&lt;/code&gt;&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Type &lt;/span&gt;&lt;span&gt;&lt;code&gt;Security.getProviders()&lt;/code&gt;&lt;/span&gt;&lt;span&gt; and press enter.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Check the providers and try to find &lt;/span&gt;&lt;span&gt;&lt;code&gt;GmsCore_OpenSSL&lt;/code&gt;&lt;/span&gt;&lt;span&gt;, which should be the new top-listed provider.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;When you do not have the source code:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Use Xposed to hook into the &lt;/span&gt;&lt;span&gt;&lt;code&gt;java.security&lt;/code&gt;&lt;/span&gt;&lt;span&gt; package, then hook into &lt;/span&gt;&lt;span&gt;&lt;code&gt;java.security.Security&lt;/code&gt;&lt;/span&gt;&lt;span&gt; with the method &lt;/span&gt;&lt;span&gt;&lt;code&gt;getProviders&lt;/code&gt;&lt;/span&gt;&lt;span&gt; (with no arguments). The return value will be an array of &lt;/span&gt;&lt;span&gt;&lt;code&gt;Provider&lt;/code&gt;&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;Determine whether the first provider is &lt;/span&gt;&lt;span&gt;&lt;code&gt;GmsCore_OpenSSL&lt;/code&gt;&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.4" name="Ensure the logout functionality terminates the session" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The purpose of this test case is verifying logout functionality and determining whether it effectively terminates the session on both client and server and invalidates a stateless token.&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Failing to destroy the server-side session is one of the most common logout functionality implementation errors. This error keeps the session or token alive, even after the user logs out of the application. An attacker who gets valid authentication information can continue to use it and hijack a user's account.&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Many mobile apps don't automatically log users out. There can be various reasons, such as: because it is inconvenient for customers, or because of decisions made when implementing stateless authentication. The application should still have a logout function, and it should be implemented according to best practices, destroying all locally stored tokens or session identifiers. If session information is stored on the server, it should also be destroyed by sending a logout request to that server. In case of a high-risk application, tokens should be blacklisted. Not removing tokens or session identifiers can result in unauthorized access to the application in case the tokens are leaked. Note that other sensitive types of information should be removed as well, as any information that is not properly cleared may be leaked later, for example during a device backup.&lt;/span&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Testing Login Activity and Device Blocking" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04e-testing-authentication-and-session-management"/>
          </references>
          <standards>
            <standard ref="4.4" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.4" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.4" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.4" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M4: Insecure Authentication" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M6: Insecure Authorization" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Use an interception proxy for dynamic application analysis and execute the following steps to check whether the logout is implemented properly:&lt;/span&gt;&lt;/p&gt; 
&lt;ol&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Log in to the application.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Access a resource that requires authentication, typically a request for private information belonging to your account.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Log out of the application.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Try to access the data again by resending the request from step 2.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ol&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;If the logout is correctly implemented on the server, an error message or redirect to the login page will be sent back to the client. On the other hand, if you receive the same response you got in step 2, the token or session ID is still valid and hasn't been correctly terminated on the server.&lt;/span&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.11" name="Implement a device blocking functionality" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;For applications which require L2 protection, the MASVS states that they should inform the user about all login activities within the app with the possibility of blocking certain devices. This can be broken down into various scenarios:&lt;/span&gt;&lt;/p&gt; 
&lt;ol&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The application provides a push notification the moment their account is used on another device to notify the user of different activities. The user can then block this device after opening the app via the push-notification.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The application provides an overview of the last session after login. If the previous session was with a different configuration (e.g. location, device, app-version) compared to the current configuration, then the user should have the option to report suspicious activities and block devices used in the previous session.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The application provides an overview of the last session after login at all times.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The application has a self-service portal in which the user can see an audit-log. This allows the user to manage the different devices that are logged in.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ol&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The developer can make use of specific meta-information and associate it to each different activity or event within the application. This will make it easier for the user to spot suspicious behavior and block the corresponding device. The meta-information may include:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Device: The user can clearly identify all devices where the app is being used.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Date and Time: The user can clearly see the latest date and time when the app was used.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Location: The user can clearly identify the latest locations where the app was used.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;The application can provide a list of activities history which will be updated after each sensitive activity within the application. The choice of which activities to audit needs to be done for each application based on the data it handles and the level of security risk the team is willing to have. Below is a list of common sensitive activities that are usually audited:&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Login attempts&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Password changes&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Personal Identifiable Information changes (name, email address, telephone number, etc.)&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Sensitive activities (purchase, accessing important resources, etc.)&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Consent to Terms and Conditions clauses&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Paid content requires special care, and additional meta-information (e.g., operation cost, credit, etc.) might be used to ensure user's knowledge about the whole operation's parameters.&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;In addition, non-repudiation mechanisms should be applied to sensitive transactions (e.g. payed content access, given consent to Terms and Conditions clauses, etc.) in order to prove that a specific transaction was in fact performed (integrity) and by whom (authentication).&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;br&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Testing Login Activity and Device Blocking" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04e-testing-authentication-and-session-management"/>
          </references>
          <standards>
            <standard ref="4.11" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.11" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;In all cases, you should verify whether different devices are detected correctly. Therefore, the binding of the application to the actual device should be tested. In iOS, a developer can use&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;identifierForVendor&lt;/code&gt;&lt;/span&gt;&lt;span&gt;, which is related to the bundle ID: the moment you change a bundle ID, the method will return a different value. When the app is ran for the first time, make sure you store the value returned by&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;identifierForVendor&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;to the KeyChain, so that changes to it can be detected at an early stage.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;&lt;span&gt;&lt;span&gt;In Android, the developer can use&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;Settings.Secure.ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;till Android 8.0 (API level 26) to identify an application instance. Note that starting at Android 8.0 (API level 26),&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;is no longer a device unique ID. Instead, it becomes scoped by the combination of app signing key, user and device. So validating&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;for device blocking could be tricky for these Android versions. Because if an app changes its signing key, the&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;will change and it won't be able to recognize old users devices. Therefore, it's better to store the&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;encrypted and privately in a private a shared preferences file using a randomly generated key from the&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;AndroidKeyStore&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;and preferably AES_GCM encryption. The moment the app signature changes, the application can check for a delta and register the new&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;ANDROID_ID&lt;/code&gt;&lt;/span&gt;&lt;span&gt;. The moment this new ID changes without a new application signing key, it should indicate that something else is wrong. Next, the device binding can be extended by signing requests with a key stored in the&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;Keychain&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;for iOS and in the&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;code&gt;KeyStore&lt;/code&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;in Android can reassure strong device binding. You should also test if using different IPs, different locations and/or different time-slots will trigger the right type of information in all scenarios.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Lastly, the blocking of the devices should be tested, by blocking a registered instance of the app and see if it is then no longer allowed to authenticate. Note: in case of an application which requires L2 protection, it can be a good idea to warn a user even before the first authentication on a new device. Instead: warn the user already when a second instance of the app is registered.&lt;/span&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.1" name="Implement detection and response functionalities for root detection" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Implement detection and response functionalities to detect rooted devices and if the device is rooted, the app shall respond in two ways:&amp;nbsp; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;The app notifies the user that their device is rooted and it's not secure to continue with the app.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Terminate the session and the app, because sensitive data is vulnerable.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Advanced Root Detection" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-root-detection-mstg-resilience-1"/>
            <reference name="OWASP MASVS - iOS - Testing Advanced Root Detection" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#jailbreak-detection-mstg-resilience-1"/>
          </references>
          <standards>
            <standard ref="8.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M8: Code Tampering" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M9: Reverse Engineering" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt;
                            &lt;li&gt;Check that the app has two or more functionalities with independent methods to
                            detect a rooted device.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that if the device is rooted, the user is alerted or the app is terminated.&lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.3" name="Implement functionality to alert when the app code changes" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Implement functionality to detect, notify and respond when the app is modified by executable files or by anti-debugging tools within its own sandbox. When the injection is detected the app shall alert the user and terminate the session.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing File Integrity Checks" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-file-integrity-checks-mstg-resilience-3"/>
            <reference name="OWASP MASVS - iOS - Testing Memory Integrity Checks" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#file-integrity-checks-mstg-resilience-3-and-mstg-resilience-11"/>
          </references>
          <standards>
            <standard ref="8.3" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.3" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;For the application source integrity checks, run the app on the device in an
                            unmodified state and make sure that everything works.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Then apply simple patches to the classes.dex and any .so libraries contained in
                            the app package. Re-package and re-sign the app.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check the app alerts the user and/or terminates the session.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.6" name="Implement functionality to detect and respond to, modifications of process memory" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create functionality to detect &amp;quot;hostile&amp;quot; code in its memory and respond
                        accordingly. Controls in this category verify the integrity of the app's own memory space, with
                        the goal of protecting against memory patches applied during runtime. This includes unwanted
                        changes to binary code or bytecode, functions pointer tables, and important data structures, as
                        well as rogue code loaded into process memory.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;div&gt;
                        Integrity can be verified either by:&amp;nbsp;
                        &lt;div&gt;
                        &lt;ul&gt;
                        &lt;li&gt;Comparing the contents of memory, or a checksum over the contents, with known good
                        values.&amp;nbsp;&lt;/li&gt;
                        &lt;li&gt;Searching memory for signatures of unwanted modifications.&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing File Integrity Checks" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-file-integrity-checks-mstg-resilience-3"/>
            <reference name="OWASP MASVS - iOS - Testing Memory Integrity Checks" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#file-integrity-checks-mstg-resilience-3-and-mstg-resilience-11"/>
          </references>
          <standards>
            <standard ref="8.6" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.6" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt;
                            &lt;li&gt;Disable all file-based detection of reverse engineering tools.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Then inject code using Xposed, Frida and Substrate, and attempt to install native
                            hooks and Java method hooks.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check that the app detects the &amp;quot;hostile&amp;quot; code in its memory and
                            responds accordingly.&lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.5" name="Implement functionality to detect if the app is being run inside an emulator" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create and implement functionality to detect when the app is being run inside an emulator. If
                        the app is running inside an emulator, the app shall terminate the session.
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Simple Emulator Detection" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-emulator-detection-mstg-resilience-5"/>
            <reference name="OWASP MASVS - iOS - Testing Simple Emulator Detection" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#testing-emulator-detection-mstg-resilience-5"/>
          </references>
          <standards>
            <standard ref="8.5" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.5" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;
                            &lt;li&gt;Install and run the app within an emulator.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check the app detects this and terminates the session.&lt;/li&gt;
                            &lt;/ol&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.4" name="Implement functionality to detect the presence of widely used reverse engineering tools" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Create functionality to detect the presence of widely used reverse engineering tools, such as
                        code injection tools, hooking frameworks and debugging servers. If any reverse engineering tool
                        is detected, the app shall force termination of the session.
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Detection of Reverse Engineering Tools" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-reverse-engineering-tools-detection-mstg-resilience-4"/>
            <reference name="OWASP MASVS - iOS - Testing Detection of Reverse Engineering Tools" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#testing-reverse-engineering-tools-detection-mstg-resilience-4"/>
          </references>
          <standards>
            <standard ref="8.4" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.4" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Launch the app systematically with various apps and frameworks installed, such as the
                            following:&amp;nbsp;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Substrate for Android&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Xposed&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Frida&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Introspy-Android&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Drozer&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;RootCloak&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Android SSL Trust Killer&amp;nbsp;&lt;/li&gt;
                            &lt;/ul&gt;The app should alert the user and/or terminate the app.
                            &lt;/div&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.2" name="Implement functionality to notify when debugging mechanisms are presented within the app" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Implement anti-debugging mechanisms to prohibit debug mode being activated. Anti-debugging
                        features can be preventive or reactive. As the name implies, preventive anti-debugging
                        techniques prevent the debugger from attaching in the first place, while reactive techniques
                        attempt to detect whether a debugger is present and react to it in some way (e.g. terminating
                        the app, or triggering some kind of hidden behavior).&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        The &amp;quot;more-is-better&amp;quot; rule applies: To maximize effectiveness, defenders
                        combine multiple methods of prevention and detection which operate on different API layers and
                        are distributed throughout the app.
                        &lt;/div&gt;
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Debugging Defenses" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-anti-debugging-detection-mstg-resilience-2"/>
            <reference name="OWASP MASVS - iOS - Testing Debugging Defenses" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#testing-anti-debugging-detection-mstg-resilience-2"/>
          </references>
          <standards>
            <standard ref="8.2" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.2" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M8: Code Tampering" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M9: Reverse Engineering" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check for the presence of anti-debugging mechanisms and verify if with the following
                            criteria the anti-debugging mechanisms are bypassed:&amp;nbsp;
                            &lt;div&gt;
                            &lt;ul&gt;
                            &lt;li&gt;Attaching JDB and ptrace based debuggers either fails or causes the app to
                            terminate or malfunction&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Multiple detection methods are scattered throughout the app (as opposed to putting
                            everything into a single method or function);&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;The anti-debugging defenses operate on multiple API layers (Java, native library
                            functions, Assembler/system calls);&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;The mechanisms show some level of originality (vs. copy/paste from StackOverflow
                            or other sources);&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;/div&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.992">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.4" name="Insert the condition DEVELOPER-MODE to remove the debugging code, log verbose errors or debugging messages in the production version" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Insert the policy in the if statement with DEVELOPER_MODE as condition. The DEVELOPER_MODE has
                        to be disabled for release build in order to disable StrictMode too.&amp;nbsp;
                        &lt;div&gt;
                        &lt;br /&gt;
                        &lt;/div&gt;
                        &lt;div&gt;
                        Remove the debugging code, log verbose errors or debugging messages in the production version.
                        &lt;/div&gt;
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing for Debugging Code and Verbose Error Logging" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#testing-for-debugging-code-and-verbose-error-logging-mstg-code-4"/>
            <reference name="OWASP MASVS - iOS - Verifying Compiler Settings" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#finding-debugging-code-and-verbose-error-logging-mstg-code-4"/>
          </references>
          <standards>
            <standard ref="7.4" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.4" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.4" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.4" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M10: Extraneous Functionality" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt;
                            &lt;li&gt;Check that there is only one method to activate the DEVELOPMENT_MODE.&lt;/li&gt;
                            &lt;li&gt;Check that the debugging code was removed.&lt;/li&gt;
                            &lt;/ul&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.9-8.12" name="Obfuscate all executable files, libraries, important code and data segments" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Obfuscation is the process of transforming code and data in order to make it more difficult to comprehend. It is an integral part of every software protection scheme. 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  If the goal of obfuscation is to protect sensitive computations, an obfuscation scheme is used that is both appropriate for the particular task and robust against manual and automated de-obfuscation methods, considering currently published research. The effectiveness of the obfuscation scheme must be verified through manual testing. Note that hardware-based isolation features are preferred over obfuscation whenever possible. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Advanced Obfuscation" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05j-testing-resiliency-against-reverse-engineering#testing-obfuscation-mstg-resilience-9"/>
            <reference name="OWASP MASVS - iOS - Testing Simple Obfuscation" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#testing-obfuscation-mstg-resilience-9"/>
          </references>
          <standards>
            <standard ref="8.12" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.12" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="8.9" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.9" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;Attempt to decompile the byte-code, disassemble any included library files, and perform static analysis. At the very least, the app's core functionality (i.e., the functionality meant to be obfuscated) shouldn't be easily discerned. Verify that&lt;/span&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;meaningful identifiers, such as class names, method names, and variable names, have been discarded,&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;string resources and strings in binaries are encrypted,&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
 &lt;li&gt; 
  &lt;div class="reset-3c756112--listItemContent-756c9114"&gt; 
   &lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;code and data related to the protected functionality is encrypted, packed, or otherwise concealed.&lt;/span&gt;&lt;/p&gt; 
  &lt;/div&gt;&lt;/li&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"&gt;For a more detailed assessment, you need a detailed understanding of the relevant threats and the obfuscation methods used.&lt;/span&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-6.7" name="Only JavaScript provided with the app code is allowed" issueId="" issueLink="" platform="" cost="1" risk="70" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>If native methods of the app are exposed to a WebView, verify that the WebView only renders JavaScript contained within the app package.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing Whether Java Objects Are Exposed Through WebViews" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05h-testing-platform-interaction#determining-whether-java-objects-are-exposed-through-webviews-mstg-platform-7"/>
          </references>
          <standards>
            <standard ref="6.7" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="6.7" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="6.7" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="6.7" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>- Produce a JavaScript payload.
                            - Inject it into the file that the app is requesting. The injection could be done either
                            through a MITM attack or by directly modifying the file in case it is stored on external
                            storage. The whole process could be done through Drozer that uses weasel (MWR's advanced
                            exploitation payload) which is able to install a full agent, injecting a limited agent into
                            a running process, or connecting a reverse shell to act as a Remote Access Tool (RAT).
                            - Check that only the JavaScript provided with the app is allowed.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-4.1" name="Perform authentication process on remote services" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  If the app provides users access to a remote service, some form of authentication, such as username/password authentication, is performed at the remote endpoint. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Authentication and Session Management Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements"/>
          </references>
          <standards>
            <standard ref="4.1" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.1" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="4.2" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="4.2" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="4.2" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="4.2" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M4: Insecure Authentication" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M6: Insecure Authorization" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.988">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.3" name="Remove or obfuscate the debugging symbols from native binaries" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>As a general rule of thumb, as little explanative information as possible should be provided
                        along with the compiled code. Some metadata such as debugging information, line numbers and
                        descriptive function or method names make the binary or bytecode easier to understand for the
                        reverse engineer, but isn't actually needed in a release build and can therefore be safely
                        discarded without impacting the functionality of the app.

                        This data shall be removed from the release version or shall be obfuscated in order to be
                        inaccessible to the reverse engineer.
                    </desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Verifying Compiler Settings" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#testing-for-debugging-symbols-mstg-code-3"/>
            <reference name="OWASP MASVS - iOS - Testing for Debugging Symbols" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#finding-debugging-symbols-mstg-code-3"/>
          </references>
          <standards>
            <standard ref="7.3" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.3" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.3" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.3" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>For Android:&amp;nbsp;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            Symbols are usually stripped during the build process, so you need the compiled byte-code
                            and libraries to verify whether any unnecessary metadata has been discarded. First find the
                            nm binary in your Android NDK and export it (or create an alias).
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            export $NM =
                            $ANDROID_NDK_DIR/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-nm&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;br /&gt;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            To display debug symbols:
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            $ $NM -a
                            libfoo.so/tmp/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-nm:
                            libfoo.so: no symbols&amp;nbsp;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;To display dynamic symbols:
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            $ $NM -D libfoo.so&amp;nbsp;
                            &lt;/blockquote&gt;Alternatively, open the file in your favorite disassembler and check the
                            symbol tables manually. Dynamic symbols can be stripped using the visibility compiler flag.
                            Adding this flag causes gcc to discard the function names while still preserving the names
                            of functions declared as JNIEXPORT.&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;br /&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            Check if the following was added to build.gradle:&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            externalNativeBuild { cmake { cppFlags &amp;quot;-fvisibility=hidden&amp;quot; } }&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;br /&gt;
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;For iOS:&amp;nbsp;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            Use gobjdump to inspect the main binary and any included dylibs for Stabs and DWARF symbols.
                            &lt;/div&gt;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;div&gt;
                            $ gobjdump --stabs --dwarf TargetApp&amp;nbsp;
                            &lt;/div&gt;
                            &lt;/blockquote&gt;In archive MyTargetApp:&amp;nbsp;
                            &lt;/blockquote&gt;
                            &lt;blockquote&gt;
                            &lt;blockquote&gt;
                            - armv5te: file format mach-o-arm - aarch64: file format mach-o-arm64 Gobjdump is part of
                            binutils and can be installed via Homebrew on Mac OS X.
                            &lt;/blockquote&gt;
                            &lt;/blockquote&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-6.1" name="Request only the minimum required permissions from the mobile operating system" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Security best practice dictates the practice of least-privilege is followed, thereby reducing the attack surface and risk of compromise. By limiting the access an application has to the system, developers may reduce the impact a compromise may have.&amp;nbsp; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Request only the minimum required permissions from the mobile operating system. For example, if there is no requirement to use the camera then the application should not request this permission. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Review features and functionality present in the application, in particular legacy features, to determine if they are relevant and required, and if not remove them and associated OS permissions. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Testing App Permissions" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide"/>
            <reference name="OWASP MASVS - iOS - Testing Custom URL Schemes" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-app-permissions-mstg-platform-1"/>
          </references>
          <standards>
            <standard ref="6.1" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="6.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="6.1" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="6.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M1: Improper Platform Usage" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M4: Insecure Authentication" supportedStandardRef="owasp-mobile-top-10-2016"/>
            <standard ref="M7: Client Code Quality" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>For Android applications:&amp;nbsp;
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Install the application and review the permissions the application is asking for.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Check they are actually needed.&lt;/li&gt;
                            &lt;/ol&gt;For iOS applications:&amp;nbsp;
                            &lt;/div&gt;
                            &lt;div&gt;
                            &lt;ol&gt;
                            &lt;li&gt;Install the application and use its main functionality, iOS will ask for the
                            permission when it is needed.&amp;nbsp;&lt;/li&gt;
                            &lt;li&gt;Verify those permissions requests are in accordance with the minimum set of
                            permissions needed by the application.&lt;/li&gt;
                            &lt;/ol&gt;
                            &lt;/div&gt;
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="use-analysis-static-code" name="Scan the code with static code analysis tools" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use periodically a static code analysis tool to analyze the code and detect potentially malicious code, such as time functions, unsafe file operations and networks connections. With the scanning of static code, we ensure the integrity of the application. 
&lt;/div&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="10.1.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.5" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.6" supportedStandardRef="owasp-asvs4-level-3"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  Verify that a code analysis tool is in use and it is configured to detect potentially malicious code, such as time functions, unsafe file operations and network connections. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-5.1-5.2" name="Secure channels with TLS" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  One of the core mobile app functions is sending/receiving data over untrusted networks like the Internet. If the data is not properly protected in transit, an attacker with access to any part of the network infrastructure (e.g., a Wi-Fi access point) may intercept, read, or modify it. This is why plaintext network protocols are rarely advisable. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  The vast majority of apps rely on HTTP for communication with the backend. HTTPS wraps HTTP in an encrypted connection (the acronym HTTPS originally referred to HTTP over Secure Socket Layer (SSL); SSL is the deprecated predecessor of TLS). TLS allows authentication of the backend service and ensures confidentiality and integrity of the network data. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Ensuring proper TLS configuration on the server side is also important. The SSL protocol is deprecated and should no longer be used. Also TLS v1.0 and TLS v1.1 have known vulnerabilities and their usage is deprecated in all major browsers by 2020. TLS v1.2 and TLS v1.3 are considered best practice for secure transmission of data. Starting with Android 10 (API level 29) TLS v1.3 will be enabled by default for faster and secure communication. The major change with TLS v1.3 is that customizing cipher suites is no longer possible and that all of them are enabled when TLS v1.3 is enabled, whereas Zero Round Trip (0-RTT) mode isn't supported. 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  When both the client and server are controlled by the same organization and used only for communicating with one another, you can increase security by hardening the configuration. 
&lt;/div&gt; 
&lt;div&gt;
  If a mobile application connects to a specific server, its networking stack can be tuned to ensure the highest possible security level for the server's configuration. Lack of support in the underlying operating system may force the mobile application to use a weaker configuration. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Verifying Data Encryption on the Network" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04f-testing-network-communication"/>
          </references>
          <standards>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="5.2" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="5.2" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="5.2" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="5.2" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M3: Insecure Communication" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  Intercept the tested app's incoming and outgoing network traffic and make sure that this traffic is encrypted. You can intercept network traffic in any of the following ways: 
&lt;/div&gt; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Capture all HTTP(S) and Websocket traffic with an interception proxy like OWASP ZAP or Burp Suite and make sure all requests are made via HTTPS instead of HTTP.&lt;/li&gt; 
  &lt;li&gt;Interception proxies like Burp and OWASP ZAP will show HTTP(S) traffic only. You can, however, use a Burp plugin such as Burp-non-HTTP-Extension or the tool mitm-relay to decode and visualize communication via XMPP and other protocols.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.8" name="Secure in the unmanaged code, the allocated memory, freed memory and used memory" issueId="" issueLink="" platform="" cost="1" risk="68" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Memory corruption bugs are a popular mainstay for hackers. This class of bug results from a programming error that causes the program to access an unintended memory location. Under the right conditions, attackers can capitalize on this behavior to hijack the execution flow of the vulnerable program and execute arbitrary code.&amp;nbsp; 
&lt;div&gt; 
 &lt;br&gt; 
&lt;/div&gt; 
&lt;div&gt;
  This kind of vulnerability occurs in a number of ways: 
 &lt;div&gt; 
  &lt;ul&gt; 
   &lt;li&gt;&lt;b&gt;Buffer overflows:&lt;/b&gt; This describes a programming error where an app writes beyond an allocated memory range for a particular operation. An attacker can use this flaw to overwrite important control data located in adjacent memory, such as function pointers. Buffer overflows were formerly the most common type of memory corruption flaw, but have become less prevalent over the years due to a number of factors. Notably, awareness among developers of the risks in using unsafe C library functions is now a common best practice plus, catching buffer overflow bugs is relatively simple. However, it is still worth testing for such defects.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;&lt;b&gt;Out-of-bounds-access: &lt;/b&gt;Buggy pointer arithmetic may cause a pointer or index to reference a position beyond the bounds of the intended memory structure (e.g. buffer or list). When an app attempts to write to an out-of-bounds address, a crash or unintended behavior occurs. If the attacker can control the target offset and manipulate the content written to some extent, code execution exploit is likely possible.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;&lt;b&gt;Dangling pointers:&lt;/b&gt; These occur when an object with an incoming reference to a memory location is deleted or deallocated, but the object pointer is not reset. If the program later uses the dangling pointer to call a virtual function of the already deallocated object, it is possible to hijack execution by overwriting the original vtable pointer. Alternatively, it is possible to read or write object variables or other memory structures referenced by a dangling pointer.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;&lt;b&gt;Use-after-free:&lt;/b&gt; This refers to a special case of dangling pointers referencing released (deallocated) memory. After a memory address is cleared, all pointers referencing the location become invalid, causing the memory manager to return the address to a pool of available memory. When this memory location is eventually re-allocated, accessing the original pointer will read or write the data contained in the newly allocated memory. This usually leads to data corruption and undefined behavior, but crafty attackers can set up the appropriate memory locations to leverage control of the instruction pointer.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;&lt;b&gt;Integer overflows: &lt;/b&gt;When the result of an arithmetic operation exceeds the maximum value for the integer type defined by the programmer, this results in the value "wrapping around" the maximum integer value, inevitably resulting in a small value being stored. Conversely, when the result of an arithmetic operation is smaller than the minimum value of the integer type, an integer underflow occurs where the result is larger than expected. Whether a particular integer overflow/underflow bug is exploitable depends on how the integer is used - for example, if the integer type were to represent the length of a buffer, this could create a buffer overflow vulnerability.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;&lt;b&gt;Format string vulnerabilities: &lt;/b&gt;When unchecked user input is passed to the format string parameter of the printf() family of C functions, attackers may inject format tokens such as '%c' and '%n' to access memory. Format string bugs are convenient to exploit due to their flexibility. Should a program output the result of the string formatting operation, the attacker can read and write to memory arbitrarily, thus bypassing protection features such as ASLR.&amp;nbsp;&lt;/li&gt; 
  &lt;/ul&gt; 
  &lt;b&gt;Remediation:&amp;nbsp;&lt;/b&gt; 
 &lt;/div&gt; 
 &lt;div&gt;
   A best practice to fix the Memory Corruption Bugs are the following:&amp;nbsp; 
 &lt;/div&gt; 
 &lt;div&gt; 
  &lt;ul&gt; 
   &lt;li&gt;When using integer variables for array indexing, buffer length calculations, or any other security-critical operation, verify that unsigned integer types are used and perform precondition tests to prevent the possibility of integer wrapping.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;Ensure the app does not use unsafe string functions such as strcpy, most other functions beginning with the "str" prefix, sprint, vsprintf, gets, etc.; If the app contains C++ code, ANSI C++ string classes are used; iOS apps written in Objective-C use NSString class. C apps on iOS should use CFString, the Core Foundation representation of a string. No untrusted data is concatenated into format strings.&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Testing for Memory Management Bugs" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/general-mobile-app-testing-guide/0x04h-testing-code-quality#memory-corruption-bugs-mstg-code-8"/>
          </references>
          <standards>
            <standard ref="7.8" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.8" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.8" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.8" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check if some of the different Memory Corruption bugs appear when you try to use them to
                            gain access to the system.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.990">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-8.8" name="Set the detection mechanism to trigger different alarms" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;span style="white-space: pre;"&gt;The detection mechanisms trigger responses of different types, including delayed and stealthy responses.&lt;/span&gt;</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Resilience Requirements" url="https://mobile-security.gitbook.io/masvs/security-requirements/0x15-v8-resiliency_against_reverse_engineering_requirements"/>
          </references>
          <standards>
            <standard ref="8.8" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="8.8" supportedStandardRef="OWASP-MASVS-L2+R"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.993">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="MASVS-7.1" name="Sign the app and provision with valid certificate with a properly protected key" issueId="" issueLink="" platform="" cost="1" risk="78" state="Recommended" owner="JamesRabe" library="OWASP-MASVS" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>Code signing your app assures users that it is from a known source and the app hasn't been modified since it was last signed. This process can prevent an app from being tampered with, or modified to include malicious code.</desc>
          <implementations/>
          <references>
            <reference name="OWASP MASVS - Android - Verifying That the App is Properly Signed" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05i-testing-code-quality-and-build-settings#making-sure-that-the-app-is-properly-signed-mstg-code-1"/>
            <reference name="OWASP MASVS - iOS - Verifying That the App is Properly Signed" url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06i-testing-code-quality-and-build-settings#making-sure-that-the-app-is-properly-signed-mstg-code-1"/>
          </references>
          <standards>
            <standard ref="7.1" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="7.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="7.1" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="7.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="M8: Code Tampering" supportedStandardRef="owasp-mobile-top-10-2016"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Check that the app is correctly signed.
                        </steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:06.989">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="GENERAL" name="General" desc="" library="OWASP-MASVS">
          <threats>
            <threat ref="CAPEC-133" name="An attacker attempts to invoke all common switches and options to discover weaknesses" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>An attacker attempts to invoke all common switches and options in the target
                                application for the purpose of discovering weaknesses in the target. For example, in
                                some applications, adding the --debug switch causes debugging information to be
                                displayed, which can sometimes reveal sensitive processing or configuration information
                                to an attacker.&amp;nbsp;
                                &lt;div&gt;
                                &lt;br /&gt;
                                &lt;/div&gt;
                                &lt;div&gt;
                                This attack differs from other forms of API abuse in that the attacker is blindly
                                attempting to invoke options in the hope that one of them will work rather than
                                specifically targeting a known option. Nonetheless, even if the attacker is familiar
                                with the published options of a targeted application this attack method may still be
                                fruitful as it might discover unpublicized functionality.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-215">
                  <countermeasures>
                    <countermeasure ref="MASVS-7.3" mitigation="15"/>
                    <countermeasure ref="MASVS-7.4" mitigation="5"/>
                    <countermeasure ref="MASVS-8.2" mitigation="5"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-489">
                  <countermeasures>
                    <countermeasure ref="MASVS-7.4" mitigation="5"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-656">
                  <countermeasures>
                    <countermeasure ref="MASVS-2.13" mitigation="5"/>
                    <countermeasure ref="MASVS-2.14" mitigation="5"/>
                    <countermeasure ref="MASVS-2.3" mitigation="5"/>
                    <countermeasure ref="MASVS-5.1-5.2" mitigation="5"/>
                    <countermeasure ref="MASVS-7.9" mitigation="5"/>
                    <countermeasure ref="MASVS-8.11" mitigation="5"/>
                    <countermeasure ref="MASVS-8.13" mitigation="5"/>
                    <countermeasure ref="MASVS-8.8" mitigation="5"/>
                    <countermeasure ref="MASVS-8.9-8.12" mitigation="5"/>
                  </countermeasures>
                </weakness>
                <weakness ref="MEMORY-LEAKAGE">
                  <countermeasures>
                    <countermeasure ref="MASVS-2.15" mitigation="5"/>
                    <countermeasure ref="MASVS-2.5" mitigation="5"/>
                    <countermeasure ref="MASVS-4.4" mitigation="5"/>
                  </countermeasures>
                </weakness>
                <weakness ref="OUTDATED-LIBRARIES">
                  <countermeasures>
                    <countermeasure ref="MASVS-1.9" mitigation="5"/>
                    <countermeasure ref="MASVS-5.6" mitigation="5"/>
                    <countermeasure ref="MASVS-7.5" mitigation="5"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-1.9" mitigation="5"/>
                <countermeasure ref="MASVS-2.13" mitigation="5"/>
                <countermeasure ref="MASVS-2.14" mitigation="5"/>
                <countermeasure ref="MASVS-2.15" mitigation="5"/>
                <countermeasure ref="MASVS-2.3" mitigation="5"/>
                <countermeasure ref="MASVS-2.5" mitigation="5"/>
                <countermeasure ref="MASVS-4.4" mitigation="5"/>
                <countermeasure ref="MASVS-5.1-5.2" mitigation="5"/>
                <countermeasure ref="MASVS-5.6" mitigation="5"/>
                <countermeasure ref="MASVS-7.3" mitigation="15"/>
                <countermeasure ref="MASVS-7.4" mitigation="5"/>
                <countermeasure ref="MASVS-7.5" mitigation="5"/>
                <countermeasure ref="MASVS-7.9" mitigation="5"/>
                <countermeasure ref="MASVS-8.11" mitigation="5"/>
                <countermeasure ref="MASVS-8.13" mitigation="5"/>
                <countermeasure ref="MASVS-8.2" mitigation="5"/>
                <countermeasure ref="MASVS-8.8" mitigation="5"/>
                <countermeasure ref="MASVS-8.9-8.12" mitigation="5"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="sec-vuln-dev-process" name="Application contains security vulnerabilities not identified during the development process" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>Application security should be embedded into a project's development environment, allowing developers to monitor their code regularly in order to avoid security vulnerabilities when the application is deployed in the production environment.</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references>
                <reference name="NIST Security Considerations in the System Development Life Cycle" url="https://csrc.nist.gov/publications/detail/sp/800-64/rev-2/archive/2008-10-16"/>
                <reference name="Risk-Based and Functional Security Testing" url="https://www.us-cert.gov/bsi/articles/best-practices/security-testing/risk-based-and-functional-security-testing"/>
              </references>
              <weaknesses>
                <weakness ref="CWE-494">
                  <countermeasures>
                    <countermeasure ref="MASVS-7.1" mitigation="34"/>
                    <countermeasure ref="MASVS-8.3" mitigation="33"/>
                  </countermeasures>
                </weakness>
                <weakness ref="lack-automated-vuln-identification">
                  <countermeasures>
                    <countermeasure ref="use-analysis-static-code" mitigation="33"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-7.1" mitigation="34"/>
                <countermeasure ref="MASVS-8.3" mitigation="33"/>
                <countermeasure ref="use-analysis-static-code" mitigation="33"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CAPEC-188" name="Attacker gains access to sensitive data by modifying the application's expected behavior" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>An attacker discovers the structure, function, and composition of an object, resource,
                                or system by using a variety of analysis techniques to effectively determine how the
                                analyzed entity was constructed or operates. The goal of reverse engineering is often to
                                duplicate the function, or a part of the function, of an object in order to duplicate or
                                &amp;quot;back engineer&amp;quot; some aspect of its functioning.&amp;nbsp;
                                &lt;div&gt;
                                &lt;br /&gt;
                                &lt;/div&gt;
                                &lt;div&gt;
                                Reverse engineering techniques can be applied to mechanical objects, electronic devices,
                                or software, although the methodology and techniques involved in each type of analysis
                                differ widely. When adversaries are reverse engineering software, methodologies fall
                                into two broad categories, 'white box' and 'black box.' White box techniques involve
                                methods which can be applied to a piece of software when an executable or some other
                                compiled object can be directly subjected to analysis, revealing at least a portion of
                                its machine instructions that can be observed upon execution.
                                &lt;/div&gt;
                                &lt;div&gt;
                                &lt;br /&gt;
                                &lt;/div&gt;
                                &lt;div&gt;
                                'Black Box' methods involve interacting with the software indirectly, in the absence of
                                the ability to measure, instrument, or analyze an executable object directly. Such
                                analysis typically involves interacting with the software at the boundaries of where the
                                software interfaces with a larger execution environment, such as input-output vectors,
                                libraries, or APIs.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality="25" integrity="25" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="MASVS-EMULATION-TOOLS">
                  <countermeasures>
                    <countermeasure ref="MASVS-8.5" mitigation="20"/>
                    <countermeasure ref="MASVS-8.7" mitigation="20"/>
                  </countermeasures>
                </weakness>
                <weakness ref="MASVS-REVERSE-ENGINEERING-TOOLS">
                  <countermeasures>
                    <countermeasure ref="MASVS-8.10" mitigation="20"/>
                    <countermeasure ref="MASVS-8.4" mitigation="20"/>
                    <countermeasure ref="MASVS-8.6" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-8.10" mitigation="20"/>
                <countermeasure ref="MASVS-8.4" mitigation="20"/>
                <countermeasure ref="MASVS-8.5" mitigation="20"/>
                <countermeasure ref="MASVS-8.6" mitigation="20"/>
                <countermeasure ref="MASVS-8.7" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CAPEC-122-MOBILE" name="Users lose trust in the application because it requests unnecessary privileges" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>If the mobile application requests permissions or access to components that are not
                                strictly needed by the application, then users can lose trust in the security of the
                                application with an associated impact on the trust placed in the application provider.
                            </desc>
              <riskRating confidentiality="50" integrity="50" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-250">
                  <countermeasures>
                    <countermeasure ref="MASVS-2.11" mitigation="20"/>
                    <countermeasure ref="MASVS-4.11" mitigation="20"/>
                    <countermeasure ref="MASVS-4.5-4.6" mitigation="20"/>
                    <countermeasure ref="MASVS-6.1" mitigation="20"/>
                    <countermeasure ref="MASVS-8.1" mitigation="20"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-2.11" mitigation="20"/>
                <countermeasure ref="MASVS-4.11" mitigation="20"/>
                <countermeasure ref="MASVS-4.5-4.6" mitigation="20"/>
                <countermeasure ref="MASVS-6.1" mitigation="20"/>
                <countermeasure ref="MASVS-8.1" mitigation="20"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="PROVIDE MOBILE ACCESS TO SERVICES" name="Provide mobile access to services" desc="" library="OWASP-MASVS">
          <threats>
            <threat ref="CAPEC-1" name="Accessing Functionality Not Properly Constrained by ACLs" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>&lt;p&gt;In applications, particularly web applications, access to functionality is mitigated by the authorization framework, whose job it is to map ACLs to elements of the application's functionality; particularly URL's for web-apps. In cases in which the administrator failed to specify an ACL for a particular element, an attacker may be able to access it with impunity. An attacker with the ability to access functionality not properly constrained by ACLs can obtain sensitive information and possibly compromise the entire application. Such an attacker could potentially access resources that should only be available to users of a higher privilege level, or access management sections of the application, or can run queries for data that he is otherwise not supposed to.&amp;nbsp;&lt;br&gt;&amp;nbsp;&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-732">
                  <countermeasures>
                    <countermeasure ref="MASVS-2.6" mitigation="25"/>
                    <countermeasure ref="MASVS-4.1" mitigation="25"/>
                    <countermeasure ref="MASVS-4.12" mitigation="25"/>
                    <countermeasure ref="MASVS-4.9" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-2.6" mitigation="25"/>
                <countermeasure ref="MASVS-4.1" mitigation="25"/>
                <countermeasure ref="MASVS-4.12" mitigation="25"/>
                <countermeasure ref="MASVS-4.9" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-WEBVIEW" name="Attackers gain access to the data through the WebView functionality" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>An attacker employs forceful browsing to access portions of a website that are
                                otherwise unreachable through direct URL entry.

                                Usually, a front controller or similar design pattern is employed to protect access to
                                portions of a web application.

                                Forceful browsing enables an attacker to access information, perform privileged
                                operations and otherwise reach sections of the web application that have been improperly
                                protected.
                            </desc>
              <riskRating confidentiality="75" integrity="50" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-749">
                  <countermeasures>
                    <countermeasure ref="MASVS-6.10" mitigation="25"/>
                    <countermeasure ref="MASVS-6.6" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-79">
                  <countermeasures>
                    <countermeasure ref="MASVS-6.7" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-83">
                  <countermeasures>
                    <countermeasure ref="MASVS-6.5" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-6.10" mitigation="25"/>
                <countermeasure ref="MASVS-6.5" mitigation="25"/>
                <countermeasure ref="MASVS-6.6" mitigation="25"/>
                <countermeasure ref="MASVS-6.7" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="7k-CWE-ErrorH" name="Attackers gain unauthorised access to the application through an error handling flaw" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>Errors and error handling represent a class of API. Errors related to error handling
                                are so common that they deserve a special kingdom of their own. As with API Abuse, there are two ways to introduce an error-related security vulnerability: the most common
                                one is handling errors poorly (or not at all). The second is producing errors that either give out too much information (to possible attackers) or are difficult to handle.
                            </desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-388">
                  <countermeasures>
                    <countermeasure ref="MASVS-7.6" mitigation="50"/>
                    <countermeasure ref="MASVS-7.7" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-7.6" mitigation="50"/>
                <countermeasure ref="MASVS-7.7" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CAPEC-100" name="Attackers gain unauthorised access to the application through buffer overflow flaws" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="OWASP-MASVS" editable="true">
              <desc>Buffer Overflow attacks target improper or missing bounds checking on buffer
                                operations, typically triggered by input injected by an attacker. As a consequence, an
                                attacker is able to write past the boundaries of allocated buffer regions in memory,
                                causing a program crash or potentially redirection of execution as per the attackers'
                                choice.
                            </desc>
              <riskRating confidentiality="100" integrity="100" availability="1" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-120">
                  <countermeasures>
                    <countermeasure ref="MASVS-7.8" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="MASVS-7.8" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="74cef105-10bd-4384-a895-41351c0ee6e5" diagramComponentId="93d1c20d-376d-4b08-bd57-224a398d01e3" ref="3744726d-db5e-42d5-8400-83b4419da7af" name="Store Secrets Secrets Manager - Sensitive data storage" desc="" library="Hydras-AWS-Foundation" parentComponentRef="e584374a-206f-43f5-a0ef-ace77965ea87" componentDefinitionRef="google-secret-manager">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AWS-Network-5.1" name="Insufficient resource identification" state="0" impact="100" issueId="" issueLink="">
          <desc>Resources are not registered in the safety net systems, and/or additional unidentified resources exist. As such, additional weakness might be introduced.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.315">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-522" name="Insufficiently Protected Credentials" state="0" impact="100" issueId="" issueLink="">
          <desc>This weakness occurs when the application transmits or stores
                    authentication credentials and uses an insecure method that is susceptible to
                    unauthorized interception and/or retrieval.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.314">
              <output/>
            </source>
            <references>
              <reference name="CWE-522: Insufficiently Protected Credentials" url="https://cwe.mitre.org/data/definitions/522.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AWS-IAM-2.7" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>Credentials for groups and roles not properly configured. User accounts are configured with excessive privileges.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.315">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="AWS-S3-7.3" name="Sensitive data is exposed in transit" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;p&gt;Sensitive data is not encrypted in transit with HTTPS or SSL, and is accessible while traversing the network.&lt;/p&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.314">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="C-AWS-SECRETS-MANAGER2" name="Configure AWS Secrets Manager to automatically rotate your secrets" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Configure AWS Secrets Manager to automatically rotate your secrets&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; You can configure AWS Secrets Manager to automatically rotate the secret for a secured service or database. Secrets Manager natively knows how to rotate secrets for supported Amazon RDS databases. However, Secrets Manager also can enable you to rotate secrets for other databases or third-party services. Because each service or database can have a unique way of configuring secrets, Secrets Manager uses a Lambda function you can customize to work with a selected database or service. You customize the Lambda function to implement the service-specific details of rotating a secret.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Network Requirements to Enable Rotation&lt;/p&gt; 
&lt;p&gt;To successfully enable rotation, you must correctly configure your network environment.&lt;/p&gt; 
&lt;p&gt;- The Lambda function must be able to communicate with the database. If you run your RDS database instance in a VPC, we recommend you configure your Lambda function to run in the same VPC. This enables direct connectivity between the rotation function and your service. To configure this, on the Lambda function details page, scroll down to the Network section and choose the VPC from the drop-down list to match the one your instance. You must also make sure the EC2 security groups attached to your instance enable communication between the instance and Lambda.&lt;/p&gt; 
&lt;p&gt;- The Lambda function must be able to communicate with the Secrets Manager service endpoint. If your Lambda rotation function can access an internet, either because you haven't configured the function to run in a VPC, or because the VPC has an attached NAT gateway, then you can use any of the available public endpoints for Secrets Manager. Alternatively, if you configure your Lambda function to run in a VPC without an internet access, then you can configure the VPC with a private Secrets Manager service endpoint.&lt;/p&gt; 
&lt;p&gt;Enabling and configuring rotation for a supported Amazon RDS database secret&lt;/p&gt; 
&lt;p&gt;Minimum permissions&lt;br&gt; To enable and configure rotation in the console, you must have permissions provided by the following managed policies:&lt;br&gt; - SecretsManagerReadWrite - Provides all of the Secrets Manager, Lambda, and AWS CloudFormation permissions.&lt;br&gt; - IAMFullAccess - Provides the IAM permissions required to create a role and attach a permission policy to it.&lt;/p&gt; 
&lt;p&gt;1. Sign in to the AWS Secrets Manager console.&lt;/p&gt; 
&lt;p&gt;2. Choose the name of the secret you want to enable rotation.&lt;/p&gt; 
&lt;p&gt;3. In the Configure automatic rotation section, choose Enable automatic rotation. This enables the other controls in this section.&lt;/p&gt; 
&lt;p&gt;4. For Select rotation interval, choose one of the predefined values-or choose Custom, and then type the number of days you want between rotations. If rotating your secret to meet compliance requirements, then AWS recommends you set this value to at least 1 day less than the compliance-mandated interval.&lt;/p&gt; 
&lt;p&gt;Secrets Manager schedules the next rotation when the previous one is complete. Secrets Manager schedules the date by adding the rotation interval (number of days) to the actual date of the last rotation. The service chooses the hour within that 24-hour date window randomly. The minute is also chosen somewhat randomly, but is weighted towards the top of the hour and influenced by a variety of factors that help distribute load.&lt;/p&gt; 
&lt;p&gt;Note&lt;br&gt; If you use the Lambda function provided by Secrets Manager to alternate between two users, the console uses this template if you choose the second "master secret" option in the next step, then you should set your rotation period to one-half of your compliance-specified minimum interval. Secrets Manager keeps the old credentials available, if not actively used, for one additional rotation cycle. Secrets Manager invalidates the old credentials only after updating the user with a new password after the second rotation.&lt;/p&gt; 
&lt;p&gt;If you modify the rotation function to immediately invalidate the old credentials after the new secret becomes active, then you can extend the rotation interval to your full compliance-mandated minimum. Leaving the old credentials active for one additional cycle with the AWSPREVIOUS staging label provides a last known good set of credentials you can use for fast recovery. If something happens to break the current credentials, you can simply move the AWSCURRENT staging label to the version with the AWSPREVIOUS label. Then your customers should be able to access the resource again.&lt;/p&gt; 
&lt;p&gt;5. Choose one of the following options:&lt;/p&gt; 
&lt;p&gt;- You want to create a new Lambda rotation function&lt;/p&gt; 
&lt;p&gt;a. Choose Create a new Lambda function to perform rotation.&lt;/p&gt; 
&lt;p&gt;b. For Lambda function name, enter the name to assign to the Lambda function Secrets Manager creates for you.&lt;/p&gt; 
&lt;p&gt;c. Specify the secret with credentials the rotation function can use. The credentials must contain permissions to update the user name and password on the protected database.&lt;/p&gt; 
&lt;p&gt;i. Use this secret: Choose this option if the credentials in this secret have permission in the database to change the password. Choosing this option causes Secrets Manager to create a Lambda function rotating secrets with a single user and changes the password with each rotation.&lt;/p&gt; 
&lt;p&gt;Considerations&lt;br&gt; Secrets Manager provides this option as a "lower availability" option. Sign-in failures can occur between the moment when rotation removes the old password and the moment when the updated password becomes accessible as the new version of the secret. This window of time may be very short-on the order of a second or less. If you choose this option, make sure your client applications implement an appropriate "backoff and retry with jitter" strategy in their code. The applications should generate an error only if sign-in fails several times over a longer period of time.&lt;/p&gt; 
&lt;p&gt;ii. Use a secret that I have previously stored in AWS Secrets Manager: Choose this option if the credentials in the current secret don't have permissions to update, or if you require high availability for the secret. To choose this option, you must create a separate master secret with credentials with permissions to update the secret credentials. Then choose the master secret from the list.&lt;/p&gt; 
&lt;p&gt;Choosing this option causes Secrets Manager to create a Lambda function that rotates secrets by creating a new user and password with each rotation, and deprecating the old user.&lt;/p&gt; 
&lt;p&gt;Considerations&lt;br&gt; Secrets Manager provides this option as the "high availability" option because the old version of the secret continues to operate and handle service requests while preparing and testing the new version. Secrets Manager doesn't deprecate the old version until after the clients switch to the new version. No downtime occurs while changing between versions.&lt;br&gt; This option requires the Lambda function to clone the permissions of the original user and apply them to the new user. The function then alternates between the two users with each rotation.&lt;br&gt; If you need to change the permissions granted to the users, ensure you change permissions for both users.&lt;/p&gt; 
&lt;p&gt;- You want to use a Lambda function you already created for another secret&lt;/p&gt; 
&lt;p&gt;a. Choose Use an existing Lambda function to perform rotation.&lt;/p&gt; 
&lt;p&gt;b. Choose the Lambda function from the drop-down list.&lt;/p&gt; 
&lt;p&gt;c. Specify the type of rotation function:&lt;/p&gt; 
&lt;p&gt;i. Single-user rotation: A rotation function for a secret that stores credentials for a user with permissions to change their password. Secrets Manager creates this is the type of function when you choose the option Use this secret.&lt;/p&gt; 
&lt;p&gt;ii. Multi-user rotation: A rotation function for a secret that stores credentials for a user that can't change their password. The function requires a separate master secret that stores credentials for a user with permission to change the credentials for this secret user. Secrets Manager creates this type of function when you choose the option Use a secret that I have previously stored in AWS Secrets Manager.&lt;/p&gt; 
&lt;p&gt;d. If you specified the second "master secret" option, then you must also choose the secret to provide the master user credentials. The credentials in the master secret must have permission to update the credentials stored in this secret.&lt;/p&gt; 
&lt;p&gt;6. Choose Save to store your changes and to trigger the initial rotation of the secret.&lt;/p&gt; 
&lt;p&gt;If you don't have an ARN for a Lambda function assigned to the secret, Secrets Manager creates the function, assigns all required permissions, and configures the function to work with your database. Secrets Manager counts down the number of days specified in the rotation interval. When the interval reaches zero, Secrets Manager rotates the secret again and resets the interval for the next cycle. This continues until you disable rotation.&lt;/p&gt; 
&lt;p&gt;For more information please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; Enabling rotation causes the secret to rotate once immediately when you save the secret. Before you enable rotation, be sure you update all of your applications using this secret credentials to retrieve the secret from Secrets Manager. The original credentials might not be usable after the initial rotation. Any applications you fail to update break as soon as the old credentials become invalid.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Rotating Your AWS Secrets Manager Secrets" url="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html"/>
          </references>
          <standards>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;To ensure that automatic rotation is enabled for a secret (Console):&lt;/p&gt;

	&lt;p&gt;1. Sign in to the AWS Secrets Manager console.&lt;/p&gt;

	&lt;p&gt;2. Choose the name of the secret you want to view.&lt;/p&gt;

	&lt;p&gt;3. Ensure that Enable automatic rotation option is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-AWS-SECRETS-MANAGER1" name="Control access to AWS Secrets Manager" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control access to AWS Secrets Manager&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; An AWS account owns all of AWS resources, including the secrets you store in AWS Secrets Manager. AWS contains permissions policies to create or access the resources. An account administrator can control access to AWS resources by attaching permissions policies directly to the resources, the secrets, or to the IAM identities, users, groups, and roles, needing to access the resources.&lt;br&gt; You can use either secret-based or identity-based permission policies for Secrets Manager. Secrets Manager groups together all of the applied policies and processes as one large policy.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Identity-based policies example&lt;/p&gt; 
&lt;p&gt;The following example policy can be attached to a user, group, or role. The policy allows the affected user or role to perform the DescribeSecret and GetSecretValue operations in your account only on secrets with a name beginning with the path "TestEnv/". The policy also restricts the user or role to retrieving only the version of the secret with the staging label AWSCURRENT attached. Replace the  and  placeholders in the following examples with your actual values.&lt;/p&gt; 
&lt;p&gt;{ "Version": "2012-10-17", "Statement": [ { "Sid" : "Stmt1DescribeSecret", "Effect": "Allow", "Action": [ "secretsmanager:DescribeSecret" ], "Resource": "arn:aws:secretsmanager:::secret:TestEnv/*" }, { "Sid" : "Stmt2GetSecretValue", "Effect": "Allow", "Action": [ "secretsmanager:GetSecretValue" ], "Resource": "arn:aws:secretsmanager:::secret:TestEnv/*", "Condition" : { "ForAnyValue:StringLike" : { "secretsmanager:VersionStage" : "AWSCURRENT" } } } ]&lt;br&gt; }&lt;/p&gt; 
&lt;p&gt;Resource-based policies example&lt;/p&gt; 
&lt;p&gt;The following example describes a Secrets Manager secret policy with one statement. The statement allows the administrator of account 123456789012 to delegate permissions to users and roles in that account. The policy limits the permissions the administrator can delegate to the secretsmanager:GetSecretValue action on a single secret named "prod/ServerA-a1b2c3". The condition ensures the user can retrieve only the current version of the secret.&lt;/p&gt; 
&lt;p&gt;{ "Version" : "2012-10-17", "Statement" : [ { "Effect": "Allow", "Principal": {"AWS": "arn:aws:iam::123456789012:root" }, "Action": "secretsmanager:GetSecretValue", "Resource": "arn:aws:secretsmanager:::secret:prod/ServerA-a1b2c3", "Condition": { "ForAnyValue:StringEquals": { "secretsmanager:VersionStage" : "AWSCURRENT" } } } ]&lt;br&gt; }&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; When an IAM principal from one account accesses a secret in a different account, the secret must be encrypted by using a custom AWS KMS CMK. A secret encrypted with the default Secrets Manager CMK for the account can be decrypted only by principals in that account. A principal from a different account must be granted permission to both the secret and to the custom AWS KMS CMK.&lt;/p&gt; 
&lt;p&gt;As an alternative, you can grant the user cross-account access to assume an IAM role in the same account as the secret. Because the role exists in the same account as the secret, the role can access secrets encrypted with the default AWS KMS key for the account.&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Managing access to resources with policies" url="https://docs.aws.amazon.com/secretsmanager/latest/userguide/auth-and-access_resource-access.html"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;With the IAM policy simulator, you can test and troubleshoot identity-based policies, IAM permissions boundaries, Organizations service control policies, and resource-based policies.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-AWS-SECRETS-MANAGER3" name="Create alarms for AWS Secrets Manager" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alarms for AWS Secrets Manager&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Secrets Manager can work with CloudWatch Events to trigger alerts when administrator-specified operations occur in an organization. For example, because of the sensitivity of such operations, administrators might want to be warned of deleted secrets or secret rotation. You might want an alert if anyone tries to use a secret version in the waiting period to be deleted. You can configure CloudWatch Events rules that look for these operations and then send the generated events to administrator defined "targets". A target could be an Amazon SNS topic that emails or text messages to subscribers. You can also create a simple AWS Lambda function triggered by the event, which logs the details of the operation for your later review.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Example - Monitoring secret versions scheduled for deletion&lt;/p&gt; 
&lt;p&gt;You can use a combination of AWS CloudTrail, Amazon CloudWatch Logs, and Amazon Simple Notification Service (Amazon SNS) to create an alarm that notifies you of any attempts to access a version of a secret pending deletion.&lt;/p&gt; 
&lt;p&gt;Part 1: Configuring CloudTrail log file delivery to CloudWatch logs&lt;/p&gt; 
&lt;p&gt;You must configure delivery of your CloudTrail log files to CloudWatch Logs. You do this so CloudWatch Logs can monitor them for Secrets Manager API requests to retrieve a version of a secret pending deletion.&lt;/p&gt; 
&lt;p&gt;To configure CloudTrail log file delivery to CloudWatch Logs&lt;/p&gt; 
&lt;p&gt;1. Open the CloudTrail console.&lt;/p&gt; 
&lt;p&gt;2. On the top navigation bar, choose the AWS Region to monitor secrets.&lt;/p&gt; 
&lt;p&gt;3. In the left navigation pane, choose Trails, and then choose the name of the trail to configure for CloudWatch.&lt;/p&gt; 
&lt;p&gt;4. On the Trails Configuration page, scroll down to the CloudWatch Logs section, and then choose the edit icon ( ).&lt;/p&gt; 
&lt;p&gt;5. For New or existing log group, type a name for the log group, such as CloudTrail/MyCloudWatchLogGroup.&lt;/p&gt; 
&lt;p&gt;6. For IAM role, you can use the default role named CloudTrail_CloudWatchLogs_Role. This role has a default role policy with the required permissions to deliver CloudTrail events to the log group.&lt;/p&gt; 
&lt;p&gt;7. Choose Continue to save your configuration.&lt;/p&gt; 
&lt;p&gt;8. On the AWS CloudTrail will deliver CloudTrail events associated with API activity in your account to your CloudWatch Logs log group page, choose Allow.&lt;/p&gt; 
&lt;p&gt;Part 2: Create the CloudWatch alarm&lt;/p&gt; 
&lt;p&gt;To receive a notification when a Secrets Manager GetSecretValue API operation requests to access a version of a secret pending deletion, you must create a CloudWatch alarm and configure notification.&lt;/p&gt; 
&lt;p&gt;Creating a CloudWatch alarm to monitors usage of a version of a secret pending deletion&lt;/p&gt; 
&lt;p&gt;1. Sign in to the CloudWatch console.&lt;/p&gt; 
&lt;p&gt;2. On the top navigation bar, choose the AWS Region where you want to monitor secrets.&lt;/p&gt; 
&lt;p&gt;3. In the left navigation pane, choose Logs.&lt;/p&gt; 
&lt;p&gt;4. In the list of Log Groups, select the check box next to the log group you created in the previous procedure, such as CloudTrail/MyCloudWatchLogGroup. Then choose Create Metric Filter.&lt;/p&gt; 
&lt;p&gt;5. For Filter Pattern, type or paste the following:&lt;/p&gt; 
&lt;p&gt;{ $.eventName = "GetSecretValue" &amp;amp;&amp;amp; $.errorMessage = "&lt;strong&gt;secret because it was marked for deletion&lt;/strong&gt;" }&lt;/p&gt; 
&lt;p&gt;Choose Assign Metric.&lt;/p&gt; 
&lt;p&gt;6. On the Create Metric Filter and Assign a Metric page, do the following:&lt;/p&gt; 
&lt;p&gt;a. For Metric Namespace, type CloudTrailLogMetrics.&lt;/p&gt; 
&lt;p&gt;b. For Metric Name, type AttemptsToAccessDeletedSecrets.&lt;/p&gt; 
&lt;p&gt;c. Choose Show advanced metric settings, and then if necessary for Metric Value, type 1.&lt;/p&gt; 
&lt;p&gt;d. Choose Create Filter.&lt;/p&gt; 
&lt;p&gt;7. In the filter box, choose Create Alarm.&lt;/p&gt; 
&lt;p&gt;8. In the Create Alarm window, do the following:&lt;/p&gt; 
&lt;p&gt;a. For Name, type AttemptsToAccessDeletedSecretsAlarm.&lt;/p&gt; 
&lt;p&gt;b. Whenever:, for is:, choose &amp;gt;=, and then type 1.&lt;/p&gt; 
&lt;p&gt;c. Next to Send notification to:, do one of the following:&lt;/p&gt; 
&lt;p&gt;- To create and use a new Amazon SNS topic, choose New list, and then type a new topic name. For Email list:, type at least one email address. You can type more than one email address by separating them with commas.&lt;/p&gt; 
&lt;p&gt;- To use an existing Amazon SNS topic, choose the name of the topic to use. If a list doesn't exist, choose Select list.&lt;/p&gt; 
&lt;p&gt;d. Choose Create Alarm.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Monitoring the use of your AWS Secrets Manager secrets" url="https://docs.aws.amazon.com/secretsmanager/latest/userguide/monitoring.html"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="29" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="30" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API10:2019-Insufficient Logging &amp; Monitoring" supportedStandardRef="owasp-api-security-top-10"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;To test alarm example of the Remediation section:&lt;/p&gt;

	&lt;p&gt;Create a version of a secret and then schedule it for deletion. Then, try to retrieve the secret value. You shortly receive an email at the address configured in the alarm. It alerts you to the use of a secret version scheduled for deletion.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="AWS-CLOUDTRAIL2" name="Log to a dedicated and centralized cloud storage" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;&lt;br&gt;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Security Best Practices in AWS CloudTrail" url="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html"/>
            <reference name="Security OU - Log Archive account" url="https://docs.aws.amazon.com/prescriptive-guidance/latest/security-reference-architecture/log-archive.html"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;br&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.244">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-AWS-SECRETS-MANAGER4" name="Maintain inter-network traffic privacy for AWS Secrets Manager" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Maintain inter-network traffic privacy for AWS Secrets Manager&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Maintain privacy when routing traffic through known and private network routes.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Traffic Between Service and On-Premises Clients and Applications&lt;/p&gt; 
&lt;p&gt;You have two connectivity options between your private network and AWS Secrets Manager:&lt;br&gt; - An AWS Site-to-Site VPN connection.&lt;br&gt; - An AWS Direct Connect connection.&lt;br&gt; For more information please see Reference URLs.&lt;/p&gt; 
&lt;p&gt;Traffic Between AWS Resources in the Same Region&lt;/p&gt; 
&lt;p&gt;If want to secure traffic between Secrets Manager and API clients in AWS, set up an AWS PrivateLink to privately access Secrets Manager API endpoints.&lt;br&gt; For more information please see Reference URLs.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="AWS PrivateLink" url="https://aws.amazon.com/privatelink"/>
            <reference name="Data Protection in AWS Secrets Manager" url="https://docs.aws.amazon.com/secretsmanager/latest/userguide/data-protection.html"/>
            <reference name="What is AWS Direct Connect?" url="https://docs.aws.amazon.com/directconnect/latest/UserGuide/Welcome.html"/>
            <reference name="What is AWS Site-to-Site VPN?" url="https://docs.aws.amazon.com/vpn/latest/s2svpn/VPC_VPN.html"/>
          </references>
          <standards/>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Ensure you are maintaining inter-network traffic privacy for AWS Secrets Manager.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="aws-tier-5.1" name="Tag all resources" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="additional-gcp-components v2" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
 &lt;b&gt;Description&lt;/b&gt;:
&lt;/div&gt;
&lt;div&gt;
 &lt;br&gt;
  Tags enable customers to categorize AWS resources in different ways, for example, by purpose, owner, or environment.
&lt;/div&gt;
&lt;div&gt;
 &lt;br&gt;
  Each tag consists of a key and an optional value, both of which customer's define.
  You should define a set of tags for the following items to help you track each instance's owner and operating environment, cost center, and other items.
&lt;/div&gt;
&lt;div&gt;
 &lt;ol&gt;
  &lt;li&gt;Amazon EC2 instances&lt;/li&gt;
  &lt;li&gt;ELB&lt;/li&gt;
  &lt;li&gt;EBS Volumes&lt;/li&gt;
  &lt;li&gt;S3 Buckets&lt;/li&gt;
 &lt;/ol&gt;
&lt;/div&gt;
&lt;div&gt;
 &lt;br&gt;
  A resource may have up to 10 tags associated with key &amp;amp; value such as:
&lt;/div&gt;
&lt;div&gt;
 &lt;ul&gt;
  &lt;li&gt;Key=tier, Value=app&lt;/li&gt;
  &lt;li&gt;Key=environment, Value=production&lt;/li&gt;
  &lt;li&gt;Key=costcenter, Value=sales&lt;/li&gt;
 &lt;/ul&gt;
 &lt;div&gt;
  &lt;b&gt;Remediation:&lt;/b&gt;
 &lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
 &lt;b&gt;&lt;br&gt;&lt;/b&gt;
  Tag all your 3 tier Web Application resources based on their tier membership (Web, App, Data), and your organizational requirements.
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="PCI Cloud Compliance" url="http://d0.awsstatic.com/whitepapers/compliance/AWS_Anitian_Wookbook_PCI_Cloud_Compliance.pdf"/>
            <reference name="Resource groups and tagging" url="https://aws.amazon.com/blogs/aws/resource-groups-and-tagging/"/>
          </references>
          <standards>
            <standard ref="5.1" supportedStandardRef="cis-amazon-web-services-three-tier-web-architecture-benchmark"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>Verify tags are being used.&amp;nbsp;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:11.245">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="authorization" name="Authorization" desc="" library="additional-gcp-components v2">
          <threats>
            <threat ref="AWS-LOSS-CONTROL-ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="additional-gcp-components v2" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized access to the control of the environment, due to improper definition and configuration of user accounts or role groups.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AWS-IAM-2.7">
                  <countermeasures>
                    <countermeasure ref="AWS-CLOUDTRAIL2" mitigation="33"/>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="AWS-CLOUDTRAIL2" mitigation="33"/>
                <countermeasure ref="C-AWS-SECRETS-MANAGER1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="general" name="General" desc="" library="additional-gcp-components v2">
          <threats>
            <threat ref="ACCESS-TO-DATA-AWS" name="Sensitive data is compromised through unauthorized access to data" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="additional-gcp-components v2" editable="true">
              <desc>&lt;p&gt;Attackers can gain access to sensitive data when the data is in transit in clear text, or when the data is stored without encryption.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-522">
                  <countermeasures>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER2" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-AWS-SECRETS-MANAGER2" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="logging-and-monitoring" name="Logging and Monitoring" desc="" library="additional-gcp-components v2">
          <threats>
            <threat ref="exploitation-of-insufficient-logging-and-monitoring" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="additional-gcp-components v2" editable="true">
              <desc>&lt;span style="color: rgb(6, 76, 121); font-family: SourceSansPro, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);"&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.&lt;/span&gt; 
&lt;br&gt;&lt;span style="color: rgb(6, 76, 121); font-family: SourceSansPro, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);"&gt;Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/span&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER3" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-AWS-SECRETS-MANAGER3" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="OWASP A10:2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Hydras-AWS-Foundation" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident.&lt;br /&gt;
 Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER3" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-AWS-SECRETS-MANAGER3" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="networking" name="Networking" desc="" library="additional-gcp-components v2">
          <threats>
            <threat ref="an-attacker-eavesdrops-on-the-communication-between-the-client-and-server-and-decrypts-the-data" name="An attacker eavesdrops on the communication between the client and server and decrypts the data" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="additional-gcp-components v2" editable="true">
              <desc>&lt;span style="color: rgb(6, 76, 121); font-family: SourceSansPro, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);"&gt;Eavesdropping on communication is a network attack that captures network packets transmitted by other computers and reads the data content. This type of network attack is most effective when weak encryption services are used. An attacker could eavesdrop on the communication between the client and server and decrypt the encrypted data.&lt;/span&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AWS-S3-7.3">
                  <countermeasures>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER4" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-AWS-SECRETS-MANAGER4" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="EAVESDROPPING-COMMUNICATIONS" name="An attacker eavesdrops on the communication between the client and server and decrypts the data" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Hydras-AWS-Foundation" editable="true">
              <desc>&lt;p&gt;Eavesdropping on communication is a network attack that captures network packets transmitted by other computers and reads the data content. This type of network attack is most effective when weak encryption services are used. An attacker could eavesdrop on the communication between the client and server and decrypt the encrypted data.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AWS-S3-7.3">
                  <countermeasures>
                    <countermeasure ref="C-AWS-SECRETS-MANAGER4" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-AWS-SECRETS-MANAGER4" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="attackers-gain-unauthorized-network-access" name="Attackers gain unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="additional-gcp-components v2" editable="true">
              <desc>&lt;span style="color: rgb(6, 76, 121); font-family: SourceSansPro, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);"&gt;Attackers could gain unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/span&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AWS-Network-5.1">
                  <countermeasures>
                    <countermeasure ref="aws-tier-5.1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="aws-tier-5.1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="UNAUTHORIZED-CONECTIONS-AWS" name="Attackers gain unauthorized network access" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Hydras-AWS-Foundation" editable="true">
              <desc>&lt;p&gt;Attackers could gain unauthorized network access to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="AWS-Network-5.1">
                  <countermeasures>
                    <countermeasure ref="aws-tier-5.1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="aws-tier-5.1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="08712012-4700-4226-bbaf-696f5685e5c1" diagramComponentId="1e29202b-b874-4edf-8eae-83098f22f83a" ref="476349e5-337c-4c19-ab7c-34bca3626737" name="GCP Run" desc="" library="IR-Dataflows" parentComponentRef="3d864622-5588-4925-a2cd-ac0e382b8bf5" componentDefinitionRef="CD-GOOGLE-CLOUD-RUN">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-937" name="Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" state="0" impact="100" issueId="" issueLink="">
          <desc>In theory, it ought to be easy to figure out if you are currently using any vulnerable
                        components or libraries. Unfortunately, vulnerability reports for commercial or open source
                        software do not always specify exactly which versions of a component are vulnerable in a
                        standard, searchable way. Further, not all libraries use an understandable version numbering
                        system. Worst of all, not all vulnerabilities are reported to a central clearing house that is
                        easy to search, although sites like CVE and NVD are becoming easier to search.

                        Determining if you are vulnerable requires searching these databases, as well as keeping abreast
                        of project mailing lists and announcements for anything that might be a vulnerability. If one of
                        your components does have a vulnerability, you should carefully evaluate whether you are
                        actually vulnerable by checking to see if your code uses the part of the component with the
                        vulnerability and whether the flaw could result in an impact you care about.

                        Component vulnerabilities can cause almost any type of risk imaginable, ranging from the trivial
                        to sophisticated malware designed to target a specific organization. Components almost always
                        run with the full privilege of the application, so flaws in any component can be serious.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.582">
              <output/>
            </source>
            <references>
              <reference name="CWE-937: Components, libraries, modules, frameworks, platform, and operating systems contain known security weaknesses" url="https://cwe.mitre.org/data/definitions/937.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-89" name="Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')" state="0" impact="100" issueId="" issueLink="">
          <desc>&lt;p&gt;The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&lt;br&gt;Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted and executed as SQL instead of ordinary user data. This can be leveraged to alter query logic in order to bypass security checks, or to insert additional statements that modify the back-end database, possibly including execution of system commands. SQL injection has become a common issue with database-driven web sites. The flaw is relatively easily detected, and often easily exploited, and as such, any site or software package with even a minimal user base is likely to be subject to an attempted automated attack of this kind. This flaw depends on the fact that SQL makes no real distinction between the control and data planes.&lt;/p&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.810">
              <output/>
            </source>
            <references>
              <reference name="CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')" url="https://cwe.mitre.org/data/definitions/89.html"/>
              <reference name="OWASP Testing Guide" url="https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#Standard_SQL_Injection_Testing"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-778" name="Insufficient Logging" state="0" impact="100" issueId="" issueLink="">
          <desc>When a critical security event occurs, the software either does not record the event or omits important details about the event when logging it. When critical security events are not logged properly, such as in the case of a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analyses after a successful attack.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.582">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE_IAM-02" name="Misconfigured credentials for groups and roles" state="0" impact="100" issueId="" issueLink="">
          <desc>The credentials for the groups and roles are incorrectly configured and there are user accounts with more privileges than necessary.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.582">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA" name="Sensitive data is accessible" state="0" impact="100" issueId="" issueLink="">
          <desc>Sensitive data is not encrypted and is exposed.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.582">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="SYSTEM-VUL-DOS" name="System is vulnerable to a denial of service attack" state="0" impact="100" issueId="" issueLink="">
          <desc>Attackers can perform a successful denial of service on the system</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.582">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="GOOGLE-NET-01" name="Unauthorized connection attempts on open ports" state="0" impact="100" issueId="" issueLink="">
          <desc>Receiving unauthorized connections to open ports is most likely an attack. To avoid this, access to the network must be as restricted as possible, so that only the necessary ports are open and the minimum inbound traffic is accepted.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.581">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN1" name="Control access to Cloud Run using IAM access control" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Control access to Cloud Run using IAM access control&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, only project owners and editors can create, update, delete, or invoke services, and only project owners and Cloud Run Admins can modify Identity and Access Management (IAM) policies - for example, make a service public.&lt;br&gt; To grant other users or groups the ability to perform these actions, you can use IAM to grant roles to different members.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Controlling access on an individual service&lt;/p&gt; 
&lt;p&gt;If you want to control access on a per-service basis, you can use per-service IAM.&lt;/p&gt; 
&lt;p&gt;Making a service public&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to make public.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. In the Add members field, allUsers&lt;/p&gt; 
&lt;p&gt;5. Select the Cloud Run Invoker role from the Select a role drop-down menu.&lt;/p&gt; 
&lt;p&gt;6. Click Add.&lt;/p&gt; 
&lt;p&gt;When creating a new service, you will be prompted if you want to "allow unauthenticated access." Answering yes will perform the actions above to make the service publicly available. Answering no will leave the service private.&lt;/p&gt; 
&lt;p&gt;Domain Restricted Sharing&lt;/p&gt; 
&lt;p&gt;If the project is subject to the domain restricted sharing constraint in an organization policy, you will be unable to create public services. Google Cloud recommends that you create all projects in a folder not subject to this restriction, and remove it on existing projects by restoring the default constraint on the project.&lt;/p&gt; 
&lt;p&gt;Adding users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to add users to.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. In the Add members field, enter one or more identities that need access to your service.&lt;/p&gt; 
&lt;p&gt;5. Select a role (or roles) from the Select a role drop-down menu. The roles you select appear in the pane with a short description of the permissions they grant.&lt;/p&gt; 
&lt;p&gt;6. Click Add.&lt;/p&gt; 
&lt;p&gt;Removing users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to remove users from.&lt;/p&gt; 
&lt;p&gt;Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;Search for the user you want to remove, or expand a role the user has.&lt;/p&gt; 
&lt;p&gt;Click the delete trash can next to the member type within the role to remove the role from the member.&lt;/p&gt; 
&lt;p&gt;Bulk addition or removal of users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to add users to or remove users from.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;If you want to add users:&lt;/p&gt; 
&lt;p&gt;1. In the Add members field, enter multiple identities that need access to your service.&lt;/p&gt; 
&lt;p&gt;2. Select a role (or roles) from the Select a role drop-down menu. The roles you select appear in the pane with a short description of the permissions they grant.&lt;/p&gt; 
&lt;p&gt;3. Click Add.&lt;/p&gt; 
&lt;p&gt;If you want to remove users:&lt;/p&gt; 
&lt;p&gt;1. Search for the user you want to remove, or expand a role the user has.&lt;/p&gt; 
&lt;p&gt;2. Click the delete trash can next to the member type within the role to remove the role from the member.&lt;/p&gt; 
&lt;p&gt;Viewing users&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Select the service you want to view users and roles.&lt;/p&gt; 
&lt;p&gt;3. Click Show Info Panel in the top right corner to show the Permissions tab.&lt;/p&gt; 
&lt;p&gt;4. All users will be shown, grouped by role granted.&lt;/p&gt; 
&lt;p&gt;Controlling access on all services in a project&lt;/p&gt; 
&lt;p&gt;If you want to grant roles to members on all services in a project, you can use project-level IAM.&lt;/p&gt; 
&lt;p&gt;1. Go to the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Find the user you want to grant a project-wide role.&lt;/p&gt; 
&lt;p&gt;3. Click the edit Pencil on the right side of the user's row.&lt;/p&gt; 
&lt;p&gt;4. Click Add another role and pick the desired role.&lt;/p&gt; 
&lt;p&gt;5. Click save.&lt;/p&gt; 
&lt;p&gt;Note: the allUsers and allAuthenticatedUsers member types can't be applied at the project level, and instead must be added to each service individually.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Access control with IAM" url="https://cloud.google.com/debugger/docs/iam"/>
            <reference name="Cloud Run IAM roles" url="https://cloud.google.com/run/docs/reference/iam/roles"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Testing permissions&lt;/p&gt;

	&lt;p&gt;Most Google Cloud resources expose the testIamPermissions() method, which allows you to programmatically check whether the currently authenticated caller has been granted one or more specific IAM permissions on the resource. The testIamPermissions() method takes a resource identifier and a set of permissions as input parameters, and returns the set of permissions that the caller is allowed.&lt;/p&gt;

	&lt;p&gt;You can use the testIamPermissions() method to determine whether a user should have access to an administrative tool in a web application. For example, you can use this method to decide, based on the user's permissions, whether to display detailed information about a Google Cloud resource.&lt;/p&gt;

	&lt;p&gt;Note: If you need to test a permission so that you can troubleshoot access to a resource, use the Policy Troubleshooter instead.&lt;/p&gt;

	&lt;p&gt;For example, to determine if the currently authenticated user has the permission to delete a project, call the projects.testIamPermissions() method by providing the project ID (such as foo-project) and the resourcemanager.projects.delete permission as input parameters. If the caller has been granted the resourcemanager.projects.delete permission, it will be listed in the response body. If the caller does not have this permission, the response body will list no permissions.&lt;/p&gt;

	&lt;p&gt;The testIamPermissions() method is intended for third-party graphical user interfaces (GUIs) that need to display Google Cloud resources based on what the authenticated user has permissions to see. For example, the Cloud Console internally uses the testIamPermissions() method to determine what resources and functionality are visible to you after authenticating. Different users are typically granted different permissions, and the Cloud Console hides or exposes items accordingly.&lt;/p&gt;

	&lt;p&gt;How to test permissions&lt;/p&gt;

	&lt;p&gt;This example shows how to test the resourcemanager.projects.get and resourcemanager.projects.delete permissions for a Google Cloud project. To test permissions for other Google Cloud resources, use the testIamPermissions() method exposed by each resource. For example, you can test the IAM permissions for a Cloud Storage bucket.&lt;/p&gt;

	&lt;p&gt;In this example, the user has an IAM role that allows them to get information about a project, but not to delete projects.&lt;/p&gt;

	&lt;p&gt;The Resource Manager API's projects.testIamPermissions method accepts a list of permissions and tests which of the permissions a member has.&lt;/p&gt;

	&lt;p&gt;Before using any of the request data below, make the following replacements:&lt;/p&gt;

	&lt;p&gt;project-id: Your Google Cloud project ID.&lt;br /&gt;
HTTP method and URL:&lt;/p&gt;

	&lt;p&gt;POST https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;Request JSON body:&lt;/p&gt;

	&lt;p&gt;{
  "permissions":  [
    "resourcemanager.projects.get",
    "resourcemanager.projects.delete"
  ]&lt;br /&gt;
}&lt;/p&gt;

	&lt;p&gt;Note: Ensure you have set the GOOGLE_APPLICATION_CREDENTIALS environment variable to your service account private key file path.&lt;br /&gt;
Save the request body in a file called request.json, and execute the following command:&lt;/p&gt;

	&lt;p&gt;curl -X POST \&lt;br /&gt;
-H "Authorization: Bearer "$(gcloud auth application-default print-access-token) \&lt;br /&gt;
-H "Content-Type: application/json; charset=utf-8" \&lt;br /&gt;
-d @request.json \&lt;br /&gt;
https://cloudresourcemanager.googleapis.com/v1/projects/project-id:testIamPermissions&lt;/p&gt;

	&lt;p&gt;You should receive a JSON response similar to the following:&lt;/p&gt;

	&lt;p&gt;{
  "permissions": [
    "resourcemanager.projects.get"
  ]&lt;br /&gt;
}&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.531">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN5" name="Create alerts for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Create alerts for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; You can use Cloud Monitoring to send notification about certain events, such as uptime check failures.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; General steps to create an alerting policy:&lt;/p&gt; 
&lt;p&gt;1. In the Cloud Console, select Monitoring.&lt;/p&gt; 
&lt;p&gt;2. Select Alerting.&lt;/p&gt; 
&lt;p&gt;3. Click Create Policy to see the Create alerting policy page.&lt;/p&gt; 
&lt;p&gt;a. Click Add condition and complete the dialog. For information on the fields in a condition, see Specifying conditions.&lt;/p&gt; 
&lt;p&gt;A condition describes a monitored resource, a metric for that resource, and when the condition is met. An alerting policy must have at least 1 condition, however alerting policies can contain up to 6 conditions. When an alerting policy has exactly 1 condition and when that condition is met, an incident is created. When an alerting policy has multiple conditions, you specify how these conditions are combined.&lt;/p&gt; 
&lt;p&gt;b. Click Next to advance to the notifications section.&lt;/p&gt; 
&lt;p&gt;c. To be informed when an incident is created, add a notification channel to your alerting policy. You can add multiple notification channels. For details about your choices of notification channels, see Notification options.&lt;/p&gt; 
&lt;p&gt;To add a notification channel, click Notification channels. In the dialog, select one or more notification channels from the menu and then click OK.&lt;/p&gt; 
&lt;p&gt;To add a notification channel to the list of channels, click Manage notification channels. You are taken to the Notification channels page in a new browser tab. From this page, you can update the configured notification channels. When you have completed your updates, return to the original tab, click Refresh, and then select the notification channels to add to the alerting policy.&lt;/p&gt; 
&lt;p&gt;d. (Optional) To be notified when an incident is opened and closed, then select Notify on incident closure. By default, notifications are sent only when an incident is opened.&lt;/p&gt; 
&lt;p&gt;e. (Optional) If the field Incident autoclose duration is shown, then set the value of this field to be the duration that Monitoring should wait before closing incidents when observations stop arriving. The default value of this field is seven days. The minimum auto-close duration is 30 minutes.&lt;/p&gt; 
&lt;p&gt;For example, assume that you have an alert with a metric threshold condition that monitors a virtual machine (VM). If you turn down the VM while an incident is open, then by default Monitoring waits for seven days before it closes the incident.&lt;/p&gt; 
&lt;p&gt;f. Click Next to advance to the documentation section.&lt;/p&gt; 
&lt;p&gt;g. Click Name and enter a policy name. This name is included in notifications and it is displayed in the Policies page.&lt;/p&gt; 
&lt;p&gt;h. (Optional) Specify the documentation to be included in notifications. To format your documentation, you can use Markdown. To pull information out of the policy itself to tailor the content of your documentation, you can use variables.&lt;/p&gt; 
&lt;p&gt;For example, documentation might include a title such as Addressing High CPU Usage and details that identify the project:&lt;/p&gt; 
&lt;p&gt; &lt;/p&gt;
&lt;ol&gt; 
 &lt;li&gt;Addressing High CPU Usage&lt;/li&gt; 
&lt;/ol&gt;
&lt;p&gt;&lt;/p&gt; 
&lt;p&gt;This note contains information about high CPU Usage.&lt;/p&gt; 
&lt;p&gt;You can include variables in the documentation. For example:&lt;/p&gt; 
&lt;p&gt;This alert originated from the project ${project}, using&lt;br&gt; the variable $${project}.&lt;/p&gt; 
&lt;p&gt;The value replaces the variable only in notifications. The Preview Markdown pane, and the other places in the Cloud Console that show the documentation, reflect only the Markdown formatting.&lt;/p&gt; 
&lt;p&gt;You can also include channel-specific tagging to control notifications.&lt;/p&gt; 
&lt;p&gt;4. Click Save.&lt;/p&gt; 
&lt;p&gt;For more information, please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Monitoring Health and Performance" url="https://cloud.google.com/run/docs/monitoring"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;View alerting policy&lt;/p&gt;

	&lt;p&gt;1. In the Cloud Console, select Monitoring.&lt;/p&gt;

	&lt;p&gt;2. In the navigation pane, select notifications Alerting.&lt;/p&gt;

	&lt;p&gt;3. To see all policies and to enable filtering, click See all policies in the Policies pane.&lt;/p&gt;

	&lt;p&gt;4. Find the policy that you want to view, and then select it.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.533">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN2" name="Enable Binary Authorization for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Enable Binary Authorization for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Binary Authorization is a deploy-time security control that ensures only trusted container images are deployed on Google Kubernetes Engine (GKE) or Cloud Run. With Binary Authorization, you can require images to be signed by trusted authorities during the development process and then enforce signature validation when deploying. By enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process.&lt;br&gt; With Binary Authorization and Cloud Run, you can enforce that a container:&lt;br&gt; - Was created using an approved build system&lt;br&gt; - Was approved by the QA team&lt;br&gt; - Was analyzed for vulnerabilities&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enable Binary Authorization on an existing Cloud Run service&lt;/p&gt; 
&lt;p&gt;This section describes how to enable Binary Authorization enforcement on an existing service.&lt;/p&gt; 
&lt;p&gt;Note: To activate enforcement after enabling it, you might need to deploy a revision or update service traffic.&lt;/p&gt; 
&lt;p&gt;To enable Binary Authorization enforcement on an existing service, do the following:&lt;/p&gt; 
&lt;p&gt;1. Go to the Cloud Run page in the Google Cloud Console.&lt;/p&gt; 
&lt;p&gt;2. Click the name of the service.&lt;/p&gt; 
&lt;p&gt;3. Click the Details tab.&lt;/p&gt; 
&lt;p&gt;4. To enable Binary Authorization enforcement on the service, click Enable.&lt;/p&gt; 
&lt;p&gt;5. Optional: To configure the Binary Authorization policy, click Configure Policy.&lt;/p&gt; 
&lt;p&gt;Note: Google Cloud recommends that you require Binary Authorization for Cloud Run by configuring an organization policy to do so. If the policy is not configured, Binary Authorization can be disabled by Cloud Run developers.&lt;/p&gt; 
&lt;p&gt;View the policy&lt;/p&gt; 
&lt;p&gt;To view the policy, click View policy.&lt;/p&gt; 
&lt;p&gt;To enable Binary Authorization on a new service, do the following:&lt;/p&gt; 
&lt;p&gt;1. Go to the Cloud Run page.&lt;/p&gt; 
&lt;p&gt;2. Click Create service. In the Create service form that displays:&lt;br&gt; a. Select Cloud Run as your development platform.&lt;br&gt; b. Select the region where you want your service located.&lt;br&gt; c. Enter the service name.&lt;br&gt; d. Click Next to continue to the Configure the service's first revision page.&lt;br&gt; e. Select Deploy one revision from an existing container image.&lt;br&gt; f. Enter or select the image to deploy.&lt;br&gt; g. Expand the Advanced settings section.&lt;br&gt; h. Click the Security tab.&lt;br&gt; i. Select the Verify container deployment with Binary Authorization checkbox.&lt;br&gt; Note: This checkbox might be disabled if your organization policy is set to require Binary Authorization for Cloud Run.&lt;br&gt; j. Optional: Click Configure policy to configure the Binary Authorization policy.&lt;br&gt; k. Deploy the service.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Enable Binary Authorization for Cloud Run" url="https://cloud.google.com/binary-authorization/docs/run/enabling-binauthz-cloud-run"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that Binary Authorization for Cloud Run is enabled.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.532">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN3" name="Protect Cloud Run container images using Cloud KMS" issueId="" issueLink="" platform="" cost="0" risk="64" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Protect Cloud Run container images using Cloud KMS&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; By default, container images deployed to Cloud Run are encrypted at rest with Google-managed encryption keys. Customers with higher security needs might want more control over the encryption of their resources at rest to improve their confidence in using the public cloud. A container image is such a resource.&lt;br&gt; Protect container images deployed to Cloud Run services using Cloud KMS customer managed encryption keys (CMEK). You can use this feature to protect containers imported by Cloud Run with a CMEK key at rest.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Enabling CMEK for a Cloud Run service&lt;/p&gt; 
&lt;p&gt;Any configuration change leads to the creation of a new revision. Subsequent revisions will also automatically get this configuration setting unless you make explicit updates to change it.&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service if you are configuring a new service you are deploying to. If you are configuring an existing service, click on the service, then click Edit and Deploy New Revision.&lt;/p&gt; 
&lt;p&gt;3. If you are configuring a new service, fill out the initial service settings page as desired, then click Next &amp;gt; Container, Variables &amp;amp; Secrets, Connections, Security to reach the service configuration page.&lt;/p&gt; 
&lt;p&gt;4. Click the Security tab.&lt;/p&gt; 
&lt;p&gt;5. Select the checkbox Use a customer-managed encryption key (CMEK) , then select the desired key from the Select a customer-managed key pulldown menu.&lt;/p&gt; 
&lt;p&gt;6. Click Create or Deploy.&lt;/p&gt; 
&lt;p&gt;Referencing keys from other projects&lt;/p&gt; 
&lt;p&gt;You can reference a key from another project, if your project's service account has been allowed to encrypt/decrypt the key.&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service if you are configuring a new service you are deploying to. If you are configuring an existing service, click on the service, then click Edit and Deploy New Revision.&lt;/p&gt; 
&lt;p&gt;3. If you are configuring a new service, fill out the initial service settings page as desired, then click Next &amp;gt; Container, Variables &amp;amp; Secrets, Connections, Security to reach the service configuration page.&lt;/p&gt; 
&lt;p&gt;4. Click the Security tab.&lt;/p&gt; 
&lt;p&gt;5. In the Security tab:&lt;/p&gt; 
&lt;p&gt;a. Select the checkbox Use a customer-managed encryption key (CMEK) .&lt;br&gt; b. Select Don't see your key? Enter key resource ID from the Select a customer-managed key pulldown list.&lt;br&gt; c. In the Add a secret by resource ID form, enter the secret from the other project, in the format projects/PROJECT_NAME/locations/LOCATION/keyRings/RING_NAME/cryptoKeys/KEY_NAME. You can alternatively copy and paste the resource ID from the other project if you have access to it, by selecting the key, clicking the Actions ellipsis at the right of the secret, and selecting Copy resource ID from the pulldown menu.&lt;br&gt; d. Click Deploy.&lt;/p&gt; 
&lt;p&gt;6. Click Create or Deploy.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using customer managed encryption keys" url="https://cloud.google.com/run/docs/securing/using-cmek"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Viewing security settings&lt;/p&gt;

	&lt;p&gt;To view the current security settings for your service:&lt;/p&gt;

	&lt;p&gt;1. Go to Cloud Run&lt;/p&gt;

	&lt;p&gt;2. Click the service you are interested in to open the Service details page.&lt;/p&gt;

	&lt;p&gt;3. Click the Revisions tab.&lt;/p&gt;

	&lt;p&gt;4. In the details panel at the right, the security setting is listed under the Security tab.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.532">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN6" name="Restrict ingress for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Restrict ingress for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; At a network level, by default, any resource on the internet is able to reach your Cloud Run service on its run.app URL or at a custom domain set up in Cloud Run. You can change this default by specifying a different setting for ingress.&lt;br&gt; Note that you can use this feature along with IAM authentication methods to manage access to a service.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Available ingress settings&lt;/p&gt; 
&lt;p&gt;The following settings are available:&lt;br&gt; All - Makes your service reachable from the internet. The IAM invoker permission is still enforced.&lt;/p&gt; 
&lt;p&gt;Internal - Only requests originating from a VPC network, Pub/Sub, Eventarc, or Workflows within the same project or VPC Service Controls perimeter are allowed to reach your service. The IAM invoker permission is still enforced.&lt;br&gt; There is no support for multi-tenancy, that is, multiple trust domains within the same project.&lt;/p&gt; 
&lt;p&gt;Internal and Cloud Load Balancing - Only accepts internal requests and requests coming through HTTP Load Balancing. The IAM invoker permission is still enforced.&lt;br&gt; If you use Identity-Aware Proxy, Google Cloud Armor, or Cloud CDN, this also prevents any bypassing of these by accessing the default URL.&lt;/p&gt; 
&lt;p&gt;Setting ingress&lt;/p&gt; 
&lt;p&gt;You can set ingress using any of the supported methods in the tabs below:&lt;/p&gt; 
&lt;p&gt;If deploying a new service:&lt;/p&gt; 
&lt;p&gt;1. Go to Cloud Run&lt;/p&gt; 
&lt;p&gt;2. Click Create Service and configure the first step (Service settings) as desired, then click Next&lt;/p&gt; 
&lt;p&gt;3. Configure the second step (Configuring the service's first revision) as desired, then click Next.&lt;/p&gt; 
&lt;p&gt;4. In the third step, Configure how this service is triggered, under the Ingress* label, select the ingress traffic you want to allow.&lt;/p&gt; 
&lt;p&gt;If you are configuring an existing service:&lt;/p&gt; 
&lt;p&gt;1. Click on the service.&lt;/p&gt; 
&lt;p&gt;2. Click the Triggers tab.&lt;/p&gt; 
&lt;p&gt;3. Under the Ingress label, select the ingress traffic you want to allow.&lt;/p&gt; 
&lt;p&gt;4. Click Save.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Restricting ingress for Cloud Run" url="https://cloud.google.com/run/docs/securing/ingress"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that ingress for Cloud Run is restricted  according to your needs.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.533">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN4" name="Use Google Cloud Armor with Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use Google Cloud Armor with Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; Google Cloud Armor helps you protect your Google Cloud deployments from multiple types of threats, including distributed denial-of-service (DDoS) attacks and application attacks like cross-site scripting (XSS) and SQL injection (SQLi). Google Cloud Armor features some automatic protections and some that you need to configure manually&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Google Cloud Armor with Google Kubernetes Engine (GKE) Ingress&lt;/p&gt; 
&lt;p&gt;After you configure a Google Cloud Armor security policy, you can use Kubernetes Ingress to enable it with GKE.&lt;/p&gt; 
&lt;p&gt;You can reference your security policy with a BackendConfig resource by adding the name of your security policy to the BackendConfig. The following BackendConfig manifest specifies a security policy named example-security-policy:&lt;/p&gt; 
&lt;p&gt;apiVersion: cloud.google.com/v1&lt;br&gt; kind: BackendConfig&lt;br&gt; metadata: namespace: cloud-armor-how-to name: my-backendconfig&lt;br&gt; spec: securityPolicy: name: "example-security-policy"&lt;/p&gt; 
&lt;p&gt;For more information, please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Integrating Google Cloud Armor with other Google products" url="https://cloud.google.com/armor/docs/integrating-cloud-armor"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Ensure that you are protecting Cloud Run with Google Cloud Armor.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.533">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CWE-89-PREPARED" name="Use prepared statements for all database queries" issueId="" issueLink="" platform="" cost="0" risk="62" state="Recommended" owner="JamesRabe" library="IR-Dataflows" source="DATAFLOW_RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Database injection attacks, such as SQLi (SQL Injection) rely on sending tainted client-side data which is used in dynamic SQL queries on the server-side in an unsafe manner. Creating queries by concatenating strings using untrusted data may result in&amp;nbsp;vulnerable code;&amp;nbsp;for example, an attacker appending an 'OR' statement to the customerName parameter in order to bypass checks and retrieve additional data from the database:&lt;/p&gt;&lt;p&gt;
 &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;String query = "SELECT user FROM users WHERE name = '"&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&amp;nbsp;+ request.getParameter("customerName")+"'";&lt;/p&gt;&lt;p&gt;The use of prepared statements with carefully controlled and validated input conditions mitigates SQLi and related attacks.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Database queries should always be executed using prepared statements or parameterized queries.&lt;/li&gt;&lt;li&gt;Queries through an Object-Relational mapper should also be treated as tainted input, and again executed using prepared statements to mitigate the threat.&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations>
            <implementation platform="C#">
              <desc>ClN0cmluZyBxdWVyeSA9ICJTRUxFQ1QgYWNjb3VudF9iYWxhbmNlIEZST00gdXNlcl9kYXRhIFdIRVJFIHVzZXJfbmFtZSA9ID8iOwp0cnkgewogCU9sZURiQ29tbWFuZCBjb21tYW5kID0gbmV3IE9sZURiQ29tbWFuZChxdWVyeSwgY29ubmVjdGlvbik7CiAJY29tbWFuZC5QYXJhbWV0ZXJzLkFkZChuZXcgT2xlRGJQYXJhbWV0ZXIoImN1c3RvbWVyTmFtZSIsIEN1c3RvbWVyTmFtZSBOYW1lLlRleHQpKTsKIAlPbGVEYkRhdGFSZWFkZXIgcmVhZGVyID0gY29tbWFuZC5FeGVjdXRlUmVhZGVyKCk7IAkKIH0gY2F0Y2ggKE9sZURiRXhjZXB0aW9uIHNlKSB7CiAJLy8gZXJyb3IgaGFuZGxpbmcKIH0g</desc>
            </implementation>
          </implementations>
          <references>
            <reference name="OSA SI-01 System And Information Integrity Policy And Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/39-08_02_SI-01"/>
            <reference name="OSA SI-10 Information Accuracy, Completeness, Validity, And Authenticity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/48-08_02_SI-10"/>
          </references>
          <standards>
            <standard ref="1" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="12" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="12.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="14" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="15" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="16" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="17" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="18" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="19" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="24" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="31" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="5.3.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="6" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="8" supportedStandardRef="csa-api-security-guidelines"/>
            <standard ref="API8:2019-Injection" supportedStandardRef="owasp-api-security-top-10"/>
            <standard ref="CA-8" supportedStandardRef="NIST 800-53"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
            <standard ref="ID.RA-1" supportedStandardRef="nist-csf"/>
            <standard ref="SI-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="SI-10" supportedStandardRef="NIST 800-53"/>
            <standard ref="cwe-top-25" supportedStandardRef="cwe-top-25-dangerous-weaknesses"/>
          </standards>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;For inputs receiving data that is subsequently added to - or used - in an SQL query:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Ensure SQL meta-characters are identified and properly escaped or encoded.&lt;/li&gt;&lt;li&gt;Data should used be in the form of parameterized SQL queries, rather than dynamically generated queries.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;To test data validation:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Review the code processing potentially tainted user input to SQL queries and confirm the data is executed only in pre-prepared parameterized SQL queries.&lt;/li&gt;&lt;li&gt;Review the acceptable input criteria, and build test cases that deviate from it (invalid characters, lengths, ranges etc.)&lt;/li&gt;&lt;li&gt;Pass invalid input to the application and review error trapping and handling.&lt;/li&gt;&lt;li&gt;Where unexpected exceptions occur, the application may be vulnerable to attack.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.750">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="C-GOOGLE-CLOUD-RUN7" name="Use VPC Service Controls for Cloud Run" issueId="" issueLink="" platform="" cost="0" risk="61" state="Recommended" owner="JamesRabe" library="Google Cloud Platform" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Use VPC Service Controls for Cloud Run&lt;/p&gt; 
&lt;p&gt;Rationale:&lt;br&gt; VPC Service Controls improves your ability to mitigate the risk of data exfiltration from Google Cloud services. You can use VPC Service Controls to create perimeters that protect the resources and data of services that you explicitly specify.&lt;/p&gt; 
&lt;p&gt;Remediation:&lt;br&gt; Setting up your organization to support VPC Service Controls&lt;/p&gt; 
&lt;p&gt;To use VPC Service Controls with Cloud Run, you must configure a service perimeter at the organization level. This setup ensures that VPC Service Controls checks are enforced when using Cloud Run and that developers can only deploy services that comply with VPC Service Controls.&lt;/p&gt; 
&lt;p&gt;Setting up a VPC Service Controls perimeter&lt;/p&gt; 
&lt;p&gt;The following steps show how to set up a VPC Service Controls perimeter.&lt;/p&gt; 
&lt;p&gt;1. Ensure that you have the required roles for administering VPC Service Controls.&lt;/p&gt; 
&lt;p&gt;2. In the Google Cloud Console, go to the VPC Service Controls page.&lt;/p&gt; 
&lt;p&gt;3. If you are prompted, select your Organization.&lt;/p&gt; 
&lt;p&gt;4. Click New Perimeter. Type a name for the perimeter.&lt;/p&gt; 
&lt;p&gt;5. Select the projects that you want to secure within the perimeter.&lt;/p&gt; 
&lt;p&gt;a. Click Projects.&lt;/p&gt; 
&lt;p&gt;b. In the Add Projects window, select the projects you want to add.&lt;br&gt; If you are using Shared VPC, make sure to add the host project and service projects.&lt;/p&gt; 
&lt;p&gt;c. Click the Add Projects button.&lt;/p&gt; 
&lt;p&gt;6. Select Cloud Run as the service that you want to secure within the perimeter.&lt;/p&gt; 
&lt;p&gt;a. Click Restricted Services.&lt;/p&gt; 
&lt;p&gt;b. Click Add Services.&lt;/p&gt; 
&lt;p&gt;c. Search for "Cloud Run." Then select Cloud Run API.&lt;/p&gt; 
&lt;p&gt;d. Click Add Cloud Run API.&lt;/p&gt; 
&lt;p&gt;7. Enable access for developers.&lt;/p&gt; 
&lt;p&gt;Turning on VPC Service Controls for Cloud Run prevents all access from outside the perimeter, including viewing and deploying services from machines not in the perimeter, such as company laptops. In order for developers and application operators to view and deploy resources within the perimeter, you must configure the perimeter ingress policy:&lt;/p&gt; 
&lt;p&gt;a. Click Ingress Policy.&lt;/p&gt; 
&lt;p&gt;b. Specify the Source, Identity, Project, and Services.&lt;/p&gt; 
&lt;p&gt;c. Click Add Rule.&lt;/p&gt; 
&lt;p&gt;If your organization uses Access Context Manager, you can also enable access for developers by setting access levels.&lt;/p&gt; 
&lt;p&gt;8. Click Create Perimeter.&lt;/p&gt; 
&lt;p&gt;Once you have completed these steps, all calls to the Cloud Run Admin API will be checked to ensure that they originate from within the same perimeter.&lt;/p&gt; 
&lt;p&gt;For more information please see Reference URL.&lt;/p&gt; 
&lt;p&gt;Impact:&lt;br&gt; None&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="Using VPC Service Controls (VPC SC)" url="https://cloud.google.com/run/docs/securing/using-vpc-service-controls"/>
          </references>
          <standards/>
          <customFields/>
          <test expiryDate="" expiryPeriod="0">
            <steps>	&lt;p&gt;Auditing existing services for VPC Service Controls compliance&lt;/p&gt;

	&lt;p&gt;After setting up VPC Service Controls, new services created in projects within the service perimeter are automatically checked for compliance. However, to avoid disruption of existing workloads, existing services continue to work and might not comply with organization policies.&lt;/p&gt;

	&lt;p&gt;Google recommends that you periodically audit your services to make sure your ingress and egress settings conform with the requirements, and update or redeploy services as necessary. For example, you could create a script that uses the Cloud Run Admin API to list your services and highlight those that do not specify the proper network settings.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:08.533">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="AUTHORIZATION" name="Authorization" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="LOSS-CONTROL_ENV" name="Attackers gain unauthorized access to the control of the environment" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could potentially gain unauthorized access to the control of the environment, due to user accounts - or role groups - not being well defined and configured. As a consequence attackers may be able to make changes without root approval.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="75" availability="75" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE_IAM-02">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN1" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN1" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="GENERAL" name="General" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A1-2017" name="Attackers gain access to the sensitive data through injecting code in the repositories" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Almost any source of data can be an injection vector: environment variables, parameters, external and internal web services, and all types of users. Injection flaws occur when an attacker can send hostile data to an interpreter.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-937">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN2" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN2" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="GOOGLE-DOS" name="Attackers perform a denial of service" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A Denial of Service (DoS) attack is a deliberate attempt to make your website unavailable. Attackers use a variety of techniques that consume large amount of resources.&lt;/p&gt;</desc>
              <riskRating confidentiality="50" integrity="50" availability="100" easeOfExploitation="100"/>
              <references/>
              <weaknesses>
                <weakness ref="SYSTEM-VUL-DOS">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN4" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN4" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
            <threat ref="ACCESS-TO-DATA" name="Sensitive data is compromised through unauthorized access to data storage" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;A data breach is a security violation in which sensitive, protected or confidential data is copied, transmitted, viewed, stolen or used by an individual unauthorized to do so. Sensitive data could be exposed due to a bad configuration in user permissions.&lt;/p&gt;</desc>
              <riskRating confidentiality="75" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-ACCESSIBLE-SENSITIVE-DATA">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN3" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN3" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="LOGGING AND MONITORING" name="Logging and Monitoring" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="OWASP-A10-2017" name="Exploitation of insufficient logging and monitoring" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>	&lt;p&gt;Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-778">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN5" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN5" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="NETWORKING" name="Networking" desc="" library="Google Cloud Platform">
          <threats>
            <threat ref="GOOGLE-UNAUTHORISED-CONNECTION" name="Attackers gain unauthorized connection to the resources" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="Google Cloud Platform" editable="true">
              <desc>&lt;p&gt;Attackers could gain an unauthorized connection to the resources through misconfigured ports or security network configurations.&lt;/p&gt;</desc>
              <riskRating confidentiality="25" integrity="25" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="GOOGLE-NET-01">
                  <countermeasures>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN6" mitigation="50"/>
                    <countermeasure ref="C-GOOGLE-CLOUD-RUN7" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN6" mitigation="50"/>
                <countermeasure ref="C-GOOGLE-CLOUD-RUN7" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="READ OR POST DATA" name="Read or Post data" desc="" library="IR-Dataflows">
          <threats>
            <threat ref="CAPEC-66" name="Attackers gain unauthorised access to data and/or systems through SQL Injection attacks" state="Expose" source="DATAFLOW_RULES" edited="false" owner="JamesRabe" library="IR-Dataflows" editable="true">
              <desc>&lt;p&gt;Successful SQL Injection attacks could lead to full compromise of the database or to a partial compromise of only the data visible to the application.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;Typically, these types of attacks result in unauthorized disclosure of sensitive data, but can also be used to inject spurious data into the database or to drop tables and deny services to legitimate users.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="25" easeOfExploitation="25"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-89">
                  <countermeasures>
                    <countermeasure ref="CWE-89-PREPARED" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="CWE-89-PREPARED" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Mitre" value=""/>
                <customField ref="Records" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="3603889f-cf86-46df-aadd-95200e148db9" diagramComponentId="57ed2592-a810-4579-a3ca-8fa7b0a71e7a" ref="897070cb-ea96-4f0c-ae29-7aaff1085908" name="Generic Client" desc="" library="CS-Default" parentComponentRef="" componentDefinitionRef="generic-client">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="internet"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses>
        <weakness ref="CWE-798, CWE-603" name="Client side code stores secret keys, sensitive business logic or other proprietary information" state="0" impact="100" issueId="" issueLink="">
          <desc>When client side code is fully controlled by the user, a malicious user may be able to read the code or reverse engineer it if it is compiled in any form. If the client side code includes secret keys, sensitive business logic (like client authentication) or proprietary information, all of this is directly exposed to the user, allowing them to get the sensitive information or study the business logic with the aim of bypassing it.&amp;nbsp; 
&lt;div&gt; 
 &lt;br /&gt; 
&lt;/div&gt; 
&lt;div&gt;
  Some examples of this vulnerability are:&amp;nbsp; 
 &lt;div&gt; 
  &lt;ul&gt; 
   &lt;li&gt;Performing an authentication on the client side without server side validation.&amp;nbsp;&lt;/li&gt; 
   &lt;li&gt;Making privileged calls from the client based solely on client side conditions (i.e. a cash check on the client side to place an order on an e-commerce platform).&lt;/li&gt; 
   &lt;li&gt;&amp;nbsp;Hard-coding keys and secrets on the client side to make client-to-client calls without a proxy.&lt;/li&gt; 
  &lt;/ul&gt; 
 &lt;/div&gt; 
&lt;/div&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.213">
              <output/>
            </source>
            <references>
              <reference name="CWE-602: client-side Enforcement of Server-Side Security" url="https://cwe.mitre.org/data/definitions/602.html"/>
              <reference name="CWE-603: Use of client-side Authentication" url="https://cwe.mitre.org/data/definitions/603.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="lack-automated-vuln-identification" name="Lack of automated vulnerability identification" state="0" impact="100" issueId="" issueLink="">
          <desc>Developmental security testing/evaluation is not enforced during post-design phases of the system development life cycle. Such testing/evaluation is necessary because it confirms that the required security controls are implemented correctly, operating as intended, enforcing the desired security policy, and meeting established security requirements.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.014">
              <output/>
            </source>
            <references>
              <reference name="Risk-Based and Functional Security Testing" url="https://www.us-cert.gov/bsi/articles/best-practices/security-testing/risk-based-and-functional-security-testing"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-311" name="Missing Encryption of Sensitive Data" state="0" impact="100" issueId="" issueLink="">
          <desc>The software does not encrypt sensitive or critical information
                        before storage or transmission.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.213">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-312" name="Secrets, API keys and or passwords are included in the source code or online repositories" state="0" impact="100" issueId="" issueLink="">
          <desc>API keys, passwords or secrets included in the source code or in the configuration files can be leaked to users with access to the code. This access can be incidentally granted by publishing the source code on a package-form or an online, public repository.

          The unauthorized access to any of those secrets could lead to a compromise of sensitive data or a system.</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.213">
              <output/>
            </source>
            <references>
              <reference name="CWE-312: Secrets, API keys and or passwords are included in the source code or online repositories" url="https://cwe.mitre.org/data/definitions/312.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-477" name="Use of Obsolete Function" state="0" impact="75" issueId="" issueLink="">
          <desc>The code uses deprecated or obsolete functions, which suggests that the code has not been actively reviewed or maintained.
&lt;br /&gt;</desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.212">
              <output/>
            </source>
            <references>
              <reference name="CWE-477: Use of Obsolete Function" url="https://cwe.mitre.org/data/definitions/477.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
        <weakness ref="CWE-327" name="Use of a Broken or Risky Cryptographic Algorithm" state="0" impact="100" issueId="" issueLink="">
          <desc>The use of a broken or risky cryptographic algorithm is an unnecessary risk that may result in
                        the exposure of sensitive information.
                    </desc>
          <test expiryDate="" expiryPeriod="0">
            <steps/>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.213">
              <output/>
            </source>
            <references>
              <reference name="CWE-327: Use of a Broken or Risky Cryptographic Algorithm" url="https://cwe.mitre.org/data/definitions/327.html"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </weakness>
      </weaknesses>
      <countermeasures>
        <countermeasure ref="CWE-319-TRANSPORT" name="Encrypt data between the client and server/service" issueId="" issueLink="" platform="" cost="0" risk="68" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Data passed between the client and server should be protected by encryption in transit.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Implement cryptographically strong TLS end-to-end encryption between the client and server, terminating within a secure environment on the server-side.&lt;/li&gt;&lt;li&gt;Consider use of client certificates to prevent interception of (or man-in-the-middle attacks on) the encrypted connection.&lt;/li&gt;&lt;li&gt;Alternatively, asymmetric (public-key) encryption could be utilized and a recognized, proven, and tested implementation/library should be used&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA AC-03 Access Enforcement" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/25-08_02_AC-03"/>
            <reference name="OSA AC-06 Least Privilege" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/28-08_02_AC-06"/>
            <reference name="OSA AC-14 Permitted Actions Without Identification Or Authentication" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/38-08_02_AC-14"/>
            <reference name="OSA AC-16 Automated Labeling" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/198-08_02_AC-16"/>
            <reference name="OSA SC-08 Transmission Integrity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/68-08_02_SC-08"/>
            <reference name="OSA SC-13 Use Of Cryptography" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/73-08_02_SC-13"/>
          </references>
          <standards>
            <standard ref="1.9.1" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.9.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="13.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="13.2.6" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="13.2.6" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="164.312(a)(1)(D)" supportedStandardRef="hipaa-addressable"/>
            <standard ref="164.312(e)(1)(A)" supportedStandardRef="hipaa-addressable"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L1"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L1+R"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L2"/>
            <standard ref="5.1" supportedStandardRef="OWASP-MASVS-L2+R"/>
            <standard ref="9.1.1" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="9.1.1" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="9.1.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="9.2.2" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="9.2.2" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="9.2.3" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="9.2.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="9.2.4" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="9.4.3" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-14" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-14" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-16" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-3" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-3" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-6" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-6" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-6" supportedStandardRef="NIST 800-53"/>
            <standard ref="PR.AC-4" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-6" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-7" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-2" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-5" supportedStandardRef="nist-csf"/>
            <standard ref="PR.PT-3" supportedStandardRef="nist-csf"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="SC-13" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="SC-13" supportedStandardRef="NIST 800-53"/>
            <standard ref="SC-8" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="SC-8" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="SC-8" supportedStandardRef="NIST 800-53"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Check client to server connections use and enforce established encryption protocols, e.g. TLSv1.2.&lt;br&gt;&amp;nbsp;&lt;/li&gt;&lt;li&gt;Verify only strong cipher suites are in use and permitted.&lt;/li&gt;&lt;li&gt;Ensure attempts to use unencrypted transport mechanisms are rejected or redirected (e.g. HTTP instead of HTTPS)&lt;/li&gt;&lt;li&gt;Review configuration of protocols and services against best-practice guidelines.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references>
              <reference name="Server Side TLS Configuration" url="https://wiki.mozilla.org/Security/Server_Side_TLS"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="INS-CLIENT" name="Ensure the application does not use unsupported, insecure, or deprecated client-side technologies" issueId="" issueLink="" platform="" cost="0" risk="60" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Ensure the application does not use unsupported, insecure, or deprecated client-side technologies such as: NSAPI plugins, Flash, Shockwave, ActiveX, Silverlight, NACL, or client-side Java applets.&lt;/p&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="1.14.6" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.14.6" supportedStandardRef="owasp-asvs4-level-3"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ul&gt;
 &lt;li&gt;Test the presence of any client side applet such as Flash, ActiveX and Silverlight.&lt;/li&gt;
&lt;/ul&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references>
              <reference name="Testing Information Gathering" url="https://www.owasp.org/index.php/Testing_Information_Gathering"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CS-CLIENT-SECRET" name="Implement sensitive logic and data validation on the server-side" issueId="" issueLink="" platform="" cost="1" risk="73" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;All data and functionalities on the client-side must be considered tainted and subject to manipulation by a malicious actor, regardless of the controls in place (e.g. encryption or obfuscation of client-side code or content). &lt;/p&gt; This includes application logic decisions, such as access controls, and data considered sensitive or secret, such as encryption keys. While controls may be duplicated on the client-side to improve the user experience, it is important to have these enforced on the server-side.&amp;nbsp; 
&lt;div&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Business logic, in particular access controls, must be implemented on the server-side.&lt;/li&gt; 
  &lt;li&gt;Secret data should be stored on the server-side, and only what is explicitly required should be duplicated on the client-side.&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt;All data provided from the client-side (even from binary clients) should be considered tainted, and security decisions should not be made solely on this data. For example, an insecure implementation could include a compiled application (e.g. Flash!) performing authentication on the client-side against a stored password. The decompilation of the binary (in this case flv file) or the interception and modification of controls between the client and server could expose the password or allow unauthorized access to the authenticated application content. 
&lt;/div&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA AC-01 Access Control Policies and Procedures" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/23-08_02_AC-01"/>
            <reference name="OSA SI-10 Information Accuracy, Completeness, Validity, And Authenticity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/48-08_02_SI-10"/>
            <reference name="OWASP Juice Shop: Broken Access Control" url="https://pwning.owasp-juice.shop/part2/broken-access-control.html"/>
            <reference name="OWASP Juice Shop: Injection" url="https://pwning.owasp-juice.shop/part2/injection.html"/>
          </references>
          <standards>
            <standard ref="12.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="2.4.11.7" supportedStandardRef="iotsf-class-0"/>
            <standard ref="2.4.11.7" supportedStandardRef="iotsf-class-1"/>
            <standard ref="2.4.11.7" supportedStandardRef="iotsf-class-2"/>
            <standard ref="4.1.1" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="4.1.1" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="4.1.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="A01:2021-Broken Access Control" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A03:2021-Injection" supportedStandardRef="owasp-top-10-2021"/>
            <standard ref="A1:2017-Injection" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="A5:2017-Broken Access Control" supportedStandardRef="owasp-top-10-2017"/>
            <standard ref="AC-1" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="AC-1" supportedStandardRef="fedramp-low-baseline"/>
            <standard ref="AC-1" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="AC-1" supportedStandardRef="NIST 800-53"/>
            <standard ref="AC-24" supportedStandardRef="NIST 800-53"/>
            <standard ref="ID.GV-1" supportedStandardRef="nist-csf"/>
            <standard ref="ID.GV-3" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-1" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-3" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-4" supportedStandardRef="nist-csf"/>
            <standard ref="PR.AC-6" supportedStandardRef="nist-csf"/>
            <standard ref="SI-10" supportedStandardRef="NIST 800-53"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;&lt;/p&gt; 
&lt;ul&gt; 
 &lt;li&gt;Identify where critical decisions are made on the application. Key areas include:&amp;nbsp;&lt;/li&gt; 
 &lt;ul&gt; 
  &lt;li&gt;authentication&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;input validation&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;access to resources&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;state bypasses&amp;nbsp;&lt;/li&gt; 
 &lt;/ul&gt; 
 &lt;li&gt;Ensure those decisions are made or validated on the server side, particularly where client-side controls are implemented.&amp;nbsp;&lt;/li&gt; 
 &lt;li&gt;Verify that sensitive data passed to the client side is appropriate, and ensure no inappropriate data is stored or hard-coded into client-side components, for example&amp;nbsp;&lt;/li&gt; 
 &lt;ul&gt; 
  &lt;li&gt;Personally Identifiable Information.&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Financial data, in particular cardholder data (as defined by the &lt;span class="caps"&gt;PCI&lt;/span&gt; Council).&amp;nbsp;&lt;/li&gt; 
  &lt;li&gt;Application secrets - such as symmetric encryption keys or passwords.&lt;/li&gt; 
 &lt;/ul&gt; 
&lt;/ul&gt; 
&lt;p&gt;&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CSD-CLIENT-SECRET" name="Review code, configuration, and online repositories for secrets and sensitive information systemically" issueId="" issueLink="" platform="" cost="0" risk="73" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Secret or sensitive information should not be exposed in source-code or client-side software.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Code and online repositories must not contain secrets or sensitive information.&lt;/li&gt;&lt;li&gt;Configuration files on the client- and server-side must not contain hard-coded credentials or other sensitive data.&lt;/li&gt;&lt;li&gt;Online repositories, services, and other associated restricted content must have appropriate access controls in place.&lt;/li&gt;&lt;li&gt;Where sensitive information must be stored on the server side, it should be in memory for transient data, or encrypted if persistent. &amp;nbsp;Depending on the use case, this encryption may be asymmetric or public key, or symmetric using a shared secret. Note however that reversible encryption on the client-side and in-memory storage are still susceptible to client-side attacks.&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="10.1.2" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="2.10.4" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="2.10.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="AU-13" supportedStandardRef="NIST 800-53"/>
            <standard ref="DE.CM-3" supportedStandardRef="nist-csf"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Use automated tools to regularly search for keywords or regular expression patterns within the code, configuration and other files exposed on the client and server-side, and any remote repositories.&lt;/li&gt;&lt;li&gt;The scanning process must be triggered before the code is published (in particular for public/open source code) as once published it is likely to be archived (and any disclosed secrets would be exposed and/or have to be changed)&lt;/li&gt;&lt;li&gt;Review criteria and requirements for any temporary or persistent storage of sensitive or secret data on the client-side, and the protections in place.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references>
              <reference name="Microsoft Exchange 2016 Sensitive Information Patterns" url="https://technet.microsoft.com/en-us/library/jj150541(v=exchg.160).aspx"/>
              <reference name="Prevents you from committing secrets and credentials into git repositories" url="https://github.com/awslabs/git-secrets"/>
              <reference name="Seekret" url="https://github.com/apuigsech/seekret"/>
            </references>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="use-analysis-static-code" name="Scan the code with static code analysis tools" issueId="" issueLink="" platform="" cost="0" risk="78" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;div&gt;
  Use periodically a static code analysis tool to analyze the code and detect potentially malicious code, such as time functions, unsafe file operations and networks connections. With the scanning of static code, we ensure the integrity of the application. 
&lt;/div&gt;</desc>
          <implementations/>
          <references/>
          <standards>
            <standard ref="10.1.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.3" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.4" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.5" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="10.2.6" supportedStandardRef="owasp-asvs4-level-3"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;div&gt;
  Verify that a code analysis tool is in use and it is configured to detect potentially malicious code, such as time functions, unsafe file operations and network connections. 
&lt;/div&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:12.979">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="secure-communication-ra-and-csp" name="Use secure communication between CSP and RA" issueId="" issueLink="" platform="" cost="0" risk="68" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;In situations where the verifier and CSP are separate entities, communications between RA (Registration Authority) and CSP (Credential Service Provider), should be authenticated with a mutually-authenticated secure channel, such as a client-authenticated TLS connection, using approved cryptographic algorithms.&lt;/p&gt;
&lt;p&gt;NIST's digital identity model involves some entities:&lt;/p&gt;
&lt;p&gt;- CSP (Credential Service Provider): A credential service provider is a trusted entity that issues security tokens or electronic credentials to subscribers. A CSP forms part of an authentication system, most typically identified as a separate entity in a Federated authentication system. A CSP may be an independent third party, or may issue credentials for its own use. Credential Service Provider is typically also the Identity Provider (IDP). An example of a CSP would be an online site whose primary purpose may be, for example, internet banking - but whose users may be subsequently authenticated to other sites, applications or services without further action on their part.&lt;/p&gt;
&lt;p&gt;- Registration Authority (RA): A trusted entity that establishes and vouches for the identity of a subscriber to a CSP. The RA may be an integral part of a CSP, or it may be independent of a CSP, but it has a relationship to the CSP.&lt;/p&gt;
&lt;p&gt;- Verifier: This refers to an entity that verifies the claimant's identity by verifying the claimant's possession and control of one or two authenticators, using an authentication protocol.&lt;/p&gt;
&lt;p&gt;- RP (Relying party): This refers to an entity that relies on the subscriber's authenticator(s) and credentials or a verifier's assertion of a claimant's identity, typically to process a transaction or grant access to information or a system.&lt;/p&gt;
&lt;p&gt;- Applicant: This refers to a subject undergoing the processes of enrollment and identity proofing.&lt;/p&gt;
&lt;p&gt;- Claimant: This refers to a subject whose identity is to be verified using one or more authentication protocols.&lt;/p&gt;
&lt;p&gt;- Subscriber: This refers to a party who has received a credential or an authenticator from a CSP.&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="NIST 800-63-1" url="https://csrc.nist.rip/groups/SMA/forum/documents/feb2012_nist-sp-800-63-1_newton-perlner.pdf"/>
            <reference name="NIST 800-63C" url="https://pages.nist.gov/800-63-3/sp800-63c.html"/>
          </references>
          <standards>
            <standard ref="2.2.5" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="5.2.6" supportedStandardRef="nist-800-63"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;p&gt;Verify the CSP and RA communicate securely with a secure channel, for example with TLS.&lt;/p&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.098">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CWE-295-CLIENT" name="Validate the certificate presented by the server" issueId="" issueLink="" platform="" cost="0" risk="68" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;Certificates presented by the server must be valid, provable, and cryptographically secure in order to derive the benefits of TLS encrypted communications.&amp;nbsp; Invalid certificates expose the application and its users to spoofing attacks such as Man In The Middle (MITM) where data may be intercepted or redirected to a malicious site, and undermine confidence in the site.&lt;/p&gt;&lt;p&gt;Validate the certificate presented by the server is signed by a trusted Certificate Authority.&lt;/p&gt;&lt;p&gt;Ensure the certificate chain of trust is legitimate and secure.&lt;/p&gt;&lt;p&gt;Verify cryptographically secure ciphers are in use throughout the chain, in particular strong hashing algorithms for certificate signatures.&amp;nbsp;&lt;/p&gt;</desc>
          <implementations/>
          <references>
            <reference name="OSA SC-11 Trusted Path" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/71-08_02_SC-11"/>
            <reference name="OSA SC-17 Public Key Infrastructure Certificates" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/77-08_02_SC-17"/>
          </references>
          <standards>
            <standard ref="1.9.2" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="1.9.2" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="13.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="164.312(e)(1)(B)" supportedStandardRef="hipaa-addressable"/>
            <standard ref="9.2.1" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="9.2.1" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="PR.DS-2" supportedStandardRef="nist-csf"/>
            <standard ref="SC-11" supportedStandardRef="NIST 800-53"/>
            <standard ref="SC-17" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="SC-17" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="SC-17" supportedStandardRef="NIST 800-53"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Verify the client is conducting appropriate checks and receives a positive response regarding the validity and quality of the site certificate.&lt;/li&gt;&lt;li&gt;Use TLS analysis tools to check and rate the server security, for example:&lt;ol&gt;&lt;li&gt;SSL Labs SSL Server Test:&amp;nbsp;https://www.ssllabs.com/ssltest/&lt;/li&gt;&lt;li&gt;sslscan tool: https://github.com/rbsec/sslscan&lt;/li&gt;&lt;li&gt;testssh.sh tool: https://github.com/drwetter/testssl.sh&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Remediate all security issues and warnings relating to the server certificate, and those in the trust chain.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
        <countermeasure ref="CWE-327" name="Validate the TLS implementation in use" issueId="" issueLink="" platform="" cost="0" risk="68" state="Recommended" owner="JamesRabe" library="CS-Default" source="RULES" edited="false" stateChangeSource="" priority="">
          <desc>&lt;p&gt;There are a number of established open- and closed- source TLS implementations in use, which have undergone extensive review and testing by the developers, as well as third-parties in the development, security, and cryptography space. Typically, these widely used implementations have a lower risk of exploitation compared with privately developed - or less known - implementations (although vulnerabilities such as Heartbleed highlight this is not universally true) due to this additional scrutiny scrutiny.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify the TLS and other cryptographic libraries, implementations, and technologies in use.&lt;/li&gt;&lt;li&gt;Verify the veracity of the implementations, and review third party validations together with security advisories or best-practices relating to them.&lt;/li&gt;&lt;li&gt;Some well-known TLS libraries are NSS from Mozilla, and OpenSSL.&lt;/li&gt;&lt;li&gt;Where an unknown or unproven implementation is in use, consider use of an established option.&lt;/li&gt;&lt;/ul&gt;</desc>
          <implementations/>
          <references>
            <reference name="Mozilla SSL Config" url="https://ssl-config.mozilla.org/"/>
            <reference name="OSA SC-08 Transmission Integrity" url="https://www.opensecurityarchitecture.org/cms/library/08_02_control-catalogue/68-08_02_SC-08"/>
            <reference name="Server Side TLS Configuration" url="https://wiki.mozilla.org/Security/Server_Side_TLS"/>
          </references>
          <standards>
            <standard ref="13.2.1" supportedStandardRef="ISO/IEC 27002:2013"/>
            <standard ref="164.312(e)(1)(B)" supportedStandardRef="hipaa-addressable"/>
            <standard ref="9.1.2" supportedStandardRef="owasp-asvs4-level-1"/>
            <standard ref="9.1.2" supportedStandardRef="owasp-asvs4-level-2"/>
            <standard ref="9.1.2" supportedStandardRef="owasp-asvs4-level-3"/>
            <standard ref="PR.DS-2" supportedStandardRef="nist-csf"/>
            <standard ref="PR.DS-5" supportedStandardRef="nist-csf"/>
            <standard ref="SC-8" supportedStandardRef="fedramp-high-baseline"/>
            <standard ref="SC-8" supportedStandardRef="fedramp-moderate-baseline"/>
            <standard ref="SC-8" supportedStandardRef="NIST 800-53"/>
          </standards>
          <customFields>
            <customField ref="Compensating Controls" value=""/>
          </customFields>
          <test expiryDate="" expiryPeriod="0">
            <steps>&lt;ol&gt;&lt;li&gt;Confirm the TLS layer in use is a secure, stable, release of a publicly published implementation that has been subject to expert analysis and review.&lt;ul&gt;&lt;li&gt;If not, assurance of the security of the implementation should be sought, or the risk quantified.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;Verify that a client connecting to the server will only be able to negotiate cryptographically strong, secure ciphers.&lt;/li&gt;&lt;li&gt;Confirm that a client can not downgrade to a weaker cipher after initial negotiation.&lt;/li&gt;&lt;li&gt;Use TLS analysis tools to check and rate the server security, for example:&lt;ol&gt;&lt;li&gt;SSL Labs SSL Server Test:&amp;nbsp;https://www.ssllabs.com/ssltest/&lt;/li&gt;&lt;li&gt;sslscan tool: https://github.com/rbsec/sslscan&lt;/li&gt;&lt;li&gt;testssh.sh tool: https://github.com/drwetter/testssl.sh&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;Remediate all security issues and warnings relating to the TLS/SSL ciphers, protocols, and security mechanisms.&lt;/li&gt;&lt;/ol&gt;</steps>
            <notes/>
            <source filename="" args="" type="Manual" result="Not Tested" enabled="true" timestamp="2022-12-14T14:44:13.097">
              <output/>
            </source>
            <references/>
            <customFields>
              <customField ref="Documentation Links" value=""/>
            </customFields>
          </test>
        </countermeasure>
      </countermeasures>
      <usecases>
        <usecase ref="GENERAL" name="General" desc="" library="CS-Default">
          <threats>
            <threat ref="sec-vuln-dev-process" name="Application contains security vulnerabilities not identified during the development process" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>Application security should be embedded into a project's development environment, allowing developers to monitor their code regularly in order to avoid security vulnerabilities when the application is deployed in the production environment.</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="100"/>
              <references>
                <reference name="NIST Security Considerations in the System Development Life Cycle" url="https://csrc.nist.gov/publications/detail/sp/800-64/rev-2/archive/2008-10-16"/>
                <reference name="Risk-Based and Functional Security Testing" url="https://www.us-cert.gov/bsi/articles/best-practices/security-testing/risk-based-and-functional-security-testing"/>
              </references>
              <weaknesses>
                <weakness ref="lack-automated-vuln-identification">
                  <countermeasures>
                    <countermeasure ref="use-analysis-static-code" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="use-analysis-static-code" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="CSD-CLIENT-SECRET" name="Attackers gain unauthorised access to data or services by accessing a client side secret" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>Secrets stored in any client side components, such as a mobile application, thick
                                client application or in JavaScript used by a browser, can be accessed by
                                users/attackers who have access to this client.
                                &lt;div&gt;
                                &lt;br /&gt;
                                &lt;/div&gt;
                                &lt;div&gt;
                                Attackers could then gain access to the data or services that are protected by this
                                secret, if no other credentials are required.
                                &lt;/div&gt;
                            </desc>
              <riskRating confidentiality="100" integrity="50" availability="50" easeOfExploitation="75"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-312">
                  <countermeasures>
                    <countermeasure ref="CSD-CLIENT-SECRET" mitigation="50"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-798, CWE-603">
                  <countermeasures>
                    <countermeasure ref="CS-CLIENT-SECRET" mitigation="50"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="CS-CLIENT-SECRET" mitigation="50"/>
                <countermeasure ref="CSD-CLIENT-SECRET" mitigation="50"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
            <threat ref="DEP-CLIENT-TECH" name="Attackers gain unauthorised access to the application by the use of deprecated client-side technologies" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;div&gt;
  As programming languages evolve, functions occasionally become obsolete due to:
&lt;/div&gt;
&lt;ul&gt;
 &lt;li&gt;Advances in the language.&lt;/li&gt;
 &lt;li&gt;Improved understanding of how operations should be performed effectively and securely.&lt;/li&gt;
 &lt;li&gt;Changes in the conventions that govern certain operations. &lt;/li&gt;
&lt;/ul&gt;
&lt;br /&gt;Functions that are removed are usually replaced by newer counterparts that perform the same task in some different and hopefully improved way.
&lt;br /&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="50" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-477">
                  <countermeasures>
                    <countermeasure ref="INS-CLIENT" mitigation="100"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="INS-CLIENT" mitigation="100"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
        <usecase ref="READ OR POST DATA" name="Read or Post data" desc="" library="CS-Default">
          <threats>
            <threat ref="NTW-MITM" name="Attackers could gain access to sensitive data through a man in the middle attack" state="Expose" source="RULES" edited="false" owner="JamesRabe" library="CS-Default" editable="true">
              <desc>&lt;p&gt;This type of attack targets the communication between two components (typically client and server). The attacker places himself in the communication channel between the two components. Whenever one component attempts to communicate with the other (data flow, authentication challenges, etc.), the data first goes to the attacker, who has the opportunity to observe or alter it, and it is then passed to the other component as if it were never intercepted. This interposition is transparent leaving the two compromised components unaware of the potential corruption or leakage of their communications. The potential for Man-in-the-Middle attacks yields an implicit lack of trust in communication or identity between two components.&lt;/p&gt;</desc>
              <riskRating confidentiality="100" integrity="100" availability="100" easeOfExploitation="50"/>
              <references/>
              <weaknesses>
                <weakness ref="CWE-311">
                  <countermeasures>
                    <countermeasure ref="CWE-295-CLIENT" mitigation="25"/>
                    <countermeasure ref="CWE-319-TRANSPORT" mitigation="25"/>
                    <countermeasure ref="secure-communication-ra-and-csp" mitigation="25"/>
                  </countermeasures>
                </weakness>
                <weakness ref="CWE-327">
                  <countermeasures>
                    <countermeasure ref="CWE-327" mitigation="25"/>
                  </countermeasures>
                </weakness>
              </weaknesses>
              <countermeasures>
                <countermeasure ref="CWE-295-CLIENT" mitigation="25"/>
                <countermeasure ref="CWE-319-TRANSPORT" mitigation="25"/>
                <countermeasure ref="CWE-327" mitigation="25"/>
                <countermeasure ref="secure-communication-ra-and-csp" mitigation="25"/>
              </countermeasures>
              <customFields>
                <customField ref="Attack Complexity" value=""/>
                <customField ref="Attack Vector" value=""/>
                <customField ref="Mitre" value=""/>
                <customField ref="Privileges Required" value=""/>
                <customField ref="Records" value=""/>
                <customField ref="STRIDE" value=""/>
                <customField ref="User Interaction" value=""/>
              </customFields>
            </threat>
          </threats>
        </usecase>
      </usecases>
    </component>
    <component uuid="2889ad67-9322-4000-bd6f-078ba0759e8a" diagramComponentId="720a7e29-2048-416a-b4fc-7be847c821fe" ref="e584374a-206f-43f5-a0ef-ace77965ea87" name="Build Process" desc="" library="CS-Default" parentComponentRef="ef612fc3-c2c3-4285-9142-3de04b0bfeb3" componentDefinitionRef="empty-component">
      <tags/>
      <questions/>
      <trustZones>
        <trustZone ref="public"/>
      </trustZones>
      <assets/>
      <settings/>
      <weaknesses/>
      <countermeasures/>
      <usecases/>
    </component>
  </components>
</template>
